<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><title>SLED 15 SP6 | Security and Hardening Guide | Intrusion detection with AIDE</title><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"/>
<meta name="title" content="Intrusion detection with AIDE | SLED 15 SP6"/>
<meta name="description" content="Securing your systems is a mandatory task for any mission-critical system administrator. Because it is impossible to always guarantee that the system…"/>
<meta name="product-name" content="SUSE Linux Enterprise Desktop"/>
<meta name="product-number" content="15 SP6"/>
<meta name="book-title" content="Security and Hardening Guide"/>
<meta name="chapter-title" content="Chapter 20. Intrusion detection with AIDE"/>
<meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi"/>
<meta name="tracker-type" content="bsc"/>
<meta name="tracker-bsc-assignee" content="fs@suse.com"/>
<meta name="tracker-bsc-component" content="Documentation"/>
<meta name="tracker-bsc-product" content="PUBLIC SUSE Linux Enterprise Desktop 15 SP6"/>
<meta name="publisher" content="SUSE"/><meta property="og:title" content="Security and Hardening Guide"/>
<meta property="og:description" content="Implement system security and hardening for SLED"/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Security and Hardening Guide"/>
<meta name="twitter:description" content="Implement system security and hardening for SLED"/>
<script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": ["TechArticle"],
    "image": "https://www.suse.com/assets/img/suse-white-logo-green.svg",
    
     "isPartOf": {
      "@type": "CreativeWorkSeries",
      "name": "Products &amp; Solutions"
    },
    
    "inLanguage": "en",
    

    "headline": "Intrusion detection with AIDE",
  
    "description": "Securing your systems is a mandatory task for any mission-critical system administrator. Because it is impossible to always guarantee that the system…",
      
    "author": [
      {
        "@type": "Corporation",
        "name": "SUSE Product &amp; Solution Documentation Team",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    ],
      
    "dateModified": "2024-06-26T00:00+02:00",
      
    "datePublished": "2024-06-26T00:00+02:00",
      

    "about": [
      
    ],
  
    "sameAs": [
          "https://www.facebook.com/SUSEWorldwide/about",
          "https://www.youtube.com/channel/UCHTfqIzPKz4f_dri36lAQGA",
          "https://twitter.com/SUSE",
          "https://www.linkedin.com/company/suse"
    ],
    "publisher": {
      "@type": "Corporation",
      "name": "SUSE",
      "url": "https://documentation.suse.com",
      "logo": {
        "@type": "ImageObject",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    }
  }</script>
<link rel="prev" href="cha-security-acls.html" title="Chapter 19. Access control lists in Linux"/><link rel="next" href="part-network-security.html" title="Part III. Network security"/><script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/script-purejs.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script><meta name="edit-url" content="https://github.com/SUSE/doc-sle/edit/main/xml/security_aide.xml"/></head><body class="draft wide offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"><img src="static/images/logo.svg" alt="Logo" class="logo"/></div></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">Security and Hardening Guide</a><span> / </span><a class="crumb" href="part-local-security.html">Local security</a><span> / </span><a class="crumb" href="cha-aide.html">Intrusion detection with AIDE</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title">Security and Hardening Guide</div><ol><li><a href="preface-security.html" class=" "><span class="title-number"> </span><span class="title-name">Preface</span></a></li><li><a href="cha-security.html" class=" "><span class="title-number">1 </span><span class="title-name">Security and confidentiality</span></a></li><li><a href="part-auth.html" class="has-children "><span class="title-number">I </span><span class="title-name">Authentication</span></a><ol><li><a href="cha-pam.html" class=" "><span class="title-number">2 </span><span class="title-name">Authentication with PAM</span></a></li><li><a href="cha-nis.html" class=" "><span class="title-number">3 </span><span class="title-name">Using NIS</span></a></li><li><a href="cha-security-auth.html" class=" "><span class="title-number">4 </span><span class="title-name">Setting up authentication clients using YaST</span></a></li><li><a href="cha-security-ldap.html" class=" "><span class="title-number">5 </span><span class="title-name">LDAP with 389 Directory Server</span></a></li><li><a href="cha-security-kerberos.html" class=" "><span class="title-number">6 </span><span class="title-name">Network authentication with Kerberos</span></a></li><li><a href="cha-security-ad.html" class=" "><span class="title-number">7 </span><span class="title-name">Active Directory support</span></a></li><li><a href="cha-security-freeradius.html" class=" "><span class="title-number">8 </span><span class="title-name">Setting up a freeRADIUS server</span></a></li></ol></li><li class="active"><a href="part-local-security.html" class="has-children you-are-here"><span class="title-number">II </span><span class="title-name">Local security</span></a><ol><li><a href="cha-physical-security.html" class=" "><span class="title-number">9 </span><span class="title-name">Physical security</span></a></li><li><a href="sec-sec-software-management.html" class=" "><span class="title-number">10 </span><span class="title-name">Software management</span></a></li><li><a href="sec-sec-file-management.html" class=" "><span class="title-number">11 </span><span class="title-name">File management</span></a></li><li><a href="cha-security-cryptofs.html" class=" "><span class="title-number">12 </span><span class="title-name">Encrypting partitions and files</span></a></li><li><a href="cha-configure-cryptctl.html" class=" "><span class="title-number">13 </span><span class="title-name">Storage encryption for hosted applications with cryptctl</span></a></li><li><a href="sec-sec-user-management.html" class=" "><span class="title-number">14 </span><span class="title-name">User management</span></a></li><li><a href="cha-sec-cron-at.html" class=" "><span class="title-number">15 </span><span class="title-name">Restricting <code class="systemitem">cron</code> and <code class="systemitem">at</code></span></a></li><li><a href="cha-spectre.html" class=" "><span class="title-number">16 </span><span class="title-name">Spectre/Meltdown checker</span></a></li><li><a href="cha-security-yast-security.html" class=" "><span class="title-number">17 </span><span class="title-name">Configuring security settings with YaST</span></a></li><li><a href="cha-security-polkit.html" class=" "><span class="title-number">18 </span><span class="title-name">The Polkit authentication framework</span></a></li><li><a href="cha-security-acls.html" class=" "><span class="title-number">19 </span><span class="title-name">Access control lists in Linux</span></a></li><li><a href="cha-aide.html" class=" you-are-here"><span class="title-number">20 </span><span class="title-name">Intrusion detection with AIDE</span></a></li></ol></li><li><a href="part-network-security.html" class="has-children "><span class="title-number">III </span><span class="title-name">Network security</span></a><ol><li><a href="cha-xauth.html" class=" "><span class="title-number">21 </span><span class="title-name">X Window System and X authentication</span></a></li><li><a href="cha-ssh.html" class=" "><span class="title-number">22 </span><span class="title-name">Securing network operations with OpenSSH</span></a></li><li><a href="cha-security-firewall.html" class=" "><span class="title-number">23 </span><span class="title-name">Masquerading and firewalls</span></a></li><li><a href="cha-security-vpnserver.html" class=" "><span class="title-number">24 </span><span class="title-name">Configuring a VPN server</span></a></li><li><a href="cha-security-xca.html" class=" "><span class="title-number">25 </span><span class="title-name">Managing a PKI with XCA, X certificate and key manager</span></a></li><li><a href="cha-sec-sysctl.html" class=" "><span class="title-number">26 </span><span class="title-name">Improving network security with <code class="command">sysctl</code> variables</span></a></li></ol></li><li><a href="part-compliance.html" class="has-children "><span class="title-number">IV </span><span class="title-name">Regulations and compliance</span></a><ol><li><a href="cha-common-criteria.html" class=" "><span class="title-number">27 </span><span class="title-name">Common Criteria</span></a></li><li><a href="cha-security-fips.html" class=" "><span class="title-number">28 </span><span class="title-name">Enabling compliance with FIPS 140-3</span></a></li></ol></li><li><a href="part-apparmor.html" class="has-children "><span class="title-number">V </span><span class="title-name">Confining privileges with <span class="phrase">AppArmor</span></span></a><ol><li><a href="cha-apparmor-intro.html" class=" "><span class="title-number">29 </span><span class="title-name">Introducing <span class="phrase">AppArmor</span></span></a></li><li><a href="cha-apparmor-start.html" class=" "><span class="title-number">30 </span><span class="title-name">Getting started</span></a></li><li><a href="cha-apparmor-concept.html" class=" "><span class="title-number">31 </span><span class="title-name">Immunizing programs</span></a></li><li><a href="cha-apparmor-profiles.html" class=" "><span class="title-number">32 </span><span class="title-name">Profile components and syntax</span></a></li><li><a href="cha-apparmor-repos.html" class=" "><span class="title-number">33 </span><span class="title-name"><span class="phrase">AppArmor</span> profile repositories</span></a></li><li><a href="cha-apparmor-yast.html" class=" "><span class="title-number">34 </span><span class="title-name">Building and managing profiles with YaST</span></a></li><li><a href="cha-apparmor-commandline.html" class=" "><span class="title-number">35 </span><span class="title-name">Building profiles from the command line</span></a></li><li><a href="cha-apparmor-hat.html" class=" "><span class="title-number">36 </span><span class="title-name">Profiling your Web applications using ChangeHat</span></a></li><li><a href="cha-apparmor-pam.html" class=" "><span class="title-number">37 </span><span class="title-name">Confining users with <code class="systemitem">pam_apparmor</code></span></a></li><li><a href="cha-apparmor-managing.html" class=" "><span class="title-number">38 </span><span class="title-name">Managing profiled applications</span></a></li><li><a href="cha-apparmor-support.html" class=" "><span class="title-number">39 </span><span class="title-name">Support</span></a></li><li><a href="cha-apparmor-glossary.html" class=" "><span class="title-number">40 </span><span class="title-name"><span class="phrase">AppArmor</span> glossary</span></a></li></ol></li><li><a href="part-audit.html" class="has-children "><span class="title-number">VI </span><span class="title-name">The Linux Audit Framework</span></a><ol><li><a href="cha-audit-comp.html" class=" "><span class="title-number">41 </span><span class="title-name">Understanding Linux audit</span></a></li><li><a href="cha-audit-setup.html" class=" "><span class="title-number">42 </span><span class="title-name">Setting up the Linux audit framework</span></a></li><li><a href="cha-audit-scenarios.html" class=" "><span class="title-number">43 </span><span class="title-name">Introducing an audit rule set</span></a></li><li><a href="cha-audit-moreinfo.html" class=" "><span class="title-number">44 </span><span class="title-name">Useful resources</span></a></li></ol></li><li><a href="bk05apa.html" class=" "><span class="title-number">A </span><span class="title-name">GNU licenses</span></a></li> </ol> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section class="chapter" id="cha-aide" data-id-title="Intrusion detection with AIDE"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname"><span class="productname"><span class="phrase">SUSE Linux Enterprise Desktop</span></span></span> <span class="productnumber"><span class="productnumber"><span class="phrase">15 SP6</span></span></span></div><div><div class="title-container"><h1 class="title"><span class="title-number-name"><span class="title-number">20 </span><span class="title-name">Intrusion detection with AIDE</span></span> <a title="Permalink" class="permalink" href="cha-aide.html#">#</a></h1><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/security_aide.xml" title="Edit source document"> </a></div></div></div><div><div class="abstract"><p>
    Securing your systems is a mandatory task for any mission-critical
    system administrator. Because it is impossible to always guarantee that
    the system is not compromised, it is important to do extra checks
    regularly (for example with
    <code class="systemitem">cron</code>) to ensure that the system
    is still under your control. This is where AIDE, the
    <span class="emphasis"><em>Advanced Intrusion Detection Environment</em></span>, comes
    into play.
   </p></div></div></div></div><section class="sect1" id="sec-aide-why" data-id-title="Why use AIDE?"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">20.1 </span><span class="title-name">Why use AIDE?</span></span> <a title="Permalink" class="permalink" href="cha-aide.html#sec-aide-why">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/security_aide.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   An easy check that often can reveal unwanted changes can be done by means
   of RPM. The package manager has a built-in verify function that checks
   all the managed files in the system for changes. To verify all files,
   run the command <code class="command">rpm -Va</code>. However, this command also
   displays changes in configuration files, and you need to do some
   filtering to detect important changes.
  </p><p>
   An additional problem to the method with RPM is that an intelligent
   attacker can modify <code class="command">rpm</code> itself to hide any changes
   that might have been done by some kind of root-kit, which allows the
   attacker to mask the intrusion and gain root privilege. To solve this,
   you should implement a secondary check that can also be run
   independent of the installed system.
  </p></section><section class="sect1" id="sec-aide-setup" data-id-title="Setting up an AIDE database"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">20.2 </span><span class="title-name">Setting up an AIDE database</span></span> <a title="Permalink" class="permalink" href="cha-aide.html#sec-aide-setup">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/security_aide.xml" title="Edit source document"> </a></div></div></div></div></div><div id="id-1.7.5.13.4.2" data-id-title="Initialize AIDE database after installation" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg"/><div class="admon-title">Important: Initialize AIDE database after installation</div><p>
    Before you install your system, verify the checksum of your medium (see
    <span class="intraxref">Book “Deployment Guide”, Chapter 9 “Troubleshooting”, Section 9.1 “Checking media”</span>) to make sure you do not use
    a compromised source. After you have installed the system, initialize
    the AIDE database. To make sure that all went well during and
    after the installation, do an installation directly on the console,
    without any network attached to the computer. Do not leave the computer
    unattended or connected to any network before AIDE creates its
    database.
   </p></div><p>
   AIDE is not installed by default on <span class="productname"><span class="phrase">SUSE Linux Enterprise Desktop</span></span>. To install it,
   either use <span class="guimenu">Computer</span> › <span class="guimenu">Install
   Software</span>, or enter <code class="literal">zypper install
   aide</code> on the command line as <code class="systemitem">root</code>.
  </p><p>
   To tell AIDE which attributes of which files should be checked, use
   the <code class="filename">/etc/aide.conf</code> configuration file. It must be
   modified to become the actual configuration. The first section handles
   general parameters like the location of the AIDE database file. More
   relevant for local configurations are the <code class="systemitem">Custom
   Rules</code> and the <code class="systemitem">Directories and Files</code>
   sections. A typical rule looks like the following:
  </p><div class="verbatim-wrap"><pre class="screen">Binlib     = p+i+n+u+g+s+b+m+c+md5+sha1</pre></div><p>
   After defining the variable <code class="literal">Binlib</code>, the respective
   check boxes are used in the files section. Important options include the
   following:
  </p><div class="table" id="tab-aide-options" data-id-title="Important AIDE check boxes"><div class="title-container"><div class="table-title-wrap"><div class="table-title"><span class="title-number-name"><span class="title-number">Table 20.1: </span><span class="title-name">Important AIDE check boxes </span></span><a title="Permalink" class="permalink" href="cha-aide.html#tab-aide-options">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/security_aide.xml" title="Edit source document"> </a></div></div><div class="table-contents"><table style="border-collapse: collapse; border-top: 1px solid ; border-bottom: 1px solid ; border-left: 1px solid ; border-right: 1px solid ; "><colgroup><col/><col/></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; ">
       <p>
        Option
       </p>
      </th><th style="border-bottom: 1px solid ; ">
       <p>
        Description
       </p>
      </th></tr></thead><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
       <p>
        p
       </p>
      </td><td style="border-bottom: 1px solid ; ">
       <p>
        Check for the file permissions of the selected files or directories.
       </p>
      </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
       <p>
        i
       </p>
      </td><td style="border-bottom: 1px solid ; ">
       <p>
        Check for the inode number. Every file name has a unique inode
        number that should not change.
       </p>
      </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
       <p>
        n
       </p>
      </td><td style="border-bottom: 1px solid ; ">
       <p>
        Check for the number of links pointing to the relevant file.
       </p>
      </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
       <p>
        u
       </p>
      </td><td style="border-bottom: 1px solid ; ">
       <p>
        Check if the owner of the file has changed.
       </p>
      </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
       <p>
        g
       </p>
      </td><td style="border-bottom: 1px solid ; ">
       <p>
        Check if the group of the file has changed.
       </p>
      </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
       <p>
        s
       </p>
      </td><td style="border-bottom: 1px solid ; ">
       <p>
        Check if the file size has changed.
       </p>
      </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
       <p>
        b
       </p>
      </td><td style="border-bottom: 1px solid ; ">
       <p>
        Check if the block count used by the file has changed.
       </p>
      </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
       <p>
        m
       </p>
      </td><td style="border-bottom: 1px solid ; ">
       <p>
        Check if the modification time of the file has changed.
       </p>
      </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
       <p>
        c
       </p>
      </td><td style="border-bottom: 1px solid ; ">
       <p>
        Check if the files access time has changed.
       </p>
      </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
       <p>
        S
       </p>
      </td><td style="border-bottom: 1px solid ; ">
       <p>
        Check for a changed file size.
       </p>
      </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
       <p>
        I
       </p>
      </td><td style="border-bottom: 1px solid ; ">
       <p>
        Ignore changes of the file name.
       </p>
      </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
       <p>
        md5
       </p>
      </td><td style="border-bottom: 1px solid ; ">
       <p>
        Check if the md5 checksum of the file has changed. We recommend
        to use sha256 or sha512.
       </p>
      </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
       <p>
        sha1
       </p>
      </td><td style="border-bottom: 1px solid ; ">
       <p>
        Check if the sha1 (160 Bit) checksum of the file has changed. We
        recommend to use sha256 or sha512.
       </p>
      </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
       <p>
        sha256
       </p>
      </td><td style="border-bottom: 1px solid ; ">
       <p>
        Check if the sha256 checksum of the file has changed.
       </p>
      </td></tr><tr><td style="border-right: 1px solid ; ">
       <p>
        sha512
       </p>
      </td><td>
       <p>
        Check if the sha512 checksum of the file has changed.
       </p>
      </td></tr></tbody></table></div></div><p>
   This is a configuration that checks for all files in
   <code class="filename">/sbin</code> with the options defined in
   <code class="literal">Binlib</code> but omits the
   <code class="filename">/sbin/conf.d/</code> directory:
  </p><div class="verbatim-wrap"><pre class="screen">/sbin  Binlib
!/sbin/conf.d</pre></div><p>
   To create the AIDE database, proceed as follows:
  </p><div class="procedure" id="pro-aide-setup-db"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
     Open <code class="filename">/etc/aide.conf</code>.
    </p></li><li class="step"><p>
     Define which files should be checked with which check boxes. For a
     complete list of available check boxes, see
     <code class="filename">/usr/share/doc/packages/aide/manual.html</code>. The
     definition of the file selection needs certain knowledge about regular
     expressions. Save your modifications.
    </p></li><li class="step"><p>
     To check whether the configuration file is valid, run:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>aide --config-check</pre></div><p>
     Any output of this command is a hint that the configuration is not
     valid. For example, if you get the following output:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>aide --config-check
35:syntax error:!
35:Error while reading configuration:!
Configuration error</pre></div><p>
     The error is to be expected in line 36 of
     <code class="filename">/etc/aide.conf</code>. The error message
     contains the last successfully read line of the configuration file.
    </p></li><li class="step"><p>
     Initialize the AIDE database. Run the command:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>aide -i</pre></div></li><li class="step"><p>
     Copy the generated database to a save location like a CD-R or DVD-R, a
     remote server or a flash disk for later use.
    </p><div id="id-1.7.5.13.4.11.5.2" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg"/><div class="admon-title">Important</div><p>
      This step is essential as it avoids compromising your database. It is
      recommended to use a medium which can be written once to prevent
      the database being modified. <span class="emphasis"><em>Never</em></span> leave the
      database on the computer which you want to monitor.
     </p></div></li></ol></div></div></section><section class="sect1" id="sec-aide-check" data-id-title="Local AIDE checks"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">20.3 </span><span class="title-name">Local AIDE checks</span></span> <a title="Permalink" class="permalink" href="cha-aide.html#sec-aide-check">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/security_aide.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   To perform a file system check, proceed as follows:
  </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
     Rename the database:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>mv /var/lib/aide/aide.db.new /var/lib/aide/aide.db</pre></div></li><li class="step"><p>
     After any configuration change, you always need to re-initialize the
     AIDE database and subsequently move the newly generated database.
     It is also a good idea to make a backup of this database. See
     <a class="xref" href="cha-aide.html#sec-aide-setup" title="20.2. Setting up an AIDE database">Section 20.2, “Setting up an AIDE database”</a> for more information.
    </p></li><li class="step"><p>
     Perform the check with the following command:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>aide --check</pre></div></li></ol></div></div><p>
   If the output is empty, everything is fine. If AIDE found changes,
   it displays a summary of changes, for example:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>aide --check
AIDE found differences between database and file system!!

Summary:
  Total number of files:        1992
  Added files:                  0
  Removed files:                0
  Changed files:                1</pre></div><p>
   To learn about the actual changes, increase the verbose level of the
   check with the parameter <code class="literal">-V</code>. For the previous example,
   this could look like the following:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>aide --check -V
AIDE found differences between database and file system!!
Start timestamp: 2009-02-18 15:14:10

Summary:
  Total number of files:        1992
  Added files:                  0
  Removed files:                0
  Changed files:                1


---------------------------------------------------
Changed files:
---------------------------------------------------

changed: /etc/passwd

--------------------------------------------------
Detailed information about changes:
---------------------------------------------------


File: /etc/passwd
  Mtime    : 2009-02-18 15:11:02              , 2009-02-18 15:11:47
  Ctime    : 2009-02-18 15:11:02              , 2009-02-18 15:11:47</pre></div><p>
   In this example, the file <code class="filename">/etc/passwd</code> was touched to
   demonstrate the effect.
  </p></section><section class="sect1" id="sec-aide-independent" data-id-title="System independent checking"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">20.4 </span><span class="title-name">System independent checking</span></span> <a title="Permalink" class="permalink" href="cha-aide.html#sec-aide-independent">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/security_aide.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   To avoid risk, it is advisable to also run the AIDE binary from a
   trusted source. This excludes the risk that attackers also modified
   the aide binary to hide its traces.
  </p><p>
   To accomplish this task, AIDE must be run from a rescue system that
   is independent of the installed system. With <span class="productname"><span class="phrase">SUSE Linux Enterprise Desktop</span></span> it is
   easy to extend the rescue system with arbitrary programs, and
   thus add the needed functionality.
  </p><p>
   Before you can start using the rescue system, you need to provide two
   packages to the system. These are included with the same syntax as you
   would add a driver update disk to the system. For a detailed description
   about the possibilities of linuxrc that are used for this purpose, see
   <a class="link" href="https://en.opensuse.org/SDB:Linuxrc" target="_blank">https://en.opensuse.org/SDB:Linuxrc</a>. In the
   following, one possible way to accomplish this task is discussed.
  </p><div class="procedure" id="id-1.7.5.13.6.5" data-id-title="Starting a rescue system with AIDE"><div class="title-container"><div class="procedure-title-wrap"><div class="procedure-title"><span class="title-number-name"><span class="title-number">Procedure 20.1: </span><span class="title-name">Starting a rescue system with AIDE </span></span><a title="Permalink" class="permalink" href="cha-aide.html#id-1.7.5.13.6.5">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/security_aide.xml" title="Edit source document"> </a></div></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
     Provide an FTP server as a second machine.
    </p></li><li class="step"><p>
     Copy the packages <code class="systemitem">aide</code> and
     <code class="systemitem">mhash</code> to the FTP server directory, in our case
     <code class="filename">/srv/ftp/</code>. Replace the placeholders
     <em class="replaceable">ARCH</em> and <em class="replaceable">VERSION</em>
     with the corresponding values:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>cp DVD1/suse/<em class="replaceable">ARCH</em>/aide<em class="replaceable">VERSION</em>.<em class="replaceable">ARCH</em>.rpm /srv/ftp
<code class="prompt root"># </code>cp DVD1/suse/<em class="replaceable">ARCH</em>/mhash<em class="replaceable">VERSION</em>.<em class="replaceable">ARCH</em>.rpm /srv/ftp</pre></div></li><li class="step"><p>
     Create an info file <code class="filename">/srv/ftp/info.txt</code> that
     provides the needed boot parameters for the rescue system:
    </p><div class="verbatim-wrap"><pre class="screen">dud:ftp://ftp.example.com/aide<em class="replaceable">VERSION</em>.<em class="replaceable">ARCH</em>.rpm
dud:ftp://ftp.example.com/mhash<em class="replaceable">VERSION</em>.<em class="replaceable">ARCH</em>.rpm</pre></div><p>
     Replace your FTP domain name, <em class="replaceable">VERSION</em> and
     <em class="replaceable">ARCH</em> with the values used on your system.
    </p></li><li class="step"><p>
     Restart the server that needs to go through an AIDE check with the
     Rescue system from your DVD. Add the following string to the boot
     parameters:
    </p><div class="verbatim-wrap"><pre class="screen">info=ftp://ftp.example.com/info.txt</pre></div><p>
     This parameter tells <code class="command">linuxrc</code> to also read in all
     information from the <code class="filename">info.txt</code> file.
    </p></li></ol></div></div><p>
   After the rescue system has booted, the AIDE program is ready for
   use.
  </p></section><section class="sect1" id="sec-aide-more" data-id-title="More information"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">20.5 </span><span class="title-name">More information</span></span> <a title="Permalink" class="permalink" href="cha-aide.html#sec-aide-more">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/security_aide.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   Information about AIDE is available at the following places:
  </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
     The home page of AIDE:
     <a class="link" href="https://aide.github.io/" target="_blank">https://aide.github.io/</a>
    </p></li><li class="listitem"><p>
     In the documented template configuration
     <code class="filename">/etc/aide.conf</code>.
    </p></li><li class="listitem"><p>
     In several files below
     <code class="filename">/usr/share/doc/packages/aide</code> after installing the
     <code class="systemitem">aide</code> package.
    </p></li><li class="listitem"><p>
     On the AIDE user mailing list at
     <a class="link" href="https://www.ipi.fi/mailman/listinfo/aide" target="_blank">https://www.ipi.fi/mailman/listinfo/aide</a>.
    </p></li></ul></div></section></section><nav class="bottom-pagination"><div><a class="pagination-link prev" href="cha-security-acls.html"><span class="pagination-relation">Previous</span><span class="pagination-label"><span class="title-number">Chapter 19 </span>Access control lists in Linux</span></a> </div><div><a class="pagination-link next" href="part-network-security.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Part III </span>Network security</span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="sect1"><a href="cha-aide.html#sec-aide-why"><span class="title-number">20.1 </span><span class="title-name">Why use AIDE?</span></a></span></li><li><span class="sect1"><a href="cha-aide.html#sec-aide-setup"><span class="title-number">20.2 </span><span class="title-name">Setting up an AIDE database</span></a></span></li><li><span class="sect1"><a href="cha-aide.html#sec-aide-check"><span class="title-number">20.3 </span><span class="title-name">Local AIDE checks</span></a></span></li><li><span class="sect1"><a href="cha-aide.html#sec-aide-independent"><span class="title-number">20.4 </span><span class="title-name">System independent checking</span></a></span></li><li><span class="sect1"><a href="cha-aide.html#sec-aide-more"><span class="title-number">20.5 </span><span class="title-name">More information</span></a></span></li></ul></div><div class="side-title">Share this page</div><ul class="share"><li><a id="_share-fb" href="#" title="Facebook"> </a></li><li><a id="_share-in" href="#" title="LinkedIn"> </a></li><li><a id="_share-tw" href="#" title="Twitter/X"> </a></li><li><a id="_share-mail" href="#" title="E-Mail"> </a></li><li><a id="_print-button" href="#" title="Print this page"> </a></li></ul> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2024</span></div></div></footer></body></html>