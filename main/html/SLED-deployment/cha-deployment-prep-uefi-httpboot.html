<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><title>SLED 15 SP6 | Deployment Guide | Setting up a UEFI HTTP Boot server</title><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"/>
<meta name="title" content="Setting up a UEFI HTTP Boot server | SLED 15 SP6"/>
<meta name="description" content="This chapter describes how to set up and configure a UEFI HTTP Boot server."/>
<meta name="product-name" content="SUSE Linux Enterprise Desktop"/>
<meta name="product-number" content="15 SP6"/>
<meta name="book-title" content="Deployment Guide"/>
<meta name="chapter-title" content="Chapter 15. Setting up a UEFI HTTP Boot server"/>
<meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi"/>
<meta name="tracker-type" content="bsc"/>
<meta name="tracker-bsc-assignee" content="fs@suse.com"/>
<meta name="tracker-bsc-component" content="Documentation"/>
<meta name="tracker-bsc-product" content="PUBLIC SUSE Linux Enterprise Desktop 15 SP6"/>
<meta name="publisher" content="SUSE"/><meta property="og:title" content="Deployment Guide"/>
<meta property="og:description" content="Install single or multiple systems"/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Deployment Guide"/>
<meta name="twitter:description" content="Install single or multiple systems"/>
<script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": ["TechArticle"],
    "image": "https://www.suse.com/assets/img/suse-white-logo-green.svg",
    
     "isPartOf": {
      "@type": "CreativeWorkSeries",
      "name": "Products &amp; Solutions"
    },
    
    "inLanguage": "en",
    

    "headline": "Setting up a UEFI HTTP Boot server",
  
    "description": "This chapter describes how to set up and configure a UEFI HTTP Boot server.",
      
    "author": [
      {
        "@type": "Corporation",
        "name": "SUSE Product &amp; Solution Documentation Team",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    ],
      
    "dateModified": "2024-06-26T00:00+02:00",
      
    "datePublished": "2024-06-26T00:00+02:00",
      

    "about": [
      
    ],
  
    "sameAs": [
          "https://www.facebook.com/SUSEWorldwide/about",
          "https://www.youtube.com/channel/UCHTfqIzPKz4f_dri36lAQGA",
          "https://twitter.com/SUSE",
          "https://www.linkedin.com/company/suse"
    ],
    "publisher": {
      "@type": "Corporation",
      "name": "SUSE",
      "url": "https://documentation.suse.com",
      "logo": {
        "@type": "ImageObject",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    }
  }</script>
<link rel="prev" href="cha-deployment-prep-pxe.html" title="Chapter 14. Preparing network boot environment"/><link rel="next" href="cha-deployment-firstboot.html" title="Chapter 16. Deploying customized preinstallations"/><script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/script-purejs.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script><meta name="edit-url" content="https://github.com/SUSE/doc-sle/edit/main/xml/uefi-httpboot-server.xml"/></head><body class="draft wide offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"><img src="static/images/logo.svg" alt="Logo" class="logo"/></div></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">Deployment Guide</a><span> / </span><a class="crumb" href="part-installserver.html">Setting up an installation server</a><span> / </span><a class="crumb" href="cha-deployment-prep-uefi-httpboot.html">Setting up a UEFI HTTP Boot server</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title">Deployment Guide</div><ol><li><a href="preface-deployment.html" class=" "><span class="title-number"> </span><span class="title-name">Preface</span></a></li><li><a href="part-prep.html" class="has-children "><span class="title-number">I </span><span class="title-name">Installation preparation</span></a><ol><li><a href="cha-sled-plan.html" class=" "><span class="title-number">1 </span><span class="title-name">Planning for SUSE Linux Enterprise Desktop</span></a></li><li><a href="cha-x86.html" class=" "><span class="title-number">2 </span><span class="title-name">Installation on AMD64 and Intel 64</span></a></li><li><a href="supported-hypervisors.html" class=" "><span class="title-number">3 </span><span class="title-name">Installation on virtualization hosts</span></a></li></ol></li><li><a href="part-deployment.html" class="has-children "><span class="title-number">II </span><span class="title-name">Installation procedure</span></a><ol><li><a href="cha-boot-parameters.html" class=" "><span class="title-number">4 </span><span class="title-name">Boot parameters</span></a></li><li><a href="cha-install.html" class=" "><span class="title-number">5 </span><span class="title-name">Installation steps</span></a></li><li><a href="cha-register-sle.html" class=" "><span class="title-number">6 </span><span class="title-name">Registering SUSE Linux Enterprise and managing modules/extensions</span></a></li><li><a href="cha-expert-partitioner.html" class=" "><span class="title-number">7 </span><span class="title-name"><span class="guimenu">Expert Partitioner</span></span></a></li><li><a href="cha-remote-installation.html" class=" "><span class="title-number">8 </span><span class="title-name">Remote installation</span></a></li><li><a href="cha-installation-troubleshooting.html" class=" "><span class="title-number">9 </span><span class="title-name">Troubleshooting</span></a></li></ol></li><li><a href="part-customize-media.html" class="has-children "><span class="title-number">III </span><span class="title-name">Customizing installation images</span></a><ol><li><a href="cha-deployment-clone-cleanup-tool.html" class=" "><span class="title-number">10 </span><span class="title-name">Prepare a disk for cloning with the system cleanup tool</span></a></li><li><a href="cha-deployment-prep-mksusecd.html" class=" "><span class="title-number">11 </span><span class="title-name">Customizing installation images with mksusecd</span></a></li><li><a href="cha-deployment-prep-customize-installation-images.html" class=" "><span class="title-number">12 </span><span class="title-name">Customizing installation images manually</span></a></li></ol></li><li class="active"><a href="part-installserver.html" class="has-children you-are-here"><span class="title-number">IV </span><span class="title-name">Setting up an installation server</span></a><ol><li><a href="cha-deployment-instserver.html" class=" "><span class="title-number">13 </span><span class="title-name">Setting up a network installation source</span></a></li><li><a href="cha-deployment-prep-pxe.html" class=" "><span class="title-number">14 </span><span class="title-name">Preparing network boot environment</span></a></li><li><a href="cha-deployment-prep-uefi-httpboot.html" class=" you-are-here"><span class="title-number">15 </span><span class="title-name">Setting up a UEFI HTTP Boot server</span></a></li><li><a href="cha-deployment-firstboot.html" class=" "><span class="title-number">16 </span><span class="title-name">Deploying customized preinstallations</span></a></li></ol></li><li><a href="app-create-os-image.html" class=" "><span class="title-number">A </span><span class="title-name">Imaging and creating products</span></a></li><li><a href="bk02apb.html" class=" "><span class="title-number">B </span><span class="title-name">GNU licenses</span></a></li> </ol> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section class="chapter" id="cha-deployment-prep-uefi-httpboot" data-id-title="Setting up a UEFI HTTP Boot server"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname"><span class="productname"><span class="phrase">SUSE Linux Enterprise Desktop</span></span></span> <span class="productnumber"><span class="productnumber"><span class="phrase">15 SP6</span></span></span></div><div><div class="title-container"><h1 class="title"><span class="title-number-name"><span class="title-number">15 </span><span class="title-name">Setting up a UEFI HTTP Boot server</span></span> <a title="Permalink" class="permalink" href="cha-deployment-prep-uefi-httpboot.html#">#</a></h1><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/uefi-httpboot-server.xml" title="Edit source document"> </a></div></div></div><div><div class="abstract"><p>
        This chapter describes how to set up and configure a UEFI HTTP Boot
        server.
      </p></div></div></div></div><section class="sect1" id="httpboot-intro" data-id-title="Introduction"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">15.1 </span><span class="title-name">Introduction</span></span> <a title="Permalink" class="permalink" href="cha-deployment-prep-uefi-httpboot.html#httpboot-intro">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/uefi-httpboot-server.xml" title="Edit source document"> </a></div></div></div></div></div><p>
      HTTP Boot combines DHCP, DNS and HTTP to make it possible to boot and
      deploy systems over the network. HTTP Boot can be used as a
      high-performance replacement for PXE. HTTP Boot allows to boot a server
      from a URI over HTTP, quickly transferring large files, such as the Linux
      kernel and root file system, from servers outside of your local network.
    </p><section class="sect2" id="httpboot-client" data-id-title="Configuring the client machine"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">15.1.1 </span><span class="title-name">Configuring the client machine</span></span> <a title="Permalink" class="permalink" href="cha-deployment-prep-uefi-httpboot.html#httpboot-client">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/uefi-httpboot-server.xml" title="Edit source document"> </a></div></div></div></div></div><p>
        Enabling HTTP Boot on a physical client machine depends on your
        specific hardware. Consult the documentation for further information on
        how to enable HTTP Boot on your particular machine.
      </p></section><section class="sect2" id="httpboot-preparation" data-id-title="Preparation"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">15.1.2 </span><span class="title-name">Preparation</span></span> <a title="Permalink" class="permalink" href="cha-deployment-prep-uefi-httpboot.html#httpboot-preparation">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/uefi-httpboot-server.xml" title="Edit source document"> </a></div></div></div></div></div><p>
        The setup described here uses 192.168.111.0/24 (IPv4) and
        2001:db8:f00f:cafe::/64 (IPv6) IP subnets and the server IP addresses
        are 192.168.111.1(IPv4) and 2001:db8:f00f:cafe::1/64 (IPv6) as
        examples. Adjust these values to match your specific setup.
      </p><p>
        Install the following packages on the machine that you plan to use as
        an HTTP Boot server: <span class="package">dhcp-server</span>,
        <span class="package">apache2</span> (or <span class="package">lighttpd</span>), and
        <span class="package">dnsmasq</span>.
      </p></section></section><section class="sect1" id="httpboot-configure-server" data-id-title="Configuring the server"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">15.2 </span><span class="title-name">Configuring the server</span></span> <a title="Permalink" class="permalink" href="cha-deployment-prep-uefi-httpboot.html#httpboot-configure-server">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/uefi-httpboot-server.xml" title="Edit source document"> </a></div></div></div></div></div><section class="sect2" id="httpboot-dns-server" data-id-title="DNS server"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">15.2.1 </span><span class="title-name">DNS server</span></span> <a title="Permalink" class="permalink" href="cha-deployment-prep-uefi-httpboot.html#httpboot-dns-server">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/uefi-httpboot-server.xml" title="Edit source document"> </a></div></div></div></div></div><p>
        While configuring the DNS server is optional, this does allow you to
        assign a user-friendly name to the HTTP Boot server. To set up the DNS
        server, add the following to the <code class="filename">/etc/dnsmasq.conf</code>
        file:
      </p><div class="verbatim-wrap"><pre class="screen">interface=eth0
addn-hosts=/etc/dnsmasq.d/hosts.conf</pre></div><p>
        Assign a domain name to the IP addresses in the
        <code class="filename">/etc/dnsmasq.d/hosts.conf</code> file:
      </p><div class="verbatim-wrap"><pre class="screen">192.168.111.1 www.httpboot.local
2001:db8:f00f:cafe::1 www.httpboot.local</pre></div><p>
        Start the DNS server.
      </p><div class="verbatim-wrap"><pre class="screen">systemctl start dnsmasq</pre></div><div id="id-1.4.6.4.4.2.8" data-id-title="Use the shim boot loader" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note: Use the <span class="productname">shim</span> boot loader</div><p>
          Because of a change in UEFI 2.7, we recommend using a shim boot
          loader from SLE 15 or newer to avoid potential errors caused by
          the additional DNS node.
        </p></div><section class="sect3" id="httpboot-dhcpv4-server" data-id-title="Configuring the DHCPv4 server"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">15.2.1.1 </span><span class="title-name">Configuring the DHCPv4 server</span></span> <a title="Permalink" class="permalink" href="cha-deployment-prep-uefi-httpboot.html#httpboot-dhcpv4-server">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/uefi-httpboot-server.xml" title="Edit source document"> </a></div></div></div></div></div><p>
          Before setting up the DHCP servers, specify the network interface for
          them in <code class="filename">/etc/sysconfig/dhcpd</code>:
        </p><div class="verbatim-wrap"><pre class="screen">DHCPD_INTERFACE="eth0"
DHCPD6_INTERFACE="eth0"</pre></div><p>
          This way, the DHCP servers provide the service on the
          <code class="literal">eth0</code> interface only.
        </p><p>
          To set up a DHCPv4 server for both PXE Boot and HTTP Boot, add the
          following configuration to the <code class="filename">/etc/dhcpd.conf</code>
          file:
        </p><div class="verbatim-wrap"><pre class="screen">option domain-name-servers 192.168.111.1;
option routers 192.168.111.1;
default-lease-time 14400;
ddns-update-style none;
class "pxeclients" {
  match if substring (option vendor-class-identifier, 0, 9) = "PXEClient";
  option vendor-class-identifier "PXEClient";
  next-server 192.168.111.1;
  filename "/bootx64.efi";
}
class "httpclients" {
  match if substring (option vendor-class-identifier, 0, 10) = "HTTPClient";
  option vendor-class-identifier "HTTPClient";
  filename "http://www.httpboot.local/sle/EFI/BOOT/bootx64.efi";
}
subnet 192.168.111.0 netmask 255.255.255.0 {
  range dynamic-bootp 192.168.111.100 192.168.111.120;
  default-lease-time 14400;
  max-lease-time 172800;
}</pre></div><p>
          Note that the DHCPv4 server must use the
          <code class="literal">HTTPClient</code> parameter for the vendor class ID, as
          the client uses it to identify an HTTP Boot offer.
        </p><p>
          Start the DHCP daemon:
        </p><p>
          <code class="literal">systemctl start dhcpd</code>
        </p></section><section class="sect3" id="httpboot-dhcpv6-server" data-id-title="Configuring the DHCPv6 server"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">15.2.1.2 </span><span class="title-name">Configuring the DHCPv6 server</span></span> <a title="Permalink" class="permalink" href="cha-deployment-prep-uefi-httpboot.html#httpboot-dhcpv6-server">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/uefi-httpboot-server.xml" title="Edit source document"> </a></div></div></div></div></div><p>
          To set up the DHCPv6 server, add the following configuration to
          <code class="filename">/etc/dhcpd6.conf</code>:
        </p><div class="verbatim-wrap"><pre class="screen">option dhcp6.bootfile-url code 59 = string;
option dhcp6.vendor-class code 16 = {integer 32, integer 16, string};
subnet6 2001:db8:f00f:cafe::/64 {
        range6 2001:db8:f00f:cafe::42:10 2001:db8:f00f:cafe::42:99;
        option dhcp6.bootfile-url "http://www.httpboot.local/sle/EFI/BOOT/bootx64.efi";
        option dhcp6.name-servers 2001:db8:f00f:cafe::1;
        option dhcp6.vendor-class 0 10 "HTTPClient";
}</pre></div><p>
          This configuration defines the type of the boot URL, the vendor
          class, and other required options. Similar to the DHCPv4 settings, it
          is necessary to provide the boot URL, which must have an IPv6
          address. It is also necessary to specify the vendor class option. In
          DHCPv6, it consists of the enterprise number and the vendor class
          data (length and the content). Since the HTTP Boot driver ignores the
          enterprise number, you can set it to <code class="literal">0</code>. The
          content of the vendor class data needs to be
          <code class="literal">HTTPClient</code>; otherwise, the client ignores the
          offer.
        </p><p>
          The older HTTP Boot implementation, which does not follow
          <a class="link" href="https://datatracker.ietf.org/doc/html/rfc3315" target="_blank">RFC
          3315</a>, requires a different configuration:
        </p><div class="verbatim-wrap"><pre class="screen">option dhcp6.bootfile-url code 59 = string;
option dhcp6.vendor-class code 16 = string;
        subnet6 2001:db8:f00f:cafe::/64 {
        range6 2001:db8:f00f:cafe::42:10 2001:db8:f00f:cafe::42:99;
        option dhcp6.bootfile-url "http://www.httpboot.local/sle/EFI/BOOT/bootx64.efi;
	option dhcp6.name-servers 2001:db8:f00f:cafe::1;
	option dhcp6.vendor-class "HTTPClient";
}</pre></div><p>
          Start the <code class="literal">dhcpv6</code> daemon.
        </p><div class="verbatim-wrap"><pre class="screen">systemctl start dhcpd6</pre></div><section class="sect4" id="httpboot-dhcpv6-pxe-server" data-id-title="Setting up the DHCPv6 server for both PXE and HTTP boot"><div class="titlepage"><div><div><div class="title-container"><h5 class="title"><span class="title-number-name"><span class="title-number">15.2.1.2.1 </span><span class="title-name">Setting up the DHCPv6 server for both PXE and HTTP boot</span></span> <a title="Permalink" class="permalink" href="cha-deployment-prep-uefi-httpboot.html#httpboot-dhcpv6-pxe-server">#</a></h5><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/uefi-httpboot-server.xml" title="Edit source document"> </a></div></div></div></div></div><p>
            Using the following configuration, it is possible to configure the
            DHCPv6 server for both PXE Boot and HTTP Boot:
          </p><div class="verbatim-wrap"><pre class="screen">option dhcp6.bootfile-url code 59 = string;
option dhcp6.vendor-class code 16 = {integer 32, integer 16, string};

subnet6 2001:db8:f00f:cafe::/64 {
        range6 2001:db8:f00f:cafe::42:10 2001:db8:f00f:cafe::42:99;

        class "PXEClient" {
	        match substring (option dhcp6.vendor-class, 6, 9);
	}

        subclass "PXEClient" "PXEClient" {
	        option dhcp6.bootfile-url "tftp://[2001:db8:f00f:cafe::1]/bootloader.efi";
	}

	class "HTTPClient" {
	        match substring (option dhcp6.vendor-class, 6, 10);
	}

	subclass "HTTPClient" "HTTPClient" {
	        option dhcp6.bootfile-url "http://www.httpboot.local/sle/EFI/BOOT/bootx64.efi";
		option dhcp6.name-servers 2001:db8:f00f:cafe::1;
		option dhcp6.vendor-class 0 10 "HTTPClient";
	}
}</pre></div><p>
            It is also possible to match the vendor class to a specific
            architecture, as follows:
          </p><div class="verbatim-wrap"><pre class="screen">class "HTTPClient" {
        match substring (option dhcp6.vendor-class, 6, 21);
	}

subclass "HTTPClient" "HTTPClient:Arch:00016" {
        option dhcp6.bootfile-url "http://www.httpboot.local/sle/EFI/BOOT/bootx64.efi";
	option dhcp6.name-servers 2001:db8:f00f:cafe::1;
	option dhcp6.vendor-class 0 10 "HTTPClient";
}</pre></div><p>
            In this example, <code class="literal">HTTPClient:Arch:00016</code> refers to
            an AMD64/Intel 64 HTTP Boot client. This configuration allows the server
            to serve different architectures simultaneously.
          </p></section><section class="sect4" id="httpboot-firewall" data-id-title="Configuring firewall"><div class="titlepage"><div><div><div class="title-container"><h5 class="title"><span class="title-number-name"><span class="title-number">15.2.1.2.2 </span><span class="title-name">Configuring firewall</span></span> <a title="Permalink" class="permalink" href="cha-deployment-prep-uefi-httpboot.html#httpboot-firewall">#</a></h5><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/uefi-httpboot-server.xml" title="Edit source document"> </a></div></div></div></div></div><p>
            If DHCPv6 packets are dropped by the RP filter in the firewall,
            check its log. In case it contains the
            <code class="literal">rpfilter_DROP</code> entry, disable the filter using
            the following configuration in
            <code class="filename">/etc/firewalld/firewalld.conf</code>:
          </p><p>
            <code class="literal">IPv6_rpfilter=no</code>
          </p></section></section><section class="sect3" id="httpboot-tftp-server" data-id-title="Deploying a TFTP server (optional)"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">15.2.1.3 </span><span class="title-name">Deploying a TFTP server (optional)</span></span> <a title="Permalink" class="permalink" href="cha-deployment-prep-uefi-httpboot.html#httpboot-tftp-server">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/uefi-httpboot-server.xml" title="Edit source document"> </a></div></div></div></div></div><p>
          To provide support for both PXE Boot and HTTP Boot, deploy a TFTP
          server. Install the <span class="package">tftp</span> and start the service:
        </p><div class="verbatim-wrap"><pre class="screen"> systemctl start tftp.socket
systemctl start tftp.service</pre></div><p>
          It is also necessary to install a specific
          <span class="package">tftpboot-installation</span> package for use with PXE
          Boot. Run the <code class="command">zypper se tftpboot</code> command, to list
          of the available <span class="package">tftp-installation</span> packages, then
          install the package for the desired system version and architecture,
          for example
          <span class="package">tftpboot-installation-SLE-15-SP3-x86_64</span> For
          example,
          <span class="package">tftpboot-installation-SLE-<em class="replaceable">VERSION</em>-x86_64</span>
          (replace <em class="replaceable">VERSION</em> with the actual version).
          Copy the content of the
          <code class="filename">SLE-<em class="replaceable">VERSION</em>-x86_64</code>
          directory to the root directory of the TFTP server:
        </p><div class="verbatim-wrap"><pre class="screen">cp -r /usr/share/tftpboot-installation/SLE-<em class="replaceable">VERSION</em>-x86_64 /srv/tftpboot</pre></div><p>
          For more information, refer to
          <code class="filename">/usr/share/tftpboot-installation/SLE-<em class="replaceable">VERSION</em>-x86_64/README</code>
        </p></section><section class="sect3" id="httpboot-http-server" data-id-title="Setting up the HTTP server"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">15.2.1.4 </span><span class="title-name">Setting up the HTTP server</span></span> <a title="Permalink" class="permalink" href="cha-deployment-prep-uefi-httpboot.html#httpboot-http-server">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/uefi-httpboot-server.xml" title="Edit source document"> </a></div></div></div></div></div><p>
          Create the
          <code class="filename">sle/</code>
          directory under the <code class="filename">/srv/www/htdocs/</code> directory
          and copy the entire content of the first system ISO image to the
          <code class="filename">/srv/www/htdocs/sle/</code>
          directory. Then edit the
          <code class="filename">/srv/www/htdocs/sle/EFI/BOOT/grub.cfg</code>
          file. Use the following example as a reference:
        </p><div class="verbatim-wrap"><pre class="screen">timeout=60
default=1

menuentry 'Installation IPv4' --class opensuse --class gnu-linux --class gnu --class os {
    set gfxpayload=keep
    echo 'Loading kernel ...'
    linux /sle/boot/x86_64/loader/linux install=http://www.httpboot.local/sle
    echo 'Loading initial ramdisk ...'
    initrd /sle/boot/x86_64/loader/initrd
}

menuentry 'Installation IPv6' --class opensuse --class gnu-linux --class gnu --class os {
    set gfxpayload=keep
    echo 'Loading kernel ...'
    linux /sle/boot/x86_64/loader/linux install=install=http://www.httpboot.local/sle ipv6only=1 ifcfg=*=dhcp6,DHCLIENT6_MODE=managed
    echo 'Loading initial ramdisk ...'
    initrd /sle/boot/x86_64/loader/initrd
}</pre></div><section class="sect4" id="httpboot-lighttpd" data-id-title="Configuring lighttpd"><div class="titlepage"><div><div><div class="title-container"><h5 class="title"><span class="title-number-name"><span class="title-number">15.2.1.4.1 </span><span class="title-name">Configuring lighttpd</span></span> <a title="Permalink" class="permalink" href="cha-deployment-prep-uefi-httpboot.html#httpboot-lighttpd">#</a></h5><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/uefi-httpboot-server.xml" title="Edit source document"> </a></div></div></div></div></div><p>
            To enable the support for both IPv4 and IPv6 in lighttpd, modify
            <code class="filename">/etc/lighttpd/lighttpd.conf</code> as follows:
          </p><div class="verbatim-wrap"><pre class="screen">##
## Use IPv6?
##
#server.use-ipv6 = "enable"
$SERVER["socket"] == "[::]:80" {  }</pre></div><p>
            Start the <code class="literal">lighttpd</code> daemon:
          </p><div class="verbatim-wrap"><pre class="screen">systemctl start lighttpd</pre></div></section><section class="sect4" id="httpboot-apache2" data-id-title="Configuring apache2"><div class="titlepage"><div><div><div class="title-container"><h5 class="title"><span class="title-number-name"><span class="title-number">15.2.1.4.2 </span><span class="title-name">Configuring apache2</span></span> <a title="Permalink" class="permalink" href="cha-deployment-prep-uefi-httpboot.html#httpboot-apache2">#</a></h5><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/uefi-httpboot-server.xml" title="Edit source document"> </a></div></div></div></div></div><p>
            Apache requires no additional configuration. Start the
            <code class="literal">apache2</code> daemon:
          </p><div class="verbatim-wrap"><pre class="screen">systemctl start apache2</pre></div></section></section><section class="sect3" id="httpboot-http-server-ssl-support" data-id-title="Enabling SSL support for the HTTP server (optional)"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">15.2.1.5 </span><span class="title-name">Enabling SSL support for the HTTP server (optional)</span></span> <a title="Permalink" class="permalink" href="cha-deployment-prep-uefi-httpboot.html#httpboot-http-server-ssl-support">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/uefi-httpboot-server.xml" title="Edit source document"> </a></div></div></div></div></div><p>
          To use the HTTPS Boot, you need to convert an existing server
          certificate into the <code class="literal">DER</code> format and enroll it into
          the client's firmware.
        </p><p>
          Assuming you already have a certificate installed on your server,
          convert it into the <code class="literal">DER</code> format for use with the
          client using the following command:
        </p><div class="verbatim-wrap"><pre class="screen">openssl x509 -in <em class="replaceable">CERTIFICATE</em>.crt -outform der -out <em class="replaceable">CERTIFICATE</em>.der</pre></div><section class="sect4" id="httpboot-enroll-certificate-physical-machine" data-id-title="Enroll the server certificate into the client firmware"><div class="titlepage"><div><div><div class="title-container"><h5 class="title"><span class="title-number-name"><span class="title-number">15.2.1.5.1 </span><span class="title-name">Enroll the server certificate into the client firmware</span></span> <a title="Permalink" class="permalink" href="cha-deployment-prep-uefi-httpboot.html#httpboot-enroll-certificate-physical-machine">#</a></h5><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/uefi-httpboot-server.xml" title="Edit source document"> </a></div></div></div></div></div><p>
            The exact procedure of enrolling the converted certificate depends
            on the specific implementation of the client's firmware. For
            certain hardware, you need to enroll the certificate manually via
            the firmware UI using an external storage device with the
            certificate on it. Machines with Redfish support can enroll the
            certificate remotely. Consult the documentation for your specific
            hardware for more information on enrolling certificates.
          </p></section><section class="sect4" id="httpboot-ssl-lighttpd" data-id-title="Enabling SSL support in lighttpd"><div class="titlepage"><div><div><div class="title-container"><h5 class="title"><span class="title-number-name"><span class="title-number">15.2.1.5.2 </span><span class="title-name">Enabling SSL support in lighttpd</span></span> <a title="Permalink" class="permalink" href="cha-deployment-prep-uefi-httpboot.html#httpboot-ssl-lighttpd">#</a></h5><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/uefi-httpboot-server.xml" title="Edit source document"> </a></div></div></div></div></div><p>
            Since lighttpd needs the private key and the certificate in the
            same file, unify them using the following command:
          </p><div class="verbatim-wrap"><pre class="screen">cat <em class="replaceable">CERTIFICATE</em>.crt server.key &gt; <em class="replaceable">CERTIFICATE</em>.pem</pre></div><p>
            Copy
            <code class="filename"><em class="replaceable">CERTIFICATE</em>.pem</code> to
            the <code class="filename">/etc/ssl/private/</code> directory.
          </p><div class="verbatim-wrap"><pre class="screen">cp server-almighty.pem /etc/ssl/private/
chown -R root:lighttpd /etc/ssl/private/server-almighty.pem
chmod 640 /etc/ssl/private/server-almighty.pem</pre></div><p>
            Make sure that <code class="literal">mod_openssl</code> is listed in the
            <code class="literal">server.modules</code> section of the
            <code class="filename">/etc/lighttpd/modules.conf</code> file, for example:
          </p><div class="verbatim-wrap"><pre class="screen">server.modules = (
  "mod_access",
  "mod_openssl",
)</pre></div><p>
            Add the following lines to <code class="literal">SSL Support</code> section
            in <code class="filename">/etc/lighttpd/lighttpd.conf</code>:
          </p><div class="verbatim-wrap"><pre class="screen"># IPv4
$SERVER["socket"] == ":443" {
    ssl.engine                 = "enable"
    ssl.pemfile                = "/etc/ssl/private/server-almighty.pem"
}
# IPv6
$SERVER["socket"] == "[::]:443" {
    ssl.engine                 = "enable"
    ssl.pemfile                = "/etc/ssl/private/server-almighty.pem"
}</pre></div><p>
            Restart lighttpd to activate SSL support:
          </p><div class="verbatim-wrap"><pre class="screen">systemctl restart lighttpd</pre></div></section><section class="sect4" id="http-ssl-apache" data-id-title="Enabling SSL support in Apache"><div class="titlepage"><div><div><div class="title-container"><h5 class="title"><span class="title-number-name"><span class="title-number">15.2.1.5.3 </span><span class="title-name">Enabling SSL support in Apache</span></span> <a title="Permalink" class="permalink" href="cha-deployment-prep-uefi-httpboot.html#http-ssl-apache">#</a></h5><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/uefi-httpboot-server.xml" title="Edit source document"> </a></div></div></div></div></div><p>
            Open the <code class="filename">/etc/sysconfig/apache2</code> file and add
            the SSL flag as follows:
          </p><div class="verbatim-wrap"><pre class="screen">APACHE_SERVER_FLAGS="SSL"</pre></div><p>
            Make sure that the <code class="literal">ssl</code> module is listed in
            <code class="literal">APACHE_MODULES</code>, for example:
          </p><p>
            Next, copy the private key and the certificate to the
            <code class="filename">/etc/apache2/</code> directory.
          </p><div class="verbatim-wrap"><pre class="screen">cp server.key /etc/apache2/ssl.key/
chown wwwrun /etc/apache2/ssl.key/server.key
chmod 600 /etc/apache2/ssl.key/server.key
cp server.crt /etc/apache2/ssl.crt/</pre></div><p>
            Create the ssl vhost configuration.
          </p><div class="verbatim-wrap"><pre class="screen">cd /etc/apache2/vhosts.d
cp vhost-ssl.template vhost-ssl.conf</pre></div><p>
            Edit <code class="filename">/etc/apache2/vhosts.d/vhost-ssl.conf</code> to
            change the private key and the certificate:
          </p><div class="verbatim-wrap"><pre class="screen">SSLCertificateFile /etc/apache2/ssl.crt/server.crt
 SSLCertificateKeyFile /etc/apache2/ssl.key/server.key</pre></div><p>
            Restart Apache to activate the SSL support:
          </p><div class="verbatim-wrap"><pre class="screen">systemctl restart apache2</pre></div></section><section class="sect4" id="httpboot-modify-dhcp-configuration" data-id-title="Modify the DHCP configuration"><div class="titlepage"><div><div><div class="title-container"><h5 class="title"><span class="title-number-name"><span class="title-number">15.2.1.5.4 </span><span class="title-name">Modify the DHCP configuration</span></span> <a title="Permalink" class="permalink" href="cha-deployment-prep-uefi-httpboot.html#httpboot-modify-dhcp-configuration">#</a></h5><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/uefi-httpboot-server.xml" title="Edit source document"> </a></div></div></div></div></div><p>
            Replace the <code class="literal">http://</code> prefix with
            <code class="literal">https://</code> in
            <code class="filename">dhcpd.conf/dhcpd6.conf</code> and restart the DHCP
            server.
          </p><div class="verbatim-wrap"><pre class="screen">systemctl restart dhcpd
systemctl restart dhcpd6</pre></div></section></section></section></section><section class="sect1" id="httpboot-client-boot" data-id-title="Booting the client via HTTP boot"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">15.3 </span><span class="title-name">Booting the client via HTTP boot</span></span> <a title="Permalink" class="permalink" href="cha-deployment-prep-uefi-httpboot.html#httpboot-client-boot">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/uefi-httpboot-server.xml" title="Edit source document"> </a></div></div></div></div></div><p>
      If the firmware already supports HTTP boot, plug in the cable and choose
      the correct boot option.
    </p></section></section><nav class="bottom-pagination"><div><a class="pagination-link prev" href="cha-deployment-prep-pxe.html"><span class="pagination-relation">Previous</span><span class="pagination-label"><span class="title-number">Chapter 14 </span>Preparing network boot environment</span></a> </div><div><a class="pagination-link next" href="cha-deployment-firstboot.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Chapter 16 </span>Deploying customized preinstallations</span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="sect1"><a href="cha-deployment-prep-uefi-httpboot.html#httpboot-intro"><span class="title-number">15.1 </span><span class="title-name">Introduction</span></a></span></li><li><span class="sect1"><a href="cha-deployment-prep-uefi-httpboot.html#httpboot-configure-server"><span class="title-number">15.2 </span><span class="title-name">Configuring the server</span></a></span></li><li><span class="sect1"><a href="cha-deployment-prep-uefi-httpboot.html#httpboot-client-boot"><span class="title-number">15.3 </span><span class="title-name">Booting the client via HTTP boot</span></a></span></li></ul></div><div class="side-title">Share this page</div><ul class="share"><li><a id="_share-fb" href="#" title="Facebook"> </a></li><li><a id="_share-in" href="#" title="LinkedIn"> </a></li><li><a id="_share-tw" href="#" title="Twitter/X"> </a></li><li><a id="_share-mail" href="#" title="E-Mail"> </a></li><li><a id="_print-button" href="#" title="Print this page"> </a></li></ul> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2024</span></div></div></footer></body></html>