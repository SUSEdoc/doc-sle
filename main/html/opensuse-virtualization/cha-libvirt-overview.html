<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>libvirt daemons | Virtualization Guide | openSUSE Leap 15.6</title><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" /><link rel="stylesheet" type="text/css" href="static/css/style.css" /><link rel="stylesheet" type="text/css" href="static/css/highlight.css" />
<meta name="title" content="libvirt daemons | openSUSE Leap 15.6" />
<meta name="description" content="A libvirt deployment for accessing KVM or Xen requires one or more daemons to be installed and active on the host. libvirt provides two daemon deployment optio…" />
<meta name="product-name" content="openSUSE Leap" />
<meta name="product-number" content="15.6" />
<meta name="book-title" content="Virtualization Guide" />
<meta name="chapter-title" content="Chapter 7. libvirt daemons" />
<meta name="tracker-url" content="https://bugzilla.opensuse.org/enter_bug.cgi" />
<meta name="tracker-type" content="bsc" />
<meta name="tracker-bsc-assignee" content="fs@suse.com" />
<meta name="tracker-bsc-component" content="Documentation" />
<meta name="tracker-bsc-product" content="openSUSE Distribution" />
<meta name="tracker-bsc-version" content="Leap 15.4" />
<meta property="og:title" content="libvirt daemons | openSUSE Leap 15.6" />
<meta property="og:description" content="A libvirt deployment for accessing KVM or Xen requires one or more daemons to be installed and active on the host. libvirt provides two daemon deployment optio…" />
<meta property="og:type" content="article" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="libvirt daemons | openSUSE Leap 15.6" />
<meta name="twitter:description" content="A libvirt deployment for accessing KVM or Xen requires one or more daemons to be installed and active on the host. libvirt provides two daemon deployment optio…" />
<link rel="home" href="index.html" title="openSUSE Leap Documentation" /><link rel="up" href="part-virt-libvirt.html" title="Part II. Managing virtual machines with libvirt" /><link rel="prev" href="part-virt-libvirt.html" title="Part II. Managing virtual machines with libvirt" /><link rel="next" href="cha-libvirt-host.html" title="Chapter 8. Preparing the VM Host Server" />
<script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css" /></noscript><script src="static/js/jquery-1.12.4.min.js" type="text/javascript"></script><script src="static/js/script.js" type="text/javascript"></script><script src="static/js/highlight.min.js" type="text/javascript"></script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-navigation">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><div id="_outer-wrap"><div id="_white-bg" style="background-color: #E11;"><div id="_header"><div id="_logo"><img src="static/images/logo.svg" alt="Logo" /></div><div class="crumbs"><a class="book-link" href="index.html" title="Virtualization Guide"><span class="book-icon">Virtualization Guide</span></a><span> › </span><a class="crumb" href="part-virt-libvirt.html">Managing virtual machines with libvirt</a><span> › </span><a class="crumb" href="cha-libvirt-overview.html">libvirt daemons</a></div><div class="clearme"></div></div></div><div id="_toolbar-wrap"><div id="_toolbar"><div id="_toc-area" class="inactive"><a id="_toc-area-button" class="tool" title="Contents" accesskey="c" href="index.html"><span class="tool-spacer"><span class="toc-icon">Contents</span><span class="clearme"></span></span><span class="tool-label">Contents</span></a><div class="active-contents bubble-corner"></div><div class="active-contents bubble"><div class="bubble-container"><h6>Virtualization Guide</h6><div id="_bubble-toc"><ol><li class="inactive"><a href="cha-kvm.html"><span class="number"> </span><span class="name">Preface</span></a></li><li class="inactive"><a href="part-virt-intro.html"><span class="number">I </span><span class="name">Introduction</span></a><ol><li class="inactive"><a href="chap-virtualization-introduction.html"><span class="number">1 </span><span class="name">Virtualization technology</span></a></li><li class="inactive"><a href="cha-virtualization-scenarios.html"><span class="number">2 </span><span class="name">Virtualization scenarios</span></a></li><li class="inactive"><a href="cha-xen-basics.html"><span class="number">3 </span><span class="name">Introduction to Xen virtualization</span></a></li><li class="inactive"><a href="cha-kvm-intro.html"><span class="number">4 </span><span class="name">Introduction to KVM virtualization</span></a></li><li class="inactive"><a href="cha-tools-intro.html"><span class="number">5 </span><span class="name">Virtualization tools</span></a></li><li class="inactive"><a href="cha-vt-installation.html"><span class="number">6 </span><span class="name">Installation of virtualization components</span></a></li></ol></li><li class="inactive"><a href="part-virt-libvirt.html"><span class="number">II </span><span class="name">Managing virtual machines with <code class="systemitem">libvirt</code></span></a><ol><li class="inactive"><a href="cha-libvirt-overview.html"><span class="number">7 </span><span class="name"><code class="systemitem">libvirt</code> daemons</span></a></li><li class="inactive"><a href="cha-libvirt-host.html"><span class="number">8 </span><span class="name">Preparing the VM Host Server</span></a></li><li class="inactive"><a href="cha-kvm-inst.html"><span class="number">9 </span><span class="name">Guest installation</span></a></li><li class="inactive"><a href="cha-libvirt-managing.html"><span class="number">10 </span><span class="name">Basic VM Guest management</span></a></li><li class="inactive"><a href="cha-libvirt-connect.html"><span class="number">11 </span><span class="name">Connecting and authorizing</span></a></li><li class="inactive"><a href="cha-libvirt-storage.html"><span class="number">12 </span><span class="name">Advanced storage topics</span></a></li><li class="inactive"><a href="cha-libvirt-config-gui.html"><span class="number">13 </span><span class="name">Configuring virtual machines with Virtual Machine Manager</span></a></li><li class="inactive"><a href="cha-libvirt-config-virsh.html"><span class="number">14 </span><span class="name">Configuring virtual machines with <code class="command">virsh</code></span></a></li><li class="inactive"><a href="cha-vm-security.html"><span class="number">15 </span><span class="name">Enhancing virtual machine security with AMD SEV-SNP</span></a></li><li class="inactive"><a href="sec-libvirt-admin-migrate.html"><span class="number">16 </span><span class="name">Migrating VM Guests</span></a></li><li class="inactive"><a href="xen2kvm-migration.html"><span class="number">17 </span><span class="name">Xen to KVM migration guide</span></a></li></ol></li><li class="inactive"><a href="part-virt-common.html"><span class="number">III </span><span class="name">Hypervisor-independent features</span></a><ol><li class="inactive"><a href="cha-cachemodes.html"><span class="number">18 </span><span class="name">Disk cache modes</span></a></li><li class="inactive"><a href="sec-kvm-managing-clock.html"><span class="number">19 </span><span class="name">VM Guest clock settings</span></a></li><li class="inactive"><a href="chap-guestfs.html"><span class="number">20 </span><span class="name">libguestfs</span></a></li><li class="inactive"><a href="cha-qemu-ga.html"><span class="number">21 </span><span class="name">QEMU guest agent</span></a></li><li class="inactive"><a href="tpm.html"><span class="number">22 </span><span class="name">Software TPM emulator</span></a></li><li class="inactive"><a href="virt-crash-dump.html"><span class="number">23 </span><span class="name">Creating crash dumps of a VM Guest</span></a></li></ol></li><li class="inactive"><a href="part-virt-xen.html"><span class="number">IV </span><span class="name">Managing virtual machines with Xen</span></a><ol><li class="inactive"><a href="cha-xen-vhost.html"><span class="number">24 </span><span class="name">Setting up a virtual machine host</span></a></li><li class="inactive"><a href="cha-xen-network.html"><span class="number">25 </span><span class="name">Virtual networking</span></a></li><li class="inactive"><a href="cha-xen-manage.html"><span class="number">26 </span><span class="name">Managing a virtualization environment</span></a></li><li class="inactive"><a href="cha-xen-vbd.html"><span class="number">27 </span><span class="name">Block devices in Xen</span></a></li><li class="inactive"><a href="cha-xen-config.html"><span class="number">28 </span><span class="name">Virtualization: configuration options and settings</span></a></li><li class="inactive"><a href="cha-xen-admin.html"><span class="number">29 </span><span class="name">Administrative tasks</span></a></li><li class="inactive"><a href="cha-xen-xenstore.html"><span class="number">30 </span><span class="name">XenStore: configuration database shared between domains</span></a></li><li class="inactive"><a href="cha-xen-ha.html"><span class="number">31 </span><span class="name">Xen as a high-availability virtualization host</span></a></li><li class="inactive"><a href="pv-to-fv.html"><span class="number">32 </span><span class="name">Xen: converting a paravirtual (PV) guest into a fully virtual (FV/HVM) guest</span></a></li></ol></li><li class="inactive"><a href="part-virt-qemu.html"><span class="number">V </span><span class="name">Managing virtual machines with QEMU</span></a><ol><li class="inactive"><a href="cha-qemu-overview.html"><span class="number">33 </span><span class="name">QEMU overview</span></a></li><li class="inactive"><a href="cha-qemu-host.html"><span class="number">34 </span><span class="name">Setting up a KVM VM Host Server</span></a></li><li class="inactive"><a href="cha-qemu-guest-inst.html"><span class="number">35 </span><span class="name">Guest installation</span></a></li><li class="inactive"><a href="cha-qemu-running.html"><span class="number">36 </span><span class="name">Running virtual machines with qemu-system-ARCH</span></a></li><li class="inactive"><a href="cha-qemu-monitor.html"><span class="number">37 </span><span class="name">Virtual machine administration using QEMU monitor</span></a></li></ol></li><li class="inactive"><a href="part-virt-troubleshoot.html"><span class="number">VI </span><span class="name">Troubleshooting</span></a><ol><li class="inactive"><a href="cha-virt-help.html"><span class="number">38 </span><span class="name">Integrated help and package documentation</span></a></li><li class="inactive"><a href="cha-virt-logs.html"><span class="number">39 </span><span class="name">Gathering system information and logs</span></a></li></ol></li><li class="inactive"><a href="gloss-vt-glossary.html"><span class="number"> </span><span class="name">Glossary</span></a></li><li class="inactive"><a href="app-gpu-passthru.html"><span class="number">A </span><span class="name">Configuring GPU Pass-Through for NVIDIA cards</span></a></li><li class="inactive"><a href="bk06apb.html"><span class="number">B </span><span class="name">GNU licenses</span></a></li></ol></div><div class="clearme"></div></div></div></div><div id="_nav-area" class="inactive"><div class="tool"><span class="nav-inner"><span class="tool-label">Navigation</span><a accesskey="p" class="tool-spacer" title="Part II. Managing virtual machines with libvirt" href="part-virt-libvirt.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 8. Preparing the VM Host Server" href="cha-libvirt-host.html"><span class="next-icon">→</span></a></span></div></div></div></div><div id="_fixed-header-wrap" style="background-color: #E11;" class="inactive"><div id="_fixed-header"><div class="crumbs"><a class="book-link" href="index.html" title="Virtualization Guide"><span class="book-icon">Virtualization Guide</span></a><span> › </span><a class="crumb" href="part-virt-libvirt.html">Managing virtual machines with libvirt</a><span> › </span><a class="crumb" href="cha-libvirt-overview.html">libvirt daemons</a></div><div class="buttons"><a class="top-button button" href="#">Top</a><div class="button"><a accesskey="p" class="tool-spacer" title="Part II. Managing virtual machines with libvirt" href="part-virt-libvirt.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 8. Preparing the VM Host Server" href="cha-libvirt-host.html"><span class="next-icon">→</span></a></div><div class="clearme"></div></div><div class="clearme"></div></div></div><div id="_content" class="draft "><div class="documentation"><div class="chapter " id="cha-libvirt-overview"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname "><span class="productname"><span class="phrase">openSUSE Leap</span></span></span> <span class="productnumber "><span class="productnumber"><span class="phrase">15.6</span></span></span></div><div><h2 class="title"><span class="number">7 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name"><code class="systemitem">libvirt</code> daemons</span> <a title="Permalink" class="permalink" href="cha-libvirt-overview.html#">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/libvirt_overview.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>libvirt_overview.xml</li><li><span class="ds-label">ID: </span>cha-libvirt-overview</li></ul></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="cha-libvirt-overview.html#libvirt-modular-daemon"><span class="number">7.1 </span><span class="name">Starting and stopping the modular daemons</span></a></span></dt><dt><span class="sect1"><a href="cha-libvirt-overview.html#libvirt-monolithic-daemon"><span class="number">7.2 </span><span class="name">Starting and stopping the monolithic daemon</span></a></span></dt><dt><span class="sect1"><a href="cha-libvirt-overview.html#libvirt-switch-daemons"><span class="number">7.3 </span><span class="name">Switching to the monolithic daemon</span></a></span></dt></dl></div></div><p>
    A <code class="systemitem">libvirt</code> deployment for accessing KVM or Xen requires one or more
    daemons to be installed and active on the host. <code class="systemitem">libvirt</code> provides two
    daemon deployment options: monolithic or modular daemons. <code class="systemitem">libvirt</code> has
    always provided the single monolithic daemon <code class="systemitem">libvirtd</code>. It includes the
    primary hypervisor drivers and all secondary drivers needed for managing
    storage, networking, node devices, etc. The monolithic <code class="systemitem">libvirtd</code> also
    provides secure remote access for external clients. Over time, <code class="systemitem">libvirt</code>
    added support for modular daemons, where each driver runs in its own
    daemon, allowing users to customize their <code class="systemitem">libvirt</code> deployment. Modular
    daemons are enabled by default, but a deployment can be switched to the
    traditional monolithic daemon by disabling the individual daemons and
    enabling <code class="systemitem">libvirtd</code>.
  </p><p>
    The modular daemon deployment is useful in scenarios where minimal
    <code class="systemitem">libvirt</code> support is needed. For example, if virtual machine storage and
    networking is not provided by <code class="systemitem">libvirt</code>, the
    <span class="package ">libvirt-daemon-driver-storage</span> and
    <span class="package ">libvirt-daemon-driver-network</span> packages are not
    required. Kubernetes is an example of an extreme case, where it handles all
    networking, storage, cgroups and namespace integration, etc. Only the
    <span class="package ">libvirt-daemon-driver-QEMU</span> package, providing
    <code class="systemitem">virtqemud</code>, needs to be installed.
    Modular daemons allow configuring a custom <code class="systemitem">libvirt</code> deployment containing
    only the components required for the use case.
  </p><div class="sect1 " id="libvirt-modular-daemon"><div class="titlepage"><div><div><h2 class="title"><span class="number">7.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Starting and stopping the modular daemons</span> <a title="Permalink" class="permalink" href="cha-libvirt-overview.html#libvirt-modular-daemon">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/libvirt_overview.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>libvirt_overview.xml</li><li><span class="ds-label">ID: </span>libvirt-modular-daemon</li></ul></div></div></div></div><p>
      The modular daemons are named after the driver which they are running,
      with the pattern <span class="quote">“<span class="quote ">virt<em class="replaceable ">DRIVER</em>d</span>”</span>.
      They are configured via the files
      <code class="filename">/etc/libvirt/virt<em class="replaceable ">DRIVER</em>d.conf</code>.
      SUSE supports the <code class="systemitem">virtqemud</code> and
      <code class="systemitem">virtxend</code> hypervisor daemons, along with
      all the secondary daemons:
    </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
          <span class="emphasis"><em>virtnetworkd</em></span> - The virtual network management
          daemon which provides <code class="systemitem">libvirt</code>'s virtual network management APIs.
          For example, virtnetworkd can be used to create a NAT virtual network
          on the host for use by virtual machines.
        </p></li><li class="listitem "><p>
          <span class="emphasis"><em>virtnodedevd</em></span> - The host physical device
          management daemon which provides <code class="systemitem">libvirt</code>'s node device management
          APIs. For example, virtnodedevd can be used to detach a PCI device
          from the host for use by a virtual machine.
        </p></li><li class="listitem "><p>
          <span class="emphasis"><em>virtnwfilterd</em></span> - The host firewall management
          daemon which provides <code class="systemitem">libvirt</code>'s firewall management APIs. For
          example, virtnwfilterd can be used to configure network traffic
          filtering rules for virtual machines.
        </p></li><li class="listitem "><p>
          <span class="emphasis"><em>virtsecretd</em></span> - The host secret management daemon
          which provides <code class="systemitem">libvirt</code>'s secret management APIs. For example,
          virtsecretd can be used to store a key associated with a LUKs volume.
        </p></li><li class="listitem "><p>
          <span class="emphasis"><em>virtstoraged</em></span> - The host storage management
          daemon which provides <code class="systemitem">libvirt</code>'s storage management APIs.
          virtstoraged can be used to create storage pools and create volumes
          from those pools.
        </p></li><li class="listitem "><p>
          <span class="emphasis"><em>virtinterfaced</em></span> - The host NIC management daemon
          which provides <code class="systemitem">libvirt</code>'s host network interface management APIs.
          For example, virtinterfaced can be used to create a bonded network
          device on the host. SUSE discourages the use of <code class="systemitem">libvirt</code>'s interface
          management APIs in favor of default networking tools like wicked or
          NetworkManager. It is recommended to disable virtinterfaced.
        </p></li><li class="listitem "><p>
          <span class="emphasis"><em>virtproxyd</em></span> - A daemon to proxy connections
          between the traditional <code class="systemitem">libvirtd</code> sockets and the modular daemon
          sockets. With a modular <code class="systemitem">libvirt</code> deployment, virtproxyd allows
          remote clients to access the <code class="systemitem">libvirt</code> APIs similar to the monolithic
          <code class="systemitem">libvirtd</code>. It can also be used by local clients that connect to the
          monolithic <code class="systemitem">libvirtd</code> sockets.
        </p></li><li class="listitem "><p>
          <span class="emphasis"><em>virtlogd</em></span> - A daemon to manage logs from virtual
          machine consoles. virtlogd is also used by the monolithic <code class="systemitem">libvirtd</code>.
          The monolithic daemon and virtqemud <code class="systemitem">systemd</code> unit files require
          virtlogd, so it is not necessary to explicitly start virtlogd.
        </p></li><li class="listitem "><p>
          <span class="emphasis"><em>virtlockd</em></span> - A daemon to manage locks held
          against virtual machine resources such as disks. virtlockd is also
          used by the monolithic <code class="systemitem">libvirtd</code>. The monolithic daemon, virtqemud,
          and virtxend <code class="systemitem">systemd</code> unit files require virtlockd, so it is not
          necessary to explicitly start virtlockd.
        </p></li></ul></div><p>
      <code class="systemitem">virtlogd</code> and
      <code class="systemitem">virtlockd</code> are also used by the
      monolithic <code class="systemitem">libvirtd</code>. These daemons have always been separate from
      <code class="systemitem">libvirtd</code> for security reasons.
    </p><p>
      By default, the modular daemons listen for connections on the
      <code class="filename">/var/run/libvirt/virt<em class="replaceable ">DRIVER</em>d-sock</code>
      and
      <code class="filename">/var/run/libvirt/virt<em class="replaceable ">DRIVER</em>d-sock-ro</code>
      Unix Domain Sockets. The client library prefers these sockets over the
      traditional <code class="filename">/var/run/libvirt/libvirtd-sock</code>. The
      virtproxyd daemon is available for remote clients or local clients
      expecting the traditional <code class="systemitem">libvirtd</code> socket.
    </p><p>
      The <code class="systemitem">virtqemud</code> and
      <code class="systemitem">virtxend</code> services are enabled in
      the <code class="systemitem">systemd</code> presets. The sockets for
      <code class="systemitem">virtnetworkd</code>,
      <code class="systemitem">virtnodedevd</code>,
      <code class="systemitem">virtnwfilterd</code>,
      <code class="systemitem">virtstoraged</code> and
      <code class="systemitem">virtsecretd</code> are also enabled in
      the presets, ensuring the daemons are enabled and available when the
      corresponding packages are installed. Although enabled in presets for
      convenience, the modular daemons can also be managed with their <code class="systemitem">systemd</code>
      unit files:
    </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
          <span class="emphasis"><em>virt<em class="replaceable ">DRIVER</em>d.service</em></span> -
          The main unit file for launching the
          virt<em class="replaceable ">DRIVER</em>d daemon. We recommend
          configuring the service to start on boot if VMs are also configured
          to start on host boot.
        </p></li><li class="listitem "><p>
          <span class="emphasis"><em>virt<em class="replaceable ">DRIVER</em>d.socket</em></span> -
          The unit file corresponding to the main read-write UNIX socket
          <code class="filename">/var/run/libvirt/virt<em class="replaceable ">DRIVER</em>d-sock</code>.
          We recommend starting this socket on boot by default.
        </p></li><li class="listitem "><p>
          <span class="emphasis"><em>virt<em class="replaceable ">DRIVER</em>d-ro.socket</em></span>
          - The unit file corresponding to the main read-only UNIX socket
          <code class="filename">/var/run/libvirt/virt<em class="replaceable ">DRIVER</em>d-sock-ro</code>.
          We recommend starting this socket on boot by default.
        </p></li><li class="listitem "><p>
          <span class="emphasis"><em>virt<em class="replaceable ">DRIVER</em>d-admin.socket</em></span>
          - The unit file corresponding to the administrative UNIX socket
          <code class="filename">/var/run/libvirt/virt<em class="replaceable ">DRIVER</em>d-admin-sock</code>.
          We recommend starting this socket on boot by default.
        </p></li></ul></div><p>
      When <code class="systemitem">systemd</code> socket activation is used, several configuration settings
      in virt<em class="replaceable ">DRIVER</em>d.conf are no longer honored.
      Instead, these settings must be controlled via the system unit files:
    </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
          <span class="emphasis"><em>unix_sock_group</em></span> - UNIX socket group owner,
          controlled via the <code class="option">SocketGroup</code> parameter in the
          <code class="filename">virt<em class="replaceable ">DRIVER</em>d.socket</code>
          and
          <code class="filename">virt<em class="replaceable ">DRIVER</em>d-ro.socket</code>
          unit files.
        </p></li><li class="listitem "><p>
          <span class="emphasis"><em>unix_sock_ro_perms</em></span> - Read-only UNIX socket
          permissions, controlled via the <code class="option">SocketMode</code> parameter
          in the
          <code class="filename">virt<em class="replaceable ">DRIVER</em>d-ro.socket</code>
          unit file.
        </p></li><li class="listitem "><p>
          <span class="emphasis"><em>unix_sock_rw_perms</em></span> - Read-write UNIX socket
          permissions, controlled via the <code class="option">SocketMode</code> parameter
          in the
          <code class="filename">virt<em class="replaceable ">DRIVER</em>d.socket</code>
          unit file.
        </p></li><li class="listitem "><p>
          <span class="emphasis"><em>unix_sock_admin_perms</em></span> - Admin UNIX socket
          permissions, controlled via the <code class="option">SocketMode</code> parameter
          in the
          <code class="filename">virt<em class="replaceable ">DRIVER</em>d-admin.socket</code>
          unit file.
        </p></li><li class="listitem "><p>
          <span class="emphasis"><em>unix_sock_dir</em></span> - Directory in which all UNIX
          sockets are created, independently controlled via the
          <code class="option">ListenStream</code> parameter in any of the
          <code class="filename">virt<em class="replaceable ">DRIVER</em>d.socket</code>,
          <code class="filename">virt<em class="replaceable ">DRIVER</em>d-ro.socket</code>
          and
          <code class="filename">virt<em class="replaceable ">DRIVER</em>d-admin.socket</code>
          unit files.
        </p></li></ul></div></div><div class="sect1 " id="libvirt-monolithic-daemon"><div class="titlepage"><div><div><h2 class="title"><span class="number">7.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Starting and stopping the monolithic daemon</span> <a title="Permalink" class="permalink" href="cha-libvirt-overview.html#libvirt-monolithic-daemon">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/libvirt_overview.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>libvirt_overview.xml</li><li><span class="ds-label">ID: </span>libvirt-monolithic-daemon</li></ul></div></div></div></div><p>
      The monolithic daemon is known as <code class="systemitem">libvirtd</code> and is configured via
      <code class="filename">/etc/libvirt/libvirtd.conf</code>. <code class="systemitem">libvirtd</code> is managed
      with several <code class="systemitem">systemd</code> unit files:
    </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
          <span class="emphasis"><em>libvirtd.service</em></span> - The main <code class="systemitem">systemd</code> unit file
          for launching <code class="systemitem">libvirtd</code>. We recommend configuring
          <code class="filename">libvirtd.service</code> to start on boot if VMs are
          also configured to start on host boot.
        </p></li><li class="listitem "><p>
          <span class="emphasis"><em>libvirtd.socket</em></span> - The unit file corresponding to
          the main read-write UNIX socket
          <code class="filename">/var/run/libvirt/libvirt-sock</code>. We recommend
          enabling this unit on boot.
        </p></li><li class="listitem "><p>
          <span class="emphasis"><em>libvirtd-ro.socket</em></span> - The unit file corresponding
          to the main read-only UNIX socket
          <code class="filename">/var/run/libvirt/libvirt-sock-ro</code>. We recommend
          enabling this unit on boot.
        </p></li><li class="listitem "><p>
          <span class="emphasis"><em>libvirtd-admin.socket</em></span> - The unit file
          corresponding to the administrative UNIX socket
          <code class="filename">/var/run/libvirt/libvirt-admin-sock</code>. We
          recommend enabling this unit on boot.
        </p></li><li class="listitem "><p>
          <span class="emphasis"><em>libvirtd-tcp.socket</em></span> - The unit file
          corresponding to the TCP 16509 port for non-TLS remote access. This
          unit should not be configured to start on boot until the
          administrator has configured a suitable authentication mechanism.
        </p></li><li class="listitem "><p>
          <span class="emphasis"><em>libvirtd-tls.socket</em></span> - The unit file
          corresponding to the TCP 16509 port for TLS remote access. This unit
          should not be configured to start on boot until the administrator has
          deployed x509 certificates and optionally configured a suitable
          authentication mechanism.
        </p></li></ul></div><p>
      When <code class="systemitem">systemd</code> socket activation is used, certain configuration settings
      in <code class="filename">libvirtd.conf</code> are no longer honored. Instead,
      these settings must be controlled via the system unit files:
    </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
          <span class="emphasis"><em>listen_tcp</em></span> - TCP socket usage is enabled by
          starting the <code class="filename">libvirtd-tcp.socket</code> unit file.
        </p></li><li class="listitem "><p>
          <span class="emphasis"><em>listen_tls</em></span> - TLS socket usage is enabled by
          starting the <code class="filename">libvirtd-tls.socket</code> unit file.
        </p></li><li class="listitem "><p>
          <span class="emphasis"><em>tcp_port</em></span> - Port for the non-TLS TCP socket,
          controlled via the <code class="option">ListenStream</code> parameter in the
          <code class="filename">libvirtd-tcp.socket</code> unit file.
        </p></li><li class="listitem "><p>
          <span class="emphasis"><em>tls_port</em></span> - Port for the TLS TCP socket,
          controlled via the <code class="option">ListenStream</code> parameter in the
          <code class="filename">libvirtd-tls.socket</code> unit file.
        </p></li><li class="listitem "><p>
          <span class="emphasis"><em>listen_addr</em></span> - IP address to listen on,
          independently controlled via the <code class="option">ListenStream</code>
          parameter in the <code class="filename">libvirtd-tcp.socket</code> or
          <code class="filename">libvirtd-tls.socket</code> unit files.
        </p></li><li class="listitem "><p>
          <span class="emphasis"><em>unix_sock_group</em></span> - UNIX socket group owner,
          controlled via the <code class="option">SocketGroup</code> parameter in the
          <code class="filename">libvirtd.socket</code> and
          <code class="filename">libvirtd-ro.socket</code> unit files.
        </p></li><li class="listitem "><p>
          <span class="emphasis"><em>unix_sock_ro_perms</em></span> - Read-only UNIX socket
          permissions, controlled via the <code class="option">SocketMode</code> parameter
          in the <code class="filename">libvirtd-ro.socket</code> unit file.
        </p></li><li class="listitem "><p>
          <span class="emphasis"><em>unix_sock_rw_perms</em></span> - Read-write UNIX socket
          permissions, controlled via the <code class="option">SocketMode</code> parameter
          in the <code class="filename">libvirtd.socket</code> unit file.
        </p></li><li class="listitem "><p>
          <span class="emphasis"><em>unix_sock_admin_perms</em></span> - Admin UNIX socket
          permissions, controlled via the <code class="option">SocketMode</code> parameter
          in the <code class="filename">libvirtd-admin.socket</code> unit file.
        </p></li><li class="listitem "><p>
          <span class="emphasis"><em>unix_sock_dir</em></span> - Directory in which all UNIX
          sockets are created, independently controlled via the
          <code class="option">ListenStream</code> parameter in any of the
          <code class="filename">libvirtd.socket</code>,
          <code class="filename">libvirtd-ro.socket</code> and
          <code class="filename">libvirtd-admin.socket</code> unit files.
        </p></li></ul></div><div id="id-1.8.4.2.6.6" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg" /><h6>Important: Conflicting services: <code class="systemitem">libvirtd</code> and <code class="systemitem">xendomains</code></h6><p>
        If <code class="systemitem">libvirtd</code> fails to start, check if the service
        <code class="systemitem">xendomains</code> is loaded:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code>systemctl is-active xendomains active</pre></div><p>
        If the command returns <code class="literal">active</code>, you need to stop
        <code class="systemitem">xendomains</code> before you can start
        the <code class="systemitem">libvirtd</code> daemon. If you want <code class="systemitem">libvirtd</code> to also start after
        rebooting, additionally prevent
        <code class="systemitem">xendomains</code> from starting
        automatically. Disable the service:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> systemctl stop xendomains
<code class="prompt user">&gt; </code><code class="command">sudo</code> systemctl disable xendomains
<code class="prompt user">&gt; </code><code class="command">sudo</code> systemctl start libvirtd</pre></div><p>
        <code class="systemitem">xendomains</code> and <code class="systemitem">libvirtd</code>
        provide the same service and when used in parallel, may interfere with
        one another. As an example,
        <code class="systemitem">xendomains</code> may attempt to start
        a domU already started by <code class="systemitem">libvirtd</code>.
      </p></div></div><div class="sect1 " id="libvirt-switch-daemons"><div class="titlepage"><div><div><h2 class="title"><span class="number">7.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Switching to the monolithic daemon</span> <a title="Permalink" class="permalink" href="cha-libvirt-overview.html#libvirt-switch-daemons">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/libvirt_overview.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>libvirt_overview.xml</li><li><span class="ds-label">ID: </span>libvirt-switch-daemons</li></ul></div></div></div></div><p>
      Several services need to be changed when switching from modular to the
      monolithic daemon. It is recommended to stop or evict any running virtual
      machines before switching between the daemon options.
    </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
          Stop the modular daemons and their sockets. The following example
          disables the QEMU daemon for KVM and several secondary daemons.
        </p><div class="verbatim-wrap"><pre class="screen">for drv in qemu network nodedev nwfilter secret storage
do
 <code class="prompt user">&gt; </code><code class="command">sudo</code> systemctl stop virt${drv}d.service
 <code class="prompt user">&gt; </code><code class="command">sudo</code> systemctl stop virt${drv}d{,-ro,-admin}.socket
done</pre></div></li><li class="step "><p>
          Disable future start of the modular daemons
        </p><div class="verbatim-wrap"><pre class="screen">for drv in qemu network nodedev nwfilter secret storage
do
 <code class="prompt user">&gt; </code><code class="command">sudo</code> systemctl disable virt${drv}d.service
 <code class="prompt user">&gt; </code><code class="command">sudo</code> systemctl disable virt${drv}d{,-ro,-admin}.socket
done</pre></div></li><li class="step "><p>
          Enable the monolithic <code class="systemitem">libvirtd</code> service and sockets
        </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> systemctl enable libvirtd.service
<code class="prompt user">&gt; </code><code class="command">sudo</code> systemctl enable libvirtd{,-ro,-admin}.socket</pre></div></li><li class="step "><p>
          Start the monolithic <code class="systemitem">libvirtd</code> sockets
        </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> systemctl start libvirtd{,-ro,-admin}.socket</pre></div></li></ol></div></div></div></div></div><div class="page-bottom"><div id="_bottom-navigation"><a class="nav-link" href="cha-libvirt-host.html"><span class="next-icon">→</span><span class="nav-label"><span class="number">Chapter 8 </span>Preparing the VM Host Server</span></a><a class="nav-link" href="part-virt-libvirt.html"><span class="prev-icon">←</span><span class="nav-label"><span class="number">Part II </span>Managing virtual machines with <code class="systemitem">libvirt</code></span></a></div><div class="_share-print"><div class="online-contents share"><strong>Share this page: </strong><span class="share-buttons"><span class="_share-fb bottom-button">Facebook</span><span class="spacer"> • </span><span class="_share-in bottom-button">LinkedIn</span><span class="spacer"> • </span><span class="_share-tw bottom-button">Twitter</span><span class="spacer"> • </span><span class="_share-mail bottom-button">E-Mail</span></span></div><div class="print"><span class="_print-button bottom-button">Print this page</span></div><div class="clearme"></div></div></div></div><div id="_inward"></div></div><div id="_footer-wrap"><div id="_footer"><p>©
        2024 
        SUSE</p><ul><li><a href="https://jobs.suse.com/" target="_top">Careers</a></li><li><a href="https://www.suse.com/company/legal/" target="_top">Legal</a></li><li><a href="https://www.suse.com/company/about/" target="_top">About</a></li><li><a href="https://www.suse.com/contact/" target="_top">Contact Us</a></li></ul></div></div></body></html>