<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Installation of virtualization components | Virtualization Guide | openSUSE Leap 15.6</title><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" /><link rel="stylesheet" type="text/css" href="static/css/style.css" /><link rel="stylesheet" type="text/css" href="static/css/highlight.css" />
<meta name="title" content="Installation of virtualization components | openSUSE L…" />
<meta name="description" content="To run a virtualization server (VM Host Server) that can host one or more guest systems (VM Guests), you need to install required virtualization components on …" />
<meta name="product-name" content="openSUSE Leap" />
<meta name="product-number" content="15.6" />
<meta name="book-title" content="Virtualization Guide" />
<meta name="chapter-title" content="Chapter 6. Installation of virtualization components" />
<meta name="tracker-url" content="https://bugzilla.opensuse.org/enter_bug.cgi" />
<meta name="tracker-type" content="bsc" />
<meta name="tracker-bsc-assignee" content="fs@suse.com" />
<meta name="tracker-bsc-component" content="Documentation" />
<meta name="tracker-bsc-product" content="openSUSE Distribution" />
<meta name="tracker-bsc-version" content="Leap 15.4" />
<meta property="og:title" content="Installation of virtualization components | openSUSE L…" />
<meta property="og:description" content="To run a virtualization server (VM Host Server) that can host one or more guest systems (VM Guests), you need to install required virtualization components on …" />
<meta property="og:type" content="article" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Installation of virtualization components | openSUSE L…" />
<meta name="twitter:description" content="To run a virtualization server (VM Host Server) that can host one or more guest systems (VM Guests), you need to install required virtualization components on …" />
<link rel="home" href="index.html" title="openSUSE Leap Documentation" /><link rel="up" href="part-virt-intro.html" title="Part I. Introduction" /><link rel="prev" href="cha-tools-intro.html" title="Chapter 5. Virtualization tools" /><link rel="next" href="part-virt-libvirt.html" title="Part II. Managing virtual machines with libvirt" />
<script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css" /></noscript><script src="static/js/jquery-1.12.4.min.js" type="text/javascript"></script><script src="static/js/script.js" type="text/javascript"></script><script src="static/js/highlight.min.js" type="text/javascript"></script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-navigation">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><div id="_outer-wrap"><div id="_white-bg" style="background-color: #E11;"><div id="_header"><div id="_logo"><img src="static/images/logo.svg" alt="Logo" /></div><div class="crumbs"><a class="book-link" href="index.html" title="Virtualization Guide"><span class="book-icon">Virtualization Guide</span></a><span> › </span><a class="crumb" href="part-virt-intro.html">Introduction</a><span> › </span><a class="crumb" href="cha-vt-installation.html">Installation of virtualization components</a></div><div class="clearme"></div></div></div><div id="_toolbar-wrap"><div id="_toolbar"><div id="_toc-area" class="inactive"><a id="_toc-area-button" class="tool" title="Contents" accesskey="c" href="index.html"><span class="tool-spacer"><span class="toc-icon">Contents</span><span class="clearme"></span></span><span class="tool-label">Contents</span></a><div class="active-contents bubble-corner"></div><div class="active-contents bubble"><div class="bubble-container"><h6>Virtualization Guide</h6><div id="_bubble-toc"><ol><li class="inactive"><a href="cha-kvm.html"><span class="number"> </span><span class="name">Preface</span></a></li><li class="inactive"><a href="part-virt-intro.html"><span class="number">I </span><span class="name">Introduction</span></a><ol><li class="inactive"><a href="chap-virtualization-introduction.html"><span class="number">1 </span><span class="name">Virtualization technology</span></a></li><li class="inactive"><a href="cha-virtualization-scenarios.html"><span class="number">2 </span><span class="name">Virtualization scenarios</span></a></li><li class="inactive"><a href="cha-xen-basics.html"><span class="number">3 </span><span class="name">Introduction to Xen virtualization</span></a></li><li class="inactive"><a href="cha-kvm-intro.html"><span class="number">4 </span><span class="name">Introduction to KVM virtualization</span></a></li><li class="inactive"><a href="cha-tools-intro.html"><span class="number">5 </span><span class="name">Virtualization tools</span></a></li><li class="inactive"><a href="cha-vt-installation.html"><span class="number">6 </span><span class="name">Installation of virtualization components</span></a></li></ol></li><li class="inactive"><a href="part-virt-libvirt.html"><span class="number">II </span><span class="name">Managing virtual machines with <code class="systemitem">libvirt</code></span></a><ol><li class="inactive"><a href="cha-libvirt-overview.html"><span class="number">7 </span><span class="name"><code class="systemitem">libvirt</code> daemons</span></a></li><li class="inactive"><a href="cha-libvirt-host.html"><span class="number">8 </span><span class="name">Preparing the VM Host Server</span></a></li><li class="inactive"><a href="cha-kvm-inst.html"><span class="number">9 </span><span class="name">Guest installation</span></a></li><li class="inactive"><a href="cha-libvirt-managing.html"><span class="number">10 </span><span class="name">Basic VM Guest management</span></a></li><li class="inactive"><a href="cha-libvirt-connect.html"><span class="number">11 </span><span class="name">Connecting and authorizing</span></a></li><li class="inactive"><a href="cha-libvirt-storage.html"><span class="number">12 </span><span class="name">Advanced storage topics</span></a></li><li class="inactive"><a href="cha-libvirt-config-gui.html"><span class="number">13 </span><span class="name">Configuring virtual machines with Virtual Machine Manager</span></a></li><li class="inactive"><a href="cha-libvirt-config-virsh.html"><span class="number">14 </span><span class="name">Configuring virtual machines with <code class="command">virsh</code></span></a></li><li class="inactive"><a href="sec-libvirt-admin-migrate.html"><span class="number">15 </span><span class="name">Migrating VM Guests</span></a></li><li class="inactive"><a href="xen2kvm-migration.html"><span class="number">16 </span><span class="name">Xen to KVM migration guide</span></a></li></ol></li><li class="inactive"><a href="part-virt-common.html"><span class="number">III </span><span class="name">Hypervisor-independent features</span></a><ol><li class="inactive"><a href="cha-cachemodes.html"><span class="number">17 </span><span class="name">Disk cache modes</span></a></li><li class="inactive"><a href="sec-kvm-managing-clock.html"><span class="number">18 </span><span class="name">VM Guest clock settings</span></a></li><li class="inactive"><a href="chap-guestfs.html"><span class="number">19 </span><span class="name">libguestfs</span></a></li><li class="inactive"><a href="cha-qemu-ga.html"><span class="number">20 </span><span class="name">QEMU guest agent</span></a></li><li class="inactive"><a href="tpm.html"><span class="number">21 </span><span class="name">Software TPM emulator</span></a></li><li class="inactive"><a href="virt-crash-dump.html"><span class="number">22 </span><span class="name">Creating crash dumps of a VM Guest</span></a></li></ol></li><li class="inactive"><a href="part-virt-xen.html"><span class="number">IV </span><span class="name">Managing virtual machines with Xen</span></a><ol><li class="inactive"><a href="cha-xen-vhost.html"><span class="number">23 </span><span class="name">Setting up a virtual machine host</span></a></li><li class="inactive"><a href="cha-xen-network.html"><span class="number">24 </span><span class="name">Virtual networking</span></a></li><li class="inactive"><a href="cha-xen-manage.html"><span class="number">25 </span><span class="name">Managing a virtualization environment</span></a></li><li class="inactive"><a href="cha-xen-vbd.html"><span class="number">26 </span><span class="name">Block devices in Xen</span></a></li><li class="inactive"><a href="cha-xen-config.html"><span class="number">27 </span><span class="name">Virtualization: configuration options and settings</span></a></li><li class="inactive"><a href="cha-xen-admin.html"><span class="number">28 </span><span class="name">Administrative tasks</span></a></li><li class="inactive"><a href="cha-xen-xenstore.html"><span class="number">29 </span><span class="name">XenStore: configuration database shared between domains</span></a></li><li class="inactive"><a href="cha-xen-ha.html"><span class="number">30 </span><span class="name">Xen as a high-availability virtualization host</span></a></li><li class="inactive"><a href="pv-to-fv.html"><span class="number">31 </span><span class="name">Xen: converting a paravirtual (PV) guest into a fully virtual (FV/HVM) guest</span></a></li></ol></li><li class="inactive"><a href="part-virt-qemu.html"><span class="number">V </span><span class="name">Managing virtual machines with QEMU</span></a><ol><li class="inactive"><a href="cha-qemu-overview.html"><span class="number">32 </span><span class="name">QEMU overview</span></a></li><li class="inactive"><a href="cha-qemu-host.html"><span class="number">33 </span><span class="name">Setting up a KVM VM Host Server</span></a></li><li class="inactive"><a href="cha-qemu-guest-inst.html"><span class="number">34 </span><span class="name">Guest installation</span></a></li><li class="inactive"><a href="cha-qemu-running.html"><span class="number">35 </span><span class="name">Running virtual machines with qemu-system-ARCH</span></a></li><li class="inactive"><a href="cha-qemu-monitor.html"><span class="number">36 </span><span class="name">Virtual machine administration using QEMU monitor</span></a></li></ol></li><li class="inactive"><a href="part-virt-troubleshoot.html"><span class="number">VI </span><span class="name">Troubleshooting</span></a><ol><li class="inactive"><a href="cha-virt-help.html"><span class="number">37 </span><span class="name">Integrated help and package documentation</span></a></li><li class="inactive"><a href="cha-virt-logs.html"><span class="number">38 </span><span class="name">Gathering system information and logs</span></a></li></ol></li><li class="inactive"><a href="gloss-vt-glossary.html"><span class="number"> </span><span class="name">Glossary</span></a></li><li class="inactive"><a href="app-gpu-passthru.html"><span class="number">A </span><span class="name">Configuring GPU Pass-Through for NVIDIA cards</span></a></li><li class="inactive"><a href="bk06apb.html"><span class="number">B </span><span class="name">GNU licenses</span></a></li></ol></div><div class="clearme"></div></div></div></div><div id="_nav-area" class="inactive"><div class="tool"><span class="nav-inner"><span class="tool-label">Navigation</span><a accesskey="p" class="tool-spacer" title="Chapter 5. Virtualization tools" href="cha-tools-intro.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Part II. Managing virtual machines with libvirt" href="part-virt-libvirt.html"><span class="next-icon">→</span></a></span></div></div></div></div><div id="_fixed-header-wrap" style="background-color: #E11;" class="inactive"><div id="_fixed-header"><div class="crumbs"><a class="book-link" href="index.html" title="Virtualization Guide"><span class="book-icon">Virtualization Guide</span></a><span> › </span><a class="crumb" href="part-virt-intro.html">Introduction</a><span> › </span><a class="crumb" href="cha-vt-installation.html">Installation of virtualization components</a></div><div class="buttons"><a class="top-button button" href="#">Top</a><div class="button"><a accesskey="p" class="tool-spacer" title="Chapter 5. Virtualization tools" href="cha-tools-intro.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Part II. Managing virtual machines with libvirt" href="part-virt-libvirt.html"><span class="next-icon">→</span></a></div><div class="clearme"></div></div><div class="clearme"></div></div></div><div id="_content" class="draft "><div class="documentation"><div class="chapter " id="cha-vt-installation"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname "><span class="productname"><span class="phrase">openSUSE Leap</span></span></span> <span class="productnumber "><span class="productnumber"><span class="phrase">15.6</span></span></span></div><div><h2 class="title"><span class="number">6 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Installation of virtualization components</span> <a title="Permalink" class="permalink" href="cha-vt-installation.html#">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/vt_installation.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>vt_installation.xml</li><li><span class="ds-label">ID: </span>cha-vt-installation</li></ul></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="cha-vt-installation.html#introduction-install-virtualization-components"><span class="number">6.1 </span><span class="name">Introduction</span></a></span></dt><dt><span class="sect1"><a href="cha-vt-installation.html#install-virtualization-components"><span class="number">6.2 </span><span class="name">Installing virtualization components</span></a></span></dt><dt><span class="sect1"><a href="cha-vt-installation.html#sec-vt-installation-nested-vms"><span class="number">6.3 </span><span class="name">Enable nested virtualization in KVM</span></a></span></dt></dl></div></div><div class="sect1 " id="introduction-install-virtualization-components"><div class="titlepage"><div><div><h2 class="title"><span class="number">6.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Introduction</span> <a title="Permalink" class="permalink" href="cha-vt-installation.html#introduction-install-virtualization-components">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/vt_installation.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>vt_installation.xml</li><li><span class="ds-label">ID: </span>introduction-install-virtualization-components</li></ul></div></div></div></div><p>
      To run a virtualization server (VM Host Server) that can host one or more guest
      systems (VM Guests), you need to install required virtualization
      components on the server. These components vary depending on which
      virtualization technology you want to use.
    </p></div><div class="sect1 " id="install-virtualization-components"><div class="titlepage"><div><div><h2 class="title"><span class="number">6.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Installing virtualization components</span> <a title="Permalink" class="permalink" href="cha-vt-installation.html#install-virtualization-components">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/vt_installation.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>vt_installation.xml</li><li><span class="ds-label">ID: </span>install-virtualization-components</li></ul></div></div></div></div><p>
      You can install the virtualization tools required to run a VM Host Server in
      one of the following ways:
    </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
          By selecting a specific system role during <span class="productname"><span class="phrase">openSUSE Leap</span></span> installation
          on the VM Host Server
        </p></li><li class="listitem "><p>
          By running the <span class="emphasis"><em>YaST Virtualization</em></span> module on
          an already installed and running <span class="productname"><span class="phrase">openSUSE Leap</span></span>.
        </p></li><li class="listitem "><p>
          By installing specific installation patterns on an already installed
          and running <span class="productname"><span class="phrase">openSUSE Leap</span></span>.
        </p></li></ul></div><div class="sect2 " id="install-virtualization-components-system-role"><div class="titlepage"><div><div><h3 class="title"><span class="number">6.2.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Specifying a system role</span> <a title="Permalink" class="permalink" href="cha-vt-installation.html#install-virtualization-components-system-role">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/vt_installation.xml" title="Edit the source file for this section">Edit source</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>vt_installation.xml</li><li><span class="ds-label">ID: </span>install-virtualization-components-system-role</li></ul></div></div></div></div><p>
        You can install all the tools required for virtualization during the
        installation of <span class="productname"><span class="phrase">openSUSE Leap</span></span> on the VM Host Server. During the installation,
        you are presented with the <span class="guimenu ">System Role</span> screen.
      </p><div class="figure" id="id-1.8.3.7.4.4.3"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/virt-system-roles.png" target="_blank"><img src="images/virt-system-roles.png" width="" alt="System Role screen" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 6.1: </span><span class="name">System Role screen </span><a title="Permalink" class="permalink" href="cha-vt-installation.html#id-1.8.3.7.4.4.3">#</a></h6></div></div><p>
        Here you can select either the <span class="guimenu ">KVM Virtualization
        Host</span> or the <span class="guimenu ">Xen Virtualization Host</span> roles.
        The appropriate software selection and setup is automatically performed
        during <span class="productname"><span class="phrase">openSUSE Leap</span></span> installation.
      </p><div id="id-1.8.3.7.4.4.5" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.svg" /><h6>Tip</h6><p>
          Both virtualization system roles create a dedicated
          <code class="filename">/var/lib/libvirt</code> partition, and enable the
          <code class="systemitem">firewalld</code> and Kdump services.
        </p></div></div><div class="sect2 " id="install-virtualization-components-yast"><div class="titlepage"><div><div><h3 class="title"><span class="number">6.2.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Running the <span class="emphasis"><em>YaST Virtualization</em></span> module</span> <a title="Permalink" class="permalink" href="cha-vt-installation.html#install-virtualization-components-yast">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/vt_installation.xml" title="Edit the source file for this section">Edit source</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>vt_installation.xml</li><li><span class="ds-label">ID: </span>install-virtualization-components-yast</li></ul></div></div></div></div><p>
        Depending on the scope of <span class="productname"><span class="phrase">openSUSE Leap</span></span> installation on the VM Host Server,
        none of the virtualization tools may be installed on your system. They
        are automatically installed when configuring the hypervisor with the
        <span class="emphasis"><em>YaST Virtualization</em></span> module.
      </p><div id="id-1.8.3.7.4.5.3" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.svg" /><h6>Tip</h6><p>
          The <span class="emphasis"><em>YaST Virtualization</em></span> module is included in
          the <span class="package ">yast2-vm</span> package. Verify it is installed on
          the VM Host Server before installing virtualization components.
        </p></div><div class="procedure " id="id-1.8.3.7.4.5.4"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 6.1: </span><span class="name">Installing the KVM environment </span><a title="Permalink" class="permalink" href="cha-vt-installation.html#id-1.8.3.7.4.5.4">#</a></h6></div><div class="procedure-contents"><p>
          To install the KVM virtualization environment and related tools,
          proceed as follows:
        </p><ol class="procedure" type="1"><li class="step "><p>
            Start YaST and select
            <span class="guimenu ">Virtualization</span> › <span class="guimenu ">Install
            Hypervisor and Tools</span>.
          </p></li><li class="step "><p>
            Select <span class="guimenu ">KVM server</span> for a minimal installation
            of QEMU and KVM environment. Select <span class="guimenu ">KVM
            tools</span> to use the <code class="systemitem">libvirt</code>-based management
            stack as well. Confirm with <span class="guimenu ">Accept</span>.
          </p></li><li class="step "><p>
            YaST offers to automatically configure a network bridge on the
            VM Host Server. It ensures proper networking capabilities of the
            VM Guest. Agree to do so by selecting <span class="guimenu ">Yes</span>,
            otherwise choose <span class="guimenu ">No</span>.
          </p></li><li class="step "><p>
            After the setup has been finished, you can start creating and
            configuring VM Guests. Rebooting the VM Host Server is not required.
          </p></li></ol></div></div><div class="procedure " id="id-1.8.3.7.4.5.5"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 6.2: </span><span class="name">Installing the Xen environment </span><a title="Permalink" class="permalink" href="cha-vt-installation.html#id-1.8.3.7.4.5.5">#</a></h6></div><div class="procedure-contents"><p>
          To install the Xen virtualization environment, proceed as follows:
        </p><ol class="procedure" type="1"><li class="step "><p>
            Start YaST and select<span class="guimenu ">Virtualization</span> › <span class="guimenu ">Install Hypervisor and
            Tools</span>.
          </p></li><li class="step "><p>
            Select <span class="guimenu ">Xen server</span> for a minimal installation
            of Xen environment. Select <span class="guimenu ">Xen tools</span> to use
            the <code class="systemitem">libvirt</code>-based management stack as well. Confirm with
            <span class="guimenu ">Accept</span>.
          </p></li><li class="step "><p>
            YaST offers to automatically configure a network bridge on the
            VM Host Server. It ensures proper networking capabilities of the
            VM Guest. Agree to do so by selecting <span class="guimenu ">Yes</span>,
            otherwise choose <span class="guimenu ">No</span>.
          </p></li><li class="step "><p>
            After the setup has been finished, you need to reboot the machine
            with the <span class="emphasis"><em>Xen kernel</em></span>.
          </p><div id="id-1.8.3.7.4.5.5.6.2" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.svg" /><h6>Tip: Default boot kernel</h6><p>
              If everything works as expected, change the default boot kernel
              with YaST and make the Xen-enabled kernel the default. For
              more information about changing the default kernel, see
              <span class="intraxref">Book “Reference”, Chapter 12 “The boot loader GRUB 2”, Section 12.3 “Configuring the boot loader with YaST”</span>.
            </p></div></li></ol></div></div></div><div class="sect2 " id="install-virtualization-components-pattern"><div class="titlepage"><div><div><h3 class="title"><span class="number">6.2.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Installing specific installation patterns</span> <a title="Permalink" class="permalink" href="cha-vt-installation.html#install-virtualization-components-pattern">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/vt_installation.xml" title="Edit the source file for this section">Edit source</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>vt_installation.xml</li><li><span class="ds-label">ID: </span>install-virtualization-components-pattern</li></ul></div></div></div></div><p>
        Related software packages from <span class="productname"><span class="phrase">openSUSE Leap</span></span> software repositories are
        organized into <span class="emphasis"><em>installation patterns</em></span>. You can use
        these patterns to install specific virtualization components on an
        already running <span class="productname"><span class="phrase">openSUSE Leap</span></span>. Use <code class="command">zypper</code> to install
        them:
      </p><div class="verbatim-wrap"><pre class="screen">zypper install -t pattern <em class="replaceable ">PATTERN_NAME</em></pre></div><p>
        To install the KVM environment, consider the following patterns:
      </p><div class="variablelist "><dl class="variablelist"><dt id="id-1.8.3.7.4.6.5.1"><span class="term "><code class="literal">kvm_server</code></span></dt><dd><p>
              Installs basic VM Host Server with the KVM and QEMU environments.
            </p></dd><dt id="id-1.8.3.7.4.6.5.2"><span class="term "><code class="literal">kvm_tools</code></span></dt><dd><p>
              Installs <code class="systemitem">libvirt</code> tools for managing and monitoring VM Guests
              in KVM environment.
            </p></dd></dl></div><p>
        To install the Xen environment, consider the following patterns:
      </p><div class="variablelist "><dl class="variablelist"><dt id="id-1.8.3.7.4.6.7.1"><span class="term "><code class="literal">xen_server</code></span></dt><dd><p>
              Installs a basic Xen VM Host Server.
            </p></dd><dt id="id-1.8.3.7.4.6.7.2"><span class="term "><code class="literal">xen_tools</code></span></dt><dd><p>
              Installs <code class="systemitem">libvirt</code> tools for managing and monitoring VM Guests
              in Xen environment.
            </p></dd></dl></div></div></div><div class="sect1 " id="sec-vt-installation-nested-vms"><div class="titlepage"><div><div><h2 class="title"><span class="number">6.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Enable nested virtualization in KVM</span> <a title="Permalink" class="permalink" href="cha-vt-installation.html#sec-vt-installation-nested-vms">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/vt_installation.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>vt_installation.xml</li><li><span class="ds-label">ID: </span>sec-vt-installation-nested-vms</li></ul></div></div></div></div><div id="id-1.8.3.7.5.2" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg" /><h6>Important: Technology preview</h6><p>
        KVM's nested virtualization is still a technology preview. It is
        provided for testing purposes and is not supported.
      </p></div><p>
      Nested guests are KVM guests run in a KVM guest. When describing
      nested guests, we use the following virtualization layers:
    </p><div class="variablelist "><dl class="variablelist"><dt id="id-1.8.3.7.5.4.1"><span class="term ">L0</span></dt><dd><p>
            A bare metal host running KVM.
          </p></dd><dt id="id-1.8.3.7.5.4.2"><span class="term ">L1</span></dt><dd><p>
            A virtual machine running on L0. Because it can run another KVM,
            it is called a <span class="emphasis"><em>guest hypervisor</em></span>.
          </p></dd><dt id="id-1.8.3.7.5.4.3"><span class="term ">L2</span></dt><dd><p>
            A virtual machine running on L1. It is called a <span class="emphasis"><em>nested
            guest</em></span>.
          </p></dd></dl></div><p>
      Nested virtualization has many advantages. You can benefit from it in the
      following scenarios:
    </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
          Manage your own virtual machines directly with your hypervisor of
          choice in cloud environments.
        </p></li><li class="listitem "><p>
          Enable the live migration of hypervisors and their guest virtual
          machines as a single entity.
        </p><div id="id-1.8.3.7.5.6.2.2" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg" /><h6>Note</h6><p>
            Live migration of a nested VM Guest is not supported.
          </p></div></li><li class="listitem "><p>
          Use it for software development and testing.
        </p></li></ul></div><p>
      To enable nesting temporarily, remove the module and reload it with the
      <code class="option">nested</code> KVM module parameter:
    </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
          For Intel CPUs, run:
        </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> modprobe -r kvm_intel &amp;&amp; modprobe kvm_intel nested=1</pre></div></li><li class="listitem "><p>
          For AMD CPUs, run:
        </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> modprobe -r kvm_amd &amp;&amp; modprobe kvm_amd nested=1</pre></div></li></ul></div><p>
      To enable nesting permanently, enable the <code class="option">nested</code> KVM
      module parameter in the <code class="filename">/etc/modprobe.d/kvm_*.conf</code>
      file, depending on your CPU:
    </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
          For Intel CPUs, edit
          <code class="filename">/etc/modprobe.d/kvm_intel.conf</code> and add the
          following line:
        </p><div class="verbatim-wrap"><pre class="screen">options kvm_intel nested=1</pre></div></li><li class="listitem "><p>
          For AMD CPUs, edit <code class="filename">/etc/modprobe.d/kvm_amd.conf</code>
          and add the following line:
        </p><div class="verbatim-wrap"><pre class="screen">options kvm_amd nested=1</pre></div></li></ul></div><p>
      When your L0 host is capable of nesting, you can start an L1 guest in one
      of the following ways:
    </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
          Use the <code class="option">-cpu host</code> QEMU command line option.
        </p></li><li class="listitem "><p>
          Add the <code class="literal">vmx</code> (for Intel CPUs) or the
          <code class="literal">svm</code> (for AMD CPUs) CPU feature to the
          <code class="option">-cpu</code> QEMU command line option, which enables
          virtualization for the virtual CPU.
        </p></li></ul></div><div class="sect2 " id="sec-vt-installation-nested-vms-esxi"><div class="titlepage"><div><div><h3 class="title"><span class="number">6.3.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">VMware ESX as a guest hypervisor</span> <a title="Permalink" class="permalink" href="cha-vt-installation.html#sec-vt-installation-nested-vms-esxi">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/vt_installation.xml" title="Edit the source file for this section">Edit source</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>vt_installation.xml</li><li><span class="ds-label">ID: </span>sec-vt-installation-nested-vms-esxi</li></ul></div></div></div></div><p>
        If you use VMware ESX as a guest hypervisor on top of a KVM bare metal
        hypervisor, you may experience unstable network communication. This
        problem occurs especially between nested KVM guests and the KVM
        bare metal hypervisor or external network. The following default CPU
        configuration of the nested KVM guest is causing the problem:
      </p><div class="verbatim-wrap"><pre class="screen">&lt;cpu mode='host-model' check='partial'/&gt;</pre></div><p>
        To fix it, modify the CPU configuration as follow:
      </p><div class="verbatim-wrap"><pre class="screen">[...]
&lt;cpu mode='host-passthrough' check='none'&gt;
 &lt;cache mode='passthrough'/&gt;
&lt;/cpu&gt;
[...]</pre></div></div></div></div></div><div class="page-bottom"><div id="_bottom-navigation"><a class="nav-link" href="part-virt-libvirt.html"><span class="next-icon">→</span><span class="nav-label"><span class="number">Part II </span>Managing virtual machines with <code class="systemitem">libvirt</code></span></a><a class="nav-link" href="cha-tools-intro.html"><span class="prev-icon">←</span><span class="nav-label"><span class="number">Chapter 5 </span>Virtualization tools</span></a></div><div class="_share-print"><div class="online-contents share"><strong>Share this page: </strong><span class="share-buttons"><span class="_share-fb bottom-button">Facebook</span><span class="spacer"> • </span><span class="_share-in bottom-button">LinkedIn</span><span class="spacer"> • </span><span class="_share-tw bottom-button">Twitter</span><span class="spacer"> • </span><span class="_share-mail bottom-button">E-Mail</span></span></div><div class="print"><span class="_print-button bottom-button">Print this page</span></div><div class="clearme"></div></div></div></div><div id="_inward"></div></div><div id="_footer-wrap"><div id="_footer"><p>©
        2024 
        SUSE</p><ul><li><a href="https://jobs.suse.com/" target="_top">Careers</a></li><li><a href="https://www.suse.com/company/legal/" target="_top">Legal</a></li><li><a href="https://www.suse.com/company/about/" target="_top">About</a></li><li><a href="https://www.suse.com/contact/" target="_top">Contact Us</a></li></ul></div></div></body></html>