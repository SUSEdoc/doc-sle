<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Squid caching proxy server | Reference | openSUSE Leap 15.7</title><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" /><link rel="stylesheet" type="text/css" href="static/css/style.css" /><link rel="stylesheet" type="text/css" href="static/css/highlight.css" />
<meta name="title" content="Squid caching proxy server | openSUSE Leap 15.7" />
<meta name="description" content="Squid is a widely used caching proxy server for Linux and Unix platforms. This means that it stores requested Internet objects, such as data on a Web or FTP se…" />
<meta name="product-name" content="openSUSE Leap" />
<meta name="product-number" content="15.7" />
<meta name="book-title" content="Reference" />
<meta name="chapter-title" content="Chapter 26. Squid caching proxy server" />
<meta name="tracker-url" content="https://bugzilla.opensuse.org/enter_bug.cgi" />
<meta name="tracker-type" content="bsc" />
<meta name="tracker-bsc-assignee" content="fs@suse.com" />
<meta name="tracker-bsc-component" content="Documentation" />
<meta name="tracker-bsc-product" content="openSUSE Distribution" />
<meta name="tracker-bsc-version" content="Leap 15.4" />
<meta property="og:title" content="Squid caching proxy server | openSUSE Leap 15.7" />
<meta property="og:description" content="Squid is a widely used caching proxy server for Linux and Unix platforms. This means that it stores requested Internet objects, such as data on a Web or FTP se…" />
<meta property="og:type" content="article" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Squid caching proxy server | openSUSE Leap 15.7" />
<meta name="twitter:description" content="Squid is a widely used caching proxy server for Linux and Unix platforms. This means that it stores requested Internet objects, such as data on a Web or FTP se…" />
<link rel="home" href="index.html" title="openSUSE Leap Documentation" /><link rel="up" href="part-reference-services.html" title="Part III. Services" /><link rel="prev" href="cha-ftp.html" title="Chapter 25. Setting up an FTP server with YaST" /><link rel="next" href="part-reference-mobility.html" title="Part IV. Mobile computers" />
<script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css" /></noscript><script src="static/js/jquery-1.12.4.min.js" type="text/javascript"></script><script src="static/js/script.js" type="text/javascript"></script><script src="static/js/highlight.min.js" type="text/javascript"></script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-navigation">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><div id="_outer-wrap"><div id="_white-bg" style="background-color: #E11;"><div id="_header"><div id="_logo"><img src="static/images/logo.svg" alt="Logo" /></div><div class="crumbs"><a class="book-link" href="index.html" title="Reference"><span class="book-icon">Reference</span></a><span> › </span><a class="crumb" href="part-reference-services.html">Services</a><span> › </span><a class="crumb" href="cha-squid.html">Squid caching proxy server</a></div><div class="clearme"></div></div></div><div id="_toolbar-wrap"><div id="_toolbar"><div id="_toc-area" class="inactive"><a id="_toc-area-button" class="tool" title="Contents" accesskey="c" href="index.html"><span class="tool-spacer"><span class="toc-icon">Contents</span><span class="clearme"></span></span><span class="tool-label">Contents</span></a><div class="active-contents bubble-corner"></div><div class="active-contents bubble"><div class="bubble-container"><h6>Reference</h6><div id="_bubble-toc"><ol><li class="inactive"><a href="preface-reference.html"><span class="number"> </span><span class="name">About this guide</span></a></li><li class="inactive"><a href="part-reference-adv-admin.html"><span class="number">I </span><span class="name">Advanced administration</span></a><ol><li class="inactive"><a href="cha-yast-text.html"><span class="number">1 </span><span class="name">YaST in text mode</span></a></li><li class="inactive"><a href="cha-sw-cl.html"><span class="number">2 </span><span class="name">Managing software with command line tools</span></a></li><li class="inactive"><a href="cha-snapper.html"><span class="number">3 </span><span class="name">System recovery and snapshot management with Snapper</span></a></li><li class="inactive"><a href="cha-vnc.html"><span class="number">4 </span><span class="name">Remote graphical sessions with VNC</span></a></li><li class="inactive"><a href="cha-expert-partitioner.html"><span class="number">5 </span><span class="name"><span class="guimenu ">Expert Partitioner</span></span></a></li><li class="inactive"><a href="cha-tuning-multikernel.html"><span class="number">6 </span><span class="name">Installing multiple kernel versions</span></a></li><li class="inactive"><a href="cha-gui-desktop.html"><span class="number">7 </span><span class="name">Graphical user interface</span></a></li></ol></li><li class="inactive"><a href="part-reference-system.html"><span class="number">II </span><span class="name">System</span></a><ol><li class="inactive"><a href="cha-64bit.html"><span class="number">8 </span><span class="name">32-bit and 64-bit applications in a 64-bit system environment</span></a></li><li class="inactive"><a href="cha-boot.html"><span class="number">9 </span><span class="name">Introduction to the boot process</span></a></li><li class="inactive"><a href="cha-systemd.html"><span class="number">10 </span><span class="name">The <code class="systemitem">systemd</code> daemon</span></a></li><li class="inactive"><a href="cha-journalctl.html"><span class="number">11 </span><span class="name"><code class="command">journalctl</code>: query the <code class="systemitem">systemd</code> journal</span></a></li><li class="inactive"><a href="cha-grub2.html"><span class="number">12 </span><span class="name">The boot loader GRUB 2</span></a></li><li class="inactive"><a href="cha-network.html"><span class="number">13 </span><span class="name">Basic networking</span></a></li><li class="inactive"><a href="cha-uefi.html"><span class="number">14 </span><span class="name">UEFI (Unified Extensible Firmware Interface)</span></a></li><li class="inactive"><a href="cha-suse.html"><span class="number">15 </span><span class="name">Special system features</span></a></li><li class="inactive"><a href="cha-udev.html"><span class="number">16 </span><span class="name">Dynamic kernel device management with <code class="systemitem">udev</code></span></a></li></ol></li><li class="inactive"><a href="part-reference-services.html"><span class="number">III </span><span class="name">Services</span></a><ol><li class="inactive"><a href="cha-slp.html"><span class="number">17 </span><span class="name">SLP</span></a></li><li class="inactive"><a href="cha-ntp.html"><span class="number">18 </span><span class="name">Time synchronization with NTP</span></a></li><li class="inactive"><a href="cha-dns.html"><span class="number">19 </span><span class="name">The domain name system</span></a></li><li class="inactive"><a href="cha-dhcp.html"><span class="number">20 </span><span class="name">DHCP</span></a></li><li class="inactive"><a href="cha-samba.html"><span class="number">21 </span><span class="name">Samba</span></a></li><li class="inactive"><a href="cha-nfs.html"><span class="number">22 </span><span class="name">Sharing file systems with NFS</span></a></li><li class="inactive"><a href="cha-autofs.html"><span class="number">23 </span><span class="name">On-demand mounting with autofs</span></a></li><li class="inactive"><a href="cha-apache2.html"><span class="number">24 </span><span class="name">The Apache HTTP server</span></a></li><li class="inactive"><a href="cha-ftp.html"><span class="number">25 </span><span class="name">Setting up an FTP server with YaST</span></a></li><li class="inactive"><a href="cha-squid.html"><span class="number">26 </span><span class="name">Squid caching proxy server</span></a></li></ol></li><li class="inactive"><a href="part-reference-mobility.html"><span class="number">IV </span><span class="name">Mobile computers</span></a><ol><li class="inactive"><a href="cha-mobile.html"><span class="number">27 </span><span class="name">Mobile computing with Linux</span></a></li><li class="inactive"><a href="cha-nm.html"><span class="number">28 </span><span class="name">Using NetworkManager</span></a></li><li class="inactive"><a href="cha-power-mgmt.html"><span class="number">29 </span><span class="name">Power management</span></a></li></ol></li><li class="inactive"><a href="app-nwscheme.html"><span class="number">A </span><span class="name">An example network</span></a></li><li class="inactive"><a href="bk02apb.html"><span class="number">B </span><span class="name">GNU licenses</span></a></li></ol></div><div class="clearme"></div></div></div></div><div id="_nav-area" class="inactive"><div class="tool"><span class="nav-inner"><span class="tool-label">Navigation</span><a accesskey="p" class="tool-spacer" title="Chapter 25. Setting up an FTP server with YaST" href="cha-ftp.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Part IV. Mobile computers" href="part-reference-mobility.html"><span class="next-icon">→</span></a></span></div></div></div></div><div id="_fixed-header-wrap" style="background-color: #E11;" class="inactive"><div id="_fixed-header"><div class="crumbs"><a class="book-link" href="index.html" title="Reference"><span class="book-icon">Reference</span></a><span> › </span><a class="crumb" href="part-reference-services.html">Services</a><span> › </span><a class="crumb" href="cha-squid.html">Squid caching proxy server</a></div><div class="buttons"><a class="top-button button" href="#">Top</a><div class="button"><a accesskey="p" class="tool-spacer" title="Chapter 25. Setting up an FTP server with YaST" href="cha-ftp.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Part IV. Mobile computers" href="part-reference-mobility.html"><span class="next-icon">→</span></a></div><div class="clearme"></div></div><div class="clearme"></div></div></div><div id="_content" class="draft "><div class="documentation"><div class="chapter " id="cha-squid"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname "><span class="productname"><span class="phrase">openSUSE Leap</span></span></span> <span class="productnumber "><span class="productnumber"><span class="phrase">15.7</span></span></span></div><div><h2 class="title"><span class="number">26 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Squid caching proxy server</span> <a title="Permalink" class="permalink" href="cha-squid.html#">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/net_proxy.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>net_proxy.xml</li><li><span class="ds-label">ID: </span>cha-squid</li></ul></div></div><div><div class="abstract"><div class="abstract-title-wrap"><h6 class="abstract-title">Abstract<a title="Permalink" class="permalink" href="cha-squid.html#id-1.4.5.11.2.1">#</a></h6></div><p>
    Squid is a widely used caching proxy server for Linux and Unix platforms.
    This means that it stores requested Internet objects, such as data on a Web
    or FTP server, on a machine that is closer to the requesting workstation
    than the server. It can be set up in multiple hierarchies to assure optimal
    response times and low bandwidth usage, even in modes that are transparent
    to end users.
   </p></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="cha-squid.html#sec-squid-cacheinfos"><span class="number">26.1 </span><span class="name">Facts about proxy servers</span></a></span></dt><dt><span class="sect1"><a href="cha-squid.html#sec-squid-sysneeds"><span class="number">26.2 </span><span class="name">System requirements</span></a></span></dt><dt><span class="sect1"><a href="cha-squid.html#sec-squid-start"><span class="number">26.3 </span><span class="name">Basic usage of Squid</span></a></span></dt><dt><span class="sect1"><a href="cha-squid.html#sec-squid-yast"><span class="number">26.4 </span><span class="name">The YaST Squid module</span></a></span></dt><dt><span class="sect1"><a href="cha-squid.html#sec-squid-configfile"><span class="number">26.5 </span><span class="name">The Squid configuration file</span></a></span></dt><dt><span class="sect1"><a href="cha-squid.html#sec-squid-proxyconfigtrans"><span class="number">26.6 </span><span class="name">Configuring a transparent proxy</span></a></span></dt><dt><span class="sect1"><a href="cha-squid.html#sec-squid-cachemgr"><span class="number">26.7 </span><span class="name">Using the Squid cache manager CGI interface (<code class="systemitem">cachemgr.cgi</code>)</span></a></span></dt><dt><span class="sect1"><a href="cha-squid.html#sec-squid-calamaris"><span class="number">26.8 </span><span class="name">Cache report generation with Calamaris</span></a></span></dt><dt><span class="sect1"><a href="cha-squid.html#sec-squid-moreinfo"><span class="number">26.9 </span><span class="name">More Information</span></a></span></dt></dl></div></div><p>
  Squid acts as a caching proxy server. It redirects object requests from
  clients (in this case, from Web browsers) to the server. When the requested
  objects arrive from the server, it delivers the objects to the client and
  keeps a copy of them in the hard disk cache. An advantage of caching is that
  several clients requesting the same object can be served from the hard disk
  cache. This enables clients to receive the data much faster than from the
  Internet. This procedure also reduces the network traffic.
 </p><p>
  Along with actual caching, Squid offers a wide range of features:
 </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
    Distributing load over intercommunicating hierarchies of proxy servers
   </p></li><li class="listitem "><p>
    Defining strict access control lists for all clients accessing the proxy
    server
   </p></li><li class="listitem "><p>
    Allowing or denying access to specific Web pages using other applications
   </p></li><li class="listitem "><p>
    Generating statistics about frequently visited Web pages for the assessment
    of surfing habits
   </p></li></ul></div><p>
  Squid is not a generic proxy server. It normally proxies only HTTP
  connections. It supports the protocols FTP, Gopher, SSL and WAIS, but it
  does not support other Internet protocols, such as the news protocol, or
  video conferencing protocols. Because Squid only supports the UDP protocol to
  provide communication between different caches, many multimedia programs are
  not supported.
 </p><div class="sect1 " id="sec-squid-cacheinfos"><div class="titlepage"><div><div><h2 class="title"><span class="number">26.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Facts about proxy servers</span> <a title="Permalink" class="permalink" href="cha-squid.html#sec-squid-cacheinfos">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/net_proxy.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>net_proxy.xml</li><li><span class="ds-label">ID: </span>sec-squid-cacheinfos</li></ul></div></div></div></div><p>
   As a caching proxy server, Squid can be used in several ways. When combined
   with a firewall, it can help with security. Multiple proxies can be used
   together. It can also determine what types of objects should be cached and
   for how long.
  </p><div class="sect2 " id="sec-squid-security"><div class="titlepage"><div><div><h3 class="title"><span class="number">26.1.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Squid and security</span> <a title="Permalink" class="permalink" href="cha-squid.html#sec-squid-security">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/net_proxy.xml" title="Edit the source file for this section">Edit source</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>net_proxy.xml</li><li><span class="ds-label">ID: </span>sec-squid-security</li></ul></div></div></div></div><p>
    It is possible to use Squid together with a firewall to secure internal
    networks from the outside. The firewall denies all clients access to
    external services except Squid. All Web connections must be established by
    the proxy server. With this configuration, Squid fully controls Web
    access.
   </p><p>
    If the firewall configuration includes a demilitarized zone (DMZ), the
    proxy server should operate within this zone.
    <a class="xref" href="cha-squid.html#sec-squid-proxyconfigtrans" title="26.6. Configuring a transparent proxy">Section 26.6, “Configuring a transparent proxy”</a> describes how to implement a
    <span class="emphasis"><em>transparent</em></span> proxy. This simplifies the configuration
    of the clients, because in this case, they do not need any information
    about the proxy server.
   </p></div><div class="sect2 " id="sec-squid-morecaches"><div class="titlepage"><div><div><h3 class="title"><span class="number">26.1.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Multiple caches</span> <a title="Permalink" class="permalink" href="cha-squid.html#sec-squid-morecaches">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/net_proxy.xml" title="Edit the source file for this section">Edit source</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>net_proxy.xml</li><li><span class="ds-label">ID: </span>sec-squid-morecaches</li></ul></div></div></div></div><p>
    Several instances of Squid can be configured to exchange objects between
    them. This reduces the total system load and increases the chances of
    retrieving an object from the local network. It is also possible to
    configure cache hierarchies, so a cache can forward object requests to
    sibling caches or to a parent cache—causing it to request objects
    from another cache in the local network, or directly from the source.
   </p><p>
    Choosing the appropriate topology for the cache hierarchy is
    important, because it is not desirable to increase the overall traffic on
    the network. For a large network, it would make sense to configure a
    proxy server for every subnet and connect them to a parent proxy server,
    which in turn is connected to the caching proxy server of the ISP.
   </p><p>
    All this communication is handled by ICP (Internet cache protocol) running
    on top of the UDP protocol. Data transfers between caches are handled using
    HTTP (hypertext transmission protocol) based on TCP.
   </p><p>
    To find the most appropriate server from which to request objects, a cache
    sends an ICP request to all sibling proxies. The sibling proxies answer
    these requests via ICP responses. If the object was detected, they use the
    code <code class="literal">HIT</code>, if not, they use <code class="literal">MISS</code>.
   </p><p>
    If multiple <code class="literal">HIT</code> responses were found, the proxy server
    decides from which server to download, depending on factors such as which
    cache sent the fastest answer or which one is closer. If no satisfactory
    responses are received, the request is sent to the parent cache.
    
   </p><div id="id-1.4.5.11.7.4.7" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg" /><h6>Note: How Squid avoids duplication of objects</h6><p>
     To avoid duplication of objects in different caches in the network, other
     ICP protocols are used, such as CARP (cache array routing protocol) or
     HTCP (hypertext cache protocol). The more objects maintained in the
     network, the greater the possibility of finding the desired object.
    </p></div></div><div class="sect2 " id="sec-squid-latching"><div class="titlepage"><div><div><h3 class="title"><span class="number">26.1.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Caching Internet objects</span> <a title="Permalink" class="permalink" href="cha-squid.html#sec-squid-latching">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/net_proxy.xml" title="Edit the source file for this section">Edit source</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>net_proxy.xml</li><li><span class="ds-label">ID: </span>sec-squid-latching</li></ul></div></div></div></div><p>
    Many objects available in the network are not static, such as dynamically
    generated pages and TLS/SSL-encrypted content. Objects like these are not
    cached because they change each time they are accessed.
    
   </p><p>
    To determine how long objects should remain in the cache, objects are
    assigned one of several states. Web and proxy servers find out the status
    of an object by adding headers to these objects, such as <span class="quote">“<span class="quote ">Last
    modified</span>”</span> or <span class="quote">“<span class="quote ">Expires</span>”</span> and the corresponding date.
    Other headers specifying that objects must not be cached can be used as
    well.
   </p><p>
    Objects in the cache are normally replaced, because of a lack of free disk
    space, using algorithms such as LRU (last recently used). This means that
    the proxy expunges those objects that have not been requested for the
    longest time.
   </p></div></div><div class="sect1 " id="sec-squid-sysneeds"><div class="titlepage"><div><div><h2 class="title"><span class="number">26.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">System requirements</span> <a title="Permalink" class="permalink" href="cha-squid.html#sec-squid-sysneeds">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/net_proxy.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>net_proxy.xml</li><li><span class="ds-label">ID: </span>sec-squid-sysneeds</li></ul></div></div></div></div><p>
   System requirements depend on the maximum network load that the
   system must bear. Therefore, examine load peaks, as during those times, load
   might be more than four times the day's average. When in doubt, slightly
   overestimate the system's requirements. Having Squid working close to the
   limit of its capabilities can lead to a severe loss in quality of service.
   The following sections point to system factors in order of significance:
  </p><div class="orderedlist "><ol class="orderedlist" type="1"><li class="listitem "><p>
     RAM size
    </p></li><li class="listitem "><p>
     CPU speed/physical CPU cores
    </p></li><li class="listitem "><p>
     Size of the disk cache
    </p></li><li class="listitem "><p>
     Hard disks/SSDs and their architecture
    </p></li></ol></div><div class="sect2 " id="sec-squid-ram"><div class="titlepage"><div><div><h3 class="title"><span class="number">26.2.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">RAM</span> <a title="Permalink" class="permalink" href="cha-squid.html#sec-squid-ram">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/net_proxy.xml" title="Edit the source file for this section">Edit source</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>net_proxy.xml</li><li><span class="ds-label">ID: </span>sec-squid-ram</li></ul></div></div></div></div><p>
    The amount of memory (RAM) required by Squid directly correlates with the
    number of objects in the cache. Random access memory is much faster than a
    hard disk/SSD. Therefore, it is important to have sufficient memory
    for the Squid process, because system performance is dramatically reduced
    if the swap disk is used.
   </p><p>
    Squid also stores cache object references and frequently requested objects
    in the main memory to speed up retrieval of this data. Besides that,
    there is other data that Squid needs to keep in memory, such as a table
    with all the IP addresses handled, an exact domain name cache, the most
    frequently requested objects, access control lists, buffers and more.
   </p></div><div class="sect2 " id="sec-squid-cpu"><div class="titlepage"><div><div><h3 class="title"><span class="number">26.2.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">CPU</span> <a title="Permalink" class="permalink" href="cha-squid.html#sec-squid-cpu">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/net_proxy.xml" title="Edit the source file for this section">Edit source</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>net_proxy.xml</li><li><span class="ds-label">ID: </span>sec-squid-cpu</li></ul></div></div></div></div><p>
    Squid is tuned to work best with lower processor core counts (4–8
    physical cores), with each providing high performance. Technologies
    providing virtual cores such as hyperthreading can hurt performance.
   </p><p>
    To make the best use of multiple CPU cores, it is necessary to set up
    multiple worker threads writing to different caching devices. By default,
    multi-core support is disabled.
   </p></div><div class="sect2 " id="sec-squid-sysneeds-cache-size"><div class="titlepage"><div><div><h3 class="title"><span class="number">26.2.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Size of the disk cache</span> <a title="Permalink" class="permalink" href="cha-squid.html#sec-squid-sysneeds-cache-size">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/net_proxy.xml" title="Edit the source file for this section">Edit source</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>net_proxy.xml</li><li><span class="ds-label">ID: </span>sec-squid-sysneeds-cache-size</li></ul></div></div></div></div><p>
    In a small cache, the probability of a <code class="literal">HIT</code> (finding the
    requested object already located there) is small, because the cache is
    easily filled and less requested objects are replaced by newer ones. If,
    for example, 1 GB is available for the cache and the users use up only
    10 MB per day surfing, it would take more than one hundred days to
    fill the cache.
   </p><p>
    The easiest way to determine the necessary cache size is to consider the
    maximum transfer rate of the connection. With a 1 Mbit/s connection,
    the maximum transfer rate is 128 KB/s. If all this traffic ended up in
    the cache, in one hour it would add up to 460 MB. Assuming that all
    this traffic is generated in only eight working hours, it would reach
    3.6 GB in one day. Because the connection is normally not used to its
    upper volume limit, it can be assumed that the total data volume handled by
    the cache is approximately 2 GB. Hence, in this example, 2 GB of
    disk space is required for Squid to keep one day's worth of browsing data
    cached.
   </p></div><div class="sect2 " id="sec-squid-sysneeds-disk"><div class="titlepage"><div><div><h3 class="title"><span class="number">26.2.4 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Hard disk/SSD architecture</span> <a title="Permalink" class="permalink" href="cha-squid.html#sec-squid-sysneeds-disk">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/net_proxy.xml" title="Edit the source file for this section">Edit source</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>net_proxy.xml</li><li><span class="ds-label">ID: </span>sec-squid-sysneeds-disk</li></ul></div></div></div></div><p>
    Speed plays an important role in the caching process, so this factor
    deserves special attention. For hard disks/SSDs, this parameter is
    described as <span class="emphasis"><em>random seek time</em></span> or <span class="emphasis"><em>random read
    performance</em></span>, measured in milliseconds. Because the data blocks
    that Squid reads from or writes to the hard disk/SSD tend to be small, the
    seek time/read performance of the hard disk/SSD is more important than its
    data throughput.
   </p><p>
    For use as a proxy server, hard disks with high rotation speeds or SSDs are
    the best choice. When using hard disks, it can be better to use multiple
    smaller hard disks, each with a single cache directory to avoid excessive
    read times.
   </p><p>
    Using a RAID system allows increasing reliability at expense of speed.
    However, for performance reasons, avoid (software) RAID5 and similar
    settings.
   </p><p>
    In most cases, the choice of file system choice does not matter. However,
    using the mount option
    <code class="literal">noatime</code> can improve performance—Squid provides its
    own time stamps, so it does not need the file system to track access
    times.
   </p></div></div><div class="sect1 " id="sec-squid-start"><div class="titlepage"><div><div><h2 class="title"><span class="number">26.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Basic usage of Squid</span> <a title="Permalink" class="permalink" href="cha-squid.html#sec-squid-start">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/net_proxy.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>net_proxy.xml</li><li><span class="ds-label">ID: </span>sec-squid-start</li></ul></div></div></div></div><p>
   Since <code class="systemitem">squid</code> is not installed by default on
   <span class="productname"><span class="phrase">openSUSE® Leap</span></span>, make sure the package is installed on your system.
  </p><p>
   As Squid is preconfigured in <span class="productname"><span class="phrase">openSUSE Leap</span></span>, you can start it immediately
   after the installation. To avoid problems during the start-up, make sure that
   the network is connected to the Internet connection and has at least one
   name server. Using a dial-up connection with a dynamic DNS configuration may
   cause problems. In this case, specify at least the name server, as Squid does
   not start if it does not detect a DNS server in
   <code class="filename">/var/run/netconfig/resolv.conf</code>.
  </p><div class="sect2 " id="sec-squid-start-commands"><div class="titlepage"><div><div><h3 class="title"><span class="number">26.3.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Starting Squid</span> <a title="Permalink" class="permalink" href="cha-squid.html#sec-squid-start-commands">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/net_proxy.xml" title="Edit the source file for this section">Edit source</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>net_proxy.xml</li><li><span class="ds-label">ID: </span>sec-squid-start-commands</li></ul></div></div></div></div><p>
    To start Squid, run the following command:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> <code class="command">systemctl start squid</code></pre></div><p>
    To start Squid on system boot, enable the service
    with <code class="command">systemctl enable squid</code>.
   </p></div><div class="sect2 " id="sec-squid-check"><div class="titlepage"><div><div><h3 class="title"><span class="number">26.3.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Checking whether Squid is working</span> <a title="Permalink" class="permalink" href="cha-squid.html#sec-squid-check">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/net_proxy.xml" title="Edit the source file for this section">Edit source</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>net_proxy.xml</li><li><span class="ds-label">ID: </span>sec-squid-check</li></ul></div></div></div></div><p>
   There are several ways to check whether Squid is running:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      Using <code class="command">systemctl</code>:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">systemctl status squid</code></pre></div><p>
      The output should indicate that Squid is
      <code class="literal">loaded</code> and <code class="literal">active (running)</code>.
     </p></li><li class="listitem "><p>
      Using Squid itself:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> <code class="command">squid -k check | echo $?</code></pre></div><p>
      The output should be <code class="literal">0</code>, but it can also contain
      additional messages, such as warnings.
     </p></li></ul></div><p>
    To test the functionality of Squid on the local system, choose one of the
    following options:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      Use <code class="command">squidclient</code>, a command-line tool
      that outputs the response to a Web request, similar to
      <code class="command">wget</code> or <code class="command">curl</code>.
     </p><p>
      Unlike <code class="command">wget</code> or <code class="command">curl</code>,
      <code class="command">squidclient</code> automatically connects to the default proxy
      setup of Squid,
      <code class="literal">localhost:3128</code>. However, if you modified the
      configuration of Squid, you must configure
      <code class="command">squidclient</code> accordingly. For more information, see
      <code class="command">squidclient --help</code>.
     </p><div class="complex-example"><div class="example" id="ex-squidclient-request"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 26.1: </span><span class="name">A request with <code class="command">squidclient</code> </span><a title="Permalink" class="permalink" href="cha-squid.html#ex-squidclient-request">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">squidclient http://www.example.org</code>
HTTP/1.1 200 OK
Cache-Control: max-age=604800
Content-Type: text/html
Date: Fri, 22 Jun 2016 12:00:00 GMT
Expires: Fri, 29 Jun 2016 12:00:00 GMT
Last-Modified: Fri, 09 Aug 2013 23:54:35 GMT
Server: ECS (iad/182A)
Vary: Accept-Encoding
X-Cache: HIT
x-ec-custom-error: 1
Content-Length: 1270
X-Cache: MISS from moon<span id="co-squid-miss"></span><span class="callout">1</span>
X-Cache-Lookup: MISS from moon:3128
Via: 1.1 moon (squid/3.5.16)<span id="co-squid-via"></span><span class="callout">2</span>
Connection: close

&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Example domain&lt;/title&gt;
[...]
&lt;/body&gt;
&lt;/html&gt;</pre></div><p>
       The output shown in <a class="xref" href="cha-squid.html#ex-squidclient-request" title="A request with squidclient">Example 26.1, “A request with <code class="command">squidclient</code>”</a> consists of two parts:
      </p><div class="orderedlist "><ol class="orderedlist" type="1"><li class="listitem "><p>
         The protocol headers of the response (the lines before the blank line).
        </p></li><li class="listitem "><p>
         The actual content of the response (the lines after the blank line).
        </p></li></ol></div><p>
       To verify that Squid is used, refer to the selected header lines:
      </p><div class="calloutlist "><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#co-squid-miss"><span class="callout">1</span></a> </p></td><td valign="top" align="left"><p>
         The value of the header <code class="literal">X-Cache</code> shows that the
         requested document was not in the Squid cache
         (<code class="literal">MISS</code>) of the computer
         <code class="systemitem">moon</code>.
        </p><p>
         The example above contains two <code class="literal">X-Cache</code> lines. The
         first <code class="literal">X-Cache</code> header can be safely ignored, as it is
         produced by the internal caching software of the originating Web
         server.
        </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co-squid-via"><span class="callout">2</span></a> </p></td><td valign="top" align="left"><p>
         The value of the header <code class="literal">Via</code> shows the HTTP
         version, the name of the computer, and the version of Squid in use.
        </p></td></tr></table></div></div></div></div></li><li class="listitem "><p>
      Using a browser: set up <code class="option">localhost</code> as the proxy and
      <code class="option">3128</code> as the port. Then load a page and check the
      response headers in the <span class="guimenu ">Network</span> panel of the browser's
      <span class="emphasis"><em>Inspector</em></span> or <span class="emphasis"><em>Developer Tools</em></span>.
      The headers should be reproduced similarly to the way shown in
      <a class="xref" href="cha-squid.html#ex-squidclient-request" title="A request with squidclient">Example 26.1, “A request with <code class="command">squidclient</code>”</a>.
     </p></li></ul></div><p>
    To allow users from the local system and other systems to access Squid and
    the Internet, change the entry in the configuration files
    <code class="filename">/etc/squid/squid.conf</code> from <code class="option">http_access deny
    all</code> to <code class="option">http_access allow all</code>. However, keep in
    mind that this makes Squid fully accessible to anyone. Therefore, define
    ACLs (access control lists) that control access to the proxy server. After
    modifying the configuration file, Squid must be reloaded or restarted. For
    more information on ACLs, see
    <a class="xref" href="cha-squid.html#sec-squid-acl" title="26.5.2. Options for access controls">Section 26.5.2, “Options for access controls”</a>.
   </p><p>
    If Squid stops working after a short period of time, check whether there is
    an incorrect name server entry or whether the
    <code class="filename">/var/run/netconfig/resolv.conf</code> file is missing. Squid
    logs the cause of a start-up failure in the file
    <code class="filename">/var/log/squid/cache.log</code>.
   </p></div><div class="sect2 " id="sec-squid-stop"><div class="titlepage"><div><div><h3 class="title"><span class="number">26.3.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Stopping, reloading, and restarting Squid</span> <a title="Permalink" class="permalink" href="cha-squid.html#sec-squid-stop">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/net_proxy.xml" title="Edit the source file for this section">Edit source</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>net_proxy.xml</li><li><span class="ds-label">ID: </span>sec-squid-stop</li></ul></div></div></div></div><p>
    There are two ways to reload Squid:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      Using <code class="command">systemctl</code>:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> <code class="command">systemctl</code> reload squid</pre></div><p>
      or
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> <code class="command">systemctl</code> restart squid</pre></div></li><li class="listitem "><p>
      Using YaST:
     </p><p>
      In the Squid module, click the <span class="guimenu ">Save Settings and Restart Squid
      Now</span> button.
     </p></li></ul></div><p>
    To stop Squid, use one of the following options:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      Using <code class="command">systemctl</code>:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> <code class="command">systemctl</code> stop squid</pre></div></li><li class="listitem "><p>
      Using YaST
     </p><p>
      In the Squid module click the <span class="guimenu ">Stop Squid Now</span>. button.
     </p></li></ul></div><p>
    Shutting down Squid can take a while, because Squid waits up to half a
    minute before dropping the connections to the clients and writing its data
    to the disk (see <code class="option">shutdown_lifetime</code> option in
    <code class="filename">/etc/squid/squid.conf</code>),
   </p><div id="id-1.4.5.11.9.6.7" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.svg" /><h6>Warning: Terminating Squid</h6><p>
     Terminating Squid with <code class="command">kill</code> or
     <code class="command">killall</code> can damage the cache. To be able to restart
     Squid, damaged caches must be deleted.
    </p></div></div><div class="sect2 " id="sec-squid-remove"><div class="titlepage"><div><div><h3 class="title"><span class="number">26.3.4 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Removing Squid</span> <a title="Permalink" class="permalink" href="cha-squid.html#sec-squid-remove">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/net_proxy.xml" title="Edit the source file for this section">Edit source</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>net_proxy.xml</li><li><span class="ds-label">ID: </span>sec-squid-remove</li></ul></div></div></div></div><p>
    Removing Squid from the system does not remove the cache hierarchy and log
    files. To remove them, delete the <code class="filename">/var/cache/squid</code>
    directory manually.
   </p></div><div class="sect2 " id="sec-squid-start-local-dns"><div class="titlepage"><div><div><h3 class="title"><span class="number">26.3.5 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Local DNS server</span> <a title="Permalink" class="permalink" href="cha-squid.html#sec-squid-start-local-dns">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/net_proxy.xml" title="Edit the source file for this section">Edit source</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>net_proxy.xml</li><li><span class="ds-label">ID: </span>sec-squid-start-local-dns</li></ul></div></div></div></div><p>
    Setting up a local DNS server makes sense even if it does not manage its
    own domain. In that case, it acts as a caching-only name server, and it can also resolve DNS requests via the root name servers without requiring
    any special configuration (see <a class="xref" href="cha-dns.html#sec-dns-bind" title="19.4. Starting the BIND name server">Section 19.4, “Starting the BIND name server”</a>). How this
    can be done depends on whether you chose dynamic DNS during the
    configuration of the Internet connection.
   </p><div class="variablelist "><dl class="variablelist"><dt id="vle-squid-dynamicdns"><span class="term ">Dynamic DNS</span></dt><dd><p>
       Normally, with dynamic DNS, the DNS server is set by the provider when establishing the Internet connection and the local
       <code class="filename">/var/run/netconfig/resolv.conf</code> file is adjusted
       automatically. This behavior is specified in the
       <code class="filename">/etc/sysconfig/network/config</code> file using the
       <code class="constant">NETCONFIG_DNS_POLICY</code> sysconfig variable. Set
       <code class="constant">NETCONFIG_DNS_POLICY</code> to <code class="constant">""</code>
       with the YaST sysconfig editor.
      </p><p>
       Then add the local DNS server in the
       <code class="filename">/var/run/netconfig/resolv.conf</code> file with the IP
       address <code class="systemitem">127.0.0.1</code> for
       <code class="systemitem">localhost</code>. This way, Squid
       can always find the local name server when it starts.
      </p><p>
       To make the provider's name server accessible, specify it in the
       configuration file <code class="filename">/etc/named.conf</code> under
       <code class="systemitem">forwarders</code> along with its IP address. With
       dynamic DNS, this can be done automatically when establishing the
       connection by setting the sysconfig variable
       <code class="constant">NETCONFIG_DNS_POLICY</code> to <code class="constant">auto</code>.
      </p></dd><dt id="id-1.4.5.11.9.8.3.2"><span class="term ">Static DNS</span></dt><dd><p>
       With static DNS, no automatic DNS adjustments take place while
       establishing a connection, so there is no need to change any sysconfig
       variables. However, you must specify the local DNS server in the file
       <code class="filename">/var/run/netconfig/resolv.conf</code> as described in
       <a class="xref" href="cha-squid.html#vle-squid-dynamicdns">Dynamic DNS</a>. Additionally, the provider's
       static name server must be specified manually in the
       <code class="filename">/etc/named.conf</code> file under
       <code class="systemitem">forwarders</code> along with its IP address.
      </p></dd></dl></div><div id="id-1.4.5.11.9.8.4" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.svg" /><h6>Tip: DNS and firewall</h6><p>
     If you have a firewall running, make sure DNS requests can pass through it.
    </p></div></div></div><div class="sect1 " id="sec-squid-yast"><div class="titlepage"><div><div><h2 class="title"><span class="number">26.4 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">The YaST Squid module</span> <a title="Permalink" class="permalink" href="cha-squid.html#sec-squid-yast">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/net_proxy.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>net_proxy.xml</li><li><span class="ds-label">ID: </span>sec-squid-yast</li></ul></div></div></div></div><p>
   The YaST Squid module contains the following tabs:
  </p><div class="variablelist "><dl class="variablelist"><dt id="id-1.4.5.11.10.3.1"><span class="term "><span class="guimenu ">Start-Up</span></span></dt><dd><p>
      Specifies how Squid is started and which firewall port is open in which
      interfaces.
     </p></dd><dt id="id-1.4.5.11.10.3.2"><span class="term "><span class="guimenu ">HTTP Ports</span></span></dt><dd><p>
      Define all ports for Squid to listen for HTTP requests from clients.
     </p></dd><dt id="id-1.4.5.11.10.3.3"><span class="term "><span class="guimenu ">Refresh Patterns</span></span></dt><dd><p>
      Defines how Squid treats objects in the cache.
     </p></dd><dt id="id-1.4.5.11.10.3.4"><span class="term "><span class="guimenu ">Cache Settings</span></span></dt><dd><p>
      Defines settings related to cache memory, maximum and minimum object
      size, and more.
     </p></dd><dt id="id-1.4.5.11.10.3.5"><span class="term "><span class="guimenu ">Cache Directory</span></span></dt><dd><p>
      Defines the top-level directory for Squid to store cache swap files.
     </p></dd><dt id="id-1.4.5.11.10.3.6"><span class="term "><span class="guimenu ">Access Control</span></span></dt><dd><p>
      Controls the access to the Squid server via ACL groups.
     </p></dd><dt id="id-1.4.5.11.10.3.7"><span class="term "><span class="guimenu ">Logging and Timeout</span></span></dt><dd><p>
      Define paths to access, cache and cache store log files and
      connection timeouts and client lifetime.
     </p></dd><dt id="id-1.4.5.11.10.3.8"><span class="term "><span class="guimenu ">Miscellaneous</span></span></dt><dd><p>
      Specifies language and mail address of administrator.
     </p></dd></dl></div></div><div class="sect1 " id="sec-squid-configfile"><div class="titlepage"><div><div><h2 class="title"><span class="number">26.5 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">The Squid configuration file</span> <a title="Permalink" class="permalink" href="cha-squid.html#sec-squid-configfile">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/net_proxy.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>net_proxy.xml</li><li><span class="ds-label">ID: </span>sec-squid-configfile</li></ul></div></div></div></div><p>
   Squid proxy server settings are stored in the
   <code class="filename">/etc/squid/squid.conf</code> file. Although starting Squid for
   the first time does not require any changes to the file, external clients are
   initially denied access. The proxy is available for
   <code class="systemitem">localhost</code>. The default port is
   <code class="option">3128</code>. The preinstalled configuration file
   <code class="filename">/etc/squid/squid.conf</code> provides detailed information
   about the options and many examples.
  </p><p>
   Many entries are disabled using the comment character
   <code class="literal">#</code>. The relevant specifications can be found at the end of
   the line. The given values usually correlate with the default values, so
   removing the comment signs without changing any of the parameters usually
   has no effect. If possible, leave the commented lines as they are and insert
   the options along with the modified values in the line below. This way, the
   default values may easily be recovered and compared with the changes.
  </p><div id="id-1.4.5.11.11.4" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.svg" /><h6>Tip: Adapting the configuration file after an update</h6><p>
    If you have updated from an earlier Squid version, it is recommended to
    edit the new <code class="filename">/etc/squid/squid.conf</code> and only apply the
    changes made in the previous file.
   </p><p>
    Sometimes, Squid options are added, removed or modified. Therefore, if you
    try to use the old <code class="filename">squid.conf</code>, Squid might stop
    working properly.
   </p></div><div class="sect2 " id="sec-squid-configfile-general"><div class="titlepage"><div><div><h3 class="title"><span class="number">26.5.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">General configuration options</span> <a title="Permalink" class="permalink" href="cha-squid.html#sec-squid-configfile-general">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/net_proxy.xml" title="Edit the source file for this section">Edit source</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>net_proxy.xml</li><li><span class="ds-label">ID: </span>sec-squid-configfile-general</li></ul></div></div></div></div><p>
    The following is a list of a selection of configuration options for Squid.
    It is not exhaustive. The Squid package contains a full, lightly documented
    list of options in <code class="filename">/etc/squid/squid.conf.documented</code>.
   </p><div class="variablelist "><dl class="variablelist"><dt id="id-1.4.5.11.11.5.3.1"><span class="term "><code class="literal">http_port <em class="replaceable ">PORT</em></code></span></dt><dd><p>
       This is the port on which Squid listens for client requests. The default
       port is <code class="option">3128</code>, but <code class="option">8080</code> is also common.
      </p></dd><dt id="id-1.4.5.11.11.5.3.2"><span class="term "><code class="literal">cache_peer <em class="replaceable ">HOST_NAME</em> <em class="replaceable ">TYPE</em> <em class="replaceable ">PROXY_PORT</em> <em class="replaceable ">ICP_PORT</em></code></span></dt><dd><p>
       This option allows creating a network of caches that work together. The
       cache peer is a computer that also hosts a network cache and stands in a
       relationship to your own. The type of relationship is specified as the
       <em class="replaceable ">TYPE</em>. The type can either be
       <code class="literal">parent</code> or <code class="literal">sibling</code>.
      </p><p>
       As the <em class="replaceable ">HOST_NAME</em>, specify the name or IP
       address of the proxy server to use. For
       <em class="replaceable ">PROXY_PORT</em>, specify the port number for use
       in a browser (usually <code class="option">8080</code>). Set
       <em class="replaceable ">ICP_PORT</em> to <code class="option">7</code> or, if the ICP
       port of the parent is not known and its use is irrelevant to the
       provider, to <code class="option">0</code>.
      </p><p>
       To make Squid behave like a Web browser instead of a proxy server,
       disable the use of the ICP protocol by appending the
       options <code class="option">default</code> and <code class="option">no-query</code>.
      </p></dd><dt id="id-1.4.5.11.11.5.3.3"><span class="term "><code class="literal">cache_mem <em class="replaceable ">SIZE</em></code></span></dt><dd><p>
       This option defines the amount of memory Squid can use for the most
       frequent replies. The default is <code class="option">8 MB</code>. This does not
       specify the memory usage of Squid and may be exceeded.
      </p></dd><dt id="id-1.4.5.11.11.5.3.4"><span class="term "><code class="literal">cache_dir <em class="replaceable ">STORAGE_TYPE</em> <em class="replaceable ">CACHE_DIRECTORY</em> <em class="replaceable ">CACHE_SIZE</em> <em class="replaceable ">LEVEL_1_DIRECTORIES</em> <em class="replaceable ">LEVEL_2_DIRECTORIES</em></code></span></dt><dd><p>
       The option <code class="literal">cache_dir</code> defines the directory for the
       disk cache. In the default configuration on <span class="productname"><span class="phrase">openSUSE Leap</span></span>, Squid does
       not create a disk cache.
      </p><p>
       The placeholder <em class="replaceable ">STORAGE_TYPE</em> can be one of
       the following:
      </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
         Directory-based storage types: <code class="literal">ufs</code>,
         <code class="literal">aufs</code> (the default), <code class="literal">diskd</code>. All
         three are variations of the storage format <code class="literal">ufs</code>.
         However, while <code class="literal">ufs</code> runs as part of the core Squid
         thread, <code class="literal">aufs</code> runs in a separate thread, and
         <code class="literal">diskd</code> uses a separate process. This means that the
         latter two types avoid blocking Squid because of disk I/O.
        </p></li><li class="listitem "><p>
         Database-based storage systems: <code class="literal">rock</code>. This storage
         format relies on a single database file, in which each object takes up
         one or more memory units of a fixed size (<span class="quote">“<span class="quote ">slots</span>”</span>).
        </p></li></ul></div><p>
       In the following, only the parameters for storage types based on
       <code class="literal">ufs</code> are discussed. <code class="literal">rock</code> has
       different parameters.
      </p><p>
       The <em class="replaceable ">CACHE_DIRECTORY</em> is the directory for the
       disk cache. By default, that is <code class="filename">/var/cache/squid</code>.
       <em class="replaceable ">CACHE_SIZE</em> is the maximum size of that
       directory in megabytes; by default, this is set to 100 MB. Set it
       to between 50% and a maximum of 80% of available disk space.
      </p><p>
       The <em class="replaceable ">LEVEL_1_DIRECTORIES</em> and
       <em class="replaceable ">LEVEL_2_DIRECTORIES</em> values specify how many
       subdirectories are created in the
       <em class="replaceable ">CACHE_DIRECTORY</em>. By default, 16
       subdirectories are created at the first level below
       <em class="replaceable ">CACHE_DIRECTORY</em> and 256 within each of these.
       These values should only be increased with caution, because creating too
       many directories can lead to performance problems.
      </p><p>
       If you have several disks that share a cache, specify several
       <code class="option">cache_dir</code> lines.
      </p></dd><dt id="id-1.4.5.11.11.5.3.5"><span class="term "><code class="option">cache_access_log <em class="replaceable ">LOG_FILE</em></code>, </span><span class="term "><code class="option">cache_log <em class="replaceable ">LOG_FILE</em></code>, </span><span class="term "><code class="option">cache_store_log <em class="replaceable ">LOG_FILE</em></code></span></dt><dd><p>
       These three options specify the paths where Squid logs all its actions.
       Normally, nothing needs to be changed here. If Squid is under heavy load, it might make sense to distribute the cache and the log
       files over several disks.
      </p></dd><dt id="id-1.4.5.11.11.5.3.6"><span class="term "><code class="option">client_netmask <em class="replaceable ">NETMASK</em></code></span></dt><dd><p>
       This option allows masking IP addresses of clients in the log files by
       applying a subnet mask. For example, to set the last digit of the IP
       address to <code class="literal">0</code>, specify
       <code class="systemitem">255.255.255.0</code>.
      </p></dd><dt id="id-1.4.5.11.11.5.3.7"><span class="term "><code class="option">ftp_user <em class="replaceable ">E-MAIL</em></code></span></dt><dd><p>
       This option allows setting the password that Squid should use for
       anonymous FTP login. Specify a valid e-mail address here, as 
       FTP servers check these for validity.
      </p></dd><dt id="id-1.4.5.11.11.5.3.8"><span class="term "><code class="option">cache_mgr <em class="replaceable ">E-MAIL</em></code></span></dt><dd><p>
       When Squid crashes, it sends a message to the specified e-mail
       address. The default is <span class="emphasis"><em>webmaster</em></span>.
      </p></dd><dt id="id-1.4.5.11.11.5.3.9"><span class="term "><code class="option">logfile_rotate <em class="replaceable ">VALUE</em></code></span></dt><dd><p>
       When used with <code class="command">squid</code> <code class="option">-k rotate</code>,
       <code class="command">squid</code> rotates log files. The files are numbered and, after reaching the specified value, the oldest file is
       overwritten. The default value is <code class="option">10</code> which rotates log
       files with the numbers 0 to 9.
      </p><p>
       However, on <span class="productname"><span class="phrase">openSUSE Leap</span></span>, rotating log files is performed automatically
       using <code class="systemitem">logrotate</code> and the
       configuration file <code class="filename">/etc/logrotate.d/squid</code>.
      </p></dd><dt id="id-1.4.5.11.11.5.3.10"><span class="term "><code class="option">append_domain <em class="replaceable ">DOMAIN</em></code></span></dt><dd><p>
       Use <span class="emphasis"><em>append_domain</em></span> to specify which domain to append
       automatically when none is given. Usually, your own domain is specified
       here, so pointing the browser to <span class="emphasis"><em>www</em></span> navigates to
       your own Web server.
      </p></dd><dt id="id-1.4.5.11.11.5.3.11"><span class="term "><code class="option">forwarded_for <em class="replaceable ">STATE</em></code></span></dt><dd><p>
       If this option is set to <code class="literal">on</code>, it adds a line to the
       header similar to this:
      </p><div class="verbatim-wrap"><pre class="screen">X-Forwarded-For: 192.168.0.1</pre></div><p>
       If you set this option to <code class="literal">off</code>, Squid removes the IP
       address and the system name of the client from HTTP requests.
      </p></dd><dt id="id-1.4.5.11.11.5.3.12"><span class="term "><code class="option">negative_ttl <em class="replaceable ">TIME</em></code>, </span><span class="term "><code class="option">negative_dns_ttl <em class="replaceable ">TIME</em></code></span></dt><dd><p>
       If these options are configured, Squid caches certain types of failures,
       such as <code class="literal">404</code> responses. It then refuses to issue new
       requests, even if the resource becomes available.
      </p><p>
       By default, <code class="option">negative_ttl</code> is set to
       <code class="literal">0</code>, <code class="option">negative_dns_ttl</code> is set to
       <code class="literal">1 minutes</code>.

       This means that negative responses to Web requests are not cached by
       default, while negative responses to DNS requests are cached for 1
       minute.
      </p></dd><dt id="id-1.4.5.11.11.5.3.13"><span class="term "><code class="option">never_direct allow <em class="replaceable ">ACL_NAME</em></code></span></dt><dd><p>
       To prevent Squid from accepting requests directly from the Internet, use
       the option <code class="literal">never_direct</code> to force connection to
       another proxy server. This must have previously been specified in
       <code class="option">cache_peer</code>. If <code class="literal">all</code> is specified as
       the <em class="replaceable ">ACL_NAME</em>, all requests are forwarded
       directly to the <code class="literal">parent</code>. This can be necessary, for
       example, if you are using a provider that dictates the use of its
       proxies or denies its firewall direct Internet access.
      </p></dd></dl></div></div><div class="sect2 " id="sec-squid-acl"><div class="titlepage"><div><div><h3 class="title"><span class="number">26.5.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Options for access controls</span> <a title="Permalink" class="permalink" href="cha-squid.html#sec-squid-acl">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/net_proxy.xml" title="Edit the source file for this section">Edit source</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>net_proxy.xml</li><li><span class="ds-label">ID: </span>sec-squid-acl</li></ul></div></div></div></div><p>
    Squid can control the access to the proxy server through Access Control
    Lists (ACL), lists with rules that are processed sequentially. ACLs must be
    defined before they can be used. Squid includes default ACLs, such as
    <code class="literal">all</code> and
    <code class="literal">localhost</code>. However, for an ACL to take effect, it must
    have a corresponding <code class="option">http_access</code> rule.
   </p><p>
    The syntax for the option <code class="option">acl</code> is as follows:
   </p><div class="verbatim-wrap"><pre class="screen">acl <em class="replaceable ">ACL_NAME</em> <em class="replaceable ">TYPE</em> <em class="replaceable ">DATA</em></pre></div><p>
    The placeholders within this syntax stand for the following:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      <em class="replaceable ">ACL_NAME</em> can be any name.
     </p></li><li class="listitem "><p>
      For <em class="replaceable ">TYPE</em>, select from the options available in
      the <code class="literal">ACCESS CONTROLS</code>
      section of the <code class="filename">/etc/squid/squid.conf</code> file.
     </p></li><li class="listitem "><p>
      The specification for <em class="replaceable ">DATA</em> depends on the
      individual ACL type, for example, host names, IP addresses, or URLs.
     </p></li></ul></div><p>
    To add rules in the YaST Squid module, open the module and click the
    <span class="guimenu ">Access Control</span> tab. Click <span class="guimenu ">Add</span> under
    the ACL Groups list and enter the name of your rule, the type, and its
    parameters.
   </p><p>
    For more information on types of ACL rules, see the Squid documentation at
    <a class="link" href="https://www.squid-cache.org/Versions/v3/3.5/cfgman/acl.html" target="_blank">https://www.squid-cache.org/Versions/v3/3.5/cfgman/acl.html</a>.
   </p><div class="example" id="ex-squid-school"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 26.2: </span><span class="name">Defining ACL rules </span><a title="Permalink" class="permalink" href="cha-squid.html#ex-squid-school">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">acl mysurfers srcdomain .example.com <span id="co-squid-school-surfer"></span><span class="callout">1</span>
acl teachers src 192.168.1.0/255.255.255.0 <span id="co-squid-school-teacher"></span><span class="callout">2</span>
acl students src 192.168.7.0-192.168.9.0/255.255.255.0 <span id="co-squid-school-student"></span><span class="callout">3</span>
acl lunch time MTWHF 12:00-15:00 <span id="co-squid-school-time"></span><span class="callout">4</span></pre></div><div class="calloutlist "><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#co-squid-school-surfer"><span class="callout">1</span></a> </p></td><td valign="top" align="left"><p>
       This ACL defines <code class="literal">mysurfers</code> as all users coming from
       within <code class="literal">.example.com</code> (as determined by a reverse
       lookup for the IP).
      </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co-squid-school-teacher"><span class="callout">2</span></a> </p></td><td valign="top" align="left"><p>
       This ACL defines <code class="literal">teachers</code> as the users of computers
       with IP addresses starting with <code class="literal">192.168.1.</code>.
      </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co-squid-school-student"><span class="callout">3</span></a> </p></td><td valign="top" align="left"><p>
       This ACL defines <code class="literal">students</code> as the users of the
       computer with IP addresses starting with <code class="literal">192.168.7.</code>,
       <code class="literal">192.168.8.</code>, or <code class="literal">192.168.9.</code>.
      </p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#co-squid-school-time"><span class="callout">4</span></a> </p></td><td valign="top" align="left"><p>
       This ACL defines <code class="literal">lunch</code> as a time on the days Monday
       through Friday between noon and 3 p.m.
      </p></td></tr></table></div></div></div><div class="variablelist "><dl class="variablelist"><dt id="id-1.4.5.11.11.6.10.1"><span class="term ">http_access allow <em class="replaceable ">ACL_NAME</em></span></dt><dd><p>
       <code class="option">http_access</code> defines who is allowed to use the proxy
       server and who can access what on the Internet. You need to define ACLs
       for this. The <code class="literal">localhost</code> and <code class="literal">all</code>
       ACLs have already been defined above, and you can deny or allow access to
       them via
       <code class="literal">deny</code> or <code class="literal">allow</code>. A list containing
       any number of <code class="option">http_access</code> entries can be created,
       processed from top to bottom. Depending on which occurs first, access is
       allowed or denied to the respective URL. The last entry should always be
       <code class="option">http_access deny all</code>. In the following example,
       <code class="literal">localhost</code> has free access to everything, while all
       other hosts are denied access:
      </p><div class="verbatim-wrap"><pre class="screen">http_access allow localhost
http_access deny all</pre></div><p>
       In another example using these rules, the group
       <code class="systemitem">teachers</code> always has access to
       the Internet. The group
       <code class="systemitem">students</code> only has access
       between Monday and Friday during lunch time:
      </p><div class="verbatim-wrap"><pre class="screen">http_access deny localhost
http_access allow teachers
http_access allow students lunch time
http_access deny all</pre></div><p>
       For better readability, specify all
       <code class="option">http_access</code> options as a block in the configuration file
       <code class="filename">/etc/squid/squid.conf</code>.
      </p></dd><dt id="id-1.4.5.11.11.6.10.2"><span class="term "><code class="option">url_rewrite_program <em class="replaceable ">PATH</em></code></span></dt><dd><p>
       Use this option to specify a URL rewriter.
      </p></dd><dt id="id-1.4.5.11.11.6.10.3"><span class="term "><code class="option">auth_param basic program <em class="replaceable ">PATH</em></code></span></dt><dd><p>
       If users must be authenticated on the proxy server, set a corresponding
       program, such as <code class="filename">/usr/sbin/pam_auth</code>. When accessing
       <code class="command">pam_auth</code> for the first time, the user is prompted to
       provide a user name and a password. Besides that, you need an ACL,
       so only clients with a valid login can use the Internet:
      </p><div class="verbatim-wrap"><pre class="screen">acl password proxy_auth REQUIRED

http_access allow password
http_access deny all</pre></div><p>
       In the <code class="option">acl proxy_auth</code> option, using
       <code class="literal">REQUIRED</code> means that all valid user names are
       accepted. <code class="literal">REQUIRED</code> can also be replaced with a list
       of permitted user names.
      </p></dd><dt id="id-1.4.5.11.11.6.10.4"><span class="term "><code class="option">ident_lookup_access allow <em class="replaceable ">ACL_NAME</em></code></span></dt><dd><p>
       Use this option to enable an ident request action to find each user's
       identity for all clients defined by an ACL of the type
       <code class="literal">src</code>. To enable this for all clients, apply the
       predefined ACL
       <code class="literal">all</code> as the <em class="replaceable ">ACL_NAME</em>.
      </p><p>
       All clients specified by <code class="option">ident_lookup_access</code> must run an
       ident daemon. On Linux, you can use
       <code class="systemitem">pidentd</code> (package
       <span class="package ">pidentd</span>) as the ident daemon. To ensure that only
       clients with a successful ident lookup are permitted, define a
       corresponding ACL:
      </p><div class="verbatim-wrap"><pre class="screen">acl identhosts ident REQUIRED

http_access allow identhosts
http_access deny all</pre></div><p>
       Setting the <code class="option">acl identhosts ident</code> option to <code class="literal">REQUIRED</code> ensures that all valid user names are
       accepted. <code class="literal">REQUIRED</code> can also be replaced with a list
       of permitted user names.
      </p><p>
       Using <code class="literal">ident</code> can slow down access time, because ident
       lookups are repeated for each request.
      </p></dd></dl></div></div></div><div class="sect1 " id="sec-squid-proxyconfigtrans"><div class="titlepage"><div><div><h2 class="title"><span class="number">26.6 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Configuring a transparent proxy</span> <a title="Permalink" class="permalink" href="cha-squid.html#sec-squid-proxyconfigtrans">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/net_proxy.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>net_proxy.xml</li><li><span class="ds-label">ID: </span>sec-squid-proxyconfigtrans</li></ul></div></div></div></div><p>
   A transparent proxy intercepts and answers the requests of the Web browser,
   so the Web browser receives the requested pages without knowing where they
   are coming from. As the name indicates, the entire process is transparent to
   the user.
  </p><p>
   The standard way of working with proxy servers is as follows: the Web browser
   sends requests to a certain port of the proxy server and the proxy always
   provides these required objects, regardless of whether they are in its
   cache. However, in the following cases using the transparent proxy mode of Squid makes
   sense:
  </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
     When for security reasons it is desirable for all clients to use a proxy
     server to access the Internet.
    </p></li><li class="listitem "><p>
     When all clients must use a proxy server, regardless of whether they are
     aware of it.
    </p></li><li class="listitem "><p>
     When the proxy server in a network is moved, but the existing clients need
     to retain their old configuration.
    </p></li></ul></div><div class="procedure " id="pro-squid-transparent-cli"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 26.1: </span><span class="name">Squid as a transparent proxy server (command line) </span><a title="Permalink" class="permalink" href="cha-squid.html#pro-squid-transparent-cli">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     In <code class="filename">/etc/squid/squid.conf</code>, add the parameter
     <code class="literal">transparent</code> to the line
     <code class="option">http_port</code>. You should then have 2 lines:
    </p><div class="verbatim-wrap"><pre class="screen">http_port 3128⎄
http_port 3128 transparent</pre></div></li><li class="step "><p>
     Restart Squid:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> <code class="command">systemctl restart squid</code></pre></div></li><li class="step " id="st-squid-transparent-cli-fwrules"><p>
     Set up the firewall to redirect HTTP traffic to the port given in
     <code class="option">http_proxy</code> (in the example above, it is port 3128). Then
     reload the firewall configuration. This assumes that the zone
     <code class="literal">internal</code> is assigned to your LAN interface.
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> <code class="command">firewall-cmd</code> --permanent --zone=internal \
    --add-forward-port=port=80:proto=tcp:toport=3128:toaddr=<em class="replaceable ">LAN_IP</em>
<code class="prompt user">&gt; </code><code class="command">sudo</code> <code class="command">firewall-cmd</code> --permanent --zone=internal --add-port=3128/tcp
<code class="prompt user">&gt; </code><code class="command">sudo</code> <code class="command">firewall-cmd</code> --reload</pre></div><p>
     Replace <em class="replaceable ">LAN_IP</em> with the IP address of your LAN
     interface or the interface Squid is listening on.
    </p></li><li class="step "><p>
     To verify that everything is working properly, check the Squid log files
     in <code class="filename">/var/log/squid/access.log</code>.
    </p></li></ol></div></div></div><div class="sect1 " id="sec-squid-cachemgr"><div class="titlepage"><div><div><h2 class="title"><span class="number">26.7 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Using the Squid cache manager CGI interface (<code class="systemitem">cachemgr.cgi</code>)</span> <a title="Permalink" class="permalink" href="cha-squid.html#sec-squid-cachemgr">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/net_proxy.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>net_proxy.xml</li><li><span class="ds-label">ID: </span>sec-squid-cachemgr</li></ul></div></div></div></div><p>
   The Squid cache manager CGI interface (<code class="filename">cachemgr.cgi</code>) is
   a CGI utility for displaying statistics about the memory usage of a running
   Squid process. It also provides a convenient way to manage the cache and view
   statistics without logging the server.
  </p><div class="procedure " id="pro-squid-setup-cachemgr"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 26.2: </span><span class="name">Setting up <code class="systemitem">cachemgr.cgi</code> </span><a title="Permalink" class="permalink" href="cha-squid.html#pro-squid-setup-cachemgr">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Make sure the Apache Web server is running on your system. Configure
     Apache as described in <a class="xref" href="cha-apache2.html" title="Chapter 24. The Apache HTTP server">Chapter 24, <em>The Apache HTTP server</em></a>. In particular, see
     <a class="xref" href="cha-apache2.html#sec-apache2-cgi" title="24.5. Enabling CGI scripts">Section 24.5, “Enabling CGI scripts”</a>. To check whether Apache is already
     running, use:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> <code class="command">systemctl status apache2</code></pre></div><p>
     If the status is <code class="literal">inactive</code>, start Apache with the
     <span class="productname"><span class="phrase">openSUSE Leap</span></span> default settings:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> <code class="command">systemctl start apache2</code></pre></div></li><li class="step "><p>
     Now enable <code class="systemitem">cachemgr.cgi</code> in
     Apache. To do this, create a configuration file for a
     <code class="literal">ScriptAlias</code>.
    </p><p>
     Create the file in the directory <code class="filename">/etc/apache2/conf.d</code>
     and name it <code class="filename">cachemgr.conf</code>. Add the following to the file:
    </p><div class="verbatim-wrap"><pre class="screen">ScriptAlias /squid/cgi-bin/ /usr/lib64/squid/

&lt;Directory "/usr/lib64/squid/"&gt;
Options +ExecCGI
AddHandler cgi-script .cgi
Require host <em class="replaceable ">HOST_NAME</em>
&lt;/Directory&gt;</pre></div><p>
     Replace <em class="replaceable ">HOST_NAME</em> with the host name of the
     computer you want to access
     <code class="systemitem">cachemgr.cgi</code> from. This allows
     only your computer to access
     <code class="systemitem">cachemgr.cgi</code>. To allow access
     from anywhere, use <code class="literal">Require all granted</code> instead.
    </p></li><li class="step "><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
       If Squid and the Apache Web server run on the same computer, the
       <code class="filename">/etc/squid/squid.conf</code> configuration file requires no
       modifications. However, verify that the file contains the following
       lines:
      </p><div class="verbatim-wrap"><pre class="screen">http_access allow manager localhost
http_access deny manager</pre></div><p>
       This allows you to access the manager interface from your
       computer (<code class="literal">localhost</code>) only.
      </p></li><li class="listitem "><p>
       If Squid and the Apache Web server run on different computers, you need
       to add extra rules to allow access from the CGI script to Squid. Define
       an ACL for the server (replace <em class="replaceable ">WEB_SERVER_IP</em>
       with the IP address of the Web server):
      </p><div class="verbatim-wrap"><pre class="screen">acl webserver src <em class="replaceable ">WEB_SERVER_IP</em>/255.255.255.255</pre></div><p>
       Make sure the following rules are in the configuration file. Keep in mind
       that the order is important.
      </p><div class="verbatim-wrap"><pre class="screen">http_access allow manager localhost
http_access allow manager webserver
http_access deny manager</pre></div></li></ul></div></li><li class="step "><p><span class="step-optional">(Optional)</span> 
     Optionally, you can configure one or more passwords for
     <code class="systemitem">cachemgr.cgi</code>. This also gives you
     access to more actions such as closing the cache remotely or viewing more
     information about the cache. To enable access, configure the options
     <code class="option">cache_mgr</code> and <code class="option">cachemgr_passwd</code> with one
     or more password for the manager and a list of allowed actions.
    </p><p>
    The following example configuration enables viewing the index page, the
    menu, and 60-minute average of counters without authentication. The
    configuration also enables toggling offline mode using the password
    <code class="literal">secretpassword</code> and to disable everything else.
    </p><div class="verbatim-wrap"><pre class="screen">cache_mgr user
cachemgr_passwd none index menu 60min
cachemgr_passwd secretpassword offline_toggle
cachemgr_passwd disable all</pre></div><p>
     <code class="option">cache_mgr</code> defines a user name. <code class="option">cache_mgr</code>
     defines which actions are allowed using which password.
    </p><p>
     The keywords <code class="literal">none</code> and <code class="literal">disable</code> are
     special: <code class="literal">none</code> removes the need for a password,
     <code class="literal">disable</code> disables functionality outright.
    </p><p>
     The full list of actions can be best seen after logging in to
     <code class="systemitem">cachemgr.cgi</code>. To find out how
     the operation needs to be referenced in the configuration file, see the
     string after <code class="literal">&amp;operation=</code> in the URL of the action
     page. <code class="literal">all</code> is a special keyword meaning all actions.
    </p></li><li class="step "><p>
     Reload Squid and Apache to enable the changes:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> <code class="command">systemctl reload squid</code></pre></div></li><li class="step "><p>
     To view the statistics, go to the
     <code class="systemitem">cachemgr.cgi</code> page that you set
     up before. For example, it could be
     <code class="literal">http://webserver.example.org/squid/cgi-bin/cachemgr.cgi</code>.
    </p><p>
     Choose the right server. If a user name and password are configured,
     specify them. Click <span class="guimenu ">Continue</span> and browse through the
     available statistics.
    </p></li></ol></div></div></div><div class="sect1 " id="sec-squid-calamaris"><div class="titlepage"><div><div><h2 class="title"><span class="number">26.8 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Cache report generation with Calamaris</span> <a title="Permalink" class="permalink" href="cha-squid.html#sec-squid-calamaris">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/net_proxy.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>net_proxy.xml</li><li><span class="ds-label">ID: </span>sec-squid-calamaris</li></ul></div></div></div></div><p>
   Calamaris is a Perl script for generating reports of cache activity in ASCII
   or HTML format. It works with Squid access log files. This tool does
   not belong to the <span class="productname"><span class="phrase">openSUSE Leap</span></span> default installation scope—to use it,
   install the
   <code class="systemitem">calamaris</code> package. Further info on Calamaris is
   available at <a class="link" href="https://cord.de/calamaris-english" target="_blank">https://cord.de/calamaris-english</a>.
  </p><p>
   Log in as <code class="systemitem">root</code>, then enter:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>cat access1.log [access2.log access3.log] | calamaris <em class="replaceable ">OPTIONS</em> &gt; reportfile</pre></div><p>
   When using more than one log file, make sure they are ordered
   chronologically, with older files listed first. This can be done either by
   listing the files one after the other as in the example above or by using
   <code class="filename">access{1..3}.log</code>.
  </p><p>
   <code class="command">calamaris</code> accepts the following options:
  </p><div class="variablelist "><dl class="variablelist"><dt id="id-1.4.5.11.14.7.1"><span class="term "><code class="option">-a</code></span></dt><dd><p>
      output all available reports
     </p></dd><dt id="id-1.4.5.11.14.7.2"><span class="term "><code class="option">-w</code></span></dt><dd><p>
      output as HTML report
     </p></dd><dt id="id-1.4.5.11.14.7.3"><span class="term "><code class="option">-l</code></span></dt><dd><p>
      include a message or logo in report header
     </p></dd></dl></div><p>
   Further information about options can be found in the program's
   man page with <code class="command">man</code> <code class="option">calamaris</code>.
  </p><p>
   A typical example is:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>cat access.log.{10..1} access.log | calamaris -a -w \
&gt; /usr/local/httpd/htdocs/Squid/squidreport.html</pre></div><p>
   This saves the report in the directory of the Web server. Apache is required
   to view the reports.
  </p></div><div class="sect1 " id="sec-squid-moreinfo"><div class="titlepage"><div><div><h2 class="title"><span class="number">26.9 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">More Information</span> <a title="Permalink" class="permalink" href="cha-squid.html#sec-squid-moreinfo">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/net_proxy.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>net_proxy.xml</li><li><span class="ds-label">ID: </span>sec-squid-moreinfo</li></ul></div></div></div></div><p>
   Visit the home page of Squid at
   <a class="link" href="https://www.squid-cache.org/" target="_blank">https://www.squid-cache.org/</a>. Here, find the
   <span class="quote">“<span class="quote ">Squid User Guide</span>”</span> and an extensive collection of FAQs on
   Squid.
  </p><p>
   Squid mailing lists are available at
   <a class="link" href="https://www.squid-cache.org/Support/mailing-lists.html" target="_blank">https://www.squid-cache.org/Support/mailing-lists.html</a>.
  </p></div></div></div><div class="page-bottom"><div id="_bottom-navigation"><a class="nav-link" href="part-reference-mobility.html"><span class="next-icon">→</span><span class="nav-label"><span class="number">Part IV </span>Mobile computers</span></a><a class="nav-link" href="cha-ftp.html"><span class="prev-icon">←</span><span class="nav-label"><span class="number">Chapter 25 </span>Setting up an FTP server with YaST</span></a></div><div class="_share-print"><div class="online-contents share"><strong>Share this page: </strong><span class="share-buttons"><span class="_share-fb bottom-button">Facebook</span><span class="spacer"> • </span><span class="_share-in bottom-button">LinkedIn</span><span class="spacer"> • </span><span class="_share-tw bottom-button">Twitter</span><span class="spacer"> • </span><span class="_share-mail bottom-button">E-Mail</span></span></div><div class="print"><span class="_print-button bottom-button">Print this page</span></div><div class="clearme"></div></div></div></div><div id="_inward"></div></div><div id="_footer-wrap"><div id="_footer"><p>©
        2024 
        SUSE</p><ul><li><a href="https://jobs.suse.com/" target="_top">Careers</a></li><li><a href="https://www.suse.com/company/legal/" target="_top">Legal</a></li><li><a href="https://www.suse.com/company/about/" target="_top">About</a></li><li><a href="https://www.suse.com/contact/" target="_top">Contact Us</a></li></ul></div></div></body></html>