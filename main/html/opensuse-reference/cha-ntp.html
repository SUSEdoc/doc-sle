<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Time synchronization with NTP | Reference | openSUSE Leap 15.7</title><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" /><link rel="stylesheet" type="text/css" href="static/css/style.css" /><link rel="stylesheet" type="text/css" href="static/css/highlight.css" />
<meta name="title" content="Time synchronization with NTP | openSUSE Leap 15.7" />
<meta name="description" content="The NTP (network time protocol) mechanism is a protocol for synchronizing the system time over the network. First, a machine can obtain the time from a server …" />
<meta name="product-name" content="openSUSE Leap" />
<meta name="product-number" content="15.7" />
<meta name="book-title" content="Reference" />
<meta name="chapter-title" content="Chapter 18. Time synchronization with NTP" />
<meta name="tracker-url" content="https://bugzilla.opensuse.org/enter_bug.cgi" />
<meta name="tracker-type" content="bsc" />
<meta name="tracker-bsc-assignee" content="fs@suse.com" />
<meta name="tracker-bsc-component" content="Documentation" />
<meta name="tracker-bsc-product" content="openSUSE Distribution" />
<meta name="tracker-bsc-version" content="Leap 15.4" />
<meta property="og:title" content="Time synchronization with NTP | openSUSE Leap 15.7" />
<meta property="og:description" content="The NTP (network time protocol) mechanism is a protocol for synchronizing the system time over the network. First, a machine can obtain the time from a server …" />
<meta property="og:type" content="article" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Time synchronization with NTP | openSUSE Leap 15.7" />
<meta name="twitter:description" content="The NTP (network time protocol) mechanism is a protocol for synchronizing the system time over the network. First, a machine can obtain the time from a server …" />
<link rel="home" href="index.html" title="openSUSE Leap Documentation" /><link rel="up" href="part-reference-services.html" title="Part III. Services" /><link rel="prev" href="cha-slp.html" title="Chapter 17. SLP" /><link rel="next" href="cha-dns.html" title="Chapter 19. The domain name system" />
<script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css" /></noscript><script src="static/js/jquery-1.12.4.min.js" type="text/javascript"></script><script src="static/js/script.js" type="text/javascript"></script><script src="static/js/highlight.min.js" type="text/javascript"></script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-navigation">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><div id="_outer-wrap"><div id="_white-bg" style="background-color: #E11;"><div id="_header"><div id="_logo"><img src="static/images/logo.svg" alt="Logo" /></div><div class="crumbs"><a class="book-link" href="index.html" title="Reference"><span class="book-icon">Reference</span></a><span> › </span><a class="crumb" href="part-reference-services.html">Services</a><span> › </span><a class="crumb" href="cha-ntp.html">Time synchronization with NTP</a></div><div class="clearme"></div></div></div><div id="_toolbar-wrap"><div id="_toolbar"><div id="_toc-area" class="inactive"><a id="_toc-area-button" class="tool" title="Contents" accesskey="c" href="index.html"><span class="tool-spacer"><span class="toc-icon">Contents</span><span class="clearme"></span></span><span class="tool-label">Contents</span></a><div class="active-contents bubble-corner"></div><div class="active-contents bubble"><div class="bubble-container"><h6>Reference</h6><div id="_bubble-toc"><ol><li class="inactive"><a href="preface-reference.html"><span class="number"> </span><span class="name">About this guide</span></a></li><li class="inactive"><a href="part-reference-adv-admin.html"><span class="number">I </span><span class="name">Advanced administration</span></a><ol><li class="inactive"><a href="cha-yast-text.html"><span class="number">1 </span><span class="name">YaST in text mode</span></a></li><li class="inactive"><a href="cha-sw-cl.html"><span class="number">2 </span><span class="name">Managing software with command line tools</span></a></li><li class="inactive"><a href="cha-snapper.html"><span class="number">3 </span><span class="name">System recovery and snapshot management with Snapper</span></a></li><li class="inactive"><a href="cha-vnc.html"><span class="number">4 </span><span class="name">Remote graphical sessions with VNC</span></a></li><li class="inactive"><a href="cha-expert-partitioner.html"><span class="number">5 </span><span class="name"><span class="guimenu ">Expert Partitioner</span></span></a></li><li class="inactive"><a href="cha-tuning-multikernel.html"><span class="number">6 </span><span class="name">Installing multiple kernel versions</span></a></li><li class="inactive"><a href="cha-gui-desktop.html"><span class="number">7 </span><span class="name">Graphical user interface</span></a></li></ol></li><li class="inactive"><a href="part-reference-system.html"><span class="number">II </span><span class="name">System</span></a><ol><li class="inactive"><a href="cha-64bit.html"><span class="number">8 </span><span class="name">32-bit and 64-bit applications in a 64-bit system environment</span></a></li><li class="inactive"><a href="cha-boot.html"><span class="number">9 </span><span class="name">Introduction to the boot process</span></a></li><li class="inactive"><a href="cha-systemd.html"><span class="number">10 </span><span class="name">The <code class="systemitem">systemd</code> daemon</span></a></li><li class="inactive"><a href="cha-journalctl.html"><span class="number">11 </span><span class="name"><code class="command">journalctl</code>: query the <code class="systemitem">systemd</code> journal</span></a></li><li class="inactive"><a href="cha-grub2.html"><span class="number">12 </span><span class="name">The boot loader GRUB 2</span></a></li><li class="inactive"><a href="cha-network.html"><span class="number">13 </span><span class="name">Basic networking</span></a></li><li class="inactive"><a href="cha-uefi.html"><span class="number">14 </span><span class="name">UEFI (Unified Extensible Firmware Interface)</span></a></li><li class="inactive"><a href="cha-suse.html"><span class="number">15 </span><span class="name">Special system features</span></a></li><li class="inactive"><a href="cha-udev.html"><span class="number">16 </span><span class="name">Dynamic kernel device management with <code class="systemitem">udev</code></span></a></li></ol></li><li class="inactive"><a href="part-reference-services.html"><span class="number">III </span><span class="name">Services</span></a><ol><li class="inactive"><a href="cha-slp.html"><span class="number">17 </span><span class="name">SLP</span></a></li><li class="inactive"><a href="cha-ntp.html"><span class="number">18 </span><span class="name">Time synchronization with NTP</span></a></li><li class="inactive"><a href="cha-dns.html"><span class="number">19 </span><span class="name">The domain name system</span></a></li><li class="inactive"><a href="cha-dhcp.html"><span class="number">20 </span><span class="name">DHCP</span></a></li><li class="inactive"><a href="cha-samba.html"><span class="number">21 </span><span class="name">Samba</span></a></li><li class="inactive"><a href="cha-nfs.html"><span class="number">22 </span><span class="name">Sharing file systems with NFS</span></a></li><li class="inactive"><a href="cha-autofs.html"><span class="number">23 </span><span class="name">On-demand mounting with autofs</span></a></li><li class="inactive"><a href="cha-apache2.html"><span class="number">24 </span><span class="name">The Apache HTTP server</span></a></li><li class="inactive"><a href="cha-ftp.html"><span class="number">25 </span><span class="name">Setting up an FTP server with YaST</span></a></li><li class="inactive"><a href="cha-squid.html"><span class="number">26 </span><span class="name">Squid caching proxy server</span></a></li></ol></li><li class="inactive"><a href="part-reference-mobility.html"><span class="number">IV </span><span class="name">Mobile computers</span></a><ol><li class="inactive"><a href="cha-mobile.html"><span class="number">27 </span><span class="name">Mobile computing with Linux</span></a></li><li class="inactive"><a href="cha-nm.html"><span class="number">28 </span><span class="name">Using NetworkManager</span></a></li><li class="inactive"><a href="cha-power-mgmt.html"><span class="number">29 </span><span class="name">Power management</span></a></li></ol></li><li class="inactive"><a href="app-nwscheme.html"><span class="number">A </span><span class="name">An example network</span></a></li><li class="inactive"><a href="bk02apb.html"><span class="number">B </span><span class="name">GNU licenses</span></a></li></ol></div><div class="clearme"></div></div></div></div><div id="_nav-area" class="inactive"><div class="tool"><span class="nav-inner"><span class="tool-label">Navigation</span><a accesskey="p" class="tool-spacer" title="Chapter 17. SLP" href="cha-slp.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 19. The domain name system" href="cha-dns.html"><span class="next-icon">→</span></a></span></div></div></div></div><div id="_fixed-header-wrap" style="background-color: #E11;" class="inactive"><div id="_fixed-header"><div class="crumbs"><a class="book-link" href="index.html" title="Reference"><span class="book-icon">Reference</span></a><span> › </span><a class="crumb" href="part-reference-services.html">Services</a><span> › </span><a class="crumb" href="cha-ntp.html">Time synchronization with NTP</a></div><div class="buttons"><a class="top-button button" href="#">Top</a><div class="button"><a accesskey="p" class="tool-spacer" title="Chapter 17. SLP" href="cha-slp.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 19. The domain name system" href="cha-dns.html"><span class="next-icon">→</span></a></div><div class="clearme"></div></div><div class="clearme"></div></div></div><div id="_content" class="draft "><div class="documentation"><div class="chapter " id="cha-ntp"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname "><span class="productname"><span class="phrase">openSUSE Leap</span></span></span> <span class="productnumber "><span class="productnumber"><span class="phrase">15.7</span></span></span></div><div><h2 class="title"><span class="number">18 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Time synchronization with NTP</span> <a title="Permalink" class="permalink" href="cha-ntp.html#">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/chrony.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>chrony.xml</li><li><span class="ds-label">ID: </span>cha-ntp</li></ul></div></div><div><div class="abstract"><div class="abstract-title-wrap"><h6 class="abstract-title">Abstract<a title="Permalink" class="permalink" href="cha-ntp.html#id-1.4.5.3.2.1">#</a></h6></div><p>
        The NTP (network time protocol) mechanism is a protocol for
        synchronizing the system time over the network. First, a machine can
        obtain the time from a server that is a reliable time source. Second, a
        machine can itself act as a time source for other computers in the
        network. The goal is twofold—maintaining the absolute time and
        synchronizing the system time of all machines within a network.
      </p></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="cha-ntp.html#sec-ntp-yast"><span class="number">18.1 </span><span class="name">Configuring an NTP client with YaST</span></a></span></dt><dt><span class="sect1"><a href="cha-ntp.html#sec-net-xntp-netconf"><span class="number">18.2 </span><span class="name">Manually configuring NTP in the network</span></a></span></dt><dt><span class="sect1"><a href="cha-ntp.html#ntp-configure-nts"><span class="number">18.3 </span><span class="name">Configuring NTS</span></a></span></dt><dt><span class="sect1"><a href="cha-ntp.html#ntp-chronyc"><span class="number">18.4 </span><span class="name">Configure <code class="systemitem">chronyd</code> at runtime using <code class="command">chronyc</code></span></a></span></dt><dt><span class="sect1"><a href="cha-ntp.html#sec-net-xntp-dynamic"><span class="number">18.5 </span><span class="name">Dynamic time synchronization at runtime</span></a></span></dt><dt><span class="sect1"><a href="cha-ntp.html#sec-net-xntp-normal"><span class="number">18.6 </span><span class="name">Setting up a local reference clock</span></a></span></dt></dl></div></div><p>
    Maintaining an exact system time is important in many situations. The
    built-in hardware clock does often not meet the requirements of applications
    such as databases or clusters. Manual correction of the system time would
    lead to severe problems because, for example, a backward leap can cause
    malfunction of critical applications. Within a network, it is usually
    necessary to synchronize the system time of all machines, but manual time
    adjustment is a bad approach. NTP provides a mechanism to solve these
    problems. The NTP service continuously adjusts the system time with reliable
    time servers in the network. It further enables the management of local
    reference clocks, such as radio-controlled clocks.
  </p><p>
    Since <span class="productname"><span class="phrase">openSUSE Leap</span></span> 15, <code class="systemitem">chrony</code> is the default implementation of NTP.
    <code class="systemitem">chrony</code> includes two parts; <code class="systemitem">chronyd</code> is a daemon that can be started at
    boot time and <code class="command">chronyc</code> is a command line interface program to monitor the
    performance of <code class="systemitem">chronyd</code>, and to change operating parameters at runtime.
  </p><p>
    Starting with <span class="productname"><span class="phrase">openSUSE Leap</span></span> 15.2, the YaST module for NTP client
    configuration configures the systemd-timer instead of the cron daemon to
    execute <code class="systemitem">chrony</code>, when it is not configured to run as a daemon.
  </p><div id="id-1.4.5.3.6" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg" /><h6>Note</h6><p>
      To enable time synchronization via active directory, follow the
      instructions found at <span class="intraxref">Book “Security and Hardening Guide”, Chapter 7 “Active Directory support”, Section 7.3.3 “Joining Active Directory using <span class="guimenu ">Windows domain membership</span>”, Joining an Active Directory domain using <span class="guimenu ">Windows domain membership</span></span>.
    </p></div><div class="sect1 " id="sec-ntp-yast"><div class="titlepage"><div><div><h2 class="title"><span class="number">18.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Configuring an NTP client with YaST</span> <a title="Permalink" class="permalink" href="cha-ntp.html#sec-ntp-yast">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/chrony.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>chrony.xml</li><li><span class="ds-label">ID: </span>sec-ntp-yast</li></ul></div></div></div></div><p>
      The NTP daemon (<code class="systemitem">chronyd</code>) coming with the <code class="systemitem">chrony</code>
      package is preset to use the local computer hardware clock as a time
      reference. The precision of the hardware clock heavily depends on its time
      source. For example, an atomic clock or GPS receiver is a precise time
      source, while a common RTC chip is not a reliable time source. YaST
      simplifies the configuration of an NTP client.
    </p><p>
      In the YaST NTP client configuration (<span class="guimenu ">Network
      Services</span> › <span class="guimenu ">NTP Configuration</span>)
      window, you can specify when to start the NTP daemon, the type of the
      configuration source, and add custom time servers.
    </p><div class="figure" id="id-1.4.5.3.7.4"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/ntp_client.png" target="_blank"><img src="images/ntp_client.png" width="" alt="NTP configuration window" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 18.1: </span><span class="name">NTP configuration window </span><a title="Permalink" class="permalink" href="cha-ntp.html#id-1.4.5.3.7.4">#</a></h6></div></div><div class="sect2 " id="id-1.4.5.3.7.5"><div class="titlepage"><div><div><h3 class="title"><span class="number">18.1.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">NTP daemon start</span> <a title="Permalink" class="permalink" href="cha-ntp.html#id-1.4.5.3.7.5">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/chrony.xml" title="Edit the source file for this section">Edit source</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>chrony.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>
        You can choose from three options for when to start the NTP daemon:
      </p><div class="variablelist "><dl class="variablelist"><dt id="id-1.4.5.3.7.5.3.1"><span class="term "><span class="guimenu ">Only manually</span></span></dt><dd><p>
              Select <span class="guimenu ">Only Manually</span> to manually start the
              <code class="systemitem">chrony</code> daemon.
            </p></dd><dt id="id-1.4.5.3.7.5.3.2"><span class="term "><span class="guimenu ">Synchronize without daemon</span></span></dt><dd><p>
              Select <span class="guimenu ">Synchronize without Daemon</span> to set the
              system time periodically without a permanently running <code class="systemitem">chrony</code>.
              You can set the <span class="guimenu ">Interval of the Synchronization in
              Minutes</span>.
            </p></dd><dt id="id-1.4.5.3.7.5.3.3"><span class="term "><span class="guimenu ">Now and on boot</span></span></dt><dd><p>
              Select <span class="guimenu ">Now and On Boot</span> to start <code class="systemitem">chronyd</code>
              automatically when the system is booted. This setting is
              recommended.
            </p></dd></dl></div></div><div class="sect2 " id="id-1.4.5.3.7.6"><div class="titlepage"><div><div><h3 class="title"><span class="number">18.1.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Type of the configuration source</span> <a title="Permalink" class="permalink" href="cha-ntp.html#id-1.4.5.3.7.6">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/chrony.xml" title="Edit the source file for this section">Edit source</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>chrony.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>
        In the <span class="guimenu ">Configuration Source</span> drop-down box, select
        either <span class="guimenu ">Dynamic</span> or <span class="guimenu ">Static</span>. Set
        <span class="guimenu ">Static</span> if your server uses only a fixed set of
        (public) NTP servers, while <span class="guimenu ">Dynamic</span> is better if your
        internal network offers NTP servers via DHCP.
      </p></div><div class="sect2 " id="sec-net-ntp-yast-new-sync"><div class="titlepage"><div><div><h3 class="title"><span class="number">18.1.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Configure time servers</span> <a title="Permalink" class="permalink" href="cha-ntp.html#sec-net-ntp-yast-new-sync">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/chrony.xml" title="Edit the source file for this section">Edit source</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>chrony.xml</li><li><span class="ds-label">ID: </span>sec-net-ntp-yast-new-sync</li></ul></div></div></div></div><p>
        Time servers for the client to query are listed in the lower part of the
        <span class="guimenu ">NTP Configuration</span> window. Modify this list as needed
        with <span class="guimenu ">Add</span>, <span class="guimenu ">Edit</span>, and
        <span class="guimenu ">Delete</span>.
      </p><p>
        Click <span class="guimenu ">Add</span> to add a new time server:
      </p><div class="figure" id="id-1.4.5.3.7.7.4"><div class="figure-contents"><div class="mediaobject"><a xmlns="" href="images/ntp_client_serveradd.png" target="_blank"><img src="images/ntp_client_serveradd.png" width="" alt="Adding a time server" /></a></div></div><div class="figure-title-wrap"><h6 class="figure-title"><span class="number">Figure 18.2: </span><span class="name">Adding a time server </span><a title="Permalink" class="permalink" href="cha-ntp.html#id-1.4.5.3.7.7.4">#</a></h6></div></div><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
            In the <span class="guimenu ">Address</span> field, type the URL of the time
            server or pool of time servers with which you want to synchronize
            the machine time. After the URL is complete, click
            <span class="guimenu ">Test</span> to verify that it points to a valid time
            source.
          </p></li><li class="step "><p>
            Activate <span class="guimenu ">Quick Initial Sync</span> to speed up the time
            synchronization by sending more requests at the <code class="systemitem">chronyd</code> daemon
            start.
          </p></li><li class="step "><p>
            Activate <span class="guimenu ">Start Offline</span> to speed up the boot time
            on systems that start the <code class="systemitem">chronyd</code> daemon automatically and may not
            have an Internet connection at boot time. This option is useful, for
            example, for laptops with network connections managed by NetworkManager.
          </p></li><li class="step "><p>
            Confirm with <span class="guimenu ">OK</span>.
          </p></li></ol></div></div></div></div><div class="sect1 " id="sec-net-xntp-netconf"><div class="titlepage"><div><div><h2 class="title"><span class="number">18.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Manually configuring NTP in the network</span> <a title="Permalink" class="permalink" href="cha-ntp.html#sec-net-xntp-netconf">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/chrony.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>chrony.xml</li><li><span class="ds-label">ID: </span>sec-net-xntp-netconf</li></ul></div></div></div></div><p>
      <code class="systemitem">chrony</code> reads its configuration from the
      <code class="filename">/etc/chrony.conf</code> file. To keep the computer clock
      synchronized, you need to tell <code class="systemitem">chrony</code> what time servers to use. You can
      use specific server names or IP addresses, for example:
    </p><div class="verbatim-wrap"><pre class="screen">0.suse.pool.ntp.org
1.suse.pool.ntp.org
2.suse.pool.ntp.org
3.suse.pool.ntp.org</pre></div><p>
      You can also specify a <span class="emphasis"><em>pool</em></span> name. Pool name resolves
      to several IP addresses:
    </p><div class="verbatim-wrap"><pre class="screen">pool pool.ntp.org</pre></div><div id="id-1.4.5.3.8.6" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.svg" /><h6>Tip: Computers on the same network</h6><p>
        To synchronize time on multiple computers on the same network, we do not
        recommend to synchronize them all with an external server. A good
        practice is to make one computer the time server which is synchronized
        with an external time server, and the other computers act as its
        clients. Add a <code class="literal">local</code> directive to the server's
        <code class="filename">/etc/chrony.conf</code> to distinguish it from an
        authoritative time server:
      </p><div class="verbatim-wrap"><pre class="screen">local stratum 10</pre></div></div><p>
      To start <code class="systemitem">chrony</code>, run:
    </p><div class="verbatim-wrap"><pre class="screen">systemctl start chronyd.service</pre></div><p>
      After initializing <code class="systemitem">chronyd</code>, it takes a while before the time is
      stabilized and the drift file for correcting the local computer clock is
      created. With the drift file, the systematic error of the hardware clock
      can be computed when the computer is powered on. The correction is used
      immediately, resulting in a higher stability of the system time.
    </p><p>
      To enable the service so that <code class="systemitem">chrony</code> starts automatically at boot time,
      run:
    </p><div class="verbatim-wrap"><pre class="screen">systemctl enable chronyd.service</pre></div><div id="id-1.4.5.3.8.12" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.svg" /><h6>Warning: Conflicting <code class="systemitem">yast-timesync.service</code> service</h6><p>
        Besides the <code class="systemitem">chronyd.service</code>
        service, <span class="productname"><span class="phrase">openSUSE Leap</span></span> includes
        <code class="systemitem">yast-timesync.service</code>.
        <code class="systemitem">yast-timesync.service</code> is
        triggered by a timer every 5 minutes and runs <code class="systemitem">chronyd</code> with the
        <code class="option">-q</code> option to set the system time and exit. Because only
        one instance of <code class="systemitem">chronyd</code> can be running at any given time, do not
        enable or start both <code class="systemitem">chronyd</code>-related services at the same time.
      </p></div></div><div class="sect1 " id="ntp-configure-nts"><div class="titlepage"><div><div><h2 class="title"><span class="number">18.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Configuring NTS</span> <a title="Permalink" class="permalink" href="cha-ntp.html#ntp-configure-nts">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/chrony.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>chrony.xml</li><li><span class="ds-label">ID: </span>ntp-configure-nts</li></ul></div></div></div></div><p>
      Network Time Protocol (NTP) is a protocol used to synchronize and keep the system time of
      one or more hosts in the network accurate. This article describes how to
      secure NTP using Network Time Security (NTS).
    </p><p>
      NTP protocol does not introduce security mechanism to make the
      communication between the time server and client authenticated and
      encrypted. Network Time Security (NTS) is an extension that improves the security of NTP.
      <code class="systemitem">chrony</code> supports NTS and can authenticate time sources and protect
      against certain network attacks.
    </p><p>
      The following procedures outline how to configure the time server and
      client machine for secure time synchronization.
    </p><div class="procedure " id="configure-nts-procedure"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 18.1: </span><span class="name">Configuring NTS time server </span><a title="Permalink" class="permalink" href="cha-ntp.html#configure-nts-procedure">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p><span class="step-optional">(Optional)</span> 
          It is a good idea to configure the time server to update its time via
          NTS. This ensures secure time synchronization from the very beginning
          of the synchronization chain. Comment out any existing time sources in
          <code class="filename">/etc/chrony.conf</code> that do not support NTS and add
          at least one that supports NTS, for example:
        </p><div class="verbatim-wrap"><pre class="screen">server time.cloudflare.com iburst nts</pre></div><div id="id-1.4.5.3.9.5.2.3" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.svg" /><h6>Tip</h6><p>
            The <code class="option">nts</code> option requests NTS connection if it is
            available, otherwise it falls back to NTP if NTS is not available.
          </p></div></li><li class="step "><p>
          Restart the <code class="systemitem">chronyd</code> service.
        </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> <code class="command">systemctl restart chronyd.srvice</code></pre></div></li><li class="step "><p>
          Verify the configured time sources.
        </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">chronyc sources -v</code>
MS Name/IP address         Stratum Poll Reach LastRx Last sample               
===============================================================================
^? time.cloudflare.com           3   6     1     2   -947ms[ -947ms] +/-   12ms
^? pyrrha.fi.muni.cz             2   6     1     1   -948ms[ -948ms] +/-   39ms
^* whitesoft-intex16.c.cbsn&gt;     1   6     1     2   -948ms[ -948ms] +/- 5444us
^? mail.combatostrich.dev        2   6     1     1   -948ms[ -948ms] +/-   28ms</pre></div><div id="id-1.4.5.3.9.5.4.3" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg" /><h6>Note</h6><p>
            The line that starts with <code class="literal">^*</code> includes the time
            source that was selected as best.
          </p></div><p>
          Verify that the configured time source uses the NTS mode.
        </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">chronyc -N authdata</code>
Name/IP address             Mode KeyID Type KLen Last Atmp  NAK Cook CLen
=========================================================================
[...]
time.cloudflare.com          NTS     1   15  256    3    0    0    8   96</pre></div></li><li class="step "><p>
          Verify that the server configuration includes the
          <code class="option">allow</code> option that specifies which clients can
          synchronize time with the time server, for example:
        </p><div class="verbatim-wrap"><pre class="screen">allow 192.168.1.0/24</pre></div></li><li class="step "><p><span class="step-optional">(Optional)</span> 
          If the time server is running behind a firewall, allow communication
          on ports for both NTP and NTS. They are 123 and 4460 by default.
        </p></li><li class="step "><p>
          Obtain a TLS certificate and a corresponding private key and copy them
          to <code class="filename">/var/lib/chrony/</code>. Verify that they are
          readable by <code class="systemitem">chrony</code>, for example:
        </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> install -m 0440 -o chrony -g chrony <em class="replaceable ">nts.key</em> /var/lib/chrony/
<code class="prompt user">&gt; </code><code class="command">sudo</code> install -m 0440 -o chrony -g chrony <em class="replaceable ">nts.crt</em> /var/lib/chrony/</pre></div><div id="id-1.4.5.3.9.5.7.3" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.svg" /><h6>Tip</h6><p>
            Find detailed information about TLS certificates in a
            <a class="link" href="https://documentation.suse.com/smart/security/html/tls-certificates/index.html" target="_blank">dedicated
            article.</a>
          </p></div></li><li class="step "><p>
          Edit <code class="filename">/etc/chrony.conf</code> and verify that the
          <code class="option">ntsdumpdir /var/lib/chrony</code> option is active. Then
          append the paths to the TLS key and certificate.
        </p><div class="verbatim-wrap"><pre class="screen">ntsdumpdir /var/lib/chrony
ntsserverkey /var/lib/chrony/nts.key
ntsservercert /var/lib/chrony/nts.crt</pre></div></li><li class="step "><p>
          Restart the <code class="systemitem">chronyd</code> service.
        </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> systemctl restart chronyd.service</pre></div></li></ol></div></div><div class="procedure " id="id-1.4.5.3.9.6"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 18.2: </span><span class="name">Configuring NTS clients </span><a title="Permalink" class="permalink" href="cha-ntp.html#id-1.4.5.3.9.6">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
          Disable existing NTP sources, for example:
        </p><div class="verbatim-wrap"><pre class="screen">#server 192.168.1.1 iburst</pre></div><p>
          The sources configurations are included in
          <code class="filename">/etc/chrony.conf</code> or in files under
          <code class="filename">/etc/chrony.d/</code>.
        </p></li><li class="step "><p>
          The client host needs to trust the Root CA that signed the TLS
          certificate. Find details on how to manage the CA certificate store in
          a
          <a class="link" href="https://documentation.suse.com/smart/security/html/tls-certificates/index.html#tls-certificates-store" target="_blank">dedicated
          article</a>.
        </p></li><li class="step "><p>
          Add the NTS time server source that you configured in
          <a class="xref" href="cha-ntp.html#configure-nts-procedure" title="Configuring NTS time server">Procedure 18.1, “Configuring NTS time server”</a> to the client <code class="systemitem">chrony</code>
          configuration in <code class="filename">/etc/chrony.conf</code>, for example:
        </p><div class="verbatim-wrap"><pre class="screen">server <em class="replaceable ">nts1.example.com</em> iburst nts</pre></div></li><li class="step "><p>
          Restart the <code class="systemitem">chronyd</code> service.
        </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> systemctl restart chronyd.service</pre></div></li><li class="step "><p>
          Verify configured time sources on the client and confirm that the
          connection is authenticated.
        </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> chronyc sources -v
<code class="prompt user">&gt; </code><code class="command">sudo</code> chronyc -N authdata</pre></div></li><li class="step "><p>
          On the NTS time server, verify per client statistics about NTS
          connections.
        </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> chronyc -N clients -k</pre></div></li></ol></div></div></div><div class="sect1 " id="ntp-chronyc"><div class="titlepage"><div><div><h2 class="title"><span class="number">18.4 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Configure <code class="systemitem">chronyd</code> at runtime using <code class="command">chronyc</code></span> <a title="Permalink" class="permalink" href="cha-ntp.html#ntp-chronyc">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/chrony.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>chrony.xml</li><li><span class="ds-label">ID: </span>ntp-chronyc</li></ul></div></div></div></div><p>
      You can use <code class="command">chronyc</code> to change the behavior of <code class="systemitem">chronyd</code> at runtime. It
      also generates status reports about the operation of <code class="systemitem">chronyd</code>.
    </p><p>
      You can run <code class="command">chronyc</code> either in interactive or non-interactive mode. To
      run <code class="command">chronyc</code> interactively, enter <code class="command">chronyc</code> on the command line. It
      displays a prompt and waits for your command input. For example, to check
      how many NTP sources are online or offline, run:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">chronyc</code>
chronyc&gt; activity
200 OK
4 sources online
2 sources offline
1 sources doing burst (return to online)
1 sources doing burst (return to offline)
0 sources with unknown address</pre></div><p>
      To exit <code class="command">chronyc</code>'s prompt, enter <code class="command">quit</code> or
      <code class="command">exit</code>.
    </p><p>
      If you do not need to use the interactive prompt, enter the command
      directly:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">chronyc</code> activity</pre></div><div id="id-1.4.5.3.10.8" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg" /><h6>Note: Temporary changes</h6><p>
        Changes made using <code class="command">chronyc</code> are not permanent. They will be lost after
        the next <code class="systemitem">chronyd</code> restart. For permanent changes, modify
        <code class="filename">/etc/chrony.conf</code>.
      </p></div><p>
      For a complete list of <code class="command">chronyc</code> commands, see its man page (<code class="command">man
      1 chronyc</code>).
    </p></div><div class="sect1 " id="sec-net-xntp-dynamic"><div class="titlepage"><div><div><h2 class="title"><span class="number">18.5 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Dynamic time synchronization at runtime</span> <a title="Permalink" class="permalink" href="cha-ntp.html#sec-net-xntp-dynamic">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/chrony.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>chrony.xml</li><li><span class="ds-label">ID: </span>sec-net-xntp-dynamic</li></ul></div></div></div></div><p>
      Although <code class="systemitem">chronyd</code> starts up normally on a system that boots without a
      network connection, the tool cannot resolve the DNS names of the time
      servers specified in the configuration file.
    </p><p>
      <code class="systemitem">chronyd</code> keeps trying to resolve the time server names specified by the
      <code class="option">server</code>, <code class="option">pool</code>, and <code class="option">peer</code>
      directives in an increasing time interval until it succeeds.
    </p><p>
      If the time server will not be reachable when <code class="systemitem">chronyd</code> is started, you
      can specify the <code class="option">offline</code> option:
    </p><div class="verbatim-wrap"><pre class="screen">server <em class="replaceable ">server_address</em> offline</pre></div><p>
      <code class="systemitem">chronyd</code> does not try to poll the server until it is enabled using the
      following command:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>chronyc online <em class="replaceable ">server_address</em></pre></div><p>
      When the <code class="option">auto_offline</code> option is set, <code class="systemitem">chronyd</code> assumes
      that the time server has gone offline when two requests have been sent to
      it without receiving a response. This option avoids the need to run the
      <code class="literal">offline</code> command from <code class="command">chronyc</code> when disconnecting the
      network link.
    </p></div><div class="sect1 " id="sec-net-xntp-normal"><div class="titlepage"><div><div><h2 class="title"><span class="number">18.6 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Setting up a local reference clock</span> <a title="Permalink" class="permalink" href="cha-ntp.html#sec-net-xntp-normal">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/chrony.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>chrony.xml</li><li><span class="ds-label">ID: </span>sec-net-xntp-normal</li></ul></div></div></div></div><p>
      The software package <code class="systemitem">chrony</code> relies on other programs (such as
      <code class="systemitem">gpsd</code>) to access the timing data via the SHM or
      SOCK driver. Use the <code class="option">refclock</code> directive in
      <code class="filename">/etc/chrony.conf</code> to specify a hardware reference
      clock to be used as a time source. It has two mandatory parameters: a
      driver name and a driver-specific parameter. The two parameters are
      followed by zero or more <code class="option">refclock</code> options. <code class="systemitem">chronyd</code>
      includes the following drivers:
    </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
          PPS - driver for the kernel <code class="literal">pulse per second</code> API.
          For example:
        </p><div class="verbatim-wrap"><pre class="screen">refclock PPS /dev/pps0 lock NMEA refid GPS</pre></div></li><li class="listitem "><p>
          SHM - NTP shared memory driver. For example:
        </p><div class="verbatim-wrap"><pre class="screen">refclock SHM 0 poll 3 refid GPS1
refclock SHM 1:perm=0644 refid GPS2</pre></div></li><li class="listitem "><p>
          SOCK - Unix domain socket driver. For example:
        </p><div class="verbatim-wrap"><pre class="screen">refclock SOCK /var/run/chrony.ttyS0.sock</pre></div></li><li class="listitem "><p>
          PHC - PTP hardware clock driver. For example:
        </p><div class="verbatim-wrap"><pre class="screen">refclock PHC /dev/ptp0 poll 0 dpoll -2 offset -37
refclock PHC /dev/ptp1:nocrossts poll 3 pps</pre></div></li></ul></div><p>
      For more information on individual drivers' options, see <code class="command">man 8
      chrony.conf</code>.
    </p></div></div></div><div class="page-bottom"><div id="_bottom-navigation"><a class="nav-link" href="cha-dns.html"><span class="next-icon">→</span><span class="nav-label"><span class="number">Chapter 19 </span>The domain name system</span></a><a class="nav-link" href="cha-slp.html"><span class="prev-icon">←</span><span class="nav-label"><span class="number">Chapter 17 </span>SLP</span></a></div><div class="_share-print"><div class="online-contents share"><strong>Share this page: </strong><span class="share-buttons"><span class="_share-fb bottom-button">Facebook</span><span class="spacer"> • </span><span class="_share-in bottom-button">LinkedIn</span><span class="spacer"> • </span><span class="_share-tw bottom-button">Twitter</span><span class="spacer"> • </span><span class="_share-mail bottom-button">E-Mail</span></span></div><div class="print"><span class="_print-button bottom-button">Print this page</span></div><div class="clearme"></div></div></div></div><div id="_inward"></div></div><div id="_footer-wrap"><div id="_footer"><p>©
        2024 
        SUSE</p><ul><li><a href="https://jobs.suse.com/" target="_top">Careers</a></li><li><a href="https://www.suse.com/company/legal/" target="_top">Legal</a></li><li><a href="https://www.suse.com/company/about/" target="_top">About</a></li><li><a href="https://www.suse.com/contact/" target="_top">Contact Us</a></li></ul></div></div></body></html>