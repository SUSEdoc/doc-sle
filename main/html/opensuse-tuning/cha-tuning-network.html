<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Tuning the network | System Analysis and Tuning Guide | openSUSE Leap 15.6</title><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" /><link rel="stylesheet" type="text/css" href="static/css/style.css" /><link rel="stylesheet" type="text/css" href="static/css/highlight.css" />
<meta name="title" content="Tuning the network | openSUSE Leap 15.6" />
<meta name="description" content="The network subsystem is complex and its tuning highly depends on the system use scenario and on external factors such as software clients or hardware componen…" />
<meta name="product-name" content="openSUSE Leap" />
<meta name="product-number" content="15.6" />
<meta name="book-title" content="System Analysis and Tuning Guide" />
<meta name="chapter-title" content="Chapter 16. Tuning the network" />
<meta name="tracker-url" content="https://bugzilla.opensuse.org/enter_bug.cgi" />
<meta name="tracker-type" content="bsc" />
<meta name="tracker-bsc-assignee" content="fs@suse.com" />
<meta name="tracker-bsc-component" content="Documentation" />
<meta name="tracker-bsc-product" content="openSUSE Distribution" />
<meta name="tracker-bsc-version" content="Leap 15.4" />
<meta property="og:title" content="Tuning the network | openSUSE Leap 15.6" />
<meta property="og:description" content="The network subsystem is complex and its tuning highly depends on the system use scenario and on external factors such as software clients or hardware componen…" />
<meta property="og:type" content="article" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Tuning the network | openSUSE Leap 15.6" />
<meta name="twitter:description" content="The network subsystem is complex and its tuning highly depends on the system use scenario and on external factors such as software clients or hardware componen…" />
<link rel="home" href="index.html" title="openSUSE Leap Documentation" /><link rel="up" href="part-tuning-kernel.html" title="Part V. Kernel tuning" /><link rel="prev" href="cha-tuning-memory.html" title="Chapter 15. Tuning the memory management subsystem" /><link rel="next" href="part-tuning-dumps.html" title="Part VI. Handling system dumps" />
<script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css" /></noscript><script src="static/js/jquery-1.12.4.min.js" type="text/javascript"></script><script src="static/js/script.js" type="text/javascript"></script><script src="static/js/highlight.min.js" type="text/javascript"></script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-navigation">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><div id="_outer-wrap"><div id="_white-bg" style="background-color: #E11;"><div id="_header"><div id="_logo"><img src="static/images/logo.svg" alt="Logo" /></div><div class="crumbs"><a class="book-link" href="index.html" title="System Analysis and Tuning Guide"><span class="book-icon">System Analysis and Tuning Guide</span></a><span> › </span><a class="crumb" href="part-tuning-kernel.html">Kernel tuning</a><span> › </span><a class="crumb" href="cha-tuning-network.html">Tuning the network</a></div><div class="clearme"></div></div></div><div id="_toolbar-wrap"><div id="_toolbar"><div id="_toc-area" class="inactive"><a id="_toc-area-button" class="tool" title="Contents" accesskey="c" href="index.html"><span class="tool-spacer"><span class="toc-icon">Contents</span><span class="clearme"></span></span><span class="tool-label">Contents</span></a><div class="active-contents bubble-corner"></div><div class="active-contents bubble"><div class="bubble-container"><h6>System Analysis and Tuning Guide</h6><div id="_bubble-toc"><ol><li class="inactive"><a href="preface-tuning.html"><span class="number"> </span><span class="name">Preface</span></a></li><li class="inactive"><a href="part-tuning-basics.html"><span class="number">I </span><span class="name">Basics</span></a><ol><li class="inactive"><a href="cha-tuning-basics.html"><span class="number">1 </span><span class="name">General notes on system tuning</span></a></li></ol></li><li class="inactive"><a href="part-tuning-monitoring.html"><span class="number">II </span><span class="name">System monitoring</span></a><ol><li class="inactive"><a href="cha-util.html"><span class="number">2 </span><span class="name">System monitoring utilities</span></a></li><li class="inactive"><a href="cha-tuning-syslog.html"><span class="number">3 </span><span class="name">System log files</span></a></li></ol></li><li class="inactive"><a href="part-tuning-kerneltrace.html"><span class="number">III </span><span class="name">Kernel monitoring</span></a><ol><li class="inactive"><a href="cha-tuning-systemtap.html"><span class="number">4 </span><span class="name">SystemTap—filtering and analyzing system data</span></a></li><li class="inactive"><a href="cha-tuning-kprobes.html"><span class="number">5 </span><span class="name">Kernel probes</span></a></li><li class="inactive"><a href="cha-perf.html"><span class="number">6 </span><span class="name">Hardware-based performance monitoring with Perf</span></a></li><li class="inactive"><a href="cha-tuning-oprofile.html"><span class="number">7 </span><span class="name">OProfile—system-wide profiler</span></a></li><li class="inactive"><a href="cha-tuning-dynamic-debug.html"><span class="number">8 </span><span class="name">Dynamic debug—kernel debugging messages</span></a></li></ol></li><li class="inactive"><a href="part-tuning-resources.html"><span class="number">IV </span><span class="name">Resource management</span></a><ol><li class="inactive"><a href="cha-tuning-resources.html"><span class="number">9 </span><span class="name">General system resource management</span></a></li><li class="inactive"><a href="cha-tuning-cgroups.html"><span class="number">10 </span><span class="name">Kernel control groups</span></a></li><li class="inactive"><a href="cha-tuning-numactl.html"><span class="number">11 </span><span class="name">Automatic Non-Uniform Memory Access (NUMA) balancing</span></a></li><li class="inactive"><a href="cha-tuning-power.html"><span class="number">12 </span><span class="name">Power management</span></a></li></ol></li><li class="inactive"><a href="part-tuning-kernel.html"><span class="number">V </span><span class="name">Kernel tuning</span></a><ol><li class="inactive"><a href="cha-tuning-io.html"><span class="number">13 </span><span class="name">Tuning I/O performance</span></a></li><li class="inactive"><a href="cha-tuning-taskscheduler.html"><span class="number">14 </span><span class="name">Tuning the task scheduler</span></a></li><li class="inactive"><a href="cha-tuning-memory.html"><span class="number">15 </span><span class="name">Tuning the memory management subsystem</span></a></li><li class="inactive"><a href="cha-tuning-network.html"><span class="number">16 </span><span class="name">Tuning the network</span></a></li></ol></li><li class="inactive"><a href="part-tuning-dumps.html"><span class="number">VI </span><span class="name">Handling system dumps</span></a><ol><li class="inactive"><a href="cha-tuning-tracing.html"><span class="number">17 </span><span class="name">Tracing tools</span></a></li><li class="inactive"><a href="cha-tuning-kexec.html"><span class="number">18 </span><span class="name">Kexec and Kdump</span></a></li><li class="inactive"><a href="cha-tuning-systemd-coredump.html"><span class="number">19 </span><span class="name">Using <code class="systemitem">systemd-coredump</code> to debug application crashes</span></a></li></ol></li><li class="inactive"><a href="part-tuning-ptp.html"><span class="number">VII </span><span class="name">Synchronized clocks with Precision Time Protocol</span></a><ol><li class="inactive"><a href="cha-tuning-ptp.html"><span class="number">20 </span><span class="name">Precision Time Protocol</span></a></li></ol></li><li class="inactive"><a href="bk05apa.html"><span class="number">A </span><span class="name">GNU licenses</span></a></li></ol></div><div class="clearme"></div></div></div></div><div id="_nav-area" class="inactive"><div class="tool"><span class="nav-inner"><span class="tool-label">Navigation</span><a accesskey="p" class="tool-spacer" title="Chapter 15. Tuning the memory management subsystem" href="cha-tuning-memory.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Part VI. Handling system dumps" href="part-tuning-dumps.html"><span class="next-icon">→</span></a></span></div></div></div></div><div id="_fixed-header-wrap" style="background-color: #E11;" class="inactive"><div id="_fixed-header"><div class="crumbs"><a class="book-link" href="index.html" title="System Analysis and Tuning Guide"><span class="book-icon">System Analysis and Tuning Guide</span></a><span> › </span><a class="crumb" href="part-tuning-kernel.html">Kernel tuning</a><span> › </span><a class="crumb" href="cha-tuning-network.html">Tuning the network</a></div><div class="buttons"><a class="top-button button" href="#">Top</a><div class="button"><a accesskey="p" class="tool-spacer" title="Chapter 15. Tuning the memory management subsystem" href="cha-tuning-memory.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Part VI. Handling system dumps" href="part-tuning-dumps.html"><span class="next-icon">→</span></a></div><div class="clearme"></div></div><div class="clearme"></div></div></div><div id="_content" class="draft "><div class="documentation"><div class="chapter " id="cha-tuning-network"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname "><span class="productname"><span class="phrase">openSUSE Leap</span></span></span> <span class="productnumber "><span class="productnumber"><span class="phrase">15.6</span></span></span></div><div><h2 class="title"><span class="number">16 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Tuning the network</span> <a title="Permalink" class="permalink" href="cha-tuning-network.html#">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/tuning_network.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>tuning_network.xml</li><li><span class="ds-label">ID: </span>cha-tuning-network</li></ul></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="cha-tuning-network.html#sec-tuning-network-buffers"><span class="number">16.1 </span><span class="name">Configurable kernel socket buffers</span></a></span></dt><dt><span class="sect1"><a href="cha-tuning-network.html#sec-tuning-network-analyzing"><span class="number">16.2 </span><span class="name">Detecting network bottlenecks and analyzing network traffic</span></a></span></dt><dt><span class="sect1"><a href="cha-tuning-network.html#sec-tuning-network-netfilter"><span class="number">16.3 </span><span class="name">Netfilter</span></a></span></dt><dt><span class="sect1"><a href="cha-tuning-network.html#sec-tuning-network-rps"><span class="number">16.4 </span><span class="name">Improving the network performance with receive packet steering (RPS)</span></a></span></dt></dl></div></div><p>
  The network subsystem is complex and its tuning highly depends on
  the system use scenario and on external factors such as software
  clients or hardware components (switches, routers, or gateways) in your
  network. The Linux kernel aims more at reliability and low latency than
  low overhead and high throughput. Other settings can mean less security,
  but better performance.
 </p><div class="sect1 " id="sec-tuning-network-buffers"><div class="titlepage"><div><div><h2 class="title"><span class="number">16.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Configurable kernel socket buffers</span> <a title="Permalink" class="permalink" href="cha-tuning-network.html#sec-tuning-network-buffers">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/tuning_network.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>tuning_network.xml</li><li><span class="ds-label">ID: </span>sec-tuning-network-buffers</li></ul></div></div></div></div><p>
   Most of modern networking is based on the TCP/IP protocol and a socket interface
   for communication; for more information about TCP/IP, see
   <span class="intraxref">Book “Reference”, Chapter 13 “Basic networking”</span>. The Linux kernel handles data it receives
   or sends via the socket interface in socket buffers. These kernel socket
   buffers are tunable.
  </p><div id="id-1.7.7.5.4.3" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg" /><h6>Important: TCP autotuning</h6><p>
    Since kernel version 2.6.17 full autotuning with 4 MB maximum buffer
    size exists. This means that manual tuning does not
    improve networking performance considerably. It is often the best not to
    touch the following variables, or, at least, to check the outcome of
    tuning efforts carefully.
   </p><p>
    If you update from an older kernel, it is recommended to remove manual
    TCP tunings in favor of the autotuning feature.
   </p></div><p>
   The special files in the <code class="filename">/proc</code> file system can
   modify the size and behavior of kernel socket buffers; for general
   information about the <code class="filename">/proc</code> file system, see
   <a class="xref" href="cha-util.html#sec-util-proc" title="2.6. The /proc file system">Section 2.6, “The <code class="filename">/proc</code> file system”</a>. Find networking related files in:
  </p><div class="verbatim-wrap"><pre class="screen">/proc/sys/net/core
/proc/sys/net/ipv4
/proc/sys/net/ipv6</pre></div><p>
   General <code class="systemitem">net</code> variables are explained in the
   kernel documentation
   (<code class="filename">linux/Documentation/sysctl/net.txt</code>). Special
   <code class="systemitem">ipv4</code> variables are explained in
   <code class="filename">linux/Documentation/networking/ip-sysctl.txt</code> and
   <code class="filename">linux/Documentation/networking/ipvs-sysctl.txt</code>.
  </p><p>
   In the <code class="filename">/proc</code> file system, for example, it is
   possible to either set the Maximum Socket Receive Buffer and Maximum
   Socket Send Buffer for all protocols, or both these options for the TCP
   protocol only (in <code class="filename">ipv4</code>) and thus overriding the
   setting for all protocols (in <code class="filename">core</code>).
  </p><div class="variablelist "><dl class="variablelist"><dt id="id-1.7.7.5.4.8.1"><span class="term "><code class="filename">/proc/sys/net/ipv4/tcp_moderate_rcvbuf</code>
    </span></dt><dd><p>
      If <code class="filename">/proc/sys/net/ipv4/tcp_moderate_rcvbuf</code> is set
      to <code class="literal">1</code>, autotuning is active and buffer size is
      adjusted dynamically.
     </p></dd><dt id="id-1.7.7.5.4.8.2"><span class="term "><code class="filename">/proc/sys/net/ipv4/tcp_rmem</code>
    </span></dt><dd><p>
      The three values setting the minimum, initial, and maximum size of the
      Memory Receive Buffer per connection. They define the actual memory
      usage, not only TCP window size.
     </p></dd><dt id="id-1.7.7.5.4.8.3"><span class="term "><code class="filename">/proc/sys/net/ipv4/tcp_wmem</code>
    </span></dt><dd><p>
      The same as <code class="filename">tcp_rmem</code>, but for Memory Send Buffer
      per connection.
     </p></dd><dt id="id-1.7.7.5.4.8.4"><span class="term "><code class="filename">/proc/sys/net/core/rmem_max</code>
    </span></dt><dd><p>
      Set to limit the maximum receive buffer size that applications can
      request.
     </p></dd><dt id="id-1.7.7.5.4.8.5"><span class="term "><code class="filename">/proc/sys/net/core/wmem_max</code>
    </span></dt><dd><p>
      Set to limit the maximum send buffer size that applications can
      request.
     </p></dd></dl></div><p>
   Via <code class="filename">/proc</code> it is possible to disable TCP features
   that you do not need (all TCP features are switched on by default). For
   example, check the following files:
  </p><div class="variablelist "><dl class="variablelist"><dt id="id-1.7.7.5.4.10.1"><span class="term "><code class="filename">/proc/sys/net/ipv4/tcp_timestamps</code>
    </span></dt><dd><p>
      TCP time stamps are defined in RFC1323.
     </p></dd><dt id="id-1.7.7.5.4.10.2"><span class="term "><code class="filename">/proc/sys/net/ipv4/tcp_window_scaling</code>
    </span></dt><dd><p>
      TCP window scaling is also defined in RFC1323.
     </p></dd><dt id="id-1.7.7.5.4.10.3"><span class="term "><code class="filename">/proc/sys/net/ipv4/tcp_sack</code>
    </span></dt><dd><p>
      Select acknowledgments (SACKS).
     </p></dd></dl></div><p>
   Use <code class="command">sysctl</code> to read or write variables of the
   <code class="filename">/proc</code> file system. <code class="command">sysctl</code> is
   preferable to <code class="command">cat</code> (for reading) and
   <code class="command">echo</code> (for writing), because it also reads settings
   from <code class="filename">/etc/sysctl.conf</code> and, thus, those settings
   survive reboots reliably. With <code class="command">sysctl</code> you can read all
   variables and their values easily; as <code class="systemitem">root</code> use the following
   command to list TCP related settings:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> sysctl -a | grep tcp</pre></div><div id="id-1.7.7.5.4.13" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg" /><h6>Note: Side effects of tuning network variables</h6><p>
    Tuning network variables can affect other system resources such as CPU
    or memory use.


   </p></div></div><div class="sect1 " id="sec-tuning-network-analyzing"><div class="titlepage"><div><div><h2 class="title"><span class="number">16.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Detecting network bottlenecks and analyzing network traffic</span> <a title="Permalink" class="permalink" href="cha-tuning-network.html#sec-tuning-network-analyzing">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/tuning_network.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>tuning_network.xml</li><li><span class="ds-label">ID: </span>sec-tuning-network-analyzing</li></ul></div></div></div></div><p>
   Before starting with network tuning, it is important to isolate network
   bottlenecks and network traffic patterns. There are certain tools that can
   help you with detecting those bottlenecks.
  </p><p>
   The following tools can help analyzing your network traffic:
   <code class="command">netstat</code>, <code class="command">tcpdump</code>, and
   <code class="command">wireshark</code>. Wireshark is a network traffic analyzer.
  </p></div><div class="sect1 " id="sec-tuning-network-netfilter"><div class="titlepage"><div><div><h2 class="title"><span class="number">16.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Netfilter</span> <a title="Permalink" class="permalink" href="cha-tuning-network.html#sec-tuning-network-netfilter">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/tuning_network.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>tuning_network.xml</li><li><span class="ds-label">ID: </span>sec-tuning-network-netfilter</li></ul></div></div></div></div><p>
   The Linux firewall and masquerading features are provided by the
   Netfilter kernel modules. This is a highly configurable rule based
   framework. If a rule matches a packet, Netfilter accepts or denies it or
   takes special action (<span class="quote">“<span class="quote ">target</span>”</span>) as defined by rules such as
   address translation.
  </p><p>
   There are many properties Netfilter can take into account.
   Thus, the more rules are defined, the longer packet processing may last.
   Also advanced connection tracking could be rather expensive and, thus,
   slowing down overall networking.
  </p><p>
   When the kernel queue becomes full, all new packets are dropped, causing
   existing connections to fail. The 'fail-open' feature allows a user to
   temporarily disable the packet inspection and maintain the connectivity
   under heavy network traffic. For reference, see <a class="link" href="https://home.regit.org/netfilter-en/using-nfqueue-and-libnetfilter_queue/" target="_blank">https://home.regit.org/netfilter-en/using-nfqueue-and-libnetfilter_queue/</a>.
  </p><p>
   For more information, see the home page of the Netfilter and iptables
   project, <a class="link" href="https://www.netfilter.org" target="_blank">https://www.netfilter.org</a>.
  </p></div><div class="sect1 " id="sec-tuning-network-rps"><div class="titlepage"><div><div><h2 class="title"><span class="number">16.4 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Improving the network performance with receive packet steering (RPS)</span> <a title="Permalink" class="permalink" href="cha-tuning-network.html#sec-tuning-network-rps">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/tuning_network.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>tuning_network.xml</li><li><span class="ds-label">ID: </span>sec-tuning-network-rps</li></ul></div></div></div></div><p>
   Modern network interface devices can move so many packets that the host
   can become the limiting factor for achieving maximum performance.
   To keep up, the system must be able to distribute the work across
   multiple CPU cores.
  </p><p>
   Some modern network interfaces can help distribute the work to multiple
   CPU cores through the implementation of multiple transmission and
   multiple receive queues in hardware. However, others are only equipped
   with a single queue and the driver must deal with all incoming packets in
   a single, serialized stream. To work around this issue, the operating
   system must <span class="quote">“<span class="quote ">parallelize</span>”</span> the stream to distribute the work across
   multiple CPUs. On <span class="productname"><span class="phrase">openSUSE Leap</span></span> this is done via Receive Packet
   Steering (RPS). RPS can also be used in virtual environments.
  </p><p>
   RPS creates a unique hash for each data stream using IP addresses and
   port numbers. The use of this hash ensures that packets for the same data
   stream are sent to the same CPU, which helps to increase performance.
  </p><p>
   RPS is configured per network device receive queue and interface. The
   configuration file names match the following scheme:
  </p><div class="verbatim-wrap"><pre class="screen">/sys/class/net/<em class="replaceable ">&lt;device&gt;</em>/queues/<em class="replaceable ">&lt;rx-queue&gt;</em>/rps_cpus</pre></div><p>
   <em class="replaceable ">&lt;device&gt;</em> stands for the network
   device, such as <code class="literal">eth0</code>, <code class="literal">eth1</code>.
   <em class="replaceable ">&lt;rx-queue&gt;</em> stands for the receive queue,
   such as <code class="literal">rx-0</code>, <code class="literal">rx-1</code>.
  </p><p>
   If the network interface hardware only supports a single receive queue,
   only <code class="literal">rx-0</code> exists. If it supports multiple receive
   queues, there is an rx-<em class="replaceable ">N</em> directory for
   each receive queue.
  </p><p>
   These configuration files contain a comma-delimited list of CPU bitmaps.
   By default, all bits are set to <code class="literal">0</code>. With this setting,
   RPS is disabled and therefore the CPU that handles the interrupt also processes the packet queue.
  </p><p>
   To enable RPS and enable specific CPUs to process packets for the receive
   queue of the interface, set the value of their positions in the bitmap to
   <code class="literal">1</code>. For example, to enable CPUs 0-3 to process packets
   for the first receive queue for eth0, set the bit positions
   0-3 to 1 in binary: <code class="literal">00001111</code>. This representation then
   needs to be converted to hex—which results in <code class="literal">F</code> in
   this case. Set this hex value with the following command:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> echo "f" &gt; /sys/class/net/eth0/queues/rx-0/rps_cpus</pre></div><p>
   If you wanted to enable CPUs 8-15:
  </p><div class="verbatim-wrap"><pre class="screen">1111 1111 0000 0000 (binary)
15     15    0    0 (decimal)
F       F    0    0 (hex)</pre></div><p>
   The command to set the hex value of <code class="literal">ff00</code> would be:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> echo "ff00" &gt; /sys/class/net/eth0/queues/rx-0/rps_cpus</pre></div><p>
   On NUMA machines, best performance can be achieved by configuring RPS to
   use the CPUs on the same NUMA node as the interrupt for the interface's
   receive queue.
  </p><p>
   On non-NUMA machines, all CPUs can be used. If the interrupt rate is high, excluding the CPU handling the network interface can boost
   performance. The CPU being used for the network interface can be
   determined from <code class="filename">/proc/interrupts</code>. For example:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> cat /proc/interrupts
            CPU0       CPU1       CPU2       CPU3
...
  51:  113915241          0          0          0      Phys-fasteoi   eth0
...</pre></div><p>
   In this case, <code class="literal">CPU 0</code> is the only CPU processing
   interrupts for <code class="literal">eth0</code>, since only
   <code class="literal">CPU0</code> contains a non-zero value.
  </p><p>
   On x86 and AMD64/Intel 64 platforms, <code class="command">irqbalance</code> can be used
   to distribute hardware interrupts across CPUs. See <code class="command">man 1
   irqbalance</code> for more details.
  </p></div></div></div><div class="page-bottom"><div id="_bottom-navigation"><a class="nav-link" href="part-tuning-dumps.html"><span class="next-icon">→</span><span class="nav-label"><span class="number">Part VI </span>Handling system dumps</span></a><a class="nav-link" href="cha-tuning-memory.html"><span class="prev-icon">←</span><span class="nav-label"><span class="number">Chapter 15 </span>Tuning the memory management subsystem</span></a></div><div class="_share-print"><div class="online-contents share"><strong>Share this page: </strong><span class="share-buttons"><span class="_share-fb bottom-button">Facebook</span><span class="spacer"> • </span><span class="_share-in bottom-button">LinkedIn</span><span class="spacer"> • </span><span class="_share-tw bottom-button">Twitter</span><span class="spacer"> • </span><span class="_share-mail bottom-button">E-Mail</span></span></div><div class="print"><span class="_print-button bottom-button">Print this page</span></div><div class="clearme"></div></div></div></div><div id="_inward"></div></div><div id="_footer-wrap"><div id="_footer"><p>©
        2024 
        SUSE</p><ul><li><a href="https://jobs.suse.com/" target="_top">Careers</a></li><li><a href="https://www.suse.com/company/legal/" target="_top">Legal</a></li><li><a href="https://www.suse.com/company/about/" target="_top">About</a></li><li><a href="https://www.suse.com/contact/" target="_top">Contact Us</a></li></ul></div></div></body></html>