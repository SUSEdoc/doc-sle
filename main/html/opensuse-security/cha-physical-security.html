<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Physical security | Security and Hardening Guide | openSUSE Leap 15.6</title><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" /><link rel="stylesheet" type="text/css" href="static/css/style.css" /><link rel="stylesheet" type="text/css" href="static/css/highlight.css" />
<meta name="title" content="Physical security | openSUSE Leap 15.6" />
<meta name="description" content="Physical security is important. Linux production servers should be in locked data centers accessible to people that have passed security checks. Depending on t…" />
<meta name="product-name" content="openSUSE Leap" />
<meta name="product-number" content="15.6" />
<meta name="book-title" content="Security and Hardening Guide" />
<meta name="chapter-title" content="Chapter 9. Physical security" />
<meta name="tracker-url" content="https://bugzilla.opensuse.org/enter_bug.cgi" />
<meta name="tracker-type" content="bsc" />
<meta name="tracker-bsc-assignee" content="fs@suse.com" />
<meta name="tracker-bsc-component" content="Documentation" />
<meta name="tracker-bsc-product" content="openSUSE Distribution" />
<meta name="tracker-bsc-version" content="Leap 15.4" />
<meta property="og:title" content="Physical security | openSUSE Leap 15.6" />
<meta property="og:description" content="Physical security is important. Linux production servers should be in locked data centers accessible to people that have passed security checks. Depending on t…" />
<meta property="og:type" content="article" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Physical security | openSUSE Leap 15.6" />
<meta name="twitter:description" content="Physical security is important. Linux production servers should be in locked data centers accessible to people that have passed security checks. Depending on t…" />
<link rel="home" href="index.html" title="openSUSE Leap Documentation" /><link rel="up" href="part-local-security.html" title="Part II. Local security" /><link rel="prev" href="part-local-security.html" title="Part II. Local security" /><link rel="next" href="sec-sec-software-management.html" title="Chapter 10. Software management" />
<script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css" /></noscript><script src="static/js/jquery-1.12.4.min.js" type="text/javascript"></script><script src="static/js/script.js" type="text/javascript"></script><script src="static/js/highlight.min.js" type="text/javascript"></script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-navigation">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><div id="_outer-wrap"><div id="_white-bg" style="background-color: #E11;"><div id="_header"><div id="_logo"><img src="static/images/logo.svg" alt="Logo" /></div><div class="crumbs"><a class="book-link" href="index.html" title="Security and Hardening Guide"><span class="book-icon">Security and Hardening Guide</span></a><span> › </span><a class="crumb" href="part-local-security.html">Local security</a><span> › </span><a class="crumb" href="cha-physical-security.html">Physical security</a></div><div class="clearme"></div></div></div><div id="_toolbar-wrap"><div id="_toolbar"><div id="_toc-area" class="inactive"><a id="_toc-area-button" class="tool" title="Contents" accesskey="c" href="index.html"><span class="tool-spacer"><span class="toc-icon">Contents</span><span class="clearme"></span></span><span class="tool-label">Contents</span></a><div class="active-contents bubble-corner"></div><div class="active-contents bubble"><div class="bubble-container"><h6>Security and Hardening Guide</h6><div id="_bubble-toc"><ol><li class="inactive"><a href="preface-security.html"><span class="number"> </span><span class="name">Preface</span></a></li><li class="inactive"><a href="cha-security.html"><span class="number">1 </span><span class="name">Security and confidentiality</span></a></li><li class="inactive"><a href="part-auth.html"><span class="number">I </span><span class="name">Authentication</span></a><ol><li class="inactive"><a href="cha-pam.html"><span class="number">2 </span><span class="name">Authentication with PAM</span></a></li><li class="inactive"><a href="cha-nis.html"><span class="number">3 </span><span class="name">Using NIS</span></a></li><li class="inactive"><a href="cha-security-auth.html"><span class="number">4 </span><span class="name">Setting up authentication clients using YaST</span></a></li><li class="inactive"><a href="cha-security-ldap.html"><span class="number">5 </span><span class="name">LDAP with 389 Directory Server</span></a></li><li class="inactive"><a href="cha-security-kerberos.html"><span class="number">6 </span><span class="name">Network authentication with Kerberos</span></a></li><li class="inactive"><a href="cha-security-ad.html"><span class="number">7 </span><span class="name">Active Directory support</span></a></li><li class="inactive"><a href="cha-security-freeradius.html"><span class="number">8 </span><span class="name">Setting up a freeRADIUS server</span></a></li></ol></li><li class="inactive"><a href="part-local-security.html"><span class="number">II </span><span class="name">Local security</span></a><ol><li class="inactive"><a href="cha-physical-security.html"><span class="number">9 </span><span class="name">Physical security</span></a></li><li class="inactive"><a href="sec-sec-software-management.html"><span class="number">10 </span><span class="name">Software management</span></a></li><li class="inactive"><a href="sec-sec-file-management.html"><span class="number">11 </span><span class="name">File management</span></a></li><li class="inactive"><a href="cha-security-cryptofs.html"><span class="number">12 </span><span class="name">Encrypting partitions and files</span></a></li><li class="inactive"><a href="cha-configure-cryptctl.html"><span class="number">13 </span><span class="name">Storage encryption for hosted applications with cryptctl</span></a></li><li class="inactive"><a href="sec-sec-user-management.html"><span class="number">14 </span><span class="name">User management</span></a></li><li class="inactive"><a href="cha-sec-cron-at.html"><span class="number">15 </span><span class="name">Restricting <code class="systemitem">cron</code> and <code class="systemitem">at</code></span></a></li><li class="inactive"><a href="cha-spectre.html"><span class="number">16 </span><span class="name">Spectre/Meltdown checker</span></a></li><li class="inactive"><a href="cha-security-yast-security.html"><span class="number">17 </span><span class="name">Configuring security settings with YaST</span></a></li><li class="inactive"><a href="cha-security-polkit.html"><span class="number">18 </span><span class="name">The Polkit authentication framework</span></a></li><li class="inactive"><a href="cha-security-acls.html"><span class="number">19 </span><span class="name">Access control lists in Linux</span></a></li><li class="inactive"><a href="cha-aide.html"><span class="number">20 </span><span class="name">Intrusion detection with AIDE</span></a></li></ol></li><li class="inactive"><a href="part-network-security.html"><span class="number">III </span><span class="name">Network security</span></a><ol><li class="inactive"><a href="cha-xauth.html"><span class="number">21 </span><span class="name">X Window System and X authentication</span></a></li><li class="inactive"><a href="cha-ssh.html"><span class="number">22 </span><span class="name">Securing network operations with OpenSSH</span></a></li><li class="inactive"><a href="cha-security-firewall.html"><span class="number">23 </span><span class="name">Masquerading and firewalls</span></a></li><li class="inactive"><a href="cha-security-vpnserver.html"><span class="number">24 </span><span class="name">Configuring a VPN server</span></a></li><li class="inactive"><a href="cha-security-xca.html"><span class="number">25 </span><span class="name">Managing a PKI with XCA, X certificate and key manager</span></a></li><li class="inactive"><a href="cha-sec-sysctl.html"><span class="number">26 </span><span class="name">Improving network security with <code class="command">sysctl</code> variables</span></a></li></ol></li><li class="inactive"><a href="part-apparmor.html"><span class="number">IV </span><span class="name">Confining privileges with <span class="phrase">AppArmor</span></span></a><ol><li class="inactive"><a href="cha-apparmor-intro.html"><span class="number">27 </span><span class="name">Introducing <span class="phrase">AppArmor</span></span></a></li><li class="inactive"><a href="cha-apparmor-start.html"><span class="number">28 </span><span class="name">Getting started</span></a></li><li class="inactive"><a href="cha-apparmor-concept.html"><span class="number">29 </span><span class="name">Immunizing programs</span></a></li><li class="inactive"><a href="cha-apparmor-profiles.html"><span class="number">30 </span><span class="name">Profile components and syntax</span></a></li><li class="inactive"><a href="cha-apparmor-repos.html"><span class="number">31 </span><span class="name"><span class="phrase">AppArmor</span> profile repositories</span></a></li><li class="inactive"><a href="cha-apparmor-yast.html"><span class="number">32 </span><span class="name">Building and managing profiles with YaST</span></a></li><li class="inactive"><a href="cha-apparmor-commandline.html"><span class="number">33 </span><span class="name">Building profiles from the command line</span></a></li><li class="inactive"><a href="cha-apparmor-hat.html"><span class="number">34 </span><span class="name">Profiling your Web applications using ChangeHat</span></a></li><li class="inactive"><a href="cha-apparmor-pam.html"><span class="number">35 </span><span class="name">Confining users with <code class="systemitem">pam_apparmor</code></span></a></li><li class="inactive"><a href="cha-apparmor-managing.html"><span class="number">36 </span><span class="name">Managing profiled applications</span></a></li><li class="inactive"><a href="cha-apparmor-support.html"><span class="number">37 </span><span class="name">Support</span></a></li><li class="inactive"><a href="cha-apparmor-glossary.html"><span class="number">38 </span><span class="name"><span class="phrase">AppArmor</span> glossary</span></a></li></ol></li><li class="inactive"><a href="part-selinux.html"><span class="number">V </span><span class="name">SELinux</span></a><ol><li class="inactive"><a href="cha-selinux.html"><span class="number">39 </span><span class="name">Configuring SELinux</span></a></li></ol></li><li class="inactive"><a href="part-audit.html"><span class="number">VI </span><span class="name">The Linux Audit Framework</span></a><ol><li class="inactive"><a href="cha-audit-comp.html"><span class="number">40 </span><span class="name">Understanding Linux audit</span></a></li><li class="inactive"><a href="cha-audit-setup.html"><span class="number">41 </span><span class="name">Setting up the Linux audit framework</span></a></li><li class="inactive"><a href="cha-audit-scenarios.html"><span class="number">42 </span><span class="name">Introducing an audit rule set</span></a></li><li class="inactive"><a href="cha-audit-moreinfo.html"><span class="number">43 </span><span class="name">Useful resources</span></a></li></ol></li><li class="inactive"><a href="bk04apa.html"><span class="number">A </span><span class="name">GNU licenses</span></a></li></ol></div><div class="clearme"></div></div></div></div><div id="_nav-area" class="inactive"><div class="tool"><span class="nav-inner"><span class="tool-label">Navigation</span><a accesskey="p" class="tool-spacer" title="Part II. Local security" href="part-local-security.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 10. Software management" href="sec-sec-software-management.html"><span class="next-icon">→</span></a></span></div></div></div></div><div id="_fixed-header-wrap" style="background-color: #E11;" class="inactive"><div id="_fixed-header"><div class="crumbs"><a class="book-link" href="index.html" title="Security and Hardening Guide"><span class="book-icon">Security and Hardening Guide</span></a><span> › </span><a class="crumb" href="part-local-security.html">Local security</a><span> › </span><a class="crumb" href="cha-physical-security.html">Physical security</a></div><div class="buttons"><a class="top-button button" href="#">Top</a><div class="button"><a accesskey="p" class="tool-spacer" title="Part II. Local security" href="part-local-security.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 10. Software management" href="sec-sec-software-management.html"><span class="next-icon">→</span></a></div><div class="clearme"></div></div><div class="clearme"></div></div></div><div id="_content" class="draft "><div class="documentation"><div class="chapter " id="cha-physical-security"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname "><span class="productname"><span class="phrase">openSUSE Leap</span></span></span> <span class="productnumber "><span class="productnumber"><span class="phrase">15.6</span></span></span></div><div><h2 class="title"><span class="number">9 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Physical security</span> <a title="Permalink" class="permalink" href="cha-physical-security.html#">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/physical_security.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>physical_security.xml</li><li><span class="ds-label">ID: </span>cha-physical-security</li></ul></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="cha-physical-security.html#sec-sec-prot-general-physical-locks"><span class="number">9.1 </span><span class="name">System locks</span></a></span></dt><dt><span class="sect1"><a href="cha-physical-security.html#sec-sec-prot-general-bios"><span class="number">9.2 </span><span class="name">Locking down the BIOS</span></a></span></dt><dt><span class="sect1"><a href="cha-physical-security.html#sec-sec-prot-general-bootloader"><span class="number">9.3 </span><span class="name">Security via the boot loaders</span></a></span></dt><dt><span class="sect1"><a href="cha-physical-security.html#sec-sec-prot-general-retiring"><span class="number">9.4 </span><span class="name">Retiring Linux servers with sensitive data</span></a></span></dt><dt><span class="sect1"><a href="cha-physical-security.html#sec-sec-prot-general-removable-media"><span class="number">9.5 </span><span class="name">Restricting access to removable media</span></a></span></dt><dt><span class="sect1"><a href="cha-physical-security.html#sec-USBGuard"><span class="number">9.6 </span><span class="name">System protection with enforced USB device authorization via <span class="emphasis"><em>USBGuard</em></span></span></a></span></dt></dl></div></div><p>
    Physical security is important. Linux production
    servers should be in locked data centers accessible to people that
    have passed security checks. Depending on the environment and
    circumstances, you can also consider boot loader passwords.
   </p><p>
    Additionally, consider questions like:
   </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      Who has direct physical access to the host?
     </p></li><li class="listitem "><p>
      Of those that do, should they?
     </p></li><li class="listitem "><p>
      Can the host be protected from tampering and should it be?
     </p></li></ul></div><p>
    The amount of physical security needed on a particular system depends on
    the situation, and can also vary widely depending on available funds.
   </p><div class="sect1 " id="sec-sec-prot-general-physical-locks"><div class="titlepage"><div><div><h2 class="title"><span class="number">9.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">System locks</span> <a title="Permalink" class="permalink" href="cha-physical-security.html#sec-sec-prot-general-physical-locks">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/physical_security.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>physical_security.xml</li><li><span class="ds-label">ID: </span>sec-sec-prot-general-physical-locks</li></ul></div></div></div></div><p>
     Most server racks in data centers include a locking feature. This
     is a hasp/cylinder lock on the front of the rack that allows you to
     turn an included key to a locked or unlocked position—granting or
     denying entry. Cage locks can help prevent someone from tampering or
     stealing devices/media from the servers, or opening the cases and
     directly manipulating/sabotaging the hardware. Preventing system reboots
     or the booting from alternate devices is also important (for example
     CD, DVDs, flash disks, etc.).
    </p><p>
     Some servers also have case locks. These locks can do different things
     according to the designs of the system vendor and construction. Many
     systems are designed to self-disable if attempts are made to open the
     system without unlocking. Others have device covers that do not let you
     plug in or unplug keyboards or mice. While locks are sometimes a useful
     feature, they are lower quality and easily defeated by attackers
     with ill intent.
    </p></div><div class="sect1 " id="sec-sec-prot-general-bios"><div class="titlepage"><div><div><h2 class="title"><span class="number">9.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Locking down the BIOS</span> <a title="Permalink" class="permalink" href="cha-physical-security.html#sec-sec-prot-general-bios">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/physical_security.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>physical_security.xml</li><li><span class="ds-label">ID: </span>sec-sec-prot-general-bios</li></ul></div></div></div></div><div id="id-1.6.5.2.8.2" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.svg" /><h6>Tip: Secure boot</h6><p>
     This section describes basic methods to secure the boot process. To
     find out about more advanced boot protection using UEFI and the
     secure boot feature, see <span class="intraxref">Book “Reference”, Chapter 14 “UEFI (Unified Extensible Firmware Interface)”, Section 14.1 “Secure boot”</span>.
    </p></div><p>
    The BIOS (Basic Input/Output System) or its successor UEFI (Unified
    Extensible Firmware Interface) is the lowest level of software/firmware
    on PC class systems. Other hardware types (POWER, IBM Z) that run
    Linux have low-level firmware that performs similar functions as the
    PC BIOS. When this document references the BIOS, it means BIOS
    and/or UEFI.
    The BIOS dictates system configuration, puts the system into a well
    defined state and provides routines for accessing low-level hardware.
    The BIOS executes the configured Linux boot loader (like GRUB 2) to
    boot the host.
   </p><p>
    Most BIOS implementations can be configured to prevent unauthorized users
    from manipulating system and boot settings. This is typically done by
    setting a BIOS administrator or boot password. The administrator password needs to
    be entered for changing the system configuration but the boot password
    is required during every normal boot. For most use cases, it is
    enough to set an administrator password and restrict booting to the built-in
    hard disk. This way an attacker is not able to simply boot a Linux
    live CD or flash drive, for example. Although this does not provide a
    high level of security (a BIOS can be reset, removed or
    modified—assuming case access), it can be another deterrent.
   </p><p>
    Many BIOS firmware implementations have other security-related
    settings. Check with the system vendor, the system documentation, or examine
    the BIOS during a system boot to find out more.
   </p><div id="id-1.6.5.2.8.6" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg" /><h6>Important: Booting when a BIOS boot password is set</h6><p>
     If a system has been set up with a boot password, the host does not boot
     up unattended (for example, in case of a system reboot or power failure).
     This is a trade-off.
    </p></div><div id="id-1.6.5.2.8.7" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg" /><h6>Important: Losing the BIOS administrator password</h6><p>
     Once a system is set up for the first time, the BIOS administrator password is
     not required often. Do not forget the password or you may need to clear
     the BIOS memory via hardware manipulation to get access again.
    </p></div></div><div class="sect1 " id="sec-sec-prot-general-bootloader"><div class="titlepage"><div><div><h2 class="title"><span class="number">9.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Security via the boot loaders</span> <a title="Permalink" class="permalink" href="cha-physical-security.html#sec-sec-prot-general-bootloader">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/physical_security.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>physical_security.xml</li><li><span class="ds-label">ID: </span>sec-sec-prot-general-bootloader</li></ul></div></div></div></div><p>
    The Linux boot loader GRUB 2, which is used by default in <span class="productname"><span class="phrase">openSUSE Leap</span></span>
    can have a boot password set. It also provides a password feature, so
    that only administrators can start the interactive operations (for example
    editing menu entries and entering the command line interface). If a
    password is specified, GRUB 2 disallows any interactive control until
    you press the key <span class="keycap">C</span> and <span class="keycap">E</span> and enter a
    correct password.
   </p><p>
    You can refer to the GRUB 2 man page for examples.
   </p><p>
    It is important to keep in mind that when setting these passwords
    they need to be remembered. Also, enabling these passwords can
    merely slow an intrusion, not necessarily prevent it. Again, someone could
    boot from a removable device, and mount your root partition. If you are
    using BIOS-level security and a boot loader, it is a good practice to
    disable the ability to boot from removable devices in your computer's
    BIOS, and then password-protect the BIOS itself.
   </p><p>
    Also keep in mind that the boot loader configuration files need to be
    protected by changing their mode to <code class="literal">600</code> (read/write for
    <code class="systemitem">root</code> only), or others can read your passwords or hashes.
   </p></div><div class="sect1 " id="sec-sec-prot-general-retiring"><div class="titlepage"><div><div><h2 class="title"><span class="number">9.4 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Retiring Linux servers with sensitive data</span> <a title="Permalink" class="permalink" href="cha-physical-security.html#sec-sec-prot-general-retiring">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/physical_security.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>physical_security.xml</li><li><span class="ds-label">ID: </span>sec-sec-prot-general-retiring</li></ul></div></div></div></div><p>

    Security policies contain certain procedures for the treatment of
    storage media that is going to be retired or disposed of. Disk and media
    wipe procedures are frequently prescribed, as is complete destruction of
    the media. You can find several free tools on the Internet. A search for
    <span class="quote">“<span class="quote ">dod disk wipe utility</span>”</span> yields several variants. To
    retire servers with sensitive data, it is important to ensure that data
    cannot be recovered from the hard disks. To ensure that all traces of data
    are removed, a wipe utility—such as
    <code class="command">scrub</code>—can be used. Many wipe utilities overwrite
    the data several times. This assures that even sophisticated methods are
    not able to retrieve any parts of the wiped data. Some tools can even be
    operated from a bootable removable device and remove data according to the
    U.S. Department of Defense (DoD) standards. Many government
    agencies specify their own standards for data security. Some standards are
    stronger than others, yet may require more time to implement.
   </p><div id="id-1.6.5.2.10.3" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg" /><h6>Important: Wiping wear leveling devices</h6><p>
     Some devices, like SSDs, use wear leveling and do not necessarily write
     new data in the same physical locations. Such devices provide
     their own erasing functionality.
    </p></div><div class="sect2 " id="sec-sec-prot-general-retiring-scrub"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.4.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">scrub: disk overwrite utility</span> <a title="Permalink" class="permalink" href="cha-physical-security.html#sec-sec-prot-general-retiring-scrub">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/physical_security.xml" title="Edit the source file for this section">Edit source</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>physical_security.xml</li><li><span class="ds-label">ID: </span>sec-sec-prot-general-retiring-scrub</li></ul></div></div></div></div><p>
     <code class="command">scrub</code> overwrites hard disks, files and other devices
     with repeating patterns intended to make recovering data from these
     devices more difficult. It operates in three basic modes: on a character
     or block device, on a file, or on a specified directory. For more
     information, see the manual page <code class="command">man 1 scrub</code>.
    </p><div class="variablelist "><div class="variablelist-title-wrap"><h6 class="variablelist-title"><span class="name">Supported scrub methods </span><a title="Permalink" class="permalink" href="cha-physical-security.html#id-1.6.5.2.10.4.3">#</a></h6></div><dl class="variablelist"><dt id="id-1.6.5.2.10.4.3.2"><span class="term ">nnsa</span></dt><dd><p>
        4-pass NNSA Policy Letter NAP-14.1-C (XVI-8) for sanitizing removable
        and non-removable hard disks, which requires overwriting all locations
        with a pseudo-random pattern twice and then with a known pattern:
        random (x2), 0x00, verify.
       </p></dd><dt id="id-1.6.5.2.10.4.3.3"><span class="term ">dod</span></dt><dd><p>
        4-pass DoD 5220.22-M section 8-306 procedure (d) for sanitizing
        removable and non-removable rigid disks. This requires overwriting all
        addressable locations with a character, its complement, a random
        character and then verifying. Note: scrub performs the random pass first to
        make verification easier: random, 0x00, 0xff, verify.
       </p></dd><dt id="id-1.6.5.2.10.4.3.4"><span class="term ">bsi</span></dt><dd><p>
        9-pass method recommended by the German Center of Security in
        Information Technologies
        (<a class="link" href="https://www.bsi.bund.de" target="_blank">https://www.bsi.bund.de</a>): 0xff, 0xfe, 0xfd, 0xfb,
        0xf7, 0xef, 0xdf, 0xbf, 0x7f.
       </p></dd><dt id="id-1.6.5.2.10.4.3.5"><span class="term ">gutmann</span></dt><dd><p>
        The canonical 35-pass sequence described in Gutmann's paper cited
        below.
       </p></dd><dt id="id-1.6.5.2.10.4.3.6"><span class="term ">schneier</span></dt><dd><p>
        7-pass method described by Bruce Schneier in "Applied Cryptography"
        (1996): 0x00, 0xff, random (x5)
       </p></dd><dt id="id-1.6.5.2.10.4.3.7"><span class="term ">pfitzner7</span></dt><dd><p>
        Roy Pfitzner's 7-random-pass method: random (x7).
       </p></dd><dt id="id-1.6.5.2.10.4.3.8"><span class="term ">pfitzner33</span></dt><dd><p>
        Roy Pfitzner's 33-random-pass method: random (x33).
       </p></dd><dt id="id-1.6.5.2.10.4.3.9"><span class="term ">usarmy</span></dt><dd><p>
        US Army AR380-19 method: 0x00, 0xff, random. (Note: identical to DoD
        522.22-M section 8-306 procedure (e) for sanitizing magnetic core
        memory).
       </p></dd><dt id="id-1.6.5.2.10.4.3.10"><span class="term ">fillzero</span></dt><dd><p>
        1-pass pattern: 0x00.
       </p></dd><dt id="id-1.6.5.2.10.4.3.11"><span class="term ">fillff</span></dt><dd><p>
        1-pass pattern: 0xff.
       </p></dd><dt id="id-1.6.5.2.10.4.3.12"><span class="term ">random</span></dt><dd><p>
        1-pass pattern: random (x1).
       </p></dd><dt id="id-1.6.5.2.10.4.3.13"><span class="term ">random2</span></dt><dd><p>
        2-pass pattern: random (x2).
       </p></dd><dt id="id-1.6.5.2.10.4.3.14"><span class="term ">old</span></dt><dd><p>
        6-pass pre-version 1.7 scrub method: 0x00, 0xff, 0xaa, 0x00, 0x55,
        verify.
       </p></dd><dt id="id-1.6.5.2.10.4.3.15"><span class="term ">fastold</span></dt><dd><p>
        5-pass pattern: 0x00, 0xff, 0xaa, 0x55 and verify.
       </p></dd><dt id="id-1.6.5.2.10.4.3.16"><span class="term ">custom=string</span></dt><dd><p>
        1-pass custom pattern. String may contain C-style numerical escapes:
        \nnn (octal) or \xnn (hex).
       </p></dd></dl></div></div></div><div class="sect1 " id="sec-sec-prot-general-removable-media"><div class="titlepage"><div><div><h2 class="title"><span class="number">9.5 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Restricting access to removable media</span> <a title="Permalink" class="permalink" href="cha-physical-security.html#sec-sec-prot-general-removable-media">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/physical_security.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>physical_security.xml</li><li><span class="ds-label">ID: </span>sec-sec-prot-general-removable-media</li></ul></div></div></div></div><p>
     In certain environments, it is required to restrict access to removable
     media such as USB storage or optical devices. The tools included with the
     <code class="systemitem">udisks2</code> package help with such a
     configuration.
    </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
       Create a user group whose users are allowed to mount and eject
       removable devices, for example <em class="replaceable ">mmedia_all</em>:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> groupadd <em class="replaceable ">mmedia_all</em></pre></div></li><li class="step "><p>
       Add a specific user <code class="systemitem">tux</code> to the new group:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> usermod -a -G <em class="replaceable ">mmedia_all</em> <code class="systemitem">tux</code></pre></div></li><li class="step "><p>
       Create the <code class="filename">/etc/polkit-1/rules.d/10-mount.rules</code>
       file with the following content:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code>cat /etc/polkit-1/rules.d/10-mount.rules
polkit.addRule(function(action, subject) {
 if (action.id =="org.freedesktop.udisks2.eject-media"
  &amp;&amp; subject.isInGroup("<em class="replaceable ">mmedia_all</em>")) {
   return polkit.Result.YES;
  }
});

polkit.addRule(function(action, subject) {
 if (action.id =="org.freedesktop.udisks2.filesystem-mount"
  &amp;&amp; subject.isInGroup("<em class="replaceable ">mmedia_all</em>")) {
   return polkit.Result.YES;
  }
});</pre></div><div id="id-1.6.5.2.11.3.3.3" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg" /><h6>Important: Naming of the rules file</h6><p>
        The name of a rules file must start with a digit, otherwise it
        is ignored.
       </p><p>
        Rules files are processed in alphabetical order. Functions are called
        in the order they were added until one of the functions returns a
        value. Therefore, to add an authorization rule that is processed before
        other rules, put it in a file in /etc/polkit-1/rules.d with a name
        that sorts before other rules files, for example
        <code class="filename">/etc/polkit-1/rules.d/10-mount.rules</code>. Each function
        should return a value from <code class="literal">polkit.Result</code>.
       </p></div></li><li class="step "><p>
       Restart <code class="systemitem">udisks2</code>:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>systemctl restart udisks2</pre></div></li><li class="step "><p>
       Restart <code class="systemitem">polkit</code>
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>systemctl restart polkit</pre></div></li></ol></div></div></div><div class="sect1 " id="sec-USBGuard"><div class="titlepage"><div><div><h2 class="title"><span class="number">9.6 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">System protection with enforced USB device authorization via <span class="emphasis"><em>USBGuard</em></span></span> <a title="Permalink" class="permalink" href="cha-physical-security.html#sec-USBGuard">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/physical_security.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>physical_security.xml</li><li><span class="ds-label">ID: </span>sec-USBGuard</li></ul></div></div></div></div><p>
  The USBGuard software framework helps to protect your system with enforced USB device authorization.
  It implements allowlist and blocklist capabilities based on the device attributes.
</p><p>The USBGuard provides the following features:</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
    A command-line interface to interact with a running USBGuard daemon
    </p></li><li class="listitem "><p>The daemon component with an inter-process communication (IPC)
    interface for dynamic interaction and policy enforcement</p></li><li class="listitem "><p>The rule language for writing USB device authorization policies</p></li><li class="listitem "><p>The C++ API for interacting with the daemon component implemented in a shared library</p></li></ul></div><div class="sect2 " id="sec-installing-usbguard"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.6.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Installing USBGuard</span> <a title="Permalink" class="permalink" href="cha-physical-security.html#sec-installing-usbguard">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/physical_security.xml" title="Edit the source file for this section">Edit source</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>physical_security.xml</li><li><span class="ds-label">ID: </span>sec-installing-usbguard</li></ul></div></div></div></div><p> The USBGuard daemon decides which USB device to authorize based on a set of rules defined in the policy.
      To install and configure USBGuard, use the following commands:</p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>To install USBGuard:</p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code>  zypper install usbguard</pre></div><p>USBGuard and the required dependencies are installed. If you want to interact with the USBGuard service, you can
      install <code class="literal">usbguard-tools</code>.</p></li><li class="step "><p>To generate a rule set based on currently connected USB devices, switch to <code class="systemitem">root</code>: </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>usbguard generate-policy &gt; /etc/usbguard/rules.conf</pre></div><div id="id-1.6.5.2.12.5.3.2.3" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg" /><h6>Note</h6><p>You can customize USBGuard by editing the <code class="filename">/etc/usbguard/rules.conf</code>
      file.
      </p></div></li><li class="step "><p> You can start the USBGuard daemon or ensure automatic enablement at
      system start by switching to <code class="systemitem">root</code>:</p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>systemctl enable --now usbguard.service</pre></div></li><li class="step "><p> You can either authorize or deauthorize a device from interacting with the system.
      This depends on the value of the <code class="literal">ImplicitPolicyTarget</code> option in the <code class="filename">usbguard-daemon.conf
      </code> file. This option is used to treat devices that do not match any rule in the policy.
    </p><div class="verbatim-wrap"><pre class="screen">usbguard allow-device 6</pre></div><div class="verbatim-wrap"><pre class="screen">usbguard block-device 6</pre></div><p> You can also use the <code class="command">reject-device</code>option to deauthorize and
        remove a device from the system.
              </p><div id="id-1.6.5.2.12.5.3.4.5" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg" /><h6>Note</h6><p>Use the <code class="command">usbguard --help </code> command to see all the options.</p></div></li></ol></div></div></div><div class="sect2 " id="sec-how-to-use-usbguard"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.6.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">How to use USBGuard</span> <a title="Permalink" class="permalink" href="cha-physical-security.html#sec-how-to-use-usbguard">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/physical_security.xml" title="Edit the source file for this section">Edit source</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>physical_security.xml</li><li><span class="ds-label">ID: </span>sec-how-to-use-usbguard</li></ul></div></div></div></div><p>You can configure a security policy to protect your system with enforced USB device authorization
  by implementing <span class="emphasis"><em>allow</em></span> and <span class="emphasis"><em>block</em></span> lists based on the device attributes.
</p><div class="sect3 " id="id-1.6.5.2.12.6.3"><div class="titlepage"><div><div><h4 class="title"><span class="number">9.6.2.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">The USBGuard configuration file </span> <a title="Permalink" class="permalink" href="cha-physical-security.html#id-1.6.5.2.12.6.3">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/physical_security.xml" title="Edit the source file for this section">Edit source</a></h4><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>physical_security.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>The USBGuard daemon loads the <code class="filename">usbguard-daemon.conf</code> file after the command-line
  options are parsed and are used to configure the runtime parameters of the daemon. The file is, by default, located at
<code class="filename">/etc/usbguard/usbguard-daemon.conf</code>. Some options in the file include:</p><div class="variablelist "><div class="variablelist-title-wrap"><h6 class="variablelist-title"><span class="name">Options </span><a title="Permalink" class="permalink" href="cha-physical-security.html#id-1.6.5.2.12.6.3.3">#</a></h6></div><dl class="variablelist"><dt id="id-1.6.5.2.12.6.3.3.2"><span class="term "><code class="option">RuleFile=<em class="replaceable ">PATH</em></code></span></dt><dd><p>The USBGuard daemon uses this file to load the policy rule set from it and to write
      new rules received through the IPC (inter-process communication) interface.
      The default is <code class="filename">%sysconfdir%/usbguard/rules.conf</code>.</p></dd><dt id="id-1.6.5.2.12.6.3.3.3"><span class="term "><code class="option">ImplicitPolicyTarget= <em class="replaceable ">TARGET</em></code></span></dt><dd><p> How to treat devices that do not match any rule in the policy, for example: </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>allow - authorize every present device</p></li><li class="listitem "><p>block - deauthorize every present device</p></li><li class="listitem "><p>reject - logically remove the device node from the system</p></li></ul></div></dd><dt id="id-1.6.5.2.12.6.3.3.4"><span class="term "><code class="option">PresentDevicePolicy= <em class="replaceable ">POLICY</em></code></span></dt><dd><p>How to treat devices that are already connected when the daemon starts.</p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>allow - authorize every present device</p></li><li class="listitem "><p>block - deauthorize every present device</p></li><li class="listitem "><p>reject - remove every present device</p></li><li class="listitem "><p>keep - sync the internal state </p></li><li class="listitem "><p>apply-policy - evaluate the rule set for all present devices </p></li></ul></div></dd><dt id="id-1.6.5.2.12.6.3.3.5"><span class="term "><code class="option">IPCAllowedUsers= <em class="replaceable ">USERNAME</em></code></span></dt><dd><p>A space-delimited list of user names that the daemon accepts IPC connections from.</p></dd><dt id="id-1.6.5.2.12.6.3.3.6"><span class="term "><code class="option">IPCAllowedGroups= <em class="replaceable ">GROUPNAME</em></code></span></dt><dd><p>A space-delimited list of group names that the daemon accepts IPC connections from.</p></dd><dt id="id-1.6.5.2.12.6.3.3.7"><span class="term "><code class="option">IPCAccessControlFiles= <em class="replaceable ">PATH</em></code></span></dt><dd><p>Path to files that are interpreted by the daemon as IPC access control definition files.</p></dd></dl></div><div class="complex-example"><div class="example" id="usbguard-config-file-ipcaccess"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 9.1: </span><span class="name">Configuration </span><a title="Permalink" class="permalink" href="cha-physical-security.html#usbguard-config-file-ipcaccess">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">IPCAllowedUsers=root joe
IPCAllowedGroups=wheel</pre></div><p>The example allows full IPC access to the users <code class="literal">root</code>, <code class="literal">joe</code>
and to the members of the group <code class="literal">wheel</code>.</p></div></div></div></div></div><div class="sect2 " id="sec-more-information-usbguard"><div class="titlepage"><div><div><h3 class="title"><span class="number">9.6.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">More information</span> <a title="Permalink" class="permalink" href="cha-physical-security.html#sec-more-information-usbguard">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/physical_security.xml" title="Edit the source file for this section">Edit source</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>physical_security.xml</li><li><span class="ds-label">ID: </span>sec-more-information-usbguard</li></ul></div></div></div></div><p>To know more about USBGuard, see: </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
      The upstream documentation at
      <a class="link" href="https://usbguard.github.io/" target="_blank">https://usbguard.github.io/</a>
    </p></li><li class="listitem "><p>
      man <span class="emphasis"><em>usbguard</em></span>
    </p></li><li class="listitem "><p>
      man <span class="emphasis"><em>usbguard-rules.conf</em></span>
    </p></li><li class="listitem "><p>
      man <span class="emphasis"><em>usbguard-daemon</em></span>
    </p></li><li class="listitem "><p>
      man <span class="emphasis"><em>usbguard-daemon.conf</em></span>
    </p></li></ul></div></div></div></div></div><div class="page-bottom"><div id="_bottom-navigation"><a class="nav-link" href="sec-sec-software-management.html"><span class="next-icon">→</span><span class="nav-label"><span class="number">Chapter 10 </span>Software management</span></a><a class="nav-link" href="part-local-security.html"><span class="prev-icon">←</span><span class="nav-label"><span class="number">Part II </span>Local security</span></a></div><div class="_share-print"><div class="online-contents share"><strong>Share this page: </strong><span class="share-buttons"><span class="_share-fb bottom-button">Facebook</span><span class="spacer"> • </span><span class="_share-in bottom-button">LinkedIn</span><span class="spacer"> • </span><span class="_share-tw bottom-button">Twitter</span><span class="spacer"> • </span><span class="_share-mail bottom-button">E-Mail</span></span></div><div class="print"><span class="_print-button bottom-button">Print this page</span></div><div class="clearme"></div></div></div></div><div id="_inward"></div></div><div id="_footer-wrap"><div id="_footer"><p>©
        2024 
        SUSE</p><ul><li><a href="https://jobs.suse.com/" target="_top">Careers</a></li><li><a href="https://www.suse.com/company/legal/" target="_top">Legal</a></li><li><a href="https://www.suse.com/company/about/" target="_top">About</a></li><li><a href="https://www.suse.com/contact/" target="_top">Contact Us</a></li></ul></div></div></body></html>