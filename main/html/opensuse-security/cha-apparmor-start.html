<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Getting started | Security and Hardening Guide | openSUSE Leap 15.7</title><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" /><link rel="stylesheet" type="text/css" href="static/css/style.css" /><link rel="stylesheet" type="text/css" href="static/css/highlight.css" />
<meta name="title" content="Getting started | openSUSE Leap 15.7" />
<meta name="description" content="Prepare a successful deployment of AppArmor on your system by carefully considering the following items:" />
<meta name="product-name" content="openSUSE Leap" />
<meta name="product-number" content="15.7" />
<meta name="book-title" content="Security and Hardening Guide" />
<meta name="chapter-title" content="Chapter 28. Getting started" />
<meta name="tracker-url" content="https://bugzilla.opensuse.org/enter_bug.cgi" />
<meta name="tracker-type" content="bsc" />
<meta name="tracker-bsc-assignee" content="fs@suse.com" />
<meta name="tracker-bsc-component" content="Documentation" />
<meta name="tracker-bsc-product" content="openSUSE Distribution" />
<meta name="tracker-bsc-version" content="Leap 15.4" />
<meta property="og:title" content="Getting started | openSUSE Leap 15.7" />
<meta property="og:description" content="Prepare a successful deployment of AppArmor on your system by carefully considering the following items:" />
<meta property="og:type" content="article" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Getting started | openSUSE Leap 15.7" />
<meta name="twitter:description" content="Prepare a successful deployment of AppArmor on your system by carefully considering the following items:" />
<link rel="home" href="index.html" title="openSUSE Leap Documentation" /><link rel="up" href="part-apparmor.html" title="Part IV. Confining privileges with AppArmor" /><link rel="prev" href="cha-apparmor-intro.html" title="Chapter 27. Introducing AppArmor" /><link rel="next" href="cha-apparmor-concept.html" title="Chapter 29. Immunizing programs" />
<script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css" /></noscript><script src="static/js/jquery-1.12.4.min.js" type="text/javascript"></script><script src="static/js/script.js" type="text/javascript"></script><script src="static/js/highlight.min.js" type="text/javascript"></script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-navigation">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><div id="_outer-wrap"><div id="_white-bg" style="background-color: #E11;"><div id="_header"><div id="_logo"><img src="static/images/logo.svg" alt="Logo" /></div><div class="crumbs"><a class="book-link" href="index.html" title="Security and Hardening Guide"><span class="book-icon">Security and Hardening Guide</span></a><span> › </span><a class="crumb" href="part-apparmor.html">Confining privileges with AppArmor</a><span> › </span><a class="crumb" href="cha-apparmor-start.html">Getting started</a></div><div class="clearme"></div></div></div><div id="_toolbar-wrap"><div id="_toolbar"><div id="_toc-area" class="inactive"><a id="_toc-area-button" class="tool" title="Contents" accesskey="c" href="index.html"><span class="tool-spacer"><span class="toc-icon">Contents</span><span class="clearme"></span></span><span class="tool-label">Contents</span></a><div class="active-contents bubble-corner"></div><div class="active-contents bubble"><div class="bubble-container"><h6>Security and Hardening Guide</h6><div id="_bubble-toc"><ol><li class="inactive"><a href="preface-security.html"><span class="number"> </span><span class="name">Preface</span></a></li><li class="inactive"><a href="cha-security.html"><span class="number">1 </span><span class="name">Security and confidentiality</span></a></li><li class="inactive"><a href="part-auth.html"><span class="number">I </span><span class="name">Authentication</span></a><ol><li class="inactive"><a href="cha-pam.html"><span class="number">2 </span><span class="name">Authentication with PAM</span></a></li><li class="inactive"><a href="cha-nis.html"><span class="number">3 </span><span class="name">Using NIS</span></a></li><li class="inactive"><a href="cha-security-auth.html"><span class="number">4 </span><span class="name">Setting up authentication clients using YaST</span></a></li><li class="inactive"><a href="cha-security-ldap.html"><span class="number">5 </span><span class="name">LDAP with 389 Directory Server</span></a></li><li class="inactive"><a href="cha-security-kerberos.html"><span class="number">6 </span><span class="name">Network authentication with Kerberos</span></a></li><li class="inactive"><a href="cha-security-ad.html"><span class="number">7 </span><span class="name">Active Directory support</span></a></li><li class="inactive"><a href="cha-security-freeradius.html"><span class="number">8 </span><span class="name">Setting up a freeRADIUS server</span></a></li></ol></li><li class="inactive"><a href="part-local-security.html"><span class="number">II </span><span class="name">Local security</span></a><ol><li class="inactive"><a href="cha-physical-security.html"><span class="number">9 </span><span class="name">Physical security</span></a></li><li class="inactive"><a href="sec-sec-software-management.html"><span class="number">10 </span><span class="name">Software management</span></a></li><li class="inactive"><a href="sec-sec-file-management.html"><span class="number">11 </span><span class="name">File management</span></a></li><li class="inactive"><a href="cha-security-cryptofs.html"><span class="number">12 </span><span class="name">Encrypting partitions and files</span></a></li><li class="inactive"><a href="cha-configure-cryptctl.html"><span class="number">13 </span><span class="name">Storage encryption for hosted applications with cryptctl</span></a></li><li class="inactive"><a href="sec-sec-user-management.html"><span class="number">14 </span><span class="name">User management</span></a></li><li class="inactive"><a href="cha-sec-cron-at.html"><span class="number">15 </span><span class="name">Restricting <code class="systemitem">cron</code> and <code class="systemitem">at</code></span></a></li><li class="inactive"><a href="cha-spectre.html"><span class="number">16 </span><span class="name">Spectre/Meltdown checker</span></a></li><li class="inactive"><a href="cha-security-yast-security.html"><span class="number">17 </span><span class="name">Configuring security settings with YaST</span></a></li><li class="inactive"><a href="cha-security-polkit.html"><span class="number">18 </span><span class="name">The Polkit authentication framework</span></a></li><li class="inactive"><a href="cha-security-acls.html"><span class="number">19 </span><span class="name">Access control lists in Linux</span></a></li><li class="inactive"><a href="cha-aide.html"><span class="number">20 </span><span class="name">Intrusion detection with AIDE</span></a></li></ol></li><li class="inactive"><a href="part-network-security.html"><span class="number">III </span><span class="name">Network security</span></a><ol><li class="inactive"><a href="cha-xauth.html"><span class="number">21 </span><span class="name">X Window System and X authentication</span></a></li><li class="inactive"><a href="cha-ssh.html"><span class="number">22 </span><span class="name">Securing network operations with OpenSSH</span></a></li><li class="inactive"><a href="cha-security-firewall.html"><span class="number">23 </span><span class="name">Masquerading and firewalls</span></a></li><li class="inactive"><a href="cha-security-vpnserver.html"><span class="number">24 </span><span class="name">Configuring a VPN server</span></a></li><li class="inactive"><a href="cha-security-xca.html"><span class="number">25 </span><span class="name">Managing a PKI with XCA, X certificate and key manager</span></a></li><li class="inactive"><a href="cha-sec-sysctl.html"><span class="number">26 </span><span class="name">Improving network security with <code class="command">sysctl</code> variables</span></a></li></ol></li><li class="inactive"><a href="part-apparmor.html"><span class="number">IV </span><span class="name">Confining privileges with <span class="phrase">AppArmor</span></span></a><ol><li class="inactive"><a href="cha-apparmor-intro.html"><span class="number">27 </span><span class="name">Introducing <span class="phrase">AppArmor</span></span></a></li><li class="inactive"><a href="cha-apparmor-start.html"><span class="number">28 </span><span class="name">Getting started</span></a></li><li class="inactive"><a href="cha-apparmor-concept.html"><span class="number">29 </span><span class="name">Immunizing programs</span></a></li><li class="inactive"><a href="cha-apparmor-profiles.html"><span class="number">30 </span><span class="name">Profile components and syntax</span></a></li><li class="inactive"><a href="cha-apparmor-repos.html"><span class="number">31 </span><span class="name"><span class="phrase">AppArmor</span> profile repositories</span></a></li><li class="inactive"><a href="cha-apparmor-yast.html"><span class="number">32 </span><span class="name">Building and managing profiles with YaST</span></a></li><li class="inactive"><a href="cha-apparmor-commandline.html"><span class="number">33 </span><span class="name">Building profiles from the command line</span></a></li><li class="inactive"><a href="cha-apparmor-hat.html"><span class="number">34 </span><span class="name">Profiling your Web applications using ChangeHat</span></a></li><li class="inactive"><a href="cha-apparmor-pam.html"><span class="number">35 </span><span class="name">Confining users with <code class="systemitem">pam_apparmor</code></span></a></li><li class="inactive"><a href="cha-apparmor-managing.html"><span class="number">36 </span><span class="name">Managing profiled applications</span></a></li><li class="inactive"><a href="cha-apparmor-support.html"><span class="number">37 </span><span class="name">Support</span></a></li><li class="inactive"><a href="cha-apparmor-glossary.html"><span class="number">38 </span><span class="name"><span class="phrase">AppArmor</span> glossary</span></a></li></ol></li><li class="inactive"><a href="part-selinux.html"><span class="number">V </span><span class="name">SELinux</span></a><ol><li class="inactive"><a href="cha-selinux.html"><span class="number">39 </span><span class="name">Configuring SELinux</span></a></li></ol></li><li class="inactive"><a href="part-audit.html"><span class="number">VI </span><span class="name">The Linux Audit Framework</span></a><ol><li class="inactive"><a href="cha-audit-comp.html"><span class="number">40 </span><span class="name">Understanding Linux audit</span></a></li><li class="inactive"><a href="cha-audit-setup.html"><span class="number">41 </span><span class="name">Setting up the Linux audit framework</span></a></li><li class="inactive"><a href="cha-audit-scenarios.html"><span class="number">42 </span><span class="name">Introducing an audit rule set</span></a></li><li class="inactive"><a href="cha-audit-moreinfo.html"><span class="number">43 </span><span class="name">Useful resources</span></a></li></ol></li><li class="inactive"><a href="bk04apa.html"><span class="number">A </span><span class="name">GNU licenses</span></a></li></ol></div><div class="clearme"></div></div></div></div><div id="_nav-area" class="inactive"><div class="tool"><span class="nav-inner"><span class="tool-label">Navigation</span><a accesskey="p" class="tool-spacer" title="Chapter 27. Introducing AppArmor" href="cha-apparmor-intro.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 29. Immunizing programs" href="cha-apparmor-concept.html"><span class="next-icon">→</span></a></span></div></div></div></div><div id="_fixed-header-wrap" style="background-color: #E11;" class="inactive"><div id="_fixed-header"><div class="crumbs"><a class="book-link" href="index.html" title="Security and Hardening Guide"><span class="book-icon">Security and Hardening Guide</span></a><span> › </span><a class="crumb" href="part-apparmor.html">Confining privileges with AppArmor</a><span> › </span><a class="crumb" href="cha-apparmor-start.html">Getting started</a></div><div class="buttons"><a class="top-button button" href="#">Top</a><div class="button"><a accesskey="p" class="tool-spacer" title="Chapter 27. Introducing AppArmor" href="cha-apparmor-intro.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 29. Immunizing programs" href="cha-apparmor-concept.html"><span class="next-icon">→</span></a></div><div class="clearme"></div></div><div class="clearme"></div></div></div><div id="_content" class="draft "><div class="documentation"><div class="chapter " id="cha-apparmor-start"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname "><span class="productname"><span class="phrase">openSUSE Leap</span></span></span> <span class="productnumber "><span class="productnumber"><span class="phrase">15.7</span></span></span></div><div><h2 class="title"><span class="number">28 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Getting started</span> <a title="Permalink" class="permalink" href="cha-apparmor-start.html#">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/apparmor_start.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>apparmor_start.xml</li><li><span class="ds-label">ID: </span>cha-apparmor-start</li></ul></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="cha-apparmor-start.html#sec-apparmor-start-install"><span class="number">28.1 </span><span class="name">Installing <span class="phrase">AppArmor</span></span></a></span></dt><dt><span class="sect1"><a href="cha-apparmor-start.html#sec-apparmor-start-enable"><span class="number">28.2 </span><span class="name">Enabling and disabling <span class="phrase">AppArmor</span></span></a></span></dt><dt><span class="sect1"><a href="cha-apparmor-start.html#sec-apparmor-start-choose"><span class="number">28.3 </span><span class="name">Choosing applications to profile</span></a></span></dt><dt><span class="sect1"><a href="cha-apparmor-start.html#sec-apparmor-start-build"><span class="number">28.4 </span><span class="name">Building and modifying profiles</span></a></span></dt><dt><span class="sect1"><a href="cha-apparmor-start.html#sec-apparmor-start-update"><span class="number">28.5 </span><span class="name">Updating your profiles</span></a></span></dt></dl></div></div><p>
  Prepare a successful deployment of <span class="phrase">AppArmor</span> on your system by carefully
  considering the following items:
 </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
    Determine the applications to profile. Read more on this in
    <a class="xref" href="cha-apparmor-start.html#sec-apparmor-start-choose" title="28.3. Choosing applications to profile">Section 28.3, “Choosing applications to profile”</a>.
   </p></li><li class="step "><p>
    Build the needed profiles as roughly outlined in
    <a class="xref" href="cha-apparmor-start.html#sec-apparmor-start-build" title="28.4. Building and modifying profiles">Section 28.4, “Building and modifying profiles”</a>. Check the results and adjust
    the profiles when necessary.
   </p></li><li class="step "><p>
    Update your profiles whenever your environment changes or you need to
    react to security events logged by the reporting tool of <span class="phrase">AppArmor</span>. Refer
    to <a class="xref" href="cha-apparmor-start.html#sec-apparmor-start-update" title="28.5. Updating your profiles">Section 28.5, “Updating your profiles”</a>.
   </p></li></ol></div></div><div class="sect1 " id="sec-apparmor-start-install"><div class="titlepage"><div><div><h2 class="title"><span class="number">28.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Installing <span class="phrase">AppArmor</span></span> <a title="Permalink" class="permalink" href="cha-apparmor-start.html#sec-apparmor-start-install">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/apparmor_start.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>apparmor_start.xml</li><li><span class="ds-label">ID: </span>sec-apparmor-start-install</li></ul></div></div></div></div><p>
   <span class="phrase">AppArmor</span> is installed and running on any installation of
   <span class="productname"><span class="phrase">openSUSE® Leap</span></span> by default, regardless of what patterns are
   installed. The packages listed below are needed for a fully functional
   instance of <span class="phrase">AppArmor</span>:
  </p><div class="itemizedlist "><ul class="itemizedlist compact"><li class="listitem "><p>
     <code class="systemitem">apparmor-docs</code>
    </p></li><li class="listitem "><p>
     <code class="systemitem">apparmor-parser</code>
    </p></li><li class="listitem "><p>
     <code class="systemitem">apparmor-profiles</code>
    </p></li><li class="listitem "><p>
     <code class="systemitem">apparmor-utils</code>
    </p></li><li class="listitem "><p>
     <code class="systemitem">audit</code>
    </p></li><li class="listitem "><p>
     <code class="systemitem">libapparmor1</code>
    </p></li><li class="listitem "><p>
     <code class="systemitem">perl-libapparmor</code>
    </p></li><li class="listitem "><p>
     <code class="systemitem">yast2-apparmor</code>
    </p></li></ul></div><div id="id-1.6.7.3.5.4" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.svg" /><h6>Tip</h6><p>
    If <span class="phrase">AppArmor</span> is not installed on your system, install the pattern
    <code class="systemitem">apparmor</code> for a complete
    <span class="phrase">AppArmor</span> installation. Either use the YaST Software Management
    module for installation, or use Zypper on the command line:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> zypper in -t pattern apparmor</pre></div></div></div><div class="sect1 " id="sec-apparmor-start-enable"><div class="titlepage"><div><div><h2 class="title"><span class="number">28.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Enabling and disabling <span class="phrase">AppArmor</span></span> <a title="Permalink" class="permalink" href="cha-apparmor-start.html#sec-apparmor-start-enable">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/apparmor_start.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>apparmor_start.xml</li><li><span class="ds-label">ID: </span>sec-apparmor-start-enable</li></ul></div></div></div></div><p>
   <span class="phrase">AppArmor</span> is configured to run by default on any fresh installation of

   <span class="productname"><span class="phrase">openSUSE Leap</span></span>. There are two ways of toggling the status of <span class="phrase">AppArmor</span>:
  </p><div class="variablelist "><dl class="variablelist"><dt id="id-1.6.7.3.6.3.1"><span class="term ">Using YaST services manager</span></dt><dd><p>
      Disable or enable <span class="phrase">AppArmor</span> by removing or adding its boot script to the
      sequence of scripts executed on system boot. Status changes are
      applied on reboot.
     </p></dd><dt id="id-1.6.7.3.6.3.2"><span class="term ">Using <span class="phrase">AppArmor</span> configuration window</span></dt><dd><p>
      Toggle the status of <span class="phrase">AppArmor</span> in a running system by switching it off
      or on using the YaST <span class="phrase">AppArmor</span> Control Panel. Changes made here are
      applied instantaneously. The Control Panel triggers a stop or start
      event for <span class="phrase">AppArmor</span> and removes or adds its boot script in the system's
      boot sequence.
     </p></dd></dl></div><p>
   To disable <span class="phrase">AppArmor</span> permanently (by removing it from the sequence of
   scripts executed on system boot) proceed as follows:
  </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Start YaST.
    </p></li><li class="step "><p>
     Select <span class="guimenu ">System</span> › <span class="guimenu ">Services
     Manager</span>.
    </p></li><li class="step "><p>
     Mark <code class="literal">apparmor</code> by clicking its row in the list of
     services, then click <span class="guimenu ">Enable/Disable</span> in the lower
     part of the window. Check that <span class="guimenu ">Enabled</span> changed to
     <span class="guimenu ">Disabled</span> in the <code class="literal">apparmor</code> row.
    </p></li><li class="step "><p>
     Confirm with <span class="guimenu ">OK</span>.
    </p></li></ol></div></div><p>
   <span class="phrase">AppArmor</span> is not initialized on reboot and stays inactive until you
   re-enable it. Re-enabling a service using the YaST
   <span class="guimenu ">Services Manager</span> tool is similar to disabling it.
  </p><p>
   Toggle the status of <span class="phrase">AppArmor</span> in a running system by using the <span class="phrase">AppArmor</span>
   Configuration window. These changes take effect when you apply them
   and survive a reboot of the system. To toggle the status of <span class="phrase">AppArmor</span>,
   proceed as follows:
  </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Start YaST, select <span class="guimenu "><span class="phrase">AppArmor</span> Configuration</span>, and
     click <span class="guimenu ">Settings</span> in the main window.
    </p></li><li class="step "><p>
     Enable <span class="phrase">AppArmor</span> by checking <span class="guimenu ">Enable <span class="phrase">AppArmor</span></span> or disable
     <span class="phrase">AppArmor</span> by deselecting it.
    </p></li><li class="step "><p>
     Click <span class="guimenu ">Done</span> in the <span class="guimenu "><span class="phrase">AppArmor</span>
     Configuration</span> window.
    </p></li></ol></div></div></div><div class="sect1 " id="sec-apparmor-start-choose"><div class="titlepage"><div><div><h2 class="title"><span class="number">28.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Choosing applications to profile</span> <a title="Permalink" class="permalink" href="cha-apparmor-start.html#sec-apparmor-start-choose">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/apparmor_start.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>apparmor_start.xml</li><li><span class="ds-label">ID: </span>sec-apparmor-start-choose</li></ul></div></div></div></div><p>
   You need to protect the programs that are exposed to attacks in your
   particular setup, so use profiles for those applications you
   run. Use the following list to determine the candidates:
  </p><table border="0" summary="Simple list" class="simplelist "><tr><td>Network Agents</td></tr><tr><td>Web Applications</td></tr><tr><td>Cron Jobs</td></tr></table><p>
   To find out which processes are currently running with open network ports
   and might need a profile to confine them, run
   <code class="command">aa-unconfined</code> as <code class="systemitem">root</code>.
  </p><div class="example" id="ex-unconfined"><div class="example-title-wrap"><h6 class="example-title"><span class="number">Example 28.1: </span><span class="name">Output of <code class="command">aa-unconfined</code> </span><a title="Permalink" class="permalink" href="cha-apparmor-start.html#ex-unconfined">#</a></h6></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">19848 /usr/sbin/cupsd not confined
19887 /usr/sbin/sshd not confined
19947 /usr/lib/postfix/master not confined
1328 /usr/sbin/smbd confined by '/usr/sbin/smbd (enforce)'</pre></div></div></div><p>
   Each of the processes in the above example labeled <code class="literal">not
   confined</code> might need a custom profile to confine it. Those
   labeled <code class="literal">confined by</code> are already protected by <span class="phrase">AppArmor</span>.
  </p><div id="id-1.6.7.3.7.7" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.svg" /><h6>Tip: More information</h6><p>
    For more information about choosing the right applications to profile,
    refer to <a class="xref" href="cha-apparmor-concept.html#sec-apparmor-concept-determine" title="29.2. Determining programs to immunize">Section 29.2, “Determining programs to immunize”</a>.
   </p></div></div><div class="sect1 " id="sec-apparmor-start-build"><div class="titlepage"><div><div><h2 class="title"><span class="number">28.4 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Building and modifying profiles</span> <a title="Permalink" class="permalink" href="cha-apparmor-start.html#sec-apparmor-start-build">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/apparmor_start.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>apparmor_start.xml</li><li><span class="ds-label">ID: </span>sec-apparmor-start-build</li></ul></div></div></div></div><p>
   <span class="phrase">AppArmor</span> on <span class="productname"><span class="phrase">openSUSE Leap</span></span> ships with a preconfigured set of profiles
   for the most important applications. Additionally, you can use <span class="phrase">AppArmor</span> to
   create your own profiles for any application you want.
  </p><p>
   There are two ways of managing profiles. One is to use the graphical
   front-end provided by the YaST <span class="phrase">AppArmor</span> modules and the other is to
   use the command-line tools provided by the <span class="phrase">AppArmor</span> suite itself. The main
   difference is that YaST supports basic functionality for
   <span class="phrase">AppArmor</span> profiles, while the command-line tools let you update/tune the
   profiles in a more fine-grained way.
  </p><p>
   For each application, perform the following steps to create a profile:
  </p><div class="procedure " id="proc-genprof"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step " id="st-genprof1"><p>
     As <code class="systemitem">root</code>, let <span class="phrase">AppArmor</span> create a rough outline of the
     application's profile by running <code class="command">aa-genprof</code>
     <em class="replaceable ">PROGRAM_NAME</em>.
    </p><p>
     <span class="emphasis"><em>or</em></span>
    </p><p>

     Outline the basic profile by running <span class="guimenu ">YaST</span> › <span class="guimenu ">Security and Users</span> › <span class="guimenu "><span class="phrase">AppArmor</span> Configuration</span> › <span class="guimenu ">Manually Add
     Profile</span> and specifying the complete path to the
     application you want to profile.
    </p><p>
     A new basic profile is outlined and put into learning mode, which means
     that it logs any activity of the program you are executing, but does
     not yet restrict it.
    </p></li><li class="step " id="st-genprof2"><p>
     Run the full range of the application's actions to let <span class="phrase">AppArmor</span> get a
     specific picture of its activities.
    </p></li><li class="step " id="st-genprof3"><p>
     Let <span class="phrase">AppArmor</span> analyze the log files generated in
     <a class="xref" href="cha-apparmor-start.html#st-genprof2" title="Step 2">Step 2</a> by typing <span class="keycap">S</span> in
     aa-genprof.
    </p><p>
     <span class="phrase">AppArmor</span> scans the logs it recorded during the application's run and
     asks you to set the access rights for each event that was logged.
     Either set them for each file or use globbing.
    </p></li><li class="step "><p>
     Depending on the complexity of your application, it might be necessary
     to repeat <a class="xref" href="cha-apparmor-start.html#st-genprof2" title="Step 2">Step 2</a> and
     <a class="xref" href="cha-apparmor-start.html#st-genprof3" title="Step 3">Step 3</a>. Confine the application, exercise it
     under the confined conditions, and process any new log events. To
     properly confine the full range of an application's capabilities, you
     might be required to repeat this procedure often.
    </p></li><li class="step " id="st-genprof4"><p>
     When you finish <code class="command">aa-genprof</code>, your profile is set to
     enforce mode. The profile is applied and <span class="phrase">AppArmor</span> restricts the
     application according to it.
    </p><p>
     If you started <code class="command">aa-genprof</code> on an application that had
     an existing profile that was in complain mode, this profile remains in
     learning mode upon exit of this learning cycle. For more information
     about changing the mode of a profile, refer to
     <a class="xref" href="cha-apparmor-commandline.html#sec-apparmor-commandline-profiling-summary-complain" title="33.7.3.2. aa-complain—entering complain or learning mode">Section 33.7.3.2, “aa-complain—entering complain or learning mode”</a>
     and
     <a class="xref" href="cha-apparmor-commandline.html#sec-apparmor-commandline-profiling-summary-enforce" title="33.7.3.6. aa-enforce—entering enforce mode">Section 33.7.3.6, “aa-enforce—entering enforce mode”</a>.
    </p></li></ol></div></div><p>
   Test your profile settings by performing every task you need with the
   application you confined. Normally, the confined program runs smoothly
   and you do not notice <span class="phrase">AppArmor</span> activities. If you notice
   certain misbehavior with your application, check the system logs and see
   if <span class="phrase">AppArmor</span> is too tightly confining your application. Depending on the
   log mechanism used on your system, there are several places to look for
   <span class="phrase">AppArmor</span> log entries:
  </p><table border="0" summary="Simple list" class="simplelist "><tr><td><code class="filename">/var/log/audit/audit.log</code>
   </td></tr><tr><td>The command <code class="command">journalctl | grep -i apparmor</code>
   </td></tr><tr><td>The command <code class="command">dmesg -T</code>
   </td></tr></table><p>
   To adjust the profile, analyze the log messages relating to this
   application again as described in
   <a class="xref" href="cha-apparmor-commandline.html#sec-apparmor-commandline-profiling-summary-logprof" title="33.7.3.9. aa-logprof—scanning the system log">Section 33.7.3.9, “aa-logprof—scanning the system log”</a>.
   Determine the access rights or restrictions when prompted.
  </p><div id="id-1.6.7.3.8.9" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.svg" /><h6>Tip: More information</h6><p>
    For more information about profile building and modification, refer to
    <a class="xref" href="cha-apparmor-profiles.html" title="Chapter 30. Profile components and syntax">Chapter 30, <em>Profile components and syntax</em></a>,
    <a class="xref" href="cha-apparmor-yast.html" title="Chapter 32. Building and managing profiles with YaST">Chapter 32, <em>Building and managing profiles with YaST</em></a>, and
    <a class="xref" href="cha-apparmor-commandline.html" title="Chapter 33. Building profiles from the command line">Chapter 33, <em>Building profiles from the command line</em></a>.
   </p></div></div><div class="sect1 " id="sec-apparmor-start-update"><div class="titlepage"><div><div><h2 class="title"><span class="number">28.5 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Updating your profiles</span> <a title="Permalink" class="permalink" href="cha-apparmor-start.html#sec-apparmor-start-update">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/apparmor_start.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>apparmor_start.xml</li><li><span class="ds-label">ID: </span>sec-apparmor-start-update</li></ul></div></div></div></div><p>
   Software and system configurations change over time. As a result, your
   profile setup for <span class="phrase">AppArmor</span> might need certain fine-tuning from time to time.
   <span class="phrase">AppArmor</span> checks your system log for policy violations or other <span class="phrase">AppArmor</span>
   events and lets you adjust your profile set accordingly. Any application
   behavior that is outside of any profile definition can be addressed by
   <code class="command">aa-logprof</code>. For more information, see
   <a class="xref" href="cha-apparmor-commandline.html#sec-apparmor-commandline-profiling-summary-logprof" title="33.7.3.9. aa-logprof—scanning the system log">Section 33.7.3.9, “aa-logprof—scanning the system log”</a>.
  </p></div></div></div><div class="page-bottom"><div id="_bottom-navigation"><a class="nav-link" href="cha-apparmor-concept.html"><span class="next-icon">→</span><span class="nav-label"><span class="number">Chapter 29 </span>Immunizing programs</span></a><a class="nav-link" href="cha-apparmor-intro.html"><span class="prev-icon">←</span><span class="nav-label"><span class="number">Chapter 27 </span>Introducing <span class="phrase">AppArmor</span></span></a></div><div class="_share-print"><div class="online-contents share"><strong>Share this page: </strong><span class="share-buttons"><span class="_share-fb bottom-button">Facebook</span><span class="spacer"> • </span><span class="_share-in bottom-button">LinkedIn</span><span class="spacer"> • </span><span class="_share-tw bottom-button">Twitter</span><span class="spacer"> • </span><span class="_share-mail bottom-button">E-Mail</span></span></div><div class="print"><span class="_print-button bottom-button">Print this page</span></div><div class="clearme"></div></div></div></div><div id="_inward"></div></div><div id="_footer-wrap"><div id="_footer"><p>©
        2024 
        SUSE</p><ul><li><a href="https://jobs.suse.com/" target="_top">Careers</a></li><li><a href="https://www.suse.com/company/legal/" target="_top">Legal</a></li><li><a href="https://www.suse.com/company/about/" target="_top">About</a></li><li><a href="https://www.suse.com/contact/" target="_top">Contact Us</a></li></ul></div></div></body></html>