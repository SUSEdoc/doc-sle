<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Restricting cron and at | Security and Hardening Guide | openSUSE Leap 15.6</title><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" /><link rel="stylesheet" type="text/css" href="static/css/style.css" /><link rel="stylesheet" type="text/css" href="static/css/highlight.css" />
<meta name="title" content="Restricting cron and at | openSUSE Leap 15.6" />
<meta name="description" content="This chapter explains how to restrict access to the cron and at daemons to improve the security of a system." />
<meta name="product-name" content="openSUSE Leap" />
<meta name="product-number" content="15.6" />
<meta name="book-title" content="Security and Hardening Guide" />
<meta name="chapter-title" content="Chapter 15. Restricting cron and at" />
<meta name="tracker-url" content="https://bugzilla.opensuse.org/enter_bug.cgi" />
<meta name="tracker-type" content="bsc" />
<meta name="tracker-bsc-assignee" content="fs@suse.com" />
<meta name="tracker-bsc-component" content="Documentation" />
<meta name="tracker-bsc-product" content="openSUSE Distribution" />
<meta name="tracker-bsc-version" content="Leap 15.4" />
<meta property="og:title" content="Restricting cron and at | openSUSE Leap 15.6" />
<meta property="og:description" content="This chapter explains how to restrict access to the cron and at daemons to improve the security of a system." />
<meta property="og:type" content="article" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Restricting cron and at | openSUSE Leap 15.6" />
<meta name="twitter:description" content="This chapter explains how to restrict access to the cron and at daemons to improve the security of a system." />
<link rel="home" href="index.html" title="openSUSE Leap Documentation" /><link rel="up" href="part-local-security.html" title="Part II. Local security" /><link rel="prev" href="sec-sec-user-management.html" title="Chapter 14. User management" /><link rel="next" href="cha-spectre.html" title="Chapter 16. Spectre/Meltdown checker" />
<script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css" /></noscript><script src="static/js/jquery-1.12.4.min.js" type="text/javascript"></script><script src="static/js/script.js" type="text/javascript"></script><script src="static/js/highlight.min.js" type="text/javascript"></script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-navigation">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><div id="_outer-wrap"><div id="_white-bg" style="background-color: #E11;"><div id="_header"><div id="_logo"><img src="static/images/logo.svg" alt="Logo" /></div><div class="crumbs"><a class="book-link" href="index.html" title="Security and Hardening Guide"><span class="book-icon">Security and Hardening Guide</span></a><span> › </span><a class="crumb" href="part-local-security.html">Local security</a><span> › </span><a class="crumb" href="cha-sec-cron-at.html">Restricting cron and at</a></div><div class="clearme"></div></div></div><div id="_toolbar-wrap"><div id="_toolbar"><div id="_toc-area" class="inactive"><a id="_toc-area-button" class="tool" title="Contents" accesskey="c" href="index.html"><span class="tool-spacer"><span class="toc-icon">Contents</span><span class="clearme"></span></span><span class="tool-label">Contents</span></a><div class="active-contents bubble-corner"></div><div class="active-contents bubble"><div class="bubble-container"><h6>Security and Hardening Guide</h6><div id="_bubble-toc"><ol><li class="inactive"><a href="preface-security.html"><span class="number"> </span><span class="name">Preface</span></a></li><li class="inactive"><a href="cha-security.html"><span class="number">1 </span><span class="name">Security and confidentiality</span></a></li><li class="inactive"><a href="part-auth.html"><span class="number">I </span><span class="name">Authentication</span></a><ol><li class="inactive"><a href="cha-pam.html"><span class="number">2 </span><span class="name">Authentication with PAM</span></a></li><li class="inactive"><a href="cha-nis.html"><span class="number">3 </span><span class="name">Using NIS</span></a></li><li class="inactive"><a href="cha-security-auth.html"><span class="number">4 </span><span class="name">Setting up authentication clients using YaST</span></a></li><li class="inactive"><a href="cha-security-ldap.html"><span class="number">5 </span><span class="name">LDAP with 389 Directory Server</span></a></li><li class="inactive"><a href="cha-security-kerberos.html"><span class="number">6 </span><span class="name">Network authentication with Kerberos</span></a></li><li class="inactive"><a href="cha-security-ad.html"><span class="number">7 </span><span class="name">Active Directory support</span></a></li><li class="inactive"><a href="cha-security-freeradius.html"><span class="number">8 </span><span class="name">Setting up a freeRADIUS server</span></a></li></ol></li><li class="inactive"><a href="part-local-security.html"><span class="number">II </span><span class="name">Local security</span></a><ol><li class="inactive"><a href="cha-physical-security.html"><span class="number">9 </span><span class="name">Physical security</span></a></li><li class="inactive"><a href="sec-sec-software-management.html"><span class="number">10 </span><span class="name">Software management</span></a></li><li class="inactive"><a href="sec-sec-file-management.html"><span class="number">11 </span><span class="name">File management</span></a></li><li class="inactive"><a href="cha-security-cryptofs.html"><span class="number">12 </span><span class="name">Encrypting partitions and files</span></a></li><li class="inactive"><a href="cha-configure-cryptctl.html"><span class="number">13 </span><span class="name">Storage encryption for hosted applications with cryptctl</span></a></li><li class="inactive"><a href="sec-sec-user-management.html"><span class="number">14 </span><span class="name">User management</span></a></li><li class="inactive"><a href="cha-sec-cron-at.html"><span class="number">15 </span><span class="name">Restricting <code class="systemitem">cron</code> and <code class="systemitem">at</code></span></a></li><li class="inactive"><a href="cha-spectre.html"><span class="number">16 </span><span class="name">Spectre/Meltdown checker</span></a></li><li class="inactive"><a href="cha-security-yast-security.html"><span class="number">17 </span><span class="name">Configuring security settings with YaST</span></a></li><li class="inactive"><a href="cha-security-polkit.html"><span class="number">18 </span><span class="name">The Polkit authentication framework</span></a></li><li class="inactive"><a href="cha-security-acls.html"><span class="number">19 </span><span class="name">Access control lists in Linux</span></a></li><li class="inactive"><a href="cha-aide.html"><span class="number">20 </span><span class="name">Intrusion detection with AIDE</span></a></li></ol></li><li class="inactive"><a href="part-network-security.html"><span class="number">III </span><span class="name">Network security</span></a><ol><li class="inactive"><a href="cha-xauth.html"><span class="number">21 </span><span class="name">X Window System and X authentication</span></a></li><li class="inactive"><a href="cha-ssh.html"><span class="number">22 </span><span class="name">Securing network operations with OpenSSH</span></a></li><li class="inactive"><a href="cha-security-firewall.html"><span class="number">23 </span><span class="name">Masquerading and firewalls</span></a></li><li class="inactive"><a href="cha-security-vpnserver.html"><span class="number">24 </span><span class="name">Configuring a VPN server</span></a></li><li class="inactive"><a href="cha-security-xca.html"><span class="number">25 </span><span class="name">Managing a PKI with XCA, X certificate and key manager</span></a></li><li class="inactive"><a href="cha-sec-sysctl.html"><span class="number">26 </span><span class="name">Improving network security with <code class="command">sysctl</code> variables</span></a></li></ol></li><li class="inactive"><a href="part-apparmor.html"><span class="number">IV </span><span class="name">Confining privileges with <span class="phrase">AppArmor</span></span></a><ol><li class="inactive"><a href="cha-apparmor-intro.html"><span class="number">27 </span><span class="name">Introducing <span class="phrase">AppArmor</span></span></a></li><li class="inactive"><a href="cha-apparmor-start.html"><span class="number">28 </span><span class="name">Getting started</span></a></li><li class="inactive"><a href="cha-apparmor-concept.html"><span class="number">29 </span><span class="name">Immunizing programs</span></a></li><li class="inactive"><a href="cha-apparmor-profiles.html"><span class="number">30 </span><span class="name">Profile components and syntax</span></a></li><li class="inactive"><a href="cha-apparmor-repos.html"><span class="number">31 </span><span class="name"><span class="phrase">AppArmor</span> profile repositories</span></a></li><li class="inactive"><a href="cha-apparmor-yast.html"><span class="number">32 </span><span class="name">Building and managing profiles with YaST</span></a></li><li class="inactive"><a href="cha-apparmor-commandline.html"><span class="number">33 </span><span class="name">Building profiles from the command line</span></a></li><li class="inactive"><a href="cha-apparmor-hat.html"><span class="number">34 </span><span class="name">Profiling your Web applications using ChangeHat</span></a></li><li class="inactive"><a href="cha-apparmor-pam.html"><span class="number">35 </span><span class="name">Confining users with <code class="systemitem">pam_apparmor</code></span></a></li><li class="inactive"><a href="cha-apparmor-managing.html"><span class="number">36 </span><span class="name">Managing profiled applications</span></a></li><li class="inactive"><a href="cha-apparmor-support.html"><span class="number">37 </span><span class="name">Support</span></a></li><li class="inactive"><a href="cha-apparmor-glossary.html"><span class="number">38 </span><span class="name"><span class="phrase">AppArmor</span> glossary</span></a></li></ol></li><li class="inactive"><a href="part-selinux.html"><span class="number">V </span><span class="name">SELinux</span></a><ol><li class="inactive"><a href="cha-selinux.html"><span class="number">39 </span><span class="name">Configuring SELinux</span></a></li></ol></li><li class="inactive"><a href="part-audit.html"><span class="number">VI </span><span class="name">The Linux Audit Framework</span></a><ol><li class="inactive"><a href="cha-audit-comp.html"><span class="number">40 </span><span class="name">Understanding Linux audit</span></a></li><li class="inactive"><a href="cha-audit-setup.html"><span class="number">41 </span><span class="name">Setting up the Linux audit framework</span></a></li><li class="inactive"><a href="cha-audit-scenarios.html"><span class="number">42 </span><span class="name">Introducing an audit rule set</span></a></li><li class="inactive"><a href="cha-audit-moreinfo.html"><span class="number">43 </span><span class="name">Useful resources</span></a></li></ol></li><li class="inactive"><a href="bk04apa.html"><span class="number">A </span><span class="name">GNU licenses</span></a></li></ol></div><div class="clearme"></div></div></div></div><div id="_nav-area" class="inactive"><div class="tool"><span class="nav-inner"><span class="tool-label">Navigation</span><a accesskey="p" class="tool-spacer" title="Chapter 14. User management" href="sec-sec-user-management.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 16. Spectre/Meltdown checker" href="cha-spectre.html"><span class="next-icon">→</span></a></span></div></div></div></div><div id="_fixed-header-wrap" style="background-color: #E11;" class="inactive"><div id="_fixed-header"><div class="crumbs"><a class="book-link" href="index.html" title="Security and Hardening Guide"><span class="book-icon">Security and Hardening Guide</span></a><span> › </span><a class="crumb" href="part-local-security.html">Local security</a><span> › </span><a class="crumb" href="cha-sec-cron-at.html">Restricting cron and at</a></div><div class="buttons"><a class="top-button button" href="#">Top</a><div class="button"><a accesskey="p" class="tool-spacer" title="Chapter 14. User management" href="sec-sec-user-management.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 16. Spectre/Meltdown checker" href="cha-spectre.html"><span class="next-icon">→</span></a></div><div class="clearme"></div></div><div class="clearme"></div></div></div><div id="_content" class="draft "><div class="documentation"><div class="chapter " id="cha-sec-cron-at"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname "><span class="productname"><span class="phrase">openSUSE Leap</span></span></span> <span class="productnumber "><span class="productnumber"><span class="phrase">15.6</span></span></span></div><div><h2 class="title"><span class="number">15 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Restricting <code class="systemitem">cron</code> and <code class="systemitem">at</code></span> <a title="Permalink" class="permalink" href="cha-sec-cron-at.html#">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/security_cron_at.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>security_cron_at.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div><div><div class="abstract"><div class="abstract-title-wrap"><h6 class="abstract-title">Abstract<a title="Permalink" class="permalink" href="cha-sec-cron-at.html#id-1.6.5.8.1.3">#</a></h6></div><p>
    This chapter explains how to restrict access to the <code class="systemitem">cron</code> and <code class="systemitem">at</code> daemons to improve the security of a system.
   </p></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="cha-sec-cron-at.html#id-1.6.5.8.2"><span class="number">15.1 </span><span class="name">Restricting the <code class="systemitem">cron</code> daemon</span></a></span></dt><dt><span class="sect1"><a href="cha-sec-cron-at.html#id-1.6.5.8.3"><span class="number">15.2 </span><span class="name">Restricting the <code class="systemitem">at</code> scheduler</span></a></span></dt></dl></div></div><div class="sect1 " id="id-1.6.5.8.2"><div class="titlepage"><div><div><h2 class="title"><span class="number">15.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Restricting the <code class="systemitem">cron</code> daemon</span> <a title="Permalink" class="permalink" href="cha-sec-cron-at.html#id-1.6.5.8.2">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/security_cron_at.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>security_cron_at.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>
   The <code class="systemitem">cron</code> system is used to automatically run commands in the background at
   predefined times. For more information about <code class="systemitem">cron</code>, refer to the <span class="intraxref">Book “Reference”, Chapter 15 “Special system features”, Section 15.1.2 “The <span class="phrase">cron</span> package”</span>.
  </p><p>
   The <code class="filename">cron.allow</code> file specifies a list of users that are
   allowed to execute jobs via <code class="systemitem">cron</code>. The file does not exist by default, so
   all users can create <code class="systemitem">cron</code> jobs—except for those listed in
   <code class="filename">cron.deny</code>.
  </p><div class="procedure "><div class="procedure-contents"><p>
    To prevent users except for <code class="systemitem">root</code> from creating <code class="systemitem">cron</code> jobs, perform
    the following steps.
   </p><ol class="procedure" type="1"><li class="step "><p>
     Create an empty file <code class="filename">/etc/cron.allow</code>:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> <code class="command">touch</code> /etc/cron.allow</pre></div></li><li class="step "><p>
     Allow users to create <code class="systemitem">cron</code> jobs by adding their user names to the file:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> <code class="command">echo</code> "tux" &gt;&gt; /etc/cron.allow</pre></div></li><li class="step "><p>
     To verify, try creating a <code class="systemitem">cron</code> job as non-root user listed in
     <code class="filename">cron.allow</code>. You should see the message:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">crontab -e</code>
no crontab for tux - using an empty one</pre></div><p>
     Quit the crontab editor and try the same with a user
     <span class="emphasis"><em>not</em></span> listed in the file (or before adding them in step
     2 of this procedure):
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">wilber &gt; </code><code class="command">crontab -e</code>
You (wilber) are not allowed to use this program (crontab)
See crontab(1) for more information</pre></div></li></ol></div></div><div id="id-1.6.5.8.2.5" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg" /><h6>Important: Existing <code class="systemitem">cron</code> jobs</h6><p>
    Implementing <code class="function">cron.allow</code> prevents users from
    creating new <code class="systemitem">cron</code> jobs. Existing jobs run, even for users
    listed in <code class="filename">cron.deny</code>. To prevent this, create the file
    as described and remove existing user crontabs from the directory
    <code class="filename">/var/spool/cron/tabs</code> to ensure they are not run
    anymore.
   </p></div><div id="id-1.6.5.8.2.6" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg" /><h6>Note: Switching to <code class="systemitem">systemd</code> timer units</h6><p>
    You should also consider switching to <code class="systemitem">systemd</code> timer units, as they allow
    for more powerful and reliable task execution. By default, users cannot use
    them to run code when they are not logged in. This limits the way users can
    interact with the system while not being connected to it.
   </p><p>
    For more information about <code class="systemitem">systemd</code> timer units, refer to <span class="intraxref">Book “Reference”, Chapter 10 “The <code class="systemitem">systemd</code> daemon”, Section 10.7 “<code class="systemitem">systemd</code> timer units”</span>.
   </p></div></div><div class="sect1 " id="id-1.6.5.8.3"><div class="titlepage"><div><div><h2 class="title"><span class="number">15.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Restricting the <code class="systemitem">at</code> scheduler</span> <a title="Permalink" class="permalink" href="cha-sec-cron-at.html#id-1.6.5.8.3">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/security_cron_at.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>security_cron_at.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>
   The <code class="systemitem">at</code> job execution system allows
   users to scheduled one-time running jobs. The <code class="filename">at.allow</code>
   file specifies a list of users that are allowed to schedule jobs via
   <code class="systemitem">at</code>. The file does not exist by
   default, so all users can schedule <code class="systemitem">at</code>
   jobs—except for those listed in <code class="filename">at.deny</code>)
  </p><div class="procedure "><div class="procedure-contents"><p>
    To prevent users except for <code class="systemitem">root</code> from scheduling jobs with <code class="systemitem">at</code>, perform the following steps.
   </p><ol class="procedure" type="1"><li class="step "><p>
     Create an empty file <code class="filename">/etc/at.allow</code>:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> <code class="command">touch</code> /etc/at.allow</pre></div></li><li class="step "><p>
     Allow users to schedule jobs with <code class="systemitem">at</code> by adding their user names to the file:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> <code class="command">echo</code> "tux" &gt;&gt; /etc/at.allow</pre></div></li><li class="step "><p>
     To verify, try scheduling a job as non-root user listed in
     <code class="filename">at.allow</code>:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">at 00:00</code>
at&gt;</pre></div><p>
     Quit the <code class="systemitem">at</code>prompt with
     <span class="keycap">Ctrl</span><span class="key-connector">–</span><span class="keycap">C</span> and
     try the same with a user <span class="emphasis"><em>not</em></span> listed in the file (or
     before adding them in step 2 of this procedure):
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">wilber &gt; </code><code class="command">at 00:00</code>
You do not have permission to use at.</pre></div></li></ol></div></div><div id="id-1.6.5.8.3.4" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg" /><h6>Note: Uninstalling <code class="systemitem">at</code></h6><p>
    <code class="systemitem">at</code> is not widely used anymore.
    If you do not have valid use cases, consider uninstalling the daemon instead
    of just restricting its access.
   </p></div></div></div></div><div class="page-bottom"><div id="_bottom-navigation"><a class="nav-link" href="cha-spectre.html"><span class="next-icon">→</span><span class="nav-label"><span class="number">Chapter 16 </span>Spectre/Meltdown checker</span></a><a class="nav-link" href="sec-sec-user-management.html"><span class="prev-icon">←</span><span class="nav-label"><span class="number">Chapter 14 </span>User management</span></a></div><div class="_share-print"><div class="online-contents share"><strong>Share this page: </strong><span class="share-buttons"><span class="_share-fb bottom-button">Facebook</span><span class="spacer"> • </span><span class="_share-in bottom-button">LinkedIn</span><span class="spacer"> • </span><span class="_share-tw bottom-button">Twitter</span><span class="spacer"> • </span><span class="_share-mail bottom-button">E-Mail</span></span></div><div class="print"><span class="_print-button bottom-button">Print this page</span></div><div class="clearme"></div></div></div></div><div id="_inward"></div></div><div id="_footer-wrap"><div id="_footer"><p>©
        2024 
        SUSE</p><ul><li><a href="https://jobs.suse.com/" target="_top">Careers</a></li><li><a href="https://www.suse.com/company/legal/" target="_top">Legal</a></li><li><a href="https://www.suse.com/company/about/" target="_top">About</a></li><li><a href="https://www.suse.com/contact/" target="_top">Contact Us</a></li></ul></div></div></body></html>