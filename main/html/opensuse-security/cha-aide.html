<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Intrusion detection with AIDE | Security and Hardening Guide | openSUSE Leap 15.7</title><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" /><link rel="stylesheet" type="text/css" href="static/css/style.css" /><link rel="stylesheet" type="text/css" href="static/css/highlight.css" />
<meta name="title" content="Intrusion detection with AIDE | openSUSE Leap 15.7" />
<meta name="description" content="Securing your systems is a mandatory task for any mission-critical system administrator. Because it is impossible to always guarantee that the system is not co…" />
<meta name="product-name" content="openSUSE Leap" />
<meta name="product-number" content="15.7" />
<meta name="book-title" content="Security and Hardening Guide" />
<meta name="chapter-title" content="Chapter 20. Intrusion detection with AIDE" />
<meta name="tracker-url" content="https://bugzilla.opensuse.org/enter_bug.cgi" />
<meta name="tracker-type" content="bsc" />
<meta name="tracker-bsc-assignee" content="fs@suse.com" />
<meta name="tracker-bsc-component" content="Documentation" />
<meta name="tracker-bsc-product" content="openSUSE Distribution" />
<meta name="tracker-bsc-version" content="Leap 15.4" />
<meta property="og:title" content="Intrusion detection with AIDE | openSUSE Leap 15.7" />
<meta property="og:description" content="Securing your systems is a mandatory task for any mission-critical system administrator. Because it is impossible to always guarantee that the system is not co…" />
<meta property="og:type" content="article" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Intrusion detection with AIDE | openSUSE Leap 15.7" />
<meta name="twitter:description" content="Securing your systems is a mandatory task for any mission-critical system administrator. Because it is impossible to always guarantee that the system is not co…" />
<link rel="home" href="index.html" title="openSUSE Leap Documentation" /><link rel="up" href="part-local-security.html" title="Part II. Local security" /><link rel="prev" href="cha-security-acls.html" title="Chapter 19. Access control lists in Linux" /><link rel="next" href="part-network-security.html" title="Part III. Network security" />
<script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css" /></noscript><script src="static/js/jquery-1.12.4.min.js" type="text/javascript"></script><script src="static/js/script.js" type="text/javascript"></script><script src="static/js/highlight.min.js" type="text/javascript"></script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-navigation">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><div id="_outer-wrap"><div id="_white-bg" style="background-color: #E11;"><div id="_header"><div id="_logo"><img src="static/images/logo.svg" alt="Logo" /></div><div class="crumbs"><a class="book-link" href="index.html" title="Security and Hardening Guide"><span class="book-icon">Security and Hardening Guide</span></a><span> › </span><a class="crumb" href="part-local-security.html">Local security</a><span> › </span><a class="crumb" href="cha-aide.html">Intrusion detection with AIDE</a></div><div class="clearme"></div></div></div><div id="_toolbar-wrap"><div id="_toolbar"><div id="_toc-area" class="inactive"><a id="_toc-area-button" class="tool" title="Contents" accesskey="c" href="index.html"><span class="tool-spacer"><span class="toc-icon">Contents</span><span class="clearme"></span></span><span class="tool-label">Contents</span></a><div class="active-contents bubble-corner"></div><div class="active-contents bubble"><div class="bubble-container"><h6>Security and Hardening Guide</h6><div id="_bubble-toc"><ol><li class="inactive"><a href="preface-security.html"><span class="number"> </span><span class="name">Preface</span></a></li><li class="inactive"><a href="cha-security.html"><span class="number">1 </span><span class="name">Security and confidentiality</span></a></li><li class="inactive"><a href="part-auth.html"><span class="number">I </span><span class="name">Authentication</span></a><ol><li class="inactive"><a href="cha-pam.html"><span class="number">2 </span><span class="name">Authentication with PAM</span></a></li><li class="inactive"><a href="cha-nis.html"><span class="number">3 </span><span class="name">Using NIS</span></a></li><li class="inactive"><a href="cha-security-auth.html"><span class="number">4 </span><span class="name">Setting up authentication clients using YaST</span></a></li><li class="inactive"><a href="cha-security-ldap.html"><span class="number">5 </span><span class="name">LDAP with 389 Directory Server</span></a></li><li class="inactive"><a href="cha-security-kerberos.html"><span class="number">6 </span><span class="name">Network authentication with Kerberos</span></a></li><li class="inactive"><a href="cha-security-ad.html"><span class="number">7 </span><span class="name">Active Directory support</span></a></li><li class="inactive"><a href="cha-security-freeradius.html"><span class="number">8 </span><span class="name">Setting up a freeRADIUS server</span></a></li></ol></li><li class="inactive"><a href="part-local-security.html"><span class="number">II </span><span class="name">Local security</span></a><ol><li class="inactive"><a href="cha-physical-security.html"><span class="number">9 </span><span class="name">Physical security</span></a></li><li class="inactive"><a href="sec-sec-software-management.html"><span class="number">10 </span><span class="name">Software management</span></a></li><li class="inactive"><a href="sec-sec-file-management.html"><span class="number">11 </span><span class="name">File management</span></a></li><li class="inactive"><a href="cha-security-cryptofs.html"><span class="number">12 </span><span class="name">Encrypting partitions and files</span></a></li><li class="inactive"><a href="cha-configure-cryptctl.html"><span class="number">13 </span><span class="name">Storage encryption for hosted applications with cryptctl</span></a></li><li class="inactive"><a href="sec-sec-user-management.html"><span class="number">14 </span><span class="name">User management</span></a></li><li class="inactive"><a href="cha-sec-cron-at.html"><span class="number">15 </span><span class="name">Restricting <code class="systemitem">cron</code> and <code class="systemitem">at</code></span></a></li><li class="inactive"><a href="cha-spectre.html"><span class="number">16 </span><span class="name">Spectre/Meltdown checker</span></a></li><li class="inactive"><a href="cha-security-yast-security.html"><span class="number">17 </span><span class="name">Configuring security settings with YaST</span></a></li><li class="inactive"><a href="cha-security-polkit.html"><span class="number">18 </span><span class="name">The Polkit authentication framework</span></a></li><li class="inactive"><a href="cha-security-acls.html"><span class="number">19 </span><span class="name">Access control lists in Linux</span></a></li><li class="inactive"><a href="cha-aide.html"><span class="number">20 </span><span class="name">Intrusion detection with AIDE</span></a></li></ol></li><li class="inactive"><a href="part-network-security.html"><span class="number">III </span><span class="name">Network security</span></a><ol><li class="inactive"><a href="cha-xauth.html"><span class="number">21 </span><span class="name">X Window System and X authentication</span></a></li><li class="inactive"><a href="cha-ssh.html"><span class="number">22 </span><span class="name">Securing network operations with OpenSSH</span></a></li><li class="inactive"><a href="cha-security-firewall.html"><span class="number">23 </span><span class="name">Masquerading and firewalls</span></a></li><li class="inactive"><a href="cha-security-vpnserver.html"><span class="number">24 </span><span class="name">Configuring a VPN server</span></a></li><li class="inactive"><a href="cha-security-xca.html"><span class="number">25 </span><span class="name">Managing a PKI with XCA, X certificate and key manager</span></a></li><li class="inactive"><a href="cha-sec-sysctl.html"><span class="number">26 </span><span class="name">Improving network security with <code class="command">sysctl</code> variables</span></a></li></ol></li><li class="inactive"><a href="part-apparmor.html"><span class="number">IV </span><span class="name">Confining privileges with <span class="phrase">AppArmor</span></span></a><ol><li class="inactive"><a href="cha-apparmor-intro.html"><span class="number">27 </span><span class="name">Introducing <span class="phrase">AppArmor</span></span></a></li><li class="inactive"><a href="cha-apparmor-start.html"><span class="number">28 </span><span class="name">Getting started</span></a></li><li class="inactive"><a href="cha-apparmor-concept.html"><span class="number">29 </span><span class="name">Immunizing programs</span></a></li><li class="inactive"><a href="cha-apparmor-profiles.html"><span class="number">30 </span><span class="name">Profile components and syntax</span></a></li><li class="inactive"><a href="cha-apparmor-repos.html"><span class="number">31 </span><span class="name"><span class="phrase">AppArmor</span> profile repositories</span></a></li><li class="inactive"><a href="cha-apparmor-yast.html"><span class="number">32 </span><span class="name">Building and managing profiles with YaST</span></a></li><li class="inactive"><a href="cha-apparmor-commandline.html"><span class="number">33 </span><span class="name">Building profiles from the command line</span></a></li><li class="inactive"><a href="cha-apparmor-hat.html"><span class="number">34 </span><span class="name">Profiling your Web applications using ChangeHat</span></a></li><li class="inactive"><a href="cha-apparmor-pam.html"><span class="number">35 </span><span class="name">Confining users with <code class="systemitem">pam_apparmor</code></span></a></li><li class="inactive"><a href="cha-apparmor-managing.html"><span class="number">36 </span><span class="name">Managing profiled applications</span></a></li><li class="inactive"><a href="cha-apparmor-support.html"><span class="number">37 </span><span class="name">Support</span></a></li><li class="inactive"><a href="cha-apparmor-glossary.html"><span class="number">38 </span><span class="name"><span class="phrase">AppArmor</span> glossary</span></a></li></ol></li><li class="inactive"><a href="part-selinux.html"><span class="number">V </span><span class="name">SELinux</span></a><ol><li class="inactive"><a href="cha-selinux.html"><span class="number">39 </span><span class="name">Configuring SELinux</span></a></li></ol></li><li class="inactive"><a href="part-audit.html"><span class="number">VI </span><span class="name">The Linux Audit Framework</span></a><ol><li class="inactive"><a href="cha-audit-comp.html"><span class="number">40 </span><span class="name">Understanding Linux audit</span></a></li><li class="inactive"><a href="cha-audit-setup.html"><span class="number">41 </span><span class="name">Setting up the Linux audit framework</span></a></li><li class="inactive"><a href="cha-audit-scenarios.html"><span class="number">42 </span><span class="name">Introducing an audit rule set</span></a></li><li class="inactive"><a href="cha-audit-moreinfo.html"><span class="number">43 </span><span class="name">Useful resources</span></a></li></ol></li><li class="inactive"><a href="bk04apa.html"><span class="number">A </span><span class="name">GNU licenses</span></a></li></ol></div><div class="clearme"></div></div></div></div><div id="_nav-area" class="inactive"><div class="tool"><span class="nav-inner"><span class="tool-label">Navigation</span><a accesskey="p" class="tool-spacer" title="Chapter 19. Access control lists in Linux" href="cha-security-acls.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Part III. Network security" href="part-network-security.html"><span class="next-icon">→</span></a></span></div></div></div></div><div id="_fixed-header-wrap" style="background-color: #E11;" class="inactive"><div id="_fixed-header"><div class="crumbs"><a class="book-link" href="index.html" title="Security and Hardening Guide"><span class="book-icon">Security and Hardening Guide</span></a><span> › </span><a class="crumb" href="part-local-security.html">Local security</a><span> › </span><a class="crumb" href="cha-aide.html">Intrusion detection with AIDE</a></div><div class="buttons"><a class="top-button button" href="#">Top</a><div class="button"><a accesskey="p" class="tool-spacer" title="Chapter 19. Access control lists in Linux" href="cha-security-acls.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Part III. Network security" href="part-network-security.html"><span class="next-icon">→</span></a></div><div class="clearme"></div></div><div class="clearme"></div></div></div><div id="_content" class="draft "><div class="documentation"><div class="chapter " id="cha-aide"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname "><span class="productname"><span class="phrase">openSUSE Leap</span></span></span> <span class="productnumber "><span class="productnumber"><span class="phrase">15.7</span></span></span></div><div><h2 class="title"><span class="number">20 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Intrusion detection with AIDE</span> <a title="Permalink" class="permalink" href="cha-aide.html#">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/security_aide.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>security_aide.xml</li><li><span class="ds-label">ID: </span>cha-aide</li></ul></div></div><div><div class="abstract"><div class="abstract-title-wrap"><h6 class="abstract-title">Abstract<a title="Permalink" class="permalink" href="cha-aide.html#id-1.6.5.13.2.1">#</a></h6></div><p>
    Securing your systems is a mandatory task for any mission-critical
    system administrator. Because it is impossible to always guarantee that
    the system is not compromised, it is important to do extra checks
    regularly (for example with
    <code class="systemitem">cron</code>) to ensure that the system
    is still under your control. This is where AIDE, the
    <span class="emphasis"><em>Advanced Intrusion Detection Environment</em></span>, comes
    into play.
   </p></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="cha-aide.html#sec-aide-why"><span class="number">20.1 </span><span class="name">Why use AIDE?</span></a></span></dt><dt><span class="sect1"><a href="cha-aide.html#sec-aide-setup"><span class="number">20.2 </span><span class="name">Setting up an AIDE database</span></a></span></dt><dt><span class="sect1"><a href="cha-aide.html#sec-aide-check"><span class="number">20.3 </span><span class="name">Local AIDE checks</span></a></span></dt><dt><span class="sect1"><a href="cha-aide.html#sec-aide-independent"><span class="number">20.4 </span><span class="name">System independent checking</span></a></span></dt><dt><span class="sect1"><a href="cha-aide.html#sec-aide-more"><span class="number">20.5 </span><span class="name">More information</span></a></span></dt></dl></div></div><div class="sect1 " id="sec-aide-why"><div class="titlepage"><div><div><h2 class="title"><span class="number">20.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Why use AIDE?</span> <a title="Permalink" class="permalink" href="cha-aide.html#sec-aide-why">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/security_aide.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>security_aide.xml</li><li><span class="ds-label">ID: </span>sec-aide-why</li></ul></div></div></div></div><p>
   An easy check that often can reveal unwanted changes can be done by means
   of RPM. The package manager has a built-in verify function that checks
   all the managed files in the system for changes. To verify all files,
   run the command <code class="command">rpm -Va</code>. However, this command also
   displays changes in configuration files, and you need to do some
   filtering to detect important changes.
  </p><p>
   An additional problem to the method with RPM is that an intelligent
   attacker can modify <code class="command">rpm</code> itself to hide any changes
   that might have been done by some kind of root-kit, which allows the
   attacker to mask the intrusion and gain root privilege. To solve this,
   you should implement a secondary check that can also be run
   independent of the installed system.
  </p></div><div class="sect1 " id="sec-aide-setup"><div class="titlepage"><div><div><h2 class="title"><span class="number">20.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Setting up an AIDE database</span> <a title="Permalink" class="permalink" href="cha-aide.html#sec-aide-setup">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/security_aide.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>security_aide.xml</li><li><span class="ds-label">ID: </span>sec-aide-setup</li></ul></div></div></div></div><div id="id-1.6.5.13.4.2" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg" /><h6>Important: Initialize AIDE database after installation</h6><p>
    Before you install your system, verify the checksum of your medium (see
    <span class="intraxref">Book “Start-Up”, Chapter 4 “Troubleshooting”, Section 4.1 “Checking media”</span>) to make sure you do not use
    a compromised source. After you have installed the system, initialize
    the AIDE database. To make sure that all went well during and
    after the installation, do an installation directly on the console,
    without any network attached to the computer. Do not leave the computer
    unattended or connected to any network before AIDE creates its
    database.
   </p></div><p>
   AIDE is not installed by default on <span class="productname"><span class="phrase">openSUSE Leap</span></span>. To install it,
   either use <span class="guimenu ">Computer</span> › <span class="guimenu ">Install
   Software</span>, or enter <code class="literal">zypper install
   aide</code> on the command line as <code class="systemitem">root</code>.
  </p><p>
   To tell AIDE which attributes of which files should be checked, use
   the <code class="filename">/etc/aide.conf</code> configuration file. It must be
   modified to become the actual configuration. The first section handles
   general parameters like the location of the AIDE database file. More
   relevant for local configurations are the <code class="systemitem">Custom
   Rules</code> and the <code class="systemitem">Directories and Files</code>
   sections. A typical rule looks like the following:
  </p><div class="verbatim-wrap"><pre class="screen">Binlib     = p+i+n+u+g+s+b+m+c+md5+sha1</pre></div><p>
   After defining the variable <code class="literal">Binlib</code>, the respective
   check boxes are used in the files section. Important options include the
   following:
  </p><div class="table" id="tab-aide-options"><div class="table-title-wrap"><h6 class="table-title"><span class="number">Table 20.1: </span><span class="name">Important AIDE check boxes </span><a title="Permalink" class="permalink" href="cha-aide.html#tab-aide-options">#</a></h6></div><div class="table-contents"><table class="table" summary="Important AIDE check boxes" border="1"><colgroup><col /><col /></colgroup><thead><tr><th>
       <p>
        Option
       </p>
      </th><th>
       <p>
        Description
       </p>
      </th></tr></thead><tbody><tr><td>
       <p>
        p
       </p>
      </td><td>
       <p>
        Check for the file permissions of the selected files or directories.
       </p>
      </td></tr><tr><td>
       <p>
        i
       </p>
      </td><td>
       <p>
        Check for the inode number. Every file name has a unique inode
        number that should not change.
       </p>
      </td></tr><tr><td>
       <p>
        n
       </p>
      </td><td>
       <p>
        Check for the number of links pointing to the relevant file.
       </p>
      </td></tr><tr><td>
       <p>
        u
       </p>
      </td><td>
       <p>
        Check if the owner of the file has changed.
       </p>
      </td></tr><tr><td>
       <p>
        g
       </p>
      </td><td>
       <p>
        Check if the group of the file has changed.
       </p>
      </td></tr><tr><td>
       <p>
        s
       </p>
      </td><td>
       <p>
        Check if the file size has changed.
       </p>
      </td></tr><tr><td>
       <p>
        b
       </p>
      </td><td>
       <p>
        Check if the block count used by the file has changed.
       </p>
      </td></tr><tr><td>
       <p>
        m
       </p>
      </td><td>
       <p>
        Check if the modification time of the file has changed.
       </p>
      </td></tr><tr><td>
       <p>
        c
       </p>
      </td><td>
       <p>
        Check if the files access time has changed.
       </p>
      </td></tr><tr><td>
       <p>
        S
       </p>
      </td><td>
       <p>
        Check for a changed file size.
       </p>
      </td></tr><tr><td>
       <p>
        I
       </p>
      </td><td>
       <p>
        Ignore changes of the file name.
       </p>
      </td></tr><tr><td>
       <p>
        md5
       </p>
      </td><td>
       <p>
        Check if the md5 checksum of the file has changed. We recommend
        to use sha256 or sha512.
       </p>
      </td></tr><tr><td>
       <p>
        sha1
       </p>
      </td><td>
       <p>
        Check if the sha1 (160 Bit) checksum of the file has changed. We
        recommend to use sha256 or sha512.
       </p>
      </td></tr><tr><td>
       <p>
        sha256
       </p>
      </td><td>
       <p>
        Check if the sha256 checksum of the file has changed.
       </p>
      </td></tr><tr><td>
       <p>
        sha512
       </p>
      </td><td>
       <p>
        Check if the sha512 checksum of the file has changed.
       </p>
      </td></tr></tbody></table></div></div><p>
   This is a configuration that checks for all files in
   <code class="filename">/sbin</code> with the options defined in
   <code class="literal">Binlib</code> but omits the
   <code class="filename">/sbin/conf.d/</code> directory:
  </p><div class="verbatim-wrap"><pre class="screen">/sbin  Binlib
!/sbin/conf.d</pre></div><p>
   To create the AIDE database, proceed as follows:
  </p><div class="procedure " id="pro-aide-setup-db"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Open <code class="filename">/etc/aide.conf</code>.
    </p></li><li class="step "><p>
     Define which files should be checked with which check boxes. For a
     complete list of available check boxes, see
     <code class="filename">/usr/share/doc/packages/aide/manual.html</code>. The
     definition of the file selection needs certain knowledge about regular
     expressions. Save your modifications.
    </p></li><li class="step "><p>
     To check whether the configuration file is valid, run:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>aide --config-check</pre></div><p>
     Any output of this command is a hint that the configuration is not
     valid. For example, if you get the following output:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>aide --config-check
35:syntax error:!
35:Error while reading configuration:!
Configuration error</pre></div><p>
     The error is to be expected in line 36 of
     <code class="filename">/etc/aide.conf</code>. The error message
     contains the last successfully read line of the configuration file.
    </p></li><li class="step "><p>
     Initialize the AIDE database. Run the command:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>aide -i</pre></div></li><li class="step "><p>
     Copy the generated database to a save location like a CD-R or DVD-R, a
     remote server or a flash disk for later use.
    </p><div id="id-1.6.5.13.4.11.5.2" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg" /><h6>Important</h6><p>
      This step is essential as it avoids compromising your database. It is
      recommended to use a medium which can be written once to prevent
      the database being modified. <span class="emphasis"><em>Never</em></span> leave the
      database on the computer which you want to monitor.
     </p></div></li></ol></div></div></div><div class="sect1 " id="sec-aide-check"><div class="titlepage"><div><div><h2 class="title"><span class="number">20.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Local AIDE checks</span> <a title="Permalink" class="permalink" href="cha-aide.html#sec-aide-check">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/security_aide.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>security_aide.xml</li><li><span class="ds-label">ID: </span>sec-aide-check</li></ul></div></div></div></div><p>
   To perform a file system check, proceed as follows:
  </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Rename the database:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>mv /var/lib/aide/aide.db.new /var/lib/aide/aide.db</pre></div></li><li class="step "><p>
     After any configuration change, you always need to re-initialize the
     AIDE database and subsequently move the newly generated database.
     It is also a good idea to make a backup of this database. See
     <a class="xref" href="cha-aide.html#sec-aide-setup" title="20.2. Setting up an AIDE database">Section 20.2, “Setting up an AIDE database”</a> for more information.
    </p></li><li class="step "><p>
     Perform the check with the following command:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>aide --check</pre></div></li></ol></div></div><p>
   If the output is empty, everything is fine. If AIDE found changes,
   it displays a summary of changes, for example:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>aide --check
AIDE found differences between database and file system!!

Summary:
  Total number of files:        1992
  Added files:                  0
  Removed files:                0
  Changed files:                1</pre></div><p>
   To learn about the actual changes, increase the verbose level of the
   check with the parameter <code class="literal">-V</code>. For the previous example,
   this could look like the following:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>aide --check -V
AIDE found differences between database and file system!!
Start timestamp: 2009-02-18 15:14:10

Summary:
  Total number of files:        1992
  Added files:                  0
  Removed files:                0
  Changed files:                1


---------------------------------------------------
Changed files:
---------------------------------------------------

changed: /etc/passwd

--------------------------------------------------
Detailed information about changes:
---------------------------------------------------


File: /etc/passwd
  Mtime    : 2009-02-18 15:11:02              , 2009-02-18 15:11:47
  Ctime    : 2009-02-18 15:11:02              , 2009-02-18 15:11:47</pre></div><p>
   In this example, the file <code class="filename">/etc/passwd</code> was touched to
   demonstrate the effect.
  </p></div><div class="sect1 " id="sec-aide-independent"><div class="titlepage"><div><div><h2 class="title"><span class="number">20.4 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">System independent checking</span> <a title="Permalink" class="permalink" href="cha-aide.html#sec-aide-independent">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/security_aide.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>security_aide.xml</li><li><span class="ds-label">ID: </span>sec-aide-independent</li></ul></div></div></div></div><p>
   To avoid risk, it is advisable to also run the AIDE binary from a
   trusted source. This excludes the risk that attackers also modified
   the aide binary to hide its traces.
  </p><p>
   To accomplish this task, AIDE must be run from a rescue system that
   is independent of the installed system. With <span class="productname"><span class="phrase">openSUSE Leap</span></span> it is
   easy to extend the rescue system with arbitrary programs, and
   thus add the needed functionality.
  </p><p>
   Before you can start using the rescue system, you need to provide two
   packages to the system. These are included with the same syntax as you
   would add a driver update disk to the system. For a detailed description
   about the possibilities of linuxrc that are used for this purpose, see
   <a class="link" href="https://en.opensuse.org/SDB:Linuxrc" target="_blank">https://en.opensuse.org/SDB:Linuxrc</a>. In the
   following, one possible way to accomplish this task is discussed.
  </p><div class="procedure " id="id-1.6.5.13.6.5"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 20.1: </span><span class="name">Starting a rescue system with AIDE </span><a title="Permalink" class="permalink" href="cha-aide.html#id-1.6.5.13.6.5">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
     Provide an FTP server as a second machine.
    </p></li><li class="step "><p>
     Copy the packages <code class="systemitem">aide</code> and
     <code class="systemitem">mhash</code> to the FTP server directory, in our case
     <code class="filename">/srv/ftp/</code>. Replace the placeholders
     <em class="replaceable ">ARCH</em> and <em class="replaceable ">VERSION</em>
     with the corresponding values:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>cp DVD1/suse/<em class="replaceable ">ARCH</em>/aide<em class="replaceable ">VERSION</em>.<em class="replaceable ">ARCH</em>.rpm /srv/ftp
<code class="prompt root"># </code>cp DVD1/suse/<em class="replaceable ">ARCH</em>/mhash<em class="replaceable ">VERSION</em>.<em class="replaceable ">ARCH</em>.rpm /srv/ftp</pre></div></li><li class="step "><p>
     Create an info file <code class="filename">/srv/ftp/info.txt</code> that
     provides the needed boot parameters for the rescue system:
    </p><div class="verbatim-wrap"><pre class="screen">dud:ftp://ftp.example.com/aide<em class="replaceable ">VERSION</em>.<em class="replaceable ">ARCH</em>.rpm
dud:ftp://ftp.example.com/mhash<em class="replaceable ">VERSION</em>.<em class="replaceable ">ARCH</em>.rpm</pre></div><p>
     Replace your FTP domain name, <em class="replaceable ">VERSION</em> and
     <em class="replaceable ">ARCH</em> with the values used on your system.
    </p></li><li class="step "><p>
     Restart the server that needs to go through an AIDE check with the
     Rescue system from your DVD. Add the following string to the boot
     parameters:
    </p><div class="verbatim-wrap"><pre class="screen">info=ftp://ftp.example.com/info.txt</pre></div><p>
     This parameter tells <code class="command">linuxrc</code> to also read in all
     information from the <code class="filename">info.txt</code> file.
    </p></li></ol></div></div><p>
   After the rescue system has booted, the AIDE program is ready for
   use.
  </p></div><div class="sect1 " id="sec-aide-more"><div class="titlepage"><div><div><h2 class="title"><span class="number">20.5 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">More information</span> <a title="Permalink" class="permalink" href="cha-aide.html#sec-aide-more">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/security_aide.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>security_aide.xml</li><li><span class="ds-label">ID: </span>sec-aide-more</li></ul></div></div></div></div><p>
   Information about AIDE is available at the following places:
  </p><div class="itemizedlist "><ul class="itemizedlist"><li class="listitem "><p>
     The home page of AIDE:
     <a class="link" href="https://aide.github.io/" target="_blank">https://aide.github.io/</a>
    </p></li><li class="listitem "><p>
     In the documented template configuration
     <code class="filename">/etc/aide.conf</code>.
    </p></li><li class="listitem "><p>
     In several files below
     <code class="filename">/usr/share/doc/packages/aide</code> after installing the
     <code class="systemitem">aide</code> package.
    </p></li><li class="listitem "><p>
     On the AIDE user mailing list at
     <a class="link" href="https://www.ipi.fi/mailman/listinfo/aide" target="_blank">https://www.ipi.fi/mailman/listinfo/aide</a>.
    </p></li></ul></div></div></div></div><div class="page-bottom"><div id="_bottom-navigation"><a class="nav-link" href="part-network-security.html"><span class="next-icon">→</span><span class="nav-label"><span class="number">Part III </span>Network security</span></a><a class="nav-link" href="cha-security-acls.html"><span class="prev-icon">←</span><span class="nav-label"><span class="number">Chapter 19 </span>Access control lists in Linux</span></a></div><div class="_share-print"><div class="online-contents share"><strong>Share this page: </strong><span class="share-buttons"><span class="_share-fb bottom-button">Facebook</span><span class="spacer"> • </span><span class="_share-in bottom-button">LinkedIn</span><span class="spacer"> • </span><span class="_share-tw bottom-button">Twitter</span><span class="spacer"> • </span><span class="_share-mail bottom-button">E-Mail</span></span></div><div class="print"><span class="_print-button bottom-button">Print this page</span></div><div class="clearme"></div></div></div></div><div id="_inward"></div></div><div id="_footer-wrap"><div id="_footer"><p>©
        2024 
        SUSE</p><ul><li><a href="https://jobs.suse.com/" target="_top">Careers</a></li><li><a href="https://www.suse.com/company/legal/" target="_top">Legal</a></li><li><a href="https://www.suse.com/company/about/" target="_top">About</a></li><li><a href="https://www.suse.com/contact/" target="_top">Contact Us</a></li></ul></div></div></body></html>