<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>User management | Security and Hardening Guide | openSUSE Leap 15.6</title><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" /><link rel="stylesheet" type="text/css" href="static/css/style.css" /><link rel="stylesheet" type="text/css" href="static/css/highlight.css" />
<meta name="title" content="User management | openSUSE Leap 15.6" />
<meta name="description" content="It is important that all system and vendor accounts that are not used for logins are locked. To get a list of unlocked accounts on your system, you can check f…" />
<meta name="product-name" content="openSUSE Leap" />
<meta name="product-number" content="15.6" />
<meta name="book-title" content="Security and Hardening Guide" />
<meta name="chapter-title" content="Chapter 14. User management" />
<meta name="tracker-url" content="https://bugzilla.opensuse.org/enter_bug.cgi" />
<meta name="tracker-type" content="bsc" />
<meta name="tracker-bsc-assignee" content="fs@suse.com" />
<meta name="tracker-bsc-component" content="Documentation" />
<meta name="tracker-bsc-product" content="openSUSE Distribution" />
<meta name="tracker-bsc-version" content="Leap 15.4" />
<meta property="og:title" content="User management | openSUSE Leap 15.6" />
<meta property="og:description" content="It is important that all system and vendor accounts that are not used for logins are locked. To get a list of unlocked accounts on your system, you can check f…" />
<meta property="og:type" content="article" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="User management | openSUSE Leap 15.6" />
<meta name="twitter:description" content="It is important that all system and vendor accounts that are not used for logins are locked. To get a list of unlocked accounts on your system, you can check f…" />
<link rel="home" href="index.html" title="openSUSE Leap Documentation" /><link rel="up" href="part-local-security.html" title="Part II. Local security" /><link rel="prev" href="cha-configure-cryptctl.html" title="Chapter 13. Storage encryption for hosted applications with cryptctl" /><link rel="next" href="cha-sec-cron-at.html" title="Chapter 15. Restricting cron and at" />
<script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css" /></noscript><script src="static/js/jquery-1.12.4.min.js" type="text/javascript"></script><script src="static/js/script.js" type="text/javascript"></script><script src="static/js/highlight.min.js" type="text/javascript"></script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-navigation">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><div id="_outer-wrap"><div id="_white-bg" style="background-color: #E11;"><div id="_header"><div id="_logo"><img src="static/images/logo.svg" alt="Logo" /></div><div class="crumbs"><a class="book-link" href="index.html" title="Security and Hardening Guide"><span class="book-icon">Security and Hardening Guide</span></a><span> › </span><a class="crumb" href="part-local-security.html">Local security</a><span> › </span><a class="crumb" href="sec-sec-user-management.html">User management</a></div><div class="clearme"></div></div></div><div id="_toolbar-wrap"><div id="_toolbar"><div id="_toc-area" class="inactive"><a id="_toc-area-button" class="tool" title="Contents" accesskey="c" href="index.html"><span class="tool-spacer"><span class="toc-icon">Contents</span><span class="clearme"></span></span><span class="tool-label">Contents</span></a><div class="active-contents bubble-corner"></div><div class="active-contents bubble"><div class="bubble-container"><h6>Security and Hardening Guide</h6><div id="_bubble-toc"><ol><li class="inactive"><a href="preface-security.html"><span class="number"> </span><span class="name">Preface</span></a></li><li class="inactive"><a href="cha-security.html"><span class="number">1 </span><span class="name">Security and confidentiality</span></a></li><li class="inactive"><a href="part-auth.html"><span class="number">I </span><span class="name">Authentication</span></a><ol><li class="inactive"><a href="cha-pam.html"><span class="number">2 </span><span class="name">Authentication with PAM</span></a></li><li class="inactive"><a href="cha-nis.html"><span class="number">3 </span><span class="name">Using NIS</span></a></li><li class="inactive"><a href="cha-security-auth.html"><span class="number">4 </span><span class="name">Setting up authentication clients using YaST</span></a></li><li class="inactive"><a href="cha-security-ldap.html"><span class="number">5 </span><span class="name">LDAP with 389 Directory Server</span></a></li><li class="inactive"><a href="cha-security-kerberos.html"><span class="number">6 </span><span class="name">Network authentication with Kerberos</span></a></li><li class="inactive"><a href="cha-security-ad.html"><span class="number">7 </span><span class="name">Active Directory support</span></a></li><li class="inactive"><a href="cha-security-freeradius.html"><span class="number">8 </span><span class="name">Setting up a freeRADIUS server</span></a></li></ol></li><li class="inactive"><a href="part-local-security.html"><span class="number">II </span><span class="name">Local security</span></a><ol><li class="inactive"><a href="cha-physical-security.html"><span class="number">9 </span><span class="name">Physical security</span></a></li><li class="inactive"><a href="sec-sec-software-management.html"><span class="number">10 </span><span class="name">Software management</span></a></li><li class="inactive"><a href="sec-sec-file-management.html"><span class="number">11 </span><span class="name">File management</span></a></li><li class="inactive"><a href="cha-security-cryptofs.html"><span class="number">12 </span><span class="name">Encrypting partitions and files</span></a></li><li class="inactive"><a href="cha-configure-cryptctl.html"><span class="number">13 </span><span class="name">Storage encryption for hosted applications with cryptctl</span></a></li><li class="inactive"><a href="sec-sec-user-management.html"><span class="number">14 </span><span class="name">User management</span></a></li><li class="inactive"><a href="cha-sec-cron-at.html"><span class="number">15 </span><span class="name">Restricting <code class="systemitem">cron</code> and <code class="systemitem">at</code></span></a></li><li class="inactive"><a href="cha-spectre.html"><span class="number">16 </span><span class="name">Spectre/Meltdown checker</span></a></li><li class="inactive"><a href="cha-security-yast-security.html"><span class="number">17 </span><span class="name">Configuring security settings with YaST</span></a></li><li class="inactive"><a href="cha-security-polkit.html"><span class="number">18 </span><span class="name">The Polkit authentication framework</span></a></li><li class="inactive"><a href="cha-security-acls.html"><span class="number">19 </span><span class="name">Access control lists in Linux</span></a></li><li class="inactive"><a href="cha-aide.html"><span class="number">20 </span><span class="name">Intrusion detection with AIDE</span></a></li></ol></li><li class="inactive"><a href="part-network-security.html"><span class="number">III </span><span class="name">Network security</span></a><ol><li class="inactive"><a href="cha-xauth.html"><span class="number">21 </span><span class="name">X Window System and X authentication</span></a></li><li class="inactive"><a href="cha-ssh.html"><span class="number">22 </span><span class="name">Securing network operations with OpenSSH</span></a></li><li class="inactive"><a href="cha-security-firewall.html"><span class="number">23 </span><span class="name">Masquerading and firewalls</span></a></li><li class="inactive"><a href="cha-security-vpnserver.html"><span class="number">24 </span><span class="name">Configuring a VPN server</span></a></li><li class="inactive"><a href="cha-security-xca.html"><span class="number">25 </span><span class="name">Managing a PKI with XCA, X certificate and key manager</span></a></li><li class="inactive"><a href="cha-sec-sysctl.html"><span class="number">26 </span><span class="name">Improving network security with <code class="command">sysctl</code> variables</span></a></li></ol></li><li class="inactive"><a href="part-apparmor.html"><span class="number">IV </span><span class="name">Confining privileges with <span class="phrase">AppArmor</span></span></a><ol><li class="inactive"><a href="cha-apparmor-intro.html"><span class="number">27 </span><span class="name">Introducing <span class="phrase">AppArmor</span></span></a></li><li class="inactive"><a href="cha-apparmor-start.html"><span class="number">28 </span><span class="name">Getting started</span></a></li><li class="inactive"><a href="cha-apparmor-concept.html"><span class="number">29 </span><span class="name">Immunizing programs</span></a></li><li class="inactive"><a href="cha-apparmor-profiles.html"><span class="number">30 </span><span class="name">Profile components and syntax</span></a></li><li class="inactive"><a href="cha-apparmor-repos.html"><span class="number">31 </span><span class="name"><span class="phrase">AppArmor</span> profile repositories</span></a></li><li class="inactive"><a href="cha-apparmor-yast.html"><span class="number">32 </span><span class="name">Building and managing profiles with YaST</span></a></li><li class="inactive"><a href="cha-apparmor-commandline.html"><span class="number">33 </span><span class="name">Building profiles from the command line</span></a></li><li class="inactive"><a href="cha-apparmor-hat.html"><span class="number">34 </span><span class="name">Profiling your Web applications using ChangeHat</span></a></li><li class="inactive"><a href="cha-apparmor-pam.html"><span class="number">35 </span><span class="name">Confining users with <code class="systemitem">pam_apparmor</code></span></a></li><li class="inactive"><a href="cha-apparmor-managing.html"><span class="number">36 </span><span class="name">Managing profiled applications</span></a></li><li class="inactive"><a href="cha-apparmor-support.html"><span class="number">37 </span><span class="name">Support</span></a></li><li class="inactive"><a href="cha-apparmor-glossary.html"><span class="number">38 </span><span class="name"><span class="phrase">AppArmor</span> glossary</span></a></li></ol></li><li class="inactive"><a href="part-selinux.html"><span class="number">V </span><span class="name">SELinux</span></a><ol><li class="inactive"><a href="cha-selinux.html"><span class="number">39 </span><span class="name">Configuring SELinux</span></a></li></ol></li><li class="inactive"><a href="part-audit.html"><span class="number">VI </span><span class="name">The Linux Audit Framework</span></a><ol><li class="inactive"><a href="cha-audit-comp.html"><span class="number">40 </span><span class="name">Understanding Linux audit</span></a></li><li class="inactive"><a href="cha-audit-setup.html"><span class="number">41 </span><span class="name">Setting up the Linux audit framework</span></a></li><li class="inactive"><a href="cha-audit-scenarios.html"><span class="number">42 </span><span class="name">Introducing an audit rule set</span></a></li><li class="inactive"><a href="cha-audit-moreinfo.html"><span class="number">43 </span><span class="name">Useful resources</span></a></li></ol></li><li class="inactive"><a href="bk04apa.html"><span class="number">A </span><span class="name">GNU licenses</span></a></li></ol></div><div class="clearme"></div></div></div></div><div id="_nav-area" class="inactive"><div class="tool"><span class="nav-inner"><span class="tool-label">Navigation</span><a accesskey="p" class="tool-spacer" title="Chapter 13. Storage encryption for hosted applications with cryptctl" href="cha-configure-cryptctl.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 15. Restricting cron and at" href="cha-sec-cron-at.html"><span class="next-icon">→</span></a></span></div></div></div></div><div id="_fixed-header-wrap" style="background-color: #E11;" class="inactive"><div id="_fixed-header"><div class="crumbs"><a class="book-link" href="index.html" title="Security and Hardening Guide"><span class="book-icon">Security and Hardening Guide</span></a><span> › </span><a class="crumb" href="part-local-security.html">Local security</a><span> › </span><a class="crumb" href="sec-sec-user-management.html">User management</a></div><div class="buttons"><a class="top-button button" href="#">Top</a><div class="button"><a accesskey="p" class="tool-spacer" title="Chapter 13. Storage encryption for hosted applications with cryptctl" href="cha-configure-cryptctl.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Chapter 15. Restricting cron and at" href="cha-sec-cron-at.html"><span class="next-icon">→</span></a></div><div class="clearme"></div></div><div class="clearme"></div></div></div><div id="_content" class="draft "><div class="documentation"><div class="chapter " id="sec-sec-user-management"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname "><span class="productname"><span class="phrase">openSUSE Leap</span></span></span> <span class="productnumber "><span class="productnumber"><span class="phrase">15.6</span></span></span></div><div><h2 class="title"><span class="number">14 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">User management</span> <a title="Permalink" class="permalink" href="sec-sec-user-management.html#">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/user_management.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>user_management.xml</li><li><span class="ds-label">ID: </span>sec-sec-user-management</li></ul></div></div></div></div><div class="line"><div class="toc"><dl><dt><span class="sect1"><a href="sec-sec-user-management.html#sec-sec-prot-general-accounts"><span class="number">14.1 </span><span class="name">Various account checks</span></a></span></dt><dt><span class="sect1"><a href="sec-sec-user-management.html#sec-sec-prot-general-pw-aging"><span class="number">14.2 </span><span class="name">Enabling password aging</span></a></span></dt><dt><span class="sect1"><a href="sec-sec-user-management.html#sec-sec-prot-general-pw-strength"><span class="number">14.3 </span><span class="name">Stronger password enforcement</span></a></span></dt><dt><span class="sect1"><a href="sec-sec-user-management.html#sec-sec-prot-general-pam"><span class="number">14.4 </span><span class="name">Password and login management with PAM</span></a></span></dt><dt><span class="sect1"><a href="sec-sec-user-management.html#sec-sec-prot-restrict-root"><span class="number">14.5 </span><span class="name">Restricting <code class="systemitem">root</code> logins</span></a></span></dt><dt><span class="sect1"><a href="sec-sec-user-management.html#sec-sec-prot-restrict-sudo"><span class="number">14.6 </span><span class="name">Restricting <code class="command">sudo</code> users</span></a></span></dt><dt><span class="sect1"><a href="sec-sec-user-management.html#sec-sec-prot-inactivity-logout"><span class="number">14.7 </span><span class="name">Setting an inactivity timeout for interactive shell sessions</span></a></span></dt><dt><span class="sect1"><a href="sec-sec-user-management.html#sec-sec-prot-dos"><span class="number">14.8 </span><span class="name">Preventing accidental denial of service</span></a></span></dt><dt><span class="sect1"><a href="sec-sec-user-management.html#sec-sec-prot-banners"><span class="number">14.9 </span><span class="name">Displaying login banners</span></a></span></dt><dt><span class="sect1"><a href="sec-sec-user-management.html#sec-sec-prot-misc-account-utils"><span class="number">14.10 </span><span class="name">Connection accounting utilities</span></a></span></dt></dl></div></div><div class="sect1 " id="sec-sec-prot-general-accounts"><div class="titlepage"><div><div><h2 class="title"><span class="number">14.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Various account checks</span> <a title="Permalink" class="permalink" href="sec-sec-user-management.html#sec-sec-prot-general-accounts">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/user_management.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>user_management.xml</li><li><span class="ds-label">ID: </span>sec-sec-prot-general-accounts</li></ul></div></div></div></div><div class="sect2 " id="sec-sec-prot-general-accounts-unlocked"><div class="titlepage"><div><div><h3 class="title"><span class="number">14.1.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Unlocked accounts</span> <a title="Permalink" class="permalink" href="sec-sec-user-management.html#sec-sec-prot-general-accounts-unlocked">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/user_management.xml" title="Edit the source file for this section">Edit source</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>user_management.xml</li><li><span class="ds-label">ID: </span>sec-sec-prot-general-accounts-unlocked</li></ul></div></div></div></div><p>
     It is important that all system and vendor accounts that are not used for
     logins are locked. To get a list of unlocked accounts on your system, you
     can check for accounts that do <span class="emphasis"><em>not</em></span> have an encrypted
     password string starting with <code class="literal">!</code> or
     <code class="literal">*</code> in the <code class="filename">/etc/shadow</code> file. If you
     lock an account using either <code class="command">passwd</code> <code class="option">-l</code> or
     <code class="command">usermod</code> <code class="option">-L</code>, it
     puts a <code class="literal">!</code> in front of the encrypted password,
     effectively disabling the password. Many system and
     shared accounts are locked by default by having a
     <code class="literal">*</code> ,<code class="literal">!!</code> or <code class="literal">!*</code> as the password field which
     renders the encrypted password into an invalid string. Hence, to get a
     list of all unlocked (encryptable) accounts, run the following command:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>egrep -v ':\*|:\!' /etc/shadow | awk -F: '{print $1}'</pre></div><p>
     Also make sure all accounts have an <code class="literal">x</code> in the password
     field in <code class="filename">/etc/passwd</code>. The following command lists
     all accounts that do not have a <code class="literal">x</code> in the password
     field:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>grep -v ':x:' /etc/passwd</pre></div><p>
     An <code class="literal">x</code> in the password field means that the password
     has been shadowed, for example, the encrypted password needs to be looked
     up in the <code class="filename">/etc/shadow</code> file. If the password field in
     <code class="filename">/etc/passwd</code> is empty, then the system does not look
     up the shadow file and it prompts the user for a password at the
     login prompt.
    </p></div><div class="sect2 " id="sec-sec-prot-general-accounts-unused"><div class="titlepage"><div><div><h3 class="title"><span class="number">14.1.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Unused accounts</span> <a title="Permalink" class="permalink" href="sec-sec-user-management.html#sec-sec-prot-general-accounts-unused">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/user_management.xml" title="Edit the source file for this section">Edit source</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>user_management.xml</li><li><span class="ds-label">ID: </span>sec-sec-prot-general-accounts-unused</li></ul></div></div></div></div><p>
     All system or vendor accounts that are not being used by users,
     applications, by the system or by daemons should be removed from the
     system. You can use the following command to find out if there are any
     files owned by a specific account:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>find / -path /proc -prune -o -user <em class="replaceable ">ACCOUNT</em> -ls</pre></div><p>
     The <code class="option">-prune</code> option in this example is used to skip the
     /proc file system. If you are sure that an account can be deleted, you
     can remove the account using the following command:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>userdel -r <em class="replaceable ">ACCOUNT</em></pre></div><p>
     Without the <code class="option">-r</code> option, <code class="command">userdel</code> does
     not delete the user's home directory and mail spool
     (<code class="filename">/var/spool/mail/<em class="replaceable ">USER</em></code>).
     Many system accounts do not have a home directory.
    </p></div></div><div class="sect1 " id="sec-sec-prot-general-pw-aging"><div class="titlepage"><div><div><h2 class="title"><span class="number">14.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Enabling password aging</span> <a title="Permalink" class="permalink" href="sec-sec-user-management.html#sec-sec-prot-general-pw-aging">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/user_management.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>user_management.xml</li><li><span class="ds-label">ID: </span>sec-sec-prot-general-pw-aging</li></ul></div></div></div></div><p>
    Password expiration is a general best practice, but might need to
    be excluded for certain system and shared accounts (for example, Oracle). Expiring passwords on those accounts could lead to system outages if
    the application account expires.
   </p><p>
    Typically a corporate policy should be developed that dictates
    rules/procedures regarding password changes for system and shared
    accounts. However, normal user account passwords should expire
    automatically. The following example shows how password expiration can be
    set up for individual user accounts.
   </p><p>
    The following files and parameters in the table can be used when a new
    account is created with the <code class="command">useradd</code> command. Settings
    such as these are stored for each user account in the
    <code class="filename">/etc/shadow</code> file. If using the YaST tool
    (<span class="guimenu ">User and Group Management</span>) to add users, the settings
    are available on a per-user basis. Here are the various
    settings, some of which can also be system-wide (for example,
    modification of <code class="filename">/etc/login.defs</code> and
    <code class="filename">/etc/default/useradd</code>):
   </p><div class="informaltable"><table class="informaltable" border="1"><colgroup><col /><col /><col /></colgroup><tbody><tr><td>
        <p>
         <code class="filename">/etc/login.defs</code>
        </p>
       </td><td>
        <p>
         <code class="literal">PASS_MAX_DAYS</code>
        </p>
       </td><td>
        <p>
         Maximum number of days a password is valid.
        </p>
       </td></tr><tr><td>
        <p>
         <code class="filename">/etc/login.defs</code>
        </p>
       </td><td>
        <p>
         <code class="literal">PASS_MIN_DAYS</code>
        </p>
       </td><td>
        <p>
         Minimum number of days before a user can change the password since
         the last change.
        </p>
       </td></tr><tr><td>
        <p>
         <code class="filename">/etc/login.defs</code>
        </p>
       </td><td>
        <p>
         <code class="literal">PASS_WARN_AGE</code>
        </p>
       </td><td>
        <p>
         Number of days between the last password change and the next
         password change reminder.
        </p>
       </td></tr><tr><td>
        <p>
         <code class="filename">/etc/default/useradd</code>
        </p>
       </td><td>
        <p>
         <code class="literal">INACTIVE</code>
        </p>
       </td><td>
        <p>
          Number of days after password expiration until the account is
          disabled.
        </p>
       </td></tr><tr><td>
        <p>
         <code class="filename">/etc/default/useradd</code>
        </p>
       </td><td>
        <p>
         <code class="literal">EXPIRE</code>
        </p>
       </td><td>
        <p>
         Account expiration date in the format YYYY-MM-DD.
        </p>
       </td></tr></tbody></table></div><div id="id-1.6.5.7.4.6" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg" /><h6>Note: Existing users not affected</h6><p>
     Users created before these modifications are not affected.
    </p></div><p>
    Ensure that the above parameters are changed in the
    <code class="filename">/etc/login.defs</code> and
    <code class="filename">/etc/default/useradd</code> files. A review of the
    <code class="filename">/etc/shadow</code> file shows how these settings are
    stored after adding a user.
   </p><p>
    To create a new user account, execute the following command:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>useradd -c "<em class="replaceable ">TEST_USER</em>" -g <em class="replaceable ">USERS</em> <em class="replaceable ">TEST</em></pre></div><p>
    The <code class="option">-g</code> option specifies the primary group for this
    account:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>id <em class="replaceable ">TEST</em>
uid=509(test) gid=100(users) groups=100(users)</pre></div><p>
    The settings in <code class="filename">/etc/login.defs</code> and
    <code class="filename">/etc/default/useradd</code> are recorded for the test user
    in the <code class="filename">/etc/shadow</code> file as follows:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>grep <em class="replaceable ">TEST</em> /etc/shadow
test:!!:12742:7:60:7:14::</pre></div><p>
    Password aging can be modified at any time by use of the
    <code class="command">chage</code> command. To disable password aging for system and
    shared accounts, you can run the following <code class="command">chage</code>
    command:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>chage -M -1 <em class="replaceable ">SYSTEM_ACCOUNT_NAME</em></pre></div><p>
    To get password expiration information:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>chage -l <em class="replaceable ">SYSTEM_ACCOUNT_NAME</em></pre></div><p>
    For example:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>chage -l <em class="replaceable ">TEST</em>
Minimum: 7
Maximum: 60
Warning: 7
Inactive: 14
Last Change: Jan 11, 2015
Password Expires: Mar 12, 2015
Password Inactive: Mar 26, 2015
Account Expires: Never</pre></div></div><div class="sect1 " id="sec-sec-prot-general-pw-strength"><div class="titlepage"><div><div><h2 class="title"><span class="number">14.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Stronger password enforcement</span> <a title="Permalink" class="permalink" href="sec-sec-user-management.html#sec-sec-prot-general-pw-strength">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/user_management.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>user_management.xml</li><li><span class="ds-label">ID: </span>sec-sec-prot-general-pw-strength</li></ul></div></div></div></div><p>
    On an audited system, it is important to restrict people from using simple
    passwords that can be cracked too easily. Writing down complex passwords
    is all right if stored securely. Some argue that
    strong passwords protect you against dictionary attacks, and those types of
    attacks can be defeated by locking accounts after a few failed attempts.
    However, this is not always an option. If set up like this, locking system
    accounts could bring down your applications and systems, which would be
    nothing short of a denial-of-service attack—another issue.
   </p><p>
    At any rate, it is important to practice effective password management
    security. Most companies require that passwords have at least a
    number, one lowercase letter, and one uppercase letter. Policies vary, but
    maintaining a balance between password strength/complexity and management
    can be difficult.
   </p></div><div class="sect1 " id="sec-sec-prot-general-pam"><div class="titlepage"><div><div><h2 class="title"><span class="number"> </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Password and login management with PAM</span> <a title="Permalink" class="permalink" href="sec-sec-user-management.html#sec-sec-prot-general-pam">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/hardening_pam_stack.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>hardening_pam_stack.xml</li><li><span class="ds-label">ID: </span><span class="ds-message">no ID found</span></li></ul></div></div></div></div><p>
     Linux-PAM (Pluggable Authentication Modules for Linux) is a suite of
     shared libraries that enable the local system administrator to choose
     how applications authenticate users.
    </p><p>
     It is strongly recommended to familiarize oneself with the capabilities
     of PAM and how this architecture can be leveraged to provide the
     best authentication setup for an environment. This configuration can be
     done once, and implemented across all systems (a standard), or can be
     enhanced for individual hosts (enhanced security—by
     host/service/application).
     The key is to realize how flexible the architecture is.
    </p><p>
     To learn more about the PAM architecture, find PAM documentation in
     the <code class="filename">/usr/share/doc/packages/pam</code> directory (in
     a variety of formats).
    </p><p>
     The following discussions are examples of how to modify the default PAM
     stacks—specifically around password policies—for
     example password strength, password re-use, and account locking. While
     these are only a few of the possibilities, they serve as a good start
     and demonstrate PAM's flexibility.
    </p><div id="id-1.6.5.7.6.6" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg" /><h6>Important: <code class="command">pam-config</code> limitations</h6><p>
            The <code class="command">pam-config</code> tool can be used to configure the
            common-{account,auth,password,session} PAM configuration files, which
            contain global options. These files include the following comment:
        </p><div class="verbatim-wrap"><pre class="screen"># This file is autogenerated by pam-config. All changes
# will be overwritten.</pre></div><p>
            Individual service files, such as <code class="filename">login, password, sshd</code>,
            and <code class="filename">su</code> must be edited directly. You can elect to edit
            all files directly, and not use <code class="command">pam-config</code>, though
            <code class="command">pam-config</code> includes useful features such as converting
            an older configuration, updating your current configuration, and sanity checks.
            For more information, see <code class="command">man 8 pam-config</code>.
        </p></div><div class="sect2 " id="sec-sec-prot-general-pam-pw-strength"><div class="titlepage"><div><div><h3 class="title"><span class="number">14.4.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Password strength</span> <a title="Permalink" class="permalink" href="sec-sec-user-management.html#sec-sec-prot-general-pam-pw-strength">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/hardening_pam_stack.xml" title="Edit the source file for this section">Edit source</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>hardening_pam_stack.xml</li><li><span class="ds-label">ID: </span>sec-sec-prot-general-pam-pw-strength</li></ul></div></div></div></div><p>
      <span class="productname"><span class="phrase">openSUSE Leap</span></span> can leverage the
      <code class="systemitem">pam_cracklib</code> library to test
      for weak passwords—and to suggest using a stronger one if it
      determines obvious weakness. The following parameters represent an
      example that could be part of a corporate password policy or something
      required because of audit constraints.
     </p><p>
      The PAM libraries follow a defined flow. The best way to design the
      perfect stack usually is to consider all of the requirements and
      policies and draw out a flow chart.
     </p><div class="table" id="id-1.6.5.7.6.7.4"><div class="table-title-wrap"><h6 class="table-title"><span class="number">Table 14.1: </span><span class="name">Sample rules/constraints for password enforcement </span><a title="Permalink" class="permalink" href="sec-sec-user-management.html#id-1.6.5.7.6.7.4">#</a></h6></div><div class="table-contents"><table class="table" summary="Sample rules/constraints for password enforcement" border="1"><colgroup><col /><col /><col /></colgroup><tbody><tr><td>
          <p>
           <code class="systemitem">pam_cracklib.so</code>
          </p>
         </td><td>
          <p>
           <code class="literal">minlen=8</code>
          </p>
         </td><td>
          <p>
           Minimum length of password is 8
          </p>
         </td></tr><tr><td>
          <p>
           <code class="systemitem">pam_cracklib.so</code>
          </p>
         </td><td>
          <p>
           <code class="literal">lcredit=-1</code>
          </p>
         </td><td>
          <p>
           Minimum number of lowercase letters is 1
          </p>
         </td></tr><tr><td>
          <p>
           <code class="systemitem">pam_cracklib.so</code>
          </p>
         </td><td>
          <p>
           <code class="literal">ucredit=-1</code>
          </p>
         </td><td>
          <p>
           Minimum number of uppercase letters is 1
          </p>
         </td></tr><tr><td>
          <p>
           <code class="systemitem">pam_cracklib.so</code>
          </p>
         </td><td>
          <p>
           <code class="literal">dcredit=-1</code>
          </p>
         </td><td>
          <p>
           Minimum number of digits is 1
          </p>
         </td></tr><tr><td>
          <p>
           <code class="systemitem">pam_cracklib.so</code>
          </p>
         </td><td>
          <p>
           <code class="literal">ocredit=-1</code>
          </p>
         </td><td>
          <p>
           Minimum number of other characters is 1
          </p>
         </td></tr></tbody></table></div></div><p>
      To set up these password restrictions, use the
      <code class="command">pam-config</code> tool to specify the parameters you want
      to configure. For example, the minimum length parameter could be
      modified like this:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> pam-config -a --cracklib-minlen=8 --cracklib-retry=3 \
--cracklib-lcredit=-1 --cracklib-ucredit=-1 --cracklib-dcredit=-1 \
--cracklib-ocredit=-1 --cracklib</pre></div><p>
      Now verify that the new password restrictions work for new passwords.
      Log in to a non-root account and change the password using the
      <code class="command">passwd</code> command. Note that the above requirements
      are not enforced if you run the <code class="command">passwd</code> command
      under root.
     </p></div><div class="sect2 " id="sec-sec-prot-general-pam-pw-previous"><div class="titlepage"><div><div><h3 class="title"><span class="number">14.4.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Restricting use of previous passwords</span> <a title="Permalink" class="permalink" href="sec-sec-user-management.html#sec-sec-prot-general-pam-pw-previous">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/hardening_pam_stack.xml" title="Edit the source file for this section">Edit source</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>hardening_pam_stack.xml</li><li><span class="ds-label">ID: </span>sec-sec-prot-general-pam-pw-previous</li></ul></div></div></div></div><p>
      The pam_pwhistory module can be used to configure the number of
      previous passwords that cannot be reused. The following command
      implements password restrictions on a system so that a password cannot
      be reused for at least six months:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> pam-config -a --pwhistory --pwhistory-remember=26</pre></div><p>
      Recall that in the section
      <a class="xref" href="sec-sec-user-management.html#sec-sec-prot-general-pw-aging" title="14.2. Enabling password aging">Section 14.2, “Enabling password aging”</a> we set
      <code class="literal">PASS_MIN_DAYS</code> to <code class="literal">7</code>, which
      specifies the minimum number of days allowed between password changes.
      Therefore, if <code class="systemitem">pam_unix</code> is configured to
      remember <code class="literal">26</code> passwords, then the previously used
      passwords cannot be reused for at least six months (26*7 days).
     </p><p>
      The PAM configuration (<code class="filename">/etc/pam.d/common-password</code>)
      resulting from the <code class="command">pam-config</code> command looks like the
      following:
     </p><div class="verbatim-wrap"><pre class="screen">auth      required   pam_env.so
auth      required   pam_unix.so     try_first_pass
account   required   pam_unix.so     try_first_pass
password  requisite   pam_cracklib.so
password  required   pam_pwhistory.so        remember=26
password  optional   pam_gnome_keyring.so    use_authtok
password  required   pam_unix.so     use_authtok nullok shadow try_first_pass
session   required   pam_limits.so
session   required   pam_unix.so     try_first_pass
session   optional   pam_umask.so</pre></div></div><div class="sect2 " id="sec-sec-prot-general-pam-lock-accounts"><div class="titlepage"><div><div><h3 class="title"><span class="number">14.4.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Locking user accounts after too many login failures</span> <a title="Permalink" class="permalink" href="sec-sec-user-management.html#sec-sec-prot-general-pam-lock-accounts">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/hardening_pam_stack.xml" title="Edit the source file for this section">Edit source</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>hardening_pam_stack.xml</li><li><span class="ds-label">ID: </span>sec-sec-prot-general-pam-lock-accounts</li></ul></div></div></div></div><p>
      Locking accounts after a defined number of failed ssh, login, su, or sudo
      attempts is a common security practice. However, this could lead to
      outages if an application, admin, or <code class="systemitem">root</code> user is locked out.
     </p><div id="id-1.6.5.7.6.9.3" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg" /><h6>Important: Denial-of-service attacks</h6><p>
       Password failure counts can easily be abused to cause denial-of-service
       attacks by deliberately creating login failures.
      </p><p>
       Only use password failure counts if you have to. Restrict locking to the
       necessary minimum, and do not lock critical accounts. Keep in mind that
       locking not only applies to human users but also to system accounts used
       to provide services.
      </p></div><p>
      <span class="productname"><span class="phrase">openSUSE Leap</span></span> does not lock accounts by default, but provides PAM module
      <code class="command">pam_tally2</code> to easily implement password failure counts.
      Add the following line to the top of <code class="filename">/etc/pam.d/login</code>
      to lock out all users (except for <code class="systemitem">root</code>) after six failed logins, and
      to automatically unlock the accounts after ten minutes:
     </p><div class="verbatim-wrap"><pre class="screen">auth required pam_tally2.so deny=6 unlock_time=600</pre></div><p>
         This is an example of a complete <code class="filename">/etc/pam.d/login</code> file:
     </p><div class="verbatim-wrap"><pre class="screen">#%PAM-1.0
auth     requisite      pam_nologin.so
auth     include        common-auth
auth     required       pam_tally2.so deny=6 unlock_time=600
account  include        common-account
account  required       pam_tally2.so
password include        common-password
session  required       pam_loginuid.so
session  include        common-session
#session  optional       pam_lastlog.so nowtmp showfailed
session  optional       pam_mail.so standard</pre></div><p>
      You can also lock out <code class="systemitem">root</code>, though obviously you must be very
      certain you want to do this:
     </p><div class="verbatim-wrap"><pre class="screen">auth required pam_tally2.so deny=6 even_deny_root unlock_time=600</pre></div><p>
      You can define a different lockout time for root:
     </p><div class="verbatim-wrap"><pre class="screen">auth required pam_tally2.so deny=6 root_unlock_time=120  unlock_time=600</pre></div><p>
     If you want to require the administrator to unlock accounts, leave out the
     <code class="literal">unlock_time</code> option. The next two example commands
     display the number of failed login attempts and how to unlock a user
     account:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> <code class="command">pam_tally2 -u <em class="replaceable ">username</em></code>
Login           Failures Latest failure     From
username            6    12/17/19 13:49:43  pts/1

<code class="prompt user">&gt; </code><code class="command">sudo</code> <code class="command">pam_tally2 -r -u <em class="replaceable ">username</em></code></pre></div><p>
      The default location for attempted accesses is recorded in
      <code class="filename">/var/log/tallylog</code>.
     </p><p>
      If the user succeeds in logging in after the login timeout expires, or
      after the administrator resets their account, the counter resets to 0.
     </p><p>
      Configure other login services to use <code class="command">pam_tally2</code> in
      their individual configuration files in <code class="filename">/etc/pam.d/</code>:
      <code class="filename">sshd, su, sudo, sudo-i</code>, and <code class="filename">su-l</code>.
     </p></div></div><div class="sect1 " id="sec-sec-prot-restrict-root"><div class="titlepage"><div><div><h2 class="title"><span class="number">14.5 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Restricting <code class="systemitem">root</code> logins</span> <a title="Permalink" class="permalink" href="sec-sec-user-management.html#sec-sec-prot-restrict-root">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/user_management.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>user_management.xml</li><li><span class="ds-label">ID: </span>sec-sec-prot-restrict-root</li></ul></div></div></div></div><p>
    By default, the <code class="systemitem">root</code> user is assigned a password
    and can log in using various methods—for example, on a local
    terminal, in a graphical session, or remotely via SSH. These methods
    should be restricted as far as possible. Shared usage of the root account
    should be avoided. Instead, individual administrators should use tools such as
    <code class="literal">su</code> or <code class="literal">sudo</code> (for more information,
    type <code class="command">man 1 su</code> or <code class="command">man 8 sudo</code>) to obtain elevated
    privileges. This allows associating <code class="systemitem">root</code> logins with particular
    users. This also adds another layer of security; not only the <code class="systemitem">root</code>
    password, but both the <code class="systemitem">root</code> <span class="emphasis"><em>and</em></span> the password of
    an administrator's regular account would need to be compromised to gain full root
    access. This section explains how to limit direct root logins on the different
    levels of the system.
   </p><div class="sect2 " id="sec-sec-prot-restrict-root-tty"><div class="titlepage"><div><div><h3 class="title"><span class="number">14.5.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Restricting local text console logins</span> <a title="Permalink" class="permalink" href="sec-sec-user-management.html#sec-sec-prot-restrict-root-tty">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/user_management.xml" title="Edit the source file for this section">Edit source</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>user_management.xml</li><li><span class="ds-label">ID: </span>sec-sec-prot-restrict-root-tty</li></ul></div></div></div></div><p>
     TTY devices provide text-mode system access via the console. For desktop
     systems these are accessed via the local keyboard or—in case of server
     systems—via input devices connected to a KVM switch or a remote
     management card (for example, ILO and DRAC).
     By default, Linux offers six different consoles, which can be switched to
     via the key combinations
     <span class="keycap">Alt</span><span class="key-connector">–</span><span class="keycap">F1</span> to
     <span class="keycap">Alt</span><span class="key-connector">–</span><span class="keycap">F6</span>, when
     running in text mode, or
     <span class="keycap">Ctrl</span><span class="key-connector">–</span><span class="keycap">Alt</span><span class="key-connector">–</span><span class="keycap">F1</span> to
     <span class="keycap">Ctrl</span><span class="key-connector">–</span><span class="keycap">Alt</span><span class="key-connector">–</span><span class="keycap">F6</span>
      when running in a graphical session. The
      associated terminal devices are named <code class="literal">tty1</code> to <code class="literal">tty6</code>.
    </p><p>
     The following steps restrict root access to the first TTY. Even this
     access method is only meant for emergency access to the system and should
     never be used for everyday system administration tasks.
    </p><div id="id-1.6.5.7.7.3.4" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg" /><h6>Note</h6><p>
      The steps shown here are tailored towards PC architectures (x86 and
      AMD64/Intel 64). On architectures such as POWER, different terminal
      device names than <code class="literal">tty1</code> can be used. Be careful not to
      lock yourself out by specifying wrong terminal device names.
      You can determine the device name of the terminal you are currently
      logged in to by running the <code class="literal">tty</code> command. Be careful
      not to do this in a virtual terminal, such as via SSH or in a graphical
      session (device names <code class="filename">/dev/pts/<em class="replaceable ">N</em></code>),
      but only from an actual login terminal reachable via
      <span class="keycap">Alt</span><span class="key-connector">–</span><span class="keycap">F<em class="replaceable ">N</em></span>.
     </p></div><div class="procedure " id="id-1.6.5.7.7.3.5"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 14.1: </span><span class="name">Restricting root logins on local TTYs </span><a title="Permalink" class="permalink" href="sec-sec-user-management.html#id-1.6.5.7.7.3.5">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
       Ensure that the PAM stack configuration file <code class="filename">/etc/pam.d/login</code>
       contains the <code class="literal">pam_securetty</code> module in the <code class="literal">auth</code> block:
      </p><div class="verbatim-wrap"><pre class="screen">auth     requisite      pam_nologin.so
 auth     [user_unknown=ignore success=ok ignore=ignore auth_err=die default=bad] pam_securetty.so noconsole
 auth     include        common-auth</pre></div><p>
        This includes the <code class="literal">pam_securetty</code> module during the
        authentication process on local consoles, which restricts <code class="systemitem">root</code> to logging in
        only on TTY devices that are listed in the file <code class="filename">/etc/securetty</code>.
      </p></li><li class="step "><p>
       Remove all entries from <code class="filename">/etc/securetty</code> except one.
       This limits the access to TTY devices for root.
      </p><div class="verbatim-wrap"><pre class="screen">#
# This file contains the device names of tty lines (one per line,
# without leading /dev/) on which root is allowed to login.
#
tty1</pre></div></li><li class="step "><p>
       Check whether logins to other terminals are rejected for
       <code class="systemitem">root</code>. A login on <code class="literal">tty2</code>, for example, should be
       rejected immediately, without even querying the account password.
       Also make sure that you can still successfully log in to
       <code class="literal">tty1</code> and thus that <code class="systemitem">root</code> is not locked out of
       the system.
      </p></li></ol></div></div><div id="id-1.6.5.7.7.3.6" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg" /><h6>Important: Do not add pam_securetty module</h6><p>
      Do not add the <code class="literal">pam_securetty</code> module to the
      <code class="filename">/etc/pam.d/common-auth</code> file. This would
      break the <code class="command">su</code> and <code class="command">sudo</code> commands,
      because these tools would then also reject <code class="systemitem">root</code> authentications.
     </p></div><div id="id-1.6.5.7.7.3.7" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg" /><h6>Important</h6><p>
      These configuration changes also cause root logins on serial
      consoles such as <code class="filename">/dev/ttyS0</code> to be denied. In case you
      require such use cases, you need to list the respective TTY devices
      additionally in the <code class="filename">/etc/securetty</code> file.
     </p></div></div><div class="sect2 " id="sec-sec-prot-restrict-root-graphical"><div class="titlepage"><div><div><h3 class="title"><span class="number">14.5.2 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Restricting graphical session logins</span> <a title="Permalink" class="permalink" href="sec-sec-user-management.html#sec-sec-prot-restrict-root-graphical">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/user_management.xml" title="Edit the source file for this section">Edit source</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>user_management.xml</li><li><span class="ds-label">ID: </span>sec-sec-prot-restrict-root-graphical</li></ul></div></div></div></div><p>
     To improve security on your server, avoid using graphical
     environments at all. Graphical programs are often
     not designed to be run as <code class="systemitem">root</code> and can
     contain security issues than console programs. If you require a graphical
     login, use a non-<code class="systemitem">root</code> login. Configure your system to disallow
     <code class="systemitem">root</code> from logging in to graphical sessions.
    </p><p>
     To prevent <code class="systemitem">root</code> from logging in to graphical sessions, you
     can apply the same basic steps as outlined in
     <a class="xref" href="sec-sec-user-management.html#sec-sec-prot-restrict-root-tty" title="14.5.1. Restricting local text console logins">Section 14.5.1, “Restricting local text console logins”</a>.
     Just add the <code class="literal">pam_securetty</code> module to the PAM
     stack file belonging to the display manager—for example,
     <code class="filename">/etc/pam.d/gdm</code> for GDM. The graphical
     session also runs on a TTY device: by default, <code class="literal">tty7</code>.
     Therefore, if you restrict <code class="systemitem">root</code> logins to <code class="literal">tty1</code>,
     then <code class="systemitem">root</code> is denied login in the graphical session.
    </p></div><div class="sect2 " id="sec-sec-prot-restrict-root-ssh"><div class="titlepage"><div><div><h3 class="title"><span class="number">14.5.3 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Restricting SSH logins</span> <a title="Permalink" class="permalink" href="sec-sec-user-management.html#sec-sec-prot-restrict-root-ssh">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/user_management.xml" title="Edit the source file for this section">Edit source</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>user_management.xml</li><li><span class="ds-label">ID: </span>sec-sec-prot-restrict-root-ssh</li></ul></div></div></div></div><p>
     By default, the <code class="systemitem">root</code> user is also allowed to log
     in to a machine remotely via the SSH network protocol (if the SSH port is
     not blocked by the firewall). To restrict this, make the following
     change to the OpenSSH configuration:
    </p><div class="procedure "><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>Edit <code class="filename">/etc/ssh/sshd_config</code> and adjust the following parameter:</p><div class="verbatim-wrap"><pre class="screen">PermitRootLogin no</pre></div></li><li class="step "><p>Restart the <code class="systemitem">sshd</code> service to make the changes effective:</p><div class="verbatim-wrap"><pre class="screen">systemctl restart sshd.service</pre></div></li></ol></div></div><div id="id-1.6.5.7.7.5.4" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg" /><h6>Note</h6><p>
      Using the PAM <code class="literal">pam_securetty</code> module is not suitable in
      case of OpenSSH, because not all SSH logins go through the PAM
      stack during authorization (for example, when using SSH public-key authentication).
      Additionally, an attacker could differentiate between a wrong password
      and a successful login that was only rejected later on by policy.
     </p></div></div></div><div class="sect1 " id="sec-sec-prot-restrict-sudo"><div class="titlepage"><div><div><h2 class="title"><span class="number">14.6 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Restricting <code class="command">sudo</code> users</span> <a title="Permalink" class="permalink" href="sec-sec-user-management.html#sec-sec-prot-restrict-sudo">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/user_management.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>user_management.xml</li><li><span class="ds-label">ID: </span>sec-sec-prot-restrict-sudo</li></ul></div></div></div></div><p>
    The <code class="command">sudo</code> command allows users to execute commands in the
    context of another user, typically the <code class="systemitem">root</code> user. The
    <code class="command">sudo</code> configuration consists of a rule-set that defines
    the mappings between commands to execute and their allowed source and target
    users and groups. The configuration is stored in the file
    <code class="filename">/etc/sudoers</code>.
    
    
   </p><p>
    By default, <code class="command">sudo</code> asks for the <code class="systemitem">root</code> password on
    SUSE systems. Unlike <code class="command">su</code> however,
    <code class="command">sudo</code> remembers the password and allows further commands
    to be executed as <code class="systemitem">root</code> without asking for the password again for five
    minutes. Therefore, <code class="command">sudo</code> should be enabled for selected
    administrator users only.
   </p><div class="procedure " id="id-1.6.5.7.8.4"><div class="procedure-title-wrap"><h6 class="procedure-title"><span class="number">Procedure 14.2: </span><span class="name">Restricting <code class="command">sudo</code> for normal users </span><a title="Permalink" class="permalink" href="sec-sec-user-management.html#id-1.6.5.7.8.4">#</a></h6></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step "><p>
      Edit file <code class="filename">/etc/sudoers</code>, for example by executing
      <code class="command">visudo</code>.
     </p></li><li class="step "><p>
      Comment out the line that allows every user to run every command as
      long as they know the password of the user they want to use. Afterwards,
      it should look like this:
     </p><div class="verbatim-wrap"><pre class="screen">#ALL ALL=(ALL) ALL # WARNING! Only use this together with 'Defaults targetpw'!</pre></div></li><li class="step "><p>
      Uncomment the following line:
     </p><div class="verbatim-wrap"><pre class="screen">%wheel ALL=(ALL) ALL</pre></div><p>
      This limits the functionality described above to members of the group
      <code class="systemitem">wheel</code>. You can use a different
      group as <code class="systemitem">wheel</code> might have other
      implications that might not be suitable depending on your setup.
     </p></li><li class="step "><p>
      Add users that should be allowed to use <code class="command">sudo</code> to the
      chosen group. To add the user <code class="systemitem">tux</code> to the group
      <code class="systemitem">wheel</code>, use:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="command">usermod -aG <em class="replaceable ">wheel</em> <em class="replaceable ">tux</em></code></pre></div><p>
      To get the new group membership, users have to log out and back in again.
     </p></li><li class="step "><p>
      Verify the change by running a command with a user not in the group you
      have chosen for access control. You should see the error message:
     </p><div class="verbatim-wrap"><pre class="screen">wilber is not in the sudoers file.  This incident will be reported.</pre></div><p>
      Next, try the same with a member of the group. They should still be able
      to execute commands via <code class="command">sudo</code>.
     </p></li></ol></div></div><p>
    This configuration only limits the <code class="command">sudo</code>
    functionality. The <code class="command">su</code> command is still available to all
    users. If there are other ways to access the system, users with knowledge of
    the <code class="systemitem">root</code> password can easily execute commands via this vector.
   </p></div><div class="sect1 " id="sec-sec-prot-inactivity-logout"><div class="titlepage"><div><div><h2 class="title"><span class="number">14.7 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Setting an inactivity timeout for interactive shell sessions</span> <a title="Permalink" class="permalink" href="sec-sec-user-management.html#sec-sec-prot-inactivity-logout">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/user_management.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>user_management.xml</li><li><span class="ds-label">ID: </span>sec-sec-prot-inactivity-logout</li></ul></div></div></div></div><p>
    It can be a good idea to terminate an interactive shell session after a
    certain period of inactivity. For example, to prevent open, unguarded sessions,
    or to avoid wasting system resources.
   </p><p>
    By default, there is no inactivity timeout for shells. Nothing
    happens if a shell stays open and unused for days or even years. However,
    it is possible
    to configure most shells so that idle sessions terminate
    automatically after a certain amount of time. The following example
    shows how to set an inactivity timeout for several
    common types of shells.
   </p><p>
    The inactivity timeout can be configured for login shells only or for all
    interactive shells. In the latter case, the inactivity timeout runs
    individually for each shell instance. This means that timeouts
    accumulate. When a sub- or child-shell is started, a new timeout begins for
    the sub- or child-shell, and only afterwards the
    timeout of the parent continues running.
   </p><p>
    The following table contains configuration details for a selection of
    common shells shipped with <span class="productname"><span class="phrase">openSUSE Leap</span></span>:
   </p><div class="informaltable"><table class="informaltable" border="1"><colgroup><col class="col_1" /><col class="col_2" /><col class="col_3" /><col class="col_4" /><col class="col_5" /><col class="col_6" /><col class="col_7" /></colgroup><thead><tr><th>package</th><th>shell personalities</th><th align="center">shell variable</th><th align="center">time unit</th><th>readonly setting</th><th align="center">config path (only login shell)</th><th align="center">config path (all shells)</th></tr></thead><tbody><tr><td><p><code class="literal">bash</code></p></td><td><p><code class="literal">bash, sh</code></p></td><td align="center"><p><code class="literal">TMOUT</code></p></td><td align="center"><p>seconds</p></td><td><p><code class="literal">read-only TMOUT=</code></p></td><td><p><code class="filename">/etc/profile.local</code>, <code class="filename">/etc/profile.d/</code></p></td><td><p><code class="filename">/etc/bash.bashrc</code></p></td></tr><tr><td><p><code class="literal">mksh</code></p></td><td><p><code class="literal">ksh, lksh, mksh, pdksh</code></p></td><td align="center"><p><code class="literal">TMOUT</code></p></td><td align="center"><p>seconds</p></td><td><p><code class="literal">read-only TMOUT=</code></p></td><td><p><code class="filename">/etc/profile.local</code>, <code class="filename">/etc/profile.d/</code></p></td><td><p><code class="filename">/etc/ksh.kshrc.local</code></p></td></tr><tr><td><p><code class="literal">tcsh</code></p></td><td><p><code class="literal">csh, tcsh</code></p></td><td align="center"><p><code class="literal">autologout</code></p></td><td align="center"><p>minutes</p></td><td><p><code class="literal">set -r autologout=</code></p></td><td><p><code class="filename">/etc/csh.login.local</code></p></td><td><p><code class="filename">/etc/csh.cshrc.local</code></p></td></tr><tr><td><p><code class="literal">zsh</code></p></td><td><p><code class="literal">zsh</code></p></td><td align="center"><p><code class="literal">TMOUT</code></p></td><td align="center"><p>seconds</p></td><td><p><code class="literal">readonly TMOUT=</code></p></td><td><p><code class="filename">/etc/profile.local</code>, <code class="filename">/etc/profile.d/</code></p></td><td><p><code class="filename">/etc/zsh.zshrc.local</code></p></td></tr></tbody></table></div><p>
    Every listed shell supports an internal timeout shell variable that can be
    set to a specific time value to cause the inactivity timeout. If you want
    to prevent users from overriding the timeout setting, you can mark the
    corresponding shell timeout variable as read-only. The corresponding variable
    declaration syntax is also found in the table above.
   </p><div id="id-1.6.5.7.9.8" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg" /><h6>Note: No protection from hostile users</h6><p>
     This feature is only helpful for avoiding risks if a user is forgetful or follows
     unsafe practices. It does not protect against hostile users. The timeout
     only applies to interactive wait states of a shell. A malicious user can always
     find ways to circumvent the timeout and keep their session open regardless.
    </p></div><p>
    To configure the inactivity timeout, you need to add the matching timeout
    variable declaration to each shell's start-up script. Use either the path for
    login shells only, or the one for all shells, as listed in the table. The
    following example uses paths and settings that are suitable for
    <code class="command">bash</code> and <code class="command">ksh</code>
    to set up a read-only login shell timeout that cannot be overridden by users.
    Create the file <code class="filename">/etc/profile.d/timeout.sh</code> with the
    following content:
   </p><div class="verbatim-wrap"><pre class="screen"># /etc/profile.d/timeout.sh for SUSE Linux
#
# Timeout in seconds until the bash/ksh session is terminated
# in case of inactivity.
# 24h = 86400 sec
readonly TMOUT=86400</pre></div><div id="id-1.6.5.7.9.11" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.svg" /><h6>Tip</h6><p>
     We recommend using the <code class="command">screen</code> tool to
     detach sessions before logging out. <code class="command">screen</code> sessions
     are not terminated and can be re-attached whenever required. An active
     session can be locked without logging out (read about <span class="keycap">Ctrl</span><span class="key-connector">–</span><span class="keycap">A</span><span class="key-connector">–</span><span class="keycap">X</span> / <code class="command">lockscreen</code> in
     <code class="command">man screen</code> for details).
    </p></div></div><div class="sect1 " id="sec-sec-prot-dos"><div class="titlepage"><div><div><h2 class="title"><span class="number">14.8 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Preventing accidental denial of service</span> <a title="Permalink" class="permalink" href="sec-sec-user-management.html#sec-sec-prot-dos">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/user_management.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>user_management.xml</li><li><span class="ds-label">ID: </span>sec-sec-prot-dos</li></ul></div></div></div></div><p>
    Linux allows you to set limits on the amount of system resources that
    users and groups can consume. This is also useful if bugs in programs
    cause them to use up too many resources (for example, memory leaks), slow
    down the machine, or even render the system unusable. Incorrect settings
    can allow programs to use too many resources, which might make the server
    unresponsive to new connections or even local logins (for example, if a
    program uses up all available file handles on the host). This can also be
    a security concern if someone is allowed to consume all system resources
    and therefore cause a denial-of-service attack—either unplanned, or
    worse, planned. Setting resource limits for users and groups might be an
    effective way to protect systems, depending on the environment.
   </p><div class="sect2 " id="sec-sec-prot-dos-restrict-resources"><div class="titlepage"><div><div><h3 class="title"><span class="number">14.8.1 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Example for restricting system resources</span> <a title="Permalink" class="permalink" href="sec-sec-user-management.html#sec-sec-prot-dos-restrict-resources">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/user_management.xml" title="Edit the source file for this section">Edit source</a></h3><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>user_management.xml</li><li><span class="ds-label">ID: </span>sec-sec-prot-dos-restrict-resources</li></ul></div></div></div></div><p>
     The following example demonstrates the practical usage of setting or
     restricting system resource consumption for an Oracle user account. For a
     list of system resource settings, see
     <code class="filename">/etc/security/limits.conf</code> or <code class="command">man
     limits.conf</code>.
    </p><p>
     Most shells, such as Bash, provide control over various resources (for
     example, the maximum allowable number of open file descriptors or the
     maximum number of processes) that are available on a per-user basis. To
     examine all current limits in the shell, execute:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>ulimit -a</pre></div><p>
     For more information on <code class="command">ulimit</code> for the Bash shell,
     examine the Bash man pages.
    </p><div id="id-1.6.5.7.10.3.6" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg" /><h6>Important: Setting limits for SSH sessions</h6><p>
      Setting <span class="quote">“<span class="quote ">hard</span>”</span> and <span class="quote">“<span class="quote ">soft</span>”</span> limits might not have
      the expected results when using an SSH session. To see valid behavior, it
      might be necessary to log in as root, and then <code class="command">su</code> to the
      ID with limits (for example, <code class="literal">Oracle</code> in these examples).
      Resource limits should also work assuming the application was started
      automatically during the boot process. It might be necessary to set
      <code class="option">UsePrivilegeSeparation</code> in
      <code class="filename">/etc/ssh/sshd_config</code> to <code class="literal">no</code> and
      restart the SSH daemon (<code class="command">systemctl restart sshd</code>)
      if it seems that the  changes to resource limits are not working (via
      SSH). However, this is not generally recommended, as it weakens a system's
      security.
     </p></div><div id="id-1.6.5.7.10.3.7" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.svg" /><h6>Tip: Disabling password logins via <code class="command">ssh</code></h6><p>
      You can add extra security to your server by disabling password
      authentication for SSH. Remember that you need to have SSH keys
      configured, otherwise you cannot access the server. To disable password
      login, add the following lines to
      <code class="filename">/etc/ssh/sshd_config</code>:
     </p><div class="verbatim-wrap"><pre class="screen">UseLogin no
UsePAM no
PasswordAuthentication no
PubkeyAuthentication yes</pre></div></div><p>
     In this example, a change to the number of file handles or open files
     that the user <code class="literal">oracle</code> can use is made by editing
     <code class="filename">/etc/security/limits.conf</code> as <code class="systemitem">root</code> making the
     following changes:
    </p><div class="verbatim-wrap"><pre class="screen">oracle           soft    nofile          4096
oracle           hard    nofile          63536</pre></div><p>
     The soft limit in the first line defines the limit on the number of file
     handles (open files) that the
     <code class="systemitem">oracle</code> user has after
     login. If the user sees error messages about running out of file handles,
     then the user can increase the number of file handles like in this
     example up to the hard limit (in this example 63536) by executing:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>ulimit -n 63536</pre></div><p>
     You can set the soft and hard limits higher if necessary.
    </p><div id="id-1.6.5.7.10.3.13" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg" /><h6>Note: Caution with using ulimits</h6><p>
      It is important to be judicious with the usage of ulimits. Allowing a
      <span class="quote">“<span class="quote ">hard</span>”</span> limit for <code class="literal">nofile</code> for a user that
      is equal to the kernel limit (<code class="filename">/proc/sys/fs/file-max</code>)
      is bad. If the user consumes all the available file handles, the
      system cannot initiate new logins, since it is not possible to access
      the PAM modules required to perform a login.
     </p></div><p>
     You also need to ensure that <code class="literal">pam_limits</code> is either
     configured globally in <code class="filename">/etc/pam.d/common-auth</code>, or
     for individual services like SSH, su, login and telnet in:
    </p><table border="0" summary="Simple list" class="simplelist "><tr><td><code class="filename">/etc/pam.d/sshd</code> (for SSH)</td></tr><tr><td><code class="filename">/etc/pam.d/su</code> (for su)</td></tr><tr><td><code class="filename">/etc/pam.d/login</code> (local logins and telnet)</td></tr></table><p>
     If you do not want to enable it for all logins, there is a specific PAM
     module that reads the <code class="filename">/etc/security/limits.conf</code>
     file. Entries in PAM configuration directives have entries like:
    </p><div class="verbatim-wrap"><pre class="screen">session     required      /lib/security/pam_limits.so
session     required      /lib/security/pam_unix.so</pre></div><p>
     Changes are not immediate and require a new
     login session:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>su - oracle
<code class="prompt user">&gt; </code>ulimit -n
4096</pre></div><p>
     These examples are specific to the Bash shell;
     <code class="command">ulimit</code> options are different for other shells. The
     default limit for the user <code class="literal">oracle</code> is
     <code class="literal">4096</code>. To increase the number of file handles the user
     <code class="literal">oracle</code> can use to <code class="literal">63536</code>, execute:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>su - oracle
<code class="prompt user">&gt; </code>ulimit -n
4096
<code class="prompt user">&gt; </code>ulimit -n 63536
<code class="prompt user">&gt; </code>ulimit -n
63536</pre></div><p>
     Making this permanent requires the addition of the setting,
     <code class="command">ulimit -n 63536</code>, (again, for Bash) to the user's
     profile (<code class="filename">~/.bashrc</code> or
     <code class="filename">~/.profile</code> file), which is the user start-up file for
     the Bash shell on <span class="productname"><span class="phrase">openSUSE Leap</span></span> (to verify your shell, run:
     <code class="command">echo $SHELL</code>). To do this you could run the following commands for the
     Bash shell of the user <code class="literal">oracle</code>:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>su - oracle
<code class="prompt user">&gt; </code>cat &gt;&gt; ~oracle/.bash_profile &lt;&lt; EOF
ulimit -n 63536
EOF</pre></div></div></div><div class="sect1 " id="sec-sec-prot-banners"><div class="titlepage"><div><div><h2 class="title"><span class="number">14.9 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Displaying login banners</span> <a title="Permalink" class="permalink" href="sec-sec-user-management.html#sec-sec-prot-banners">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/user_management.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>user_management.xml</li><li><span class="ds-label">ID: </span>sec-sec-prot-banners</li></ul></div></div></div></div><p>
    It is often necessary to place a banner on login screens on all servers
    for legal/audit policy reasons or to give security instructions to
    users.
   </p><p>
    To print a login banner <span class="emphasis"><em>after</em></span> a user
    logs in on a text based terminal, for example, using SSH or on a local
    console, you can use the file <code class="filename">/etc/motd</code> (motd =
    message of the day). The file exists by default on <span class="productname"><span class="phrase">openSUSE Leap</span></span>, but
    it is empty. Simply add content to the file that is applicable/required
    by the organization.
   </p><div id="id-1.6.5.7.11.4" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg" /><h6>Note: Banner length</h6><p>
     Try to keep the login banner content to a single terminal page (or
     less), as it scrolls the screen if it does not fit, making it more
     difficult to read.
    </p></div><p>
    You can also have a login banner printed <span class="emphasis"><em>before</em></span> a
    user logs in on a text based terminal. For local console
    logins, you can edit the <code class="filename">/etc/issue</code> file, which
    causes the banner to be displayed before the login prompt. For logins via
    SSH, you can edit the <span class="quote">“<span class="quote ">Banner</span>”</span> parameter in the
    <code class="filename">/etc/ssh/sshd_config</code> file, which then
    appropriately displays the banner text before the SSH login prompt.
   </p><p>
    For graphical logins via GDM, you can follow
    <a class="link" href="https://help.gnome.org/admin/system-admin-guide/stable/login-banner.html.en" target="_blank">
    the GNOME admin guide</a> to set up a login banner. Furthermore,
    you can make the following changes to require a user to acknowledge the
    legal banner by selecting <span class="guimenu ">Yes</span> or <span class="guimenu ">No</span>.
    Edit the <code class="filename">/etc/gdm/Xsession</code> file and add the
    following lines at the <span class="emphasis"><em>beginning</em></span> of the script:
   </p><div class="verbatim-wrap"><pre class="screen">if ! /usr/bin/gdialog --yesno '\n<em class="replaceable ">This system is classified...</em>\n' 10 10; then
    /usr/bin/gdialog --infobox 'Aborting login'
    exit 1;
fi</pre></div><p>
    The text <em class="replaceable ">This system is classified...</em> needs to
    be replaced with the desired banner text. This dialog does not prevent a login from progressing.
    For more information about GDM scripting, refer to the
    <a class="link" href="https://help.gnome.org/admin/gdm/stable/configuration.html.en#scripting" target="_blank">
    GDM Admin Manual</a>.
   </p></div><div class="sect1 " id="sec-sec-prot-misc-account-utils"><div class="titlepage"><div><div><h2 class="title"><span class="number">14.10 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Connection accounting utilities</span> <a title="Permalink" class="permalink" href="sec-sec-user-management.html#sec-sec-prot-misc-account-utils">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/user_management.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>user_management.xml</li><li><span class="ds-label">ID: </span>sec-sec-prot-misc-account-utils</li></ul></div></div></div></div><p>
     Here is a list of commands you can use to get data about user logins:
    </p><p><span class="formalpara-title"><code class="command">who</code>. </span>
      Lists currently logged in users.
     </p><p><span class="formalpara-title"><code class="command">w</code>. </span>
      Shows who is logged in and what they are doing.
     </p><p><span class="formalpara-title"><code class="command">last</code>. </span>
      Shows a list of the most recent logged in users, including login time, logout time,
      login IP address, etc.
     </p><p><span class="formalpara-title"><code class="command">lastb</code>. </span>
      Same as <code class="command">last</code>, except that by default it shows
      <code class="filename">/var/log/btmp</code>, which contains all the bad login
      attempts.
     </p><p><span class="formalpara-title"><code class="command">lastlog</code>. </span>
      This command reports data maintained in
      <code class="filename">/var/log/lastlog</code>, which is a record of the last
      time a user logged in.
     </p><p><span class="formalpara-title"><code class="command">ac</code>. </span>
      Available after installing the <code class="systemitem">acct</code> package.
      Prints the connect time in hours on a per-user basis or daily basis,
      etc. This command reads <code class="filename">/var/log/wtmp</code>.
     </p><p><span class="formalpara-title"><code class="command">dump-utmp</code>. </span>
      Converts raw data from /var/run/utmp or
      <code class="filename">/var/log/wtmp</code> into ASCII-parseable format.
     </p><p>
     Also check the <code class="filename">/var/log/messages</code> file, or the output
     of <code class="command">journalctl</code> if no logging facility is running. See
     <span class="intraxref">Book “Reference”, Chapter 11 “<code class="command">journalctl</code>: query the <code class="systemitem">systemd</code> journal”</span> for more information on the <code class="systemitem">systemd</code>
     journal.
    </p></div></div></div><div class="page-bottom"><div id="_bottom-navigation"><a class="nav-link" href="cha-sec-cron-at.html"><span class="next-icon">→</span><span class="nav-label"><span class="number">Chapter 15 </span>Restricting <code class="systemitem">cron</code> and <code class="systemitem">at</code></span></a><a class="nav-link" href="cha-configure-cryptctl.html"><span class="prev-icon">←</span><span class="nav-label"><span class="number">Chapter 13 </span>Storage encryption for hosted applications with cryptctl</span></a></div><div class="_share-print"><div class="online-contents share"><strong>Share this page: </strong><span class="share-buttons"><span class="_share-fb bottom-button">Facebook</span><span class="spacer"> • </span><span class="_share-in bottom-button">LinkedIn</span><span class="spacer"> • </span><span class="_share-tw bottom-button">Twitter</span><span class="spacer"> • </span><span class="_share-mail bottom-button">E-Mail</span></span></div><div class="print"><span class="_print-button bottom-button">Print this page</span></div><div class="clearme"></div></div></div></div><div id="_inward"></div></div><div id="_footer-wrap"><div id="_footer"><p>©
        2024 
        SUSE</p><ul><li><a href="https://jobs.suse.com/" target="_top">Careers</a></li><li><a href="https://www.suse.com/company/legal/" target="_top">Legal</a></li><li><a href="https://www.suse.com/company/about/" target="_top">About</a></li><li><a href="https://www.suse.com/contact/" target="_top">Contact Us</a></li></ul></div></div></body></html>