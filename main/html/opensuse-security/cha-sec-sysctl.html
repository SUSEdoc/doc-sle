<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Improving network security with sysctl variables | Security and Hardening Guide | openSUSE Leap 15.6</title><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" /><link rel="stylesheet" type="text/css" href="static/css/style.css" /><link rel="stylesheet" type="text/css" href="static/css/highlight.css" />
<meta name="title" content="Improving network security with sysctl variables | ope…" />
<meta name="description" content="Sysctl (system control) variables control certain kernel parameters that influence the behavior of different parts of the operating system, for example the Lin…" />
<meta name="product-name" content="openSUSE Leap" />
<meta name="product-number" content="15.6" />
<meta name="book-title" content="Security and Hardening Guide" />
<meta name="chapter-title" content="Chapter 26. Improving network security with sysctl variables" />
<meta name="tracker-url" content="https://bugzilla.opensuse.org/enter_bug.cgi" />
<meta name="tracker-type" content="bsc" />
<meta name="tracker-bsc-assignee" content="fs@suse.com" />
<meta name="tracker-bsc-component" content="Documentation" />
<meta name="tracker-bsc-product" content="openSUSE Distribution" />
<meta name="tracker-bsc-version" content="Leap 15.4" />
<meta property="og:title" content="Improving network security with sysctl variables | ope…" />
<meta property="og:description" content="Sysctl (system control) variables control certain kernel parameters that influence the behavior of different parts of the operating system, for example the Lin…" />
<meta property="og:type" content="article" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Improving network security with sysctl variables | ope…" />
<meta name="twitter:description" content="Sysctl (system control) variables control certain kernel parameters that influence the behavior of different parts of the operating system, for example the Lin…" />
<link rel="home" href="index.html" title="openSUSE Leap Documentation" /><link rel="up" href="part-network-security.html" title="Part III. Network security" /><link rel="prev" href="cha-security-xca.html" title="Chapter 25. Managing a PKI with XCA, X certificate and key manager" /><link rel="next" href="part-apparmor.html" title="Part IV. Confining privileges with AppArmor" />
<script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css" /></noscript><script src="static/js/jquery-1.12.4.min.js" type="text/javascript"></script><script src="static/js/script.js" type="text/javascript"></script><script src="static/js/highlight.min.js" type="text/javascript"></script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script></head><body class="draft offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-navigation">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><div id="_outer-wrap"><div id="_white-bg" style="background-color: #E11;"><div id="_header"><div id="_logo"><img src="static/images/logo.svg" alt="Logo" /></div><div class="crumbs"><a class="book-link" href="index.html" title="Security and Hardening Guide"><span class="book-icon">Security and Hardening Guide</span></a><span> › </span><a class="crumb" href="part-network-security.html">Network security</a><span> › </span><a class="crumb" href="cha-sec-sysctl.html">Improving network security with sysctl variables</a></div><div class="clearme"></div></div></div><div id="_toolbar-wrap"><div id="_toolbar"><div id="_toc-area" class="inactive"><a id="_toc-area-button" class="tool" title="Contents" accesskey="c" href="index.html"><span class="tool-spacer"><span class="toc-icon">Contents</span><span class="clearme"></span></span><span class="tool-label">Contents</span></a><div class="active-contents bubble-corner"></div><div class="active-contents bubble"><div class="bubble-container"><h6>Security and Hardening Guide</h6><div id="_bubble-toc"><ol><li class="inactive"><a href="preface-security.html"><span class="number"> </span><span class="name">Preface</span></a></li><li class="inactive"><a href="cha-security.html"><span class="number">1 </span><span class="name">Security and confidentiality</span></a></li><li class="inactive"><a href="part-auth.html"><span class="number">I </span><span class="name">Authentication</span></a><ol><li class="inactive"><a href="cha-pam.html"><span class="number">2 </span><span class="name">Authentication with PAM</span></a></li><li class="inactive"><a href="cha-nis.html"><span class="number">3 </span><span class="name">Using NIS</span></a></li><li class="inactive"><a href="cha-security-auth.html"><span class="number">4 </span><span class="name">Setting up authentication clients using YaST</span></a></li><li class="inactive"><a href="cha-security-ldap.html"><span class="number">5 </span><span class="name">LDAP with 389 Directory Server</span></a></li><li class="inactive"><a href="cha-security-kerberos.html"><span class="number">6 </span><span class="name">Network authentication with Kerberos</span></a></li><li class="inactive"><a href="cha-security-ad.html"><span class="number">7 </span><span class="name">Active Directory support</span></a></li><li class="inactive"><a href="cha-security-freeradius.html"><span class="number">8 </span><span class="name">Setting up a freeRADIUS server</span></a></li></ol></li><li class="inactive"><a href="part-local-security.html"><span class="number">II </span><span class="name">Local security</span></a><ol><li class="inactive"><a href="cha-physical-security.html"><span class="number">9 </span><span class="name">Physical security</span></a></li><li class="inactive"><a href="sec-sec-software-management.html"><span class="number">10 </span><span class="name">Software management</span></a></li><li class="inactive"><a href="sec-sec-file-management.html"><span class="number">11 </span><span class="name">File management</span></a></li><li class="inactive"><a href="cha-security-cryptofs.html"><span class="number">12 </span><span class="name">Encrypting partitions and files</span></a></li><li class="inactive"><a href="cha-configure-cryptctl.html"><span class="number">13 </span><span class="name">Storage encryption for hosted applications with cryptctl</span></a></li><li class="inactive"><a href="sec-sec-user-management.html"><span class="number">14 </span><span class="name">User management</span></a></li><li class="inactive"><a href="cha-sec-cron-at.html"><span class="number">15 </span><span class="name">Restricting <code class="systemitem">cron</code> and <code class="systemitem">at</code></span></a></li><li class="inactive"><a href="cha-spectre.html"><span class="number">16 </span><span class="name">Spectre/Meltdown checker</span></a></li><li class="inactive"><a href="cha-security-yast-security.html"><span class="number">17 </span><span class="name">Configuring security settings with YaST</span></a></li><li class="inactive"><a href="cha-security-polkit.html"><span class="number">18 </span><span class="name">The Polkit authentication framework</span></a></li><li class="inactive"><a href="cha-security-acls.html"><span class="number">19 </span><span class="name">Access control lists in Linux</span></a></li><li class="inactive"><a href="cha-aide.html"><span class="number">20 </span><span class="name">Intrusion detection with AIDE</span></a></li></ol></li><li class="inactive"><a href="part-network-security.html"><span class="number">III </span><span class="name">Network security</span></a><ol><li class="inactive"><a href="cha-xauth.html"><span class="number">21 </span><span class="name">X Window System and X authentication</span></a></li><li class="inactive"><a href="cha-ssh.html"><span class="number">22 </span><span class="name">Securing network operations with OpenSSH</span></a></li><li class="inactive"><a href="cha-security-firewall.html"><span class="number">23 </span><span class="name">Masquerading and firewalls</span></a></li><li class="inactive"><a href="cha-security-vpnserver.html"><span class="number">24 </span><span class="name">Configuring a VPN server</span></a></li><li class="inactive"><a href="cha-security-xca.html"><span class="number">25 </span><span class="name">Managing a PKI with XCA, X certificate and key manager</span></a></li><li class="inactive"><a href="cha-sec-sysctl.html"><span class="number">26 </span><span class="name">Improving network security with <code class="command">sysctl</code> variables</span></a></li></ol></li><li class="inactive"><a href="part-apparmor.html"><span class="number">IV </span><span class="name">Confining privileges with <span class="phrase">AppArmor</span></span></a><ol><li class="inactive"><a href="cha-apparmor-intro.html"><span class="number">27 </span><span class="name">Introducing <span class="phrase">AppArmor</span></span></a></li><li class="inactive"><a href="cha-apparmor-start.html"><span class="number">28 </span><span class="name">Getting started</span></a></li><li class="inactive"><a href="cha-apparmor-concept.html"><span class="number">29 </span><span class="name">Immunizing programs</span></a></li><li class="inactive"><a href="cha-apparmor-profiles.html"><span class="number">30 </span><span class="name">Profile components and syntax</span></a></li><li class="inactive"><a href="cha-apparmor-repos.html"><span class="number">31 </span><span class="name"><span class="phrase">AppArmor</span> profile repositories</span></a></li><li class="inactive"><a href="cha-apparmor-yast.html"><span class="number">32 </span><span class="name">Building and managing profiles with YaST</span></a></li><li class="inactive"><a href="cha-apparmor-commandline.html"><span class="number">33 </span><span class="name">Building profiles from the command line</span></a></li><li class="inactive"><a href="cha-apparmor-hat.html"><span class="number">34 </span><span class="name">Profiling your Web applications using ChangeHat</span></a></li><li class="inactive"><a href="cha-apparmor-pam.html"><span class="number">35 </span><span class="name">Confining users with <code class="systemitem">pam_apparmor</code></span></a></li><li class="inactive"><a href="cha-apparmor-managing.html"><span class="number">36 </span><span class="name">Managing profiled applications</span></a></li><li class="inactive"><a href="cha-apparmor-support.html"><span class="number">37 </span><span class="name">Support</span></a></li><li class="inactive"><a href="cha-apparmor-glossary.html"><span class="number">38 </span><span class="name"><span class="phrase">AppArmor</span> glossary</span></a></li></ol></li><li class="inactive"><a href="part-selinux.html"><span class="number">V </span><span class="name">SELinux</span></a><ol><li class="inactive"><a href="cha-selinux.html"><span class="number">39 </span><span class="name">Configuring SELinux</span></a></li></ol></li><li class="inactive"><a href="part-audit.html"><span class="number">VI </span><span class="name">The Linux Audit Framework</span></a><ol><li class="inactive"><a href="cha-audit-comp.html"><span class="number">40 </span><span class="name">Understanding Linux audit</span></a></li><li class="inactive"><a href="cha-audit-setup.html"><span class="number">41 </span><span class="name">Setting up the Linux audit framework</span></a></li><li class="inactive"><a href="cha-audit-scenarios.html"><span class="number">42 </span><span class="name">Introducing an audit rule set</span></a></li><li class="inactive"><a href="cha-audit-moreinfo.html"><span class="number">43 </span><span class="name">Useful resources</span></a></li></ol></li><li class="inactive"><a href="bk04apa.html"><span class="number">A </span><span class="name">GNU licenses</span></a></li></ol></div><div class="clearme"></div></div></div></div><div id="_nav-area" class="inactive"><div class="tool"><span class="nav-inner"><span class="tool-label">Navigation</span><a accesskey="p" class="tool-spacer" title="Chapter 25. Managing a PKI with XCA, X certificate and key manager" href="cha-security-xca.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Part IV. Confining privileges with AppArmor" href="part-apparmor.html"><span class="next-icon">→</span></a></span></div></div></div></div><div id="_fixed-header-wrap" style="background-color: #E11;" class="inactive"><div id="_fixed-header"><div class="crumbs"><a class="book-link" href="index.html" title="Security and Hardening Guide"><span class="book-icon">Security and Hardening Guide</span></a><span> › </span><a class="crumb" href="part-network-security.html">Network security</a><span> › </span><a class="crumb" href="cha-sec-sysctl.html">Improving network security with sysctl variables</a></div><div class="buttons"><a class="top-button button" href="#">Top</a><div class="button"><a accesskey="p" class="tool-spacer" title="Chapter 25. Managing a PKI with XCA, X certificate and key manager" href="cha-security-xca.html"><span class="prev-icon">←</span></a><a accesskey="n" class="tool-spacer" title="Part IV. Confining privileges with AppArmor" href="part-apparmor.html"><span class="next-icon">→</span></a></div><div class="clearme"></div></div><div class="clearme"></div></div></div><div id="_content" class="draft "><div class="documentation"><div class="chapter " id="cha-sec-sysctl"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname "><span class="productname"><span class="phrase">openSUSE Leap</span></span></span> <span class="productnumber "><span class="productnumber"><span class="phrase">15.6</span></span></span></div><div><h2 class="title"><span class="number">26 </span><span xmlns:dm="urn:x-suse:ns:docmanager" class="name">Improving network security with <code class="command">sysctl</code> variables</span> <a title="Permalink" class="permalink" href="cha-sec-sysctl.html#">#</a><a class="report-bug" rel="nofollow" target="_blank" href="https://github.com/SUSE/doc-sle/edit/main/xml/security_sysctl.xml" title="Edit the source file for this section">Edit source</a></h2><div class="doc-status"><ul><li><span class="ds-label">File Name: </span>security_sysctl.xml</li><li><span class="ds-label">ID: </span>cha-sec-sysctl</li></ul></div></div></div></div><div class="line"></div><p>
  Sysctl (system control) variables control certain kernel parameters that
  influence the behavior of different parts of the operating system, for example
  the Linux network stack. These parameters can be looked up in the
  <code class="literal">proc</code> file system, in <code class="filename">/proc/sys</code>. Many
  kernel parameters can be changed directly by writing a new value into a
  parameter pseudo file. However, these changes are not persisted and are lost
  after a system reboot. Therefore, we recommend configuring all changes in
  a sysctl configuration file to have them applied at every system start.
 </p><p>
  In this chapter, several networking related variables are configured
  that improve the security features of Linux. Depending on the presence of a
  firewall and its settings, certain variables listed here already
  have the safe values by default. You can check the current value of a setting
  by using the <code class="command">sysctl</code> utility like this:
 </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code>/sbin/sysctl net.ipv4.conf.all.rp_filter
net.ipv4.conf.all.rp_filter = 2</pre></div><p>
  To apply the following settings, create a configuration file
  <code class="filename">/etc/sysctl.d/</code>. The file needs to end with a
  <code class="filename">.conf</code> suffix, for example
  <code class="filename">/etc/sysctl.d/network.conf</code>. For details, refer to
  <code class="command">man 5 sysctl.d</code>.
 </p><p>
  Set the variables from the following list as appropriate for your environment.
 </p><div class="itemizedlist " id="il-security-sysctl"><ul class="itemizedlist"><li class="listitem "><div class="verbatim-wrap"><pre class="screen"># the default setting for this is 2 (loose mode)
net.ipv4.conf.default.rp_filter = 1
net.ipv4.conf.all.rp_filter = 1</pre></div><p>
    This setting enables the IPv4 reverse path filter in strict mode. It ensures
    that answers to incoming IP packets are always sent out via the interface
    from that the packets have been received. If the system would direct answer
    packets to a different outgoing interface according to the routing table,
    these packets would be discarded. The setting prevents certain kinds of
    IP spoofing attacks that are, for example, used for distributed denial-of-service
    (DDoS) attacks.
   </p></li><li class="listitem "><div class="verbatim-wrap"><pre class="screen"># the default setting for this should already be 0
net.ipv4.conf.default.accept_source_route = 0
net.ipv4.conf.all.accept_source_route = 0</pre></div><p>
    This setting disables the acceptance of packets with the
    <code class="option">SSR</code> option set in the IPv4 packet header. Packets that use
    <span class="emphasis"><em>Source Routing</em></span> are rejected. This prevents IP
    packet redirection, that is redirection to a host behind a firewall, that is
    not directly reachable otherwise.
   </p></li><li class="listitem "><div class="verbatim-wrap"><pre class="screen"># the default setting for this should already be 1
net.ipv4.tcp_syncookies = 1</pre></div><p>
    This enables TCP SYN Cookie Protection for IPv4 <span class="emphasis"><em>and</em></span>
    IPv6. It addresses a specific denial-of-service attack on the TCP protocol
    level. The protection involves a small CPU trade-off in favor of avoiding
    memory exhaustion caused by attackers. The protection mechanism consists of
    a fallback algorithm that only comes into play when no further TCP
    connections can be accepted the normal way. The mechanism is not fully TCP
    protocol compliant and can thus cause protocol issues in certain TCP contexts.
    The alternative would be to drop additional connections in
    overload scenarios. This also needs a differentiation between legitimate
    high TCP load and a TCP denial-of-service attack. If you expect a high load
    of TCP connections on your system, then this setting could be
    counterproductive.
   </p></li><li class="listitem "><div class="verbatim-wrap"><pre class="screen"># default is 128
net.ipv4.tcp_max_syn_backlog = 4096</pre></div><p>
    The TCP SYN backlog defines the number of SYN packets that are queued for
    further processing. Once the queue limit is exceeded, all new incoming
    SYN-packets are dropped and new TCP connections are not  possible (or the
    SYN cookie protection kicks in). Increasing this value improves the
    protection against TCP SYN flood attacks.
   </p></li><li class="listitem "><div class="verbatim-wrap"><pre class="screen"># the default setting for this should already be 1
net.ipv4.icmp_echo_ignore_broadcasts = 1</pre></div><p>
    ICMP echo requests (ping) can be sent to an IPv4 broadcast address in order
    to scan a network for existing hosts / IP addresses or to perform an ICMP
    flood within a network segment. This setting causes the networking stack to
    ignore ICMP echo packets sent to a broadcast address.
   </p></li><li class="listitem "><div class="verbatim-wrap"><pre class="screen"># the default setting for this should already be 1
net.ipv4.icmp_ignore_bogus_error_responses = 1</pre></div><p>
    This setting avoids filling up log files with unnecessary error messages
    coming from invalid responses to broadcast frames. Refer to <a class="link" href="https://datatracker.ietf.org/doc/html/rfc1122#section-3.2.2" target="_blank">RFC
     1122 <em class="citetitle ">Requirements for Internet Hosts -- Communication
      Layers</em> Section 3.2.2</a> for more information.
   </p></li><li class="listitem "><div class="verbatim-wrap"><pre class="screen"># default should already be 0
net.ipv4.conf.default.accept_redirects = 0
net.ipv4.conf.all.accept_redirects = 0
net.ipv6.conf.default.accept_redirects = 0
net.ipv6.conf.all.accept_redirects = 0</pre></div><p>
    Disables the acceptance of ICMP redirect messages. These messages are
     sent by gateways to inform a host about a better route to an outside
    network. These redirects can be misused for man-in-the-middle attacks.
   </p></li><li class="listitem "><div class="verbatim-wrap"><pre class="screen">net.ipv4.conf.default.secure_redirects = 0
net.ipv4.conf.all.secure_redirects = 0</pre></div><p>
    Accepting 'secure' ICMP redirects (from those gateways listed as default
    gateways) has few legitimate uses. It should be disabled unless it is
    absolutely required.
   </p></li><li class="listitem "><div class="verbatim-wrap"><pre class="screen">net.ipv4.conf.default.send_redirects = 0
net.ipv4.conf.all.send_redirects = 0</pre></div><p>
    A node should not send IPv4 ICMP redirects, unless it acts as a router.
   </p></li><li class="listitem "><div class="verbatim-wrap"><pre class="screen"># default should already be 0
net.ipv4.ip_forward = 0
net.ipv6.conf.all.forwarding = 0
net.ipv6.conf.default.forwarding = 0</pre></div><p>
    IP forwarding should only be enabled on systems acting as routers.
   </p></li></ul></div></div></div><div class="page-bottom"><div id="_bottom-navigation"><a class="nav-link" href="part-apparmor.html"><span class="next-icon">→</span><span class="nav-label"><span class="number">Part IV </span>Confining privileges with <span class="phrase">AppArmor</span></span></a><a class="nav-link" href="cha-security-xca.html"><span class="prev-icon">←</span><span class="nav-label"><span class="number">Chapter 25 </span>Managing a PKI with XCA, X certificate and key manager</span></a></div><div class="_share-print"><div class="online-contents share"><strong>Share this page: </strong><span class="share-buttons"><span class="_share-fb bottom-button">Facebook</span><span class="spacer"> • </span><span class="_share-in bottom-button">LinkedIn</span><span class="spacer"> • </span><span class="_share-tw bottom-button">Twitter</span><span class="spacer"> • </span><span class="_share-mail bottom-button">E-Mail</span></span></div><div class="print"><span class="_print-button bottom-button">Print this page</span></div><div class="clearme"></div></div></div></div><div id="_inward"></div></div><div id="_footer-wrap"><div id="_footer"><p>©
        2024 
        SUSE</p><ul><li><a href="https://jobs.suse.com/" target="_top">Careers</a></li><li><a href="https://www.suse.com/company/legal/" target="_top">Legal</a></li><li><a href="https://www.suse.com/company/about/" target="_top">About</a></li><li><a href="https://www.suse.com/contact/" target="_top">Contact Us</a></li></ul></div></div></body></html>