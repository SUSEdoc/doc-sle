<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><title>SLE Micro 5.5 | Administration Guide | Snapshots</title><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"/>
<meta name="title" content="Snapshots | SLE Micro 5.5"/>
<meta name="description" content="This chapter describes managing snapshots and gives details about directories included in snapshots."/>
<meta name="product-name" content="SUSE Linux Enterprise Micro"/>
<meta name="product-number" content="5.5"/>
<meta name="book-title" content="Administration Guide"/>
<meta name="chapter-title" content="Chapter 2. Snapshots"/>
<meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi"/>
<meta name="tracker-type" content="bsc"/>
<meta name="tracker-bsc-assignee" content="jsindelarova@suse.com"/>
<meta name="tracker-bsc-component" content="Documentation"/>
<meta name="tracker-bsc-product" content="SUSE Linux Enterprise Micro 5.5"/>
<meta name="publisher" content="SUSE"/><meta property="og:title" content="Snapshots | SLE Micro 5.5"/>
<meta property="og:description" content="This chapter describes managing snapshots and gives details…"/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Snapshots | SLE Micro 5.5"/>
<meta name="twitter:description" content="This chapter describes managing snapshots and gives details…"/>
<script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": ["TechArticle"],
    "image": "https://www.suse.com/assets/img/suse-white-logo-green.svg",
    
     "isPartOf": {
      "@type": "CreativeWorkSeries",
      "name": "Products &amp; Solutions"
    },
    
    "inLanguage": "en",
    

    "headline": "Snapshots",
  
    "description": "This chapter describes managing snapshots and gives details about directories included in snapshots.",
      
    "author": [
      {
        "@type": "Corporation",
        "name": "SUSE Product &amp; Solution Documentation Team",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    ],
      

    "about": [
      
    ],
  
    "sameAs": [
          "https://www.facebook.com/SUSEWorldwide/about",
          "https://www.youtube.com/channel/UCHTfqIzPKz4f_dri36lAQGA",
          "https://twitter.com/SUSE",
          "https://www.linkedin.com/company/suse"
    ],
    "publisher": {
      "@type": "Corporation",
      "name": "SUSE",
      "url": "https://documentation.suse.com",
      "logo": {
        "@type": "ImageObject",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    }
  }</script>
<link rel="prev" href="cha-read-only-filesystem.html" title="Chapter 1. Read-only file system"/><link rel="next" href="sec-transactional-udate.html" title="Chapter 3. Administration using transactional updates"/><script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/script-purejs.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script><meta name="edit-url" content="https://github.com/SUSE/doc-sle/edit/main/xml/slemicro_snapshots.xml"/></head><body class="draft wide offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"><img src="static/images/logo.svg" alt="Logo" class="logo"/></div></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">Administration Guide</a><span> / </span><a class="crumb" href="part-common.html">Common tasks</a><span> / </span><a class="crumb" href="cha-snapshots.html">Snapshots</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title">Administration Guide</div><ol><li><a href="preface-administration-slemicro.html" class=" "><span class="title-number"> </span><span class="title-name">Preface</span></a></li><li class="active"><a href="part-common.html" class="has-children you-are-here"><span class="title-number">I </span><span class="title-name">Common tasks</span></a><ol><li><a href="cha-read-only-filesystem.html" class=" "><span class="title-number">1 </span><span class="title-name">Read-only file system</span></a></li><li><a href="cha-snapshots.html" class=" you-are-here"><span class="title-number">2 </span><span class="title-name">Snapshots</span></a></li><li><a href="sec-transactional-udate.html" class=" "><span class="title-number">3 </span><span class="title-name">Administration using transactional updates</span></a></li><li><a href="cha-ulp.html" class=" "><span class="title-number">4 </span><span class="title-name">User space live patching</span></a></li></ol></li><li><a href="part-networking-slemicro.html" class="has-children "><span class="title-number">II </span><span class="title-name">Networking</span></a><ol><li><a href="cha-network.html" class=" "><span class="title-number">5 </span><span class="title-name">Basic networking</span></a></li><li><a href="cha-nm-vs-wicked.html" class=" "><span class="title-number">6 </span><span class="title-name">NetworkManager and <code class="command">wicked</code></span></a></li><li><a href="cha-nm-configuration.html" class=" "><span class="title-number">7 </span><span class="title-name">NetworkManager configuration and usage</span></a></li></ol></li><li><a href="part-slemicro-monitoring.html" class="has-children "><span class="title-number">III </span><span class="title-name">Monitoring and debugging</span></a><ol><li><a href="cha-health-checker.html" class=" "><span class="title-number">8 </span><span class="title-name">Health checker</span></a></li><li><a href="cha-admin-toolbox.html" class=" "><span class="title-number">9 </span><span class="title-name"><code class="literal">toolbox</code> for SLE Micro debugging</span></a></li><li><a href="cha-performance-monitoring.html" class=" "><span class="title-number">10 </span><span class="title-name">Monitoring performance</span></a></li></ol></li><li><a href="part-slemicro-troubleshooting.html" class="has-children "><span class="title-number">IV </span><span class="title-name">Troubleshooting</span></a><ol><li><a href="cha-adm-support-slemicro.html" class=" "><span class="title-number">11 </span><span class="title-name">Gathering system information for support</span></a></li></ol></li> </ol> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section xml:lang="en" class="chapter" id="cha-snapshots" data-id-title="Snapshots"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname"><span class="productname"><span class="phrase">SUSE Linux Enterprise Micro</span></span></span> <span class="productnumber"><span class="productnumber"><span class="phrase">5.5</span></span></span></div><div><div class="title-container"><h1 class="title"><span class="title-number-name"><span class="title-number">2 </span><span class="title-name">Snapshots</span></span> <a title="Permalink" class="permalink" href="cha-snapshots.html#">#</a></h1><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/slemicro_snapshots.xml" title="Edit source document"> </a></div></div></div><div><div class="abstract"><p>
    This chapter describes managing snapshots and gives details about directories included in snapshots.  
   </p></div></div></div></div><div id="id-1.8.3.3.3" data-id-title="Snapshots are mandatory" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.svg"/><div class="admon-title">Warning: Snapshots are mandatory</div><p>
   As snapshots are crucial for the correct functioning of SLE Micro, do not
   disable the feature, and ensure that the root partition is big enough to
   store the snapshots.
  </p></div><p>
  When a snapshot is created, both the snapshot and the original point to the
  same blocks in the file system. So, initially a snapshot does not occupy
  additional disk space. If data in the original file system is modified,
  changed data blocks are copied while the old data blocks are kept for the
  snapshot.
 </p><p>
  Snapshots always reside on the same partition or subvolume on which the
  snapshot has been taken. It is not possible to store snapshots on a different
  partition or subvolume. As a result, partitions containing snapshots need to
  be larger than partitions which do not contain snapshots. The exact amount
  depends strongly on the number of snapshots you keep and the amount of data
  modifications. As a rule of thumb, give partitions twice as much space as you
  normally would. To prevent disks from running out of space, old snapshots are
  automatically cleaned up.
 </p><p>
  Snapshots that are known to be working properly are marked as
  <span class="emphasis"><em>important</em></span>.
 </p><section class="sect1" id="sec-exclude-directories" data-id-title="Directories excluded from snapshots"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">2.1 </span><span class="title-name">Directories excluded from snapshots</span></span> <a title="Permalink" class="permalink" href="cha-snapshots.html#sec-exclude-directories">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/slemicro_snapshots.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   As some directories store user-specific or volatile data, these directories
   are excluded from snapshots:
  </p><div class="variablelist"><dl class="variablelist"><dt id="id-1.8.3.3.7.3.1"><span class="term"><code class="filename">/home</code></span></dt><dd><p>
      Contains users' data. Excluded so that the data will not be included in
      snapshots and thus potentially overwritten by a rollback operation.
     </p></dd><dt id="id-1.8.3.3.7.3.2"><span class="term"><code class="filename">/root</code></span></dt><dd><p>
      Contains root's data. Excluded so that the data will not be included in
      snapshots and thus potentially overwritten by a rollback operation.
     </p></dd><dt id="id-1.8.3.3.7.3.3"><span class="term"><code class="filename">/opt</code></span></dt><dd><p>
      Third-party products usually get installed to <code class="filename">/opt</code>.
      Excluded so that these applications are not uninstalled during rollbacks.
     </p></dd><dt id="id-1.8.3.3.7.3.4"><span class="term"><code class="filename">/srv</code></span></dt><dd><p>
      Contains data for Web and FTP servers. Excluded in order to avoid data
      loss on rollbacks.
     </p></dd><dt id="id-1.8.3.3.7.3.5"><span class="term"><code class="filename">/usr/local</code></span></dt><dd><p>
      This directory is used when manually installing software. It is excluded
      to avoid uninstalling these installations on rollbacks.
     </p></dd><dt id="id-1.8.3.3.7.3.6"><span class="term"><code class="filename">/var</code></span></dt><dd><p>
      This directory contains many variable files, including logs, temporary
      caches, third-party products in <code class="filename">/var/opt</code>, and is the
      default location for virtual machine images and databases. Therefore, a
      separate subvolume is created with Copy-On-Write disabled, so as to
      exclude all of this variable data from snapshots.
     </p></dd><dt id="id-1.8.3.3.7.3.7"><span class="term"><code class="filename">/tmp</code></span></dt><dd><p>
      The directory contains temporary data.
     </p></dd><dt id="id-1.8.3.3.7.3.8"><span class="term">the architecture-specific <code class="filename">/boot/grub2</code> directory</span></dt><dd><p>
      Rollback of the boot loader binaries is not supported.
     </p></dd></dl></div></section><section class="sect1" id="sec-snapshot-size" data-id-title="Showing exclusive disk space used by snapshots"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">2.2 </span><span class="title-name">Showing exclusive disk space used by snapshots</span></span> <a title="Permalink" class="permalink" href="cha-snapshots.html#sec-snapshot-size">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/slemicro_snapshots.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   Snapshots share data, for efficient use of storage space, so using ordinary
   commands like <code class="command">du</code> and <code class="command">df</code> won't measure
   used disk space accurately. When you want to free up disk space on Btrfs
   with quotas enabled, you need to know how much exclusive disk space is used
   by each snapshot, rather than shared space. The <code class="command">btrfs</code>
   command provides a view of space used by snapshots:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>btrfs qgroup show -p /
qgroupid         rfer         excl parent  
--------         ----         ---- ------  
0/5          16.00KiB     16.00KiB ---     
[...]    
0/272         3.09GiB     14.23MiB 1/0     
0/273         3.11GiB    144.00KiB 1/0     
0/274         3.11GiB    112.00KiB 1/0     
0/275         3.11GiB    128.00KiB 1/0     
0/276         3.11GiB     80.00KiB 1/0     
0/277         3.11GiB    256.00KiB 1/0     
0/278         3.11GiB    112.00KiB 1/0     
0/279         3.12GiB     64.00KiB 1/0     
0/280         3.12GiB     16.00KiB 1/0     
1/0           3.33GiB    222.95MiB ---</pre></div><p>
   The <code class="literal">qgroupid</code> column displays the identification number
   for each subvolume, assigning a qgroup level/ID combination.
  </p><p>
   The <code class="literal">rfer</code> column displays the total amount of data
   referred to in the subvolume.
  </p><p>
   The <code class="literal">excl</code> column displays the exclusive data in each
   subvolume.
  </p><p>
   The <code class="literal">parent</code> column shows the parent qgroup of the
   subvolumes.
  </p><p>
   The final item, <code class="literal">1/0</code>, shows the totals for the parent
   qgroup. In the above example, 222.95 MiB will be freed if all subvolumes are
   removed. Run the following command to see which snapshots are associated
   with each subvolume:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>btrfs subvolume list -st /</pre></div></section></section><nav class="bottom-pagination"><div><a class="pagination-link prev" href="cha-read-only-filesystem.html"><span class="pagination-relation">Previous</span><span class="pagination-label"><span class="title-number">Chapter 1 </span>Read-only file system</span></a> </div><div><a class="pagination-link next" href="sec-transactional-udate.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Chapter 3 </span>Administration using transactional updates</span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="section"><a href="cha-snapshots.html#sec-exclude-directories"><span class="title-number">2.1 </span><span class="title-name">Directories excluded from snapshots</span></a></span></li><li><span class="section"><a href="cha-snapshots.html#sec-snapshot-size"><span class="title-number">2.2 </span><span class="title-name">Showing exclusive disk space used by snapshots</span></a></span></li></ul></div><div class="side-title">Share this page</div><ul class="share"><li><a id="_share-fb" href="#" title="Facebook"> </a></li><li><a id="_share-in" href="#" title="LinkedIn"> </a></li><li><a id="_share-tw" href="#" title="Twitter/X"> </a></li><li><a id="_share-mail" href="#" title="E-Mail"> </a></li><li><a id="_print-button" href="#" title="Print this page"> </a></li></ul> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2024</span></div></div></footer></body></html>