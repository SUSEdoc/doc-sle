<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><title>SLE Micro 5.2 | Deployment Guide | Configuring with Ignition</title><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"/>
<meta name="title" content="Configuring with Ignition | SLE Micro 5.2"/>
<meta name="description" content="This chapter provides details about the Ignition provisioning tool that is used to set up a machine. Here you will learn how to provide required conf…"/>
<meta name="product-name" content="SUSE Linux Enterprise Micro"/>
<meta name="product-number" content="5.2"/>
<meta name="book-title" content="Deployment Guide"/>
<meta name="chapter-title" content="Chapter 8. Configuring with Ignition"/>
<meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi"/>
<meta name="tracker-type" content="bsc"/>
<meta name="tracker-bsc-assignee" content="jsindelarova@suse.com"/>
<meta name="tracker-bsc-component" content="Documentation"/>
<meta name="tracker-bsc-product" content="SUSE Linux Enterprise Micro 5.2"/>
<meta name="publisher" content="SUSE"/><meta property="og:title" content="Deployment Guide"/>
<meta property="og:description" content="Deployment of SLE Micro"/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Deployment Guide"/>
<meta name="twitter:description" content="Deployment of SLE Micro"/>
<script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": ["TechArticle"],
    "image": "https://www.suse.com/assets/img/suse-white-logo-green.svg",
    
     "isPartOf": {
      "@type": "CreativeWorkSeries",
      "name": "Products &amp; Solutions"
    },
    
    "inLanguage": "en",
    

    "headline": "Configuring with Ignition",
  
    "description": "This chapter provides details about the Ignition provisioning tool that is used to set up a machine. Here you will learn how to provide required conf…",
      
    "author": [
      {
        "@type": "Corporation",
        "name": "SUSE Product &amp; Solution Documentation Team",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    ],
      
    "dateModified": "2022-10-03T00:00+02:00",
      
    "datePublished": "2022-10-03T00:00+02:00",
      

    "about": [
      
    ],
  
    "sameAs": [
          "https://www.facebook.com/SUSEWorldwide/about",
          "https://www.youtube.com/channel/UCHTfqIzPKz4f_dri36lAQGA",
          "https://twitter.com/SUSE",
          "https://www.linkedin.com/company/suse"
    ],
    "publisher": {
      "@type": "Corporation",
      "name": "SUSE",
      "url": "https://documentation.suse.com",
      "logo": {
        "@type": "ImageObject",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    }
  }</script>
<link rel="prev" href="cha-selfinstal-procedure.html" title="Chapter 7. Deploying selfinstall images"/><link rel="next" href="cha-images-combustion.html" title="Chapter 9. Configuring with Combustion"/><script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/script-purejs.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script><meta name="edit-url" content="https://github.com/SUSE/doc-sle/edit/main/xml/deployment_images_ignition.xml"/></head><body class="draft wide offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"><img src="static/images/logo.svg" alt="Logo" class="logo"/></div></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">Deployment Guide</a><span> / </span><a class="crumb" href="part-raw-image.html">Pre-built image deployment</a><span> / </span><a class="crumb" href="cha-images-ignition.html">Configuring with Ignition</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title">Deployment Guide</div><ol><li><a href="preface-deployment.html" class=" "><span class="title-number"> </span><span class="title-name">Preface</span></a></li><li><a href="part-prep.html" class="has-children "><span class="title-number">I </span><span class="title-name">Installation preparation</span></a><ol><li><a href="cha-planning.html" class=" "><span class="title-number">1 </span><span class="title-name">Planning for <span class="productname"><span class="phrase">SUSE Linux Enterprise Micro</span></span></span></a></li><li><a href="cha-x86.html" class=" "><span class="title-number">2 </span><span class="title-name">Installation on AMD64 and Intel 64</span></a></li><li><a href="cha-aarch64.html" class=" "><span class="title-number">3 </span><span class="title-name">Installation on AArch64</span></a></li><li><a href="cha-zseries.html" class=" "><span class="title-number">4 </span><span class="title-name">Installation on IBM Z and LinuxONE</span></a></li></ol></li><li class="active"><a href="part-raw-image.html" class="has-children you-are-here"><span class="title-number">II </span><span class="title-name">Pre-built image deployment</span></a><ol><li><a href="cha-images-description.html" class=" "><span class="title-number">5 </span><span class="title-name">Description of pre-built images</span></a></li><li><a href="cha-images-procedure.html" class=" "><span class="title-number">6 </span><span class="title-name">Deploying raw images</span></a></li><li><a href="cha-selfinstal-procedure.html" class=" "><span class="title-number">7 </span><span class="title-name">Deploying selfinstall images</span></a></li><li><a href="cha-images-ignition.html" class=" you-are-here"><span class="title-number">8 </span><span class="title-name">Configuring with Ignition</span></a></li><li><a href="cha-images-combustion.html" class=" "><span class="title-number">9 </span><span class="title-name">Configuring with Combustion</span></a></li><li><a href="cha-postintall-registration.html" class=" "><span class="title-number">10 </span><span class="title-name">Post-deployment steps</span></a></li></ol></li><li><a href="part-manual-installation.html" class="has-children "><span class="title-number">III </span><span class="title-name">Manual installation</span></a><ol><li><a href="cha-boot-parameters.html" class=" "><span class="title-number">11 </span><span class="title-name">Boot parameters</span></a></li><li><a href="cha-install.html" class=" "><span class="title-number">12 </span><span class="title-name">Installation steps</span></a></li><li><a href="cha-remote-installation.html" class=" "><span class="title-number">13 </span><span class="title-name">Remote installation</span></a></li><li><a href="cha-installation-troubleshooting.html" class=" "><span class="title-number">14 </span><span class="title-name">Troubleshooting</span></a></li></ol></li><li><a href="bk02apa.html" class=" "><span class="title-number">A </span><span class="title-name">GNU licenses</span></a></li> </ol> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section class="chapter" id="cha-images-ignition" data-id-title="Configuring with Ignition"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname"><span class="productname"><span class="phrase">SUSE Linux Enterprise Micro</span></span></span> <span class="productnumber"><span class="productnumber"><span class="phrase">5.2</span></span></span></div><div><div class="title-container"><h1 class="title"><span class="title-number-name"><span class="title-number">8 </span><span class="title-name">Configuring with Ignition</span></span> <a title="Permalink" class="permalink" href="cha-images-ignition.html#">#</a></h1><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/deployment_images_ignition.xml" title="Edit source document"> </a></div></div></div><div><div class="abstract"><p>
    This chapter provides details about the Ignition provisioning tool that is
    used to set up a machine. Here you will learn how to provide required
    configuration files used for the machine definition.
   </p></div></div></div></div><section class="sect1" id="sec-about-ignition" data-id-title="About Ignition"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">8.1 </span><span class="title-name">About Ignition</span></span> <a title="Permalink" class="permalink" href="cha-images-ignition.html#sec-about-ignition">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/deployment_images_ignition.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   Ignition is a provisioning tool that enables you to configure a system
   according to your specification on the first boot. When the system is booted
   for the first time, Ignition is loaded as part of an
   <code class="filename">initramfs</code> and searches for a configuration file within
   a specific directory (on a USB flash disk or you can provide a URL). All
   changes are performed before the kernel switches from the temporal file system
   to the real root file system (before the <code class="literal">switch_root</code>
   command is issued).
  </p><p>
   Ignition uses a configuration file in the JSON format. The file is called
   <code class="filename">config.ign</code>. 
  </p></section><section class="sect1" id="sec-ignition-configuration" data-id-title="config.ign"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">8.2 </span><span class="title-name"><code class="filename">config.ign</code></span></span> <a title="Permalink" class="permalink" href="cha-images-ignition.html#sec-ignition-configuration">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/deployment_images_ignition.xml" title="Edit source document"> </a></div></div></div></div></div><p>
      The <code class="filename">config.ign</code> is a JSON configuration file that
      provides prescriptions for Ignition. You can either create the file
      manually in JSON, or you can use the Fuel Ignition tool
      (<a class="link" href="https://opensuse.github.io/fuel-ignition/" target="_blank">https://opensuse.github.io/fuel-ignition/</a>) to
      generate a basic set of prescriptions. Bear in mind that the Fuel
      Ignition tool does not provide a full set of options, so you might have
      to modify the file manually.
    </p><p>
      Alternatively, for the purpose of better human readability, you can
      create the file <code class="filename">config.fcc</code> in YAML and transpile the
      file to JSON. For details, refer to
      <a class="xref" href="cha-images-ignition.html#sec-converting-config" title="8.2.2. Converting YAML fcc file to JSON ign">Section 8.2.2, “Converting YAML <code class="literal">fcc</code> file to JSON <code class="literal">ign</code>”</a>.
    </p><p>
      When installing on bare metal, the configuration file
      <code class="filename">config.ign</code> must reside in the
      <code class="filename">ignition</code> subdirectory on the configuration media
      labeled <code class="literal">ignition</code>. The directory structure must look as
      follows:
    </p><div class="verbatim-wrap"><pre class="screen">&lt;root directory&gt;
└── ignition
    └── config.ign</pre></div><p>
   If you intend to configure a QEMU/KVM virtual machine, provide the path
   to the <code class="filename">config.ign</code> as an attribute of the
   <code class="command">qemu</code> command. For example:
  </p><div class="verbatim-wrap"><pre class="screen">-fw_cfg name=opt/com.coreos/config,file=<em class="replaceable">PATH_TO_config.ign</em></pre></div><p>
      The <code class="filename">config.ign</code> contains various data types: objects,
      strings, integers, Booleans and lists of objects. For a complete
      specification, refer to
      <a class="link" href="https://coreos.github.io/ignition/configuration-v3_3/" target="_blank">Ignition
      specification v3.3.0</a>.
    </p><p>
      The <code class="literal">version</code> attribute is mandatory, and in the case of
      SLE Micro, its value must be set either to <code class="literal">3.3.0</code> or to
      any lower version. Otherwise Ignition will fail.
    </p><p>
      If you want to log in to your system as root, you must at least include a
      password for <code class="systemitem">root</code>. However, it is recommended to establish access
      via SSH keys. If you want to configure a password, make sure to use a
      secure one. If you use a randomly generated password, use at least 10
      characters. If you create your password manually, use even more than 10
      characters and combine uppercase and lowercase letters and numbers.
    </p><section class="sect2" id="sec-ignition-examples" data-id-title="Configuration examples"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">8.2.1 </span><span class="title-name">Configuration examples</span></span> <a title="Permalink" class="permalink" href="cha-images-ignition.html#sec-ignition-examples">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/deployment_images_ignition.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    This section will provide you with some common examples of the Ignition
    configuration in both JSON and YAML formats. If you create configuration in the YAML format, you need to transpile the configuration to JSON as described in <a class="xref" href="cha-images-ignition.html#sec-converting-config" title="8.2.2. Converting YAML fcc file to JSON ign">Section 8.2.2, “Converting YAML <code class="literal">fcc</code> file to JSON <code class="literal">ign</code>”</a>.
   </p><div id="id-1.4.4.5.4.11.3" data-id-title="Declaring content outside of default subvolumes" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg"/><div class="admon-title">Important: Declaring content outside of default subvolumes</div><p>
      Bear in mind that if you want to create files outside the
      <a class="xref" href="cha-images-description.html#sec-default-partitioning" title="5.1. Default partitioning">default mounted directories</a>,
      you need to define the directories by using the
      <code class="literal">filesystem</code> attribute.
    </p></div><div id="id-1.4.4.5.4.11.4" data-id-title="The version attribute is mandatory" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note: The <code class="literal">version</code> attribute is mandatory</div><p>
     Include the version specification in <code class="filename">config.ign</code> (version 3.3.0 or lower), resp. <code class="filename">config.fcc</code> (version 1.4.0 or
     lower). 
    </p></div><section class="sect3" id="sec-ignition-storage" data-id-title="Storage configuration"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">8.2.1.1 </span><span class="title-name">Storage configuration</span></span> <a title="Permalink" class="permalink" href="cha-images-ignition.html#sec-ignition-storage">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/deployment_images_ignition.xml" title="Edit source document"> </a></div></div></div></div></div><p>
     The <code class="literal">storage</code> attribute is used to configure partitions,
     RAID, define file systems, create files, etc. To define partitions, use
     the <code class="literal">disks</code> attribute. The <code class="literal">filesystem</code>
     attribute is used to format partitions and define mount points of
     particular partitions. The <code class="literal">files</code> attribute can be used
     to create files in the file system. Each of the mentioned attributes is
     described in the following sections.
    </p><section class="sect4" id="sec-storage-disks" data-id-title="The disks attribute"><div class="titlepage"><div><div><div class="title-container"><h5 class="title"><span class="title-number-name"><span class="title-number">8.2.1.1.1 </span><span class="title-name">The <code class="literal">disks</code> attribute</span></span> <a title="Permalink" class="permalink" href="cha-images-ignition.html#sec-storage-disks">#</a></h5><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/deployment_images_ignition.xml" title="Edit source document"> </a></div></div></div></div></div><p>
      The <code class="literal">disks</code> attribute is a list of devices that enables
      you to define partitions on these devices. The <code class="literal">disks</code>
      attribute must contain at least one <code class="literal">device</code>, other
      attributes are optional. The following example will use a single virtual
      device and divide the disk into four partitions:
     </p><div class="verbatim-wrap"><pre class="screen">    {
    "variant": "fcos",
    "version": "3.3.0",
    "storage": {
        "disks": [
            {
                "device": "/dev/vda",
                "wipe_table": true,
                "partitions": [
                    {
                        "label": "root",
                        "number": 1,
                        "type_guid": "4F68BCE3-E8CD-4DB1-96E7-FBCAF984B709"
                    },
                    {
                        "label": "boot",
                        "number": 2,
                        "type_guid": "BC13C2FF-59E6-4262-A352-B275FD6F7172"
                    },
                    {
                        "label": "swap",
                        "number": 3,
                        "type_guid": "0657FD6D-A4AB-43C4-84E5-0933C84B4F4F"
                    },
                    {
                        "label": "home",
                        "number": 4,
                        "type_guid": "933AC7E1-2EB4-4F13-B844-0E14E2AEF915"
                    }
                ]
            }
        ]
    }
}</pre></div><p>
      The same example in the YAML format:
     </p><div class="verbatim-wrap"><pre class="screen">variant: fcos
version: 1.4.0
storage:
  disks:
    - device: "/dev/vda"
      wipeTable: true
      partitions: 
        - label: root
          number: 1
          typeGuid: 4F68BCE3-E8CD-4DB1-96E7-FBCAF984B709
        - label: boot
          number: 2
          typeGuid: BC13C2FF-59E6-4262-A352-B275FD6F7172
        - label: swap
          number: 3
          typeGuid: 0657FD6D-A4AB-43C4-84E5-0933C84B4F4F
        - label: home
          number: 4
          typeGuid: 933AC7E1-2EB4-4F13-B844-0E14E2AEF915</pre></div></section><section class="sect4" id="sec-storage-raid" data-id-title="The raid attribute"><div class="titlepage"><div><div><div class="title-container"><h5 class="title"><span class="title-number-name"><span class="title-number">8.2.1.1.2 </span><span class="title-name">The <code class="literal">raid</code> attribute</span></span> <a title="Permalink" class="permalink" href="cha-images-ignition.html#sec-storage-raid">#</a></h5><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/deployment_images_ignition.xml" title="Edit source document"> </a></div></div></div></div></div><p>
      The <code class="literal">raid</code> is a list of RAID arrays. The following
      attributes of <code class="literal">raid</code> are mandatory:
     </p><div class="variablelist"><dl class="variablelist"><dt id="id-1.4.4.5.4.11.5.4.3.1"><span class="term">level</span></dt><dd><p>
         a level of the particular RAID array (linear, raid0, raid1, raid2,
         raid3, raid4, raid5, raid6)
        </p></dd><dt id="id-1.4.4.5.4.11.5.4.3.2"><span class="term">devices</span></dt><dd><p>
         a list of devices in the array referenced by their absolute paths
        </p></dd><dt id="id-1.4.4.5.4.11.5.4.3.3"><span class="term">name</span></dt><dd><p>
         a name that will be used for the md device
        </p></dd></dl></div><div class="verbatim-wrap"><pre class="screen">      {
    "variant": "fcos",
    "version": "3.3.0",
    "storage": {
        "raid": [
            {
                "name": "system",
                "level": "raid1",
                "devices": [
                    "/dev/sda",
                    "/dev/sdb"
                ]
            }
        ]
    }
}</pre></div><p>
      The same example in the YAML format:
     </p><div class="verbatim-wrap"><pre class="screen">variant: fcos
version: 1.4.0
storage:
  - raid: data
    name: system
    level: raid1
    devices: "/dev/sda", "/dev/sdb"</pre></div></section><section class="sect4" id="sec-storage-filesystem" data-id-title="The filesystem attribute"><div class="titlepage"><div><div><div class="title-container"><h5 class="title"><span class="title-number-name"><span class="title-number">8.2.1.1.3 </span><span class="title-name">The <code class="literal">filesystem</code> attribute</span></span> <a title="Permalink" class="permalink" href="cha-images-ignition.html#sec-storage-filesystem">#</a></h5><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/deployment_images_ignition.xml" title="Edit source document"> </a></div></div></div></div></div><p>
            <code class="literal">filesystem</code> must contain the following
            attributes:
          </p><div class="variablelist"><dl class="variablelist"><dt id="id-1.4.4.5.4.11.5.5.3.1"><span class="term">device</span></dt><dd><p>
                  the absolute path to the device, typically
                  <code class="literal">/dev/sda</code> in case of physical disk
                </p></dd><dt id="id-1.4.4.5.4.11.5.5.3.2"><span class="term">format</span></dt><dd><p>
                  the file system format (btrfs, ext4, xfs, vfat or swap)
                </p><div id="id-1.4.4.5.4.11.5.5.3.2.2.2" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note</div><p>
                    In the case of SLE Micro, the <code class="literal">root</code> file
                    system must be formatted to btrfs.
                  </p></div></dd></dl></div><p>
            The following example demonstrates using the
            <code class="literal">filesystem</code> attribute. The
            <code class="filename">/opt</code> directory will be mounted to the
            <code class="literal">/dev/sda1</code> partition, which is formatted to
            btrfs. The partition table will not be erased.
          </p><div class="verbatim-wrap"><pre class="screen">{
    "variant": "fcos",
    "version": "3.3.0",
    "storage": {
        "filesystems": [
            {
                "path": "/opt",
                "device": "/dev/sda1",
                "format": "btrfs",
                "wipe_filesystem": false
            }
        ]
    }
}</pre></div><p>
  The same example in the YAML format:
  </p><div class="verbatim-wrap"><pre class="screen">variant: fcos
version: 1.4.0
storage:
  filesystems:
    - path: /opt
      device: "/dev/sda1"
      format: btrfs
      wipe_filesystem: false</pre></div></section><section class="sect4" id="sec-storage-files" data-id-title="The files attribute"><div class="titlepage"><div><div><div class="title-container"><h5 class="title"><span class="title-number-name"><span class="title-number">8.2.1.1.4 </span><span class="title-name">The <code class="literal">files</code> attribute</span></span> <a title="Permalink" class="permalink" href="cha-images-ignition.html#sec-storage-files">#</a></h5><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/deployment_images_ignition.xml" title="Edit source document"> </a></div></div></div></div></div><p>
            You can use the <code class="literal">files</code> attribute to create any
            files on your machine. Bear in mind that if you want to create
            files outside the
            <a class="xref" href="cha-images-description.html#sec-default-partitioning" title="5.1. Default partitioning">default mounted directories</a>,
            you need to define the directories by using the
            <code class="literal">filesystem</code> attribute.
          </p><p>
            In the following example, a host name is created by using the
            <code class="literal">files</code> attribute. The file
            <code class="filename">/etc/hostname</code> will be created with the
            <span class="emphasis"><em>slemicro-1</em></span> host name.
          </p><div id="id-1.4.4.5.4.11.5.6.4" data-id-title="Different numeral systems in JSON and YAML" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note: Different numeral systems in JSON and YAML</div><p>
              Bear in mind that JSON uses the decimal numeral system, so the
              <code class="literal">mode</code> value is a decimal notation of the access
              rights. To use the octal notation, prefer YAML in this case.
            </p></div><div class="verbatim-wrap"><pre class="screen">{
    "variant": "fcos",
    "version": "3.3.0",
    "storage": {
        "files": [
            {
                "path": "/etc/hostname",
                "mode": 420,
                "overwrite": true,
                "contents": {
                    "inline": "slemicro-1"
                }
            }
        ]
    }
}</pre></div><p>
  The same example in YAML:
  </p><div class="verbatim-wrap"><pre class="screen">variant: fcos
version: 1.4.0
storage:
  files:
    - path: /etc/hostname
      mode: 0644
      overwrite: true
      contents:
        inline: "slemicro-1"</pre></div></section><section class="sect4" id="sec-storage-directories" data-id-title="The directories attribute"><div class="titlepage"><div><div><div class="title-container"><h5 class="title"><span class="title-number-name"><span class="title-number">8.2.1.1.5 </span><span class="title-name">The <code class="literal">directories</code> attribute</span></span> <a title="Permalink" class="permalink" href="cha-images-ignition.html#sec-storage-directories">#</a></h5><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/deployment_images_ignition.xml" title="Edit source document"> </a></div></div></div></div></div><p>
      The <code class="literal">directories</code> attribute is a list of directories
      that will be created in the file system. The
      <code class="literal">directories</code> attribute must contain at least one
      <code class="literal">path</code> attribute.
     </p><div class="verbatim-wrap"><pre class="screen">{
    "variant": "fcos",
    "version": "3.3.0",
    "storage": {
        "directories": [
            {
                "path": "/mnt/backup",
                "user": {
                    "name": "tux"
                }
            }
        ]
    }
}</pre></div><p>
  The same example in YAML:
  </p><div class="verbatim-wrap"><pre class="screen">variant: fcos
version: 1.4.0
storage:
  directories:
    - path: /mnt/backup
      user: 
       - name: tux</pre></div></section></section><section class="sect3" id="sec-ignition-users" data-id-title="Users administration"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">8.2.1.2 </span><span class="title-name">Users administration</span></span> <a title="Permalink" class="permalink" href="cha-images-ignition.html#sec-ignition-users">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/deployment_images_ignition.xml" title="Edit source document"> </a></div></div></div></div></div><p>
          The <code class="literal">passwd</code> attribute is used to add users. If you
          intend to log in to your system, create <code class="systemitem">root</code> and set the
          <code class="systemitem">root</code>'s password and/or add the SSH key to the Ignition
          configuration. You need to hash the <code class="systemitem">root</code> password, for example,
          by using the <code class="command">openssl</code> command:
        </p><div class="verbatim-wrap"><pre class="screen"> openssl passwd -6</pre></div><p>
     The command creates a hash of the password you chose. Use this hash as the
     value of the <code class="literal">password_hash</code> attribute.
    </p><div class="verbatim-wrap"><pre class="screen">variant: fcos
version: 1.0.0
passwd:
  users:
   - name: root
     password_hash: "$6$PfKm6Fv5WbqOvZ0C$g4kByYM.D2B5GCsgluuqDNL87oeXiHqctr6INNNmF75WPGgkLn9O9uVx4iEe3UdbbhaHbTJ1vpZymKWuDIrWI1"
     ssh_authorized_keys: 
       - ssh-rsa long...key user@host</pre></div><p>
          The <code class="literal">users</code> attribute must contain at least one
          <code class="literal">name</code> attribute.
          <code class="literal">ssh_authorized_keys</code> is a list of ssh keys for the
          user.
        </p><div id="id-1.4.4.5.4.11.6.7" data-id-title="Creating other users than root" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note: Creating other users than <code class="systemitem">root</code></div><p>
            When you are creating other users than <code class="systemitem">root</code>, you need to
            define <code class="filename">/home</code> directories for the users,
            because these directories (usually
            <code class="filename">/home/<em class="replaceable">USER_NAME</em></code>)
            are not mounted by default. Therefore, declare these directories
            using the <code class="literal">storage</code>/<code class="literal">filesystem</code>
            attribute. For example, for the tux, the example
            looks as follows:
          </p><div class="verbatim-wrap"><pre class="screen">        {
  "ignition": {
    "version": "3.2.0"
  },
  "passwd": {
    "users": [
      {
        "name": "tux",
        "passwordHash": "$2a$10$US9XSqLOqMmGq/OnhlVjPOwuZREh2.iEtlwD5LI7DKgV24NJU.wO6"
      }
    ]
  },
  "storage": {
    "filesystems": [
      {
        "device": "/dev/disk/by-label/ROOT",
        "format": "btrfs",
        "mountOptions": [
          "subvol=/@/home"
        ],
        "path": "/home",
        "wipeFilesystem": false
      }
    ]
  }
}</pre></div><p>
        The same in YAML:
      </p><div class="verbatim-wrap"><pre class="screen">version: 1.2.0
passwd:
  users:
    - name: tux
      passwordHash: $2a$10$US9XSqLOqMmGq/OnhlVjPOwuZREh2.iEtlwD5LI7DKgV24NJU.wO6
storage:
  filesystems:
    - device: /dev/disk/by-label/ROOT
      format: btrfs
      mountOptions:
        - subvol=/@/home
      path: /home
      wipeFilesystem: false</pre></div></div></section><section class="sect3" id="sec-ignition-systemd" data-id-title="Enabling systemd services"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">8.2.1.3 </span><span class="title-name">Enabling <code class="literal">systemd</code> services</span></span> <a title="Permalink" class="permalink" href="cha-images-ignition.html#sec-ignition-systemd">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/deployment_images_ignition.xml" title="Edit source document"> </a></div></div></div></div></div><p>
     You can enable <code class="systemitem">systemd</code> services by specifying them in the
     <code class="literal">systemd</code> attribute. 
     The <code class="literal">name</code> must be the exact name of a service to be
     enabled (including the suffix).
    </p><div class="verbatim-wrap"><pre class="screen">variant: fcos
version: 1.0.0
systemd:
  units:
  - name: sshd.service
    enabled: true</pre></div><div class="verbatim-wrap"><pre class="screen">  {
  "ignition": {
    "version": "3.0.0"
  },
  "systemd": {
    "units": [
      {
        "enabled": true,
        "name": "sshd.service"
      }
    ]
  }
}</pre></div><p>
  The same example in YAML:
 </p><div class="verbatim-wrap"><pre class="screen">variant: fcos
version: 1.0.0
systemd:
  units:
  - name: sshd.service
    enabled: true</pre></div></section></section><section class="sect2" id="sec-converting-config" data-id-title="Converting YAML fcc file to JSON ign"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">8.2.2 </span><span class="title-name">Converting YAML <code class="literal">fcc</code> file to JSON <code class="literal">ign</code></span></span> <a title="Permalink" class="permalink" href="cha-images-ignition.html#sec-converting-config">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/deployment_images_ignition.xml" title="Edit source document"> </a></div></div></div></div></div><p>
        To make the Ignition configuration more human-readable, you can use a
        two-phase configuration. First, prepare your configuration in YAML as
        a <code class="literal">fcc</code> file and then transpile this configuration to
        JSON. The transpilation can be done by the <code class="literal">butane</code>
        tool.
      </p><p>
        During the transpilation, <code class="literal">butane</code> also verifies the
        syntax of the YAML file to catch potential errors in the structure. For
        the latest version of the <code class="literal">butane</code> tool, add a
        repository:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code>  zypper ar -f \
  https://download.opensuse.org/repositories/devel:/kubic:/ignition/<em class="replaceable">DISTRIBUTION</em>/ \
  devel_kubic_ignition</pre></div><p>
    where <em class="replaceable">DISTRIBUTION</em> is one of the following
    (depending on your distribution):
   </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
      <code class="literal">openSUSE_Tumbleweed</code>
     </p></li><li class="listitem"><p>
      <code class="literal">openSUSE_Leap_$release_number</code>
     </p></li><li class="listitem"><p>
      <code class="literal">15.a</code>
     </p></li></ul></div><p>
    Now you can install the <code class="literal">butane</code> tool:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code>  zypper in butane</pre></div><p>
    Now you can invoke <code class="literal">butane</code> by running:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code> butane -p -o config.ign config.fcc</pre></div><p>
    where:
   </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
      <code class="filename">config.fcc</code> is the path to the YAML configuration
      file
     </p></li><li class="listitem"><p>
      <code class="filename">config.ign</code> is the path to the output JSON
      configuration file
     </p></li><li class="listitem"><p>
      The <code class="option">-p</code> command option adds line breaks to the output
      file and thus makes it more readable.
     </p></li></ul></div></section></section></section><nav class="bottom-pagination"><div><a class="pagination-link prev" href="cha-selfinstal-procedure.html"><span class="pagination-relation">Previous</span><span class="pagination-label"><span class="title-number">Chapter 7 </span>Deploying selfinstall images</span></a> </div><div><a class="pagination-link next" href="cha-images-combustion.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Chapter 9 </span>Configuring with Combustion</span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="sect1"><a href="cha-images-ignition.html#sec-about-ignition"><span class="title-number">8.1 </span><span class="title-name">About Ignition</span></a></span></li><li><span class="sect1"><a href="cha-images-ignition.html#sec-ignition-configuration"><span class="title-number">8.2 </span><span class="title-name"><code class="filename">config.ign</code></span></a></span></li></ul></div><div class="side-title">Share this page</div><ul class="share"><li><a id="_share-fb" href="#" title="Facebook"> </a></li><li><a id="_share-in" href="#" title="LinkedIn"> </a></li><li><a id="_share-tw" href="#" title="Twitter/X"> </a></li><li><a id="_share-mail" href="#" title="E-Mail"> </a></li><li><a id="_print-button" href="#" title="Print this page"> </a></li></ul> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2024</span></div></div></footer></body></html>