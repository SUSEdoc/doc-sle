<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><title>SLES 15 SP2 | Virtualization Guide | Managing Networks</title><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"/>
<meta name="title" content="Managing Networks | SLES 15 SP2"/>
<meta name="description" content="This chapter describes common network configurations for a VM Host Server, including those supported natively by the VM Host Server and libvirt. The …"/>
<meta name="product-name" content="SUSE Linux Enterprise Server"/>
<meta name="product-number" content="15 SP2"/>
<meta name="book-title" content="Virtualization Guide"/>
<meta name="chapter-title" content="Chapter 12. Managing Networks"/>
<meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi"/>
<meta name="tracker-type" content="bsc"/>
<meta name="tracker-bsc-assignee" content="fs@suse.com"/>
<meta name="tracker-bsc-component" content="Documentation"/>
<meta name="tracker-bsc-product" content="SUSE Linux Enterprise Server 15 SP2"/>
<meta name="publisher" content="SUSE"/><meta property="og:title" content="Virtualization Guide"/>
<meta property="og:description" content="Learn all about virtualization and VM management"/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Virtualization Guide"/>
<meta name="twitter:description" content="Learn all about virtualization and VM management"/>
<script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": ["TechArticle"],
    "image": "https://www.suse.com/assets/img/suse-white-logo-green.svg",
    
     "isPartOf": {
      "@type": "CreativeWorkSeries",
      "name": "Products &amp; Solutions"
    },
    
    "inLanguage": "en",
    

    "headline": "Managing Networks",
  
    "description": "This chapter describes common network configurations for a VM Host Server, including those supported natively by the VM Host Server and libvirt. The …",
      
    "author": [
      {
        "@type": "Corporation",
        "name": "SUSE Product &amp; Solution Documentation Team",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    ],
      
    "dateModified": "2024-06-10T00:00+02:00",
      
    "datePublished": "2020-07-21T00:00+02:00",
      

    "about": [
      
    ],
  
    "sameAs": [
          "https://www.facebook.com/SUSEWorldwide/about",
          "https://www.youtube.com/channel/UCHTfqIzPKz4f_dri36lAQGA",
          "https://twitter.com/SUSE",
          "https://www.linkedin.com/company/suse"
    ],
    "publisher": {
      "@type": "Corporation",
      "name": "SUSE",
      "url": "https://documentation.suse.com",
      "logo": {
        "@type": "ImageObject",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    }
  }</script>
<link rel="prev" href="cha-libvirt-storage.html" title="Chapter 11. Managing Storage"/><link rel="next" href="cha-libvirt-config-gui.html" title="Chapter 13. Configuring Virtual Machines with Virtual Machine Manager"/><script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/script-purejs.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script><meta name="edit-url" content="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/libvirt_networking.xml"/></head><body class="draft wide offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"><img src="static/images/logo.svg" alt="Logo" class="logo"/></div></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">Virtualization Guide</a><span> / </span><a class="crumb" href="part-virt-libvirt.html">Managing Virtual Machines with libvirt</a><span> / </span><a class="crumb" href="cha-libvirt-networks.html">Managing Networks</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title">Virtualization Guide</div><ol><li><a href="cha-kvm.html" class=" "><span class="title-number"> </span><span class="title-name">About This Manual</span></a></li><li><a href="part-virt-intro.html" class="has-children "><span class="title-number">I </span><span class="title-name">Introduction</span></a><ol><li><a href="chap-virtualization-introduction.html" class=" "><span class="title-number">1 </span><span class="title-name">Virtualization Technology</span></a></li><li><a href="cha-xen-basics.html" class=" "><span class="title-number">2 </span><span class="title-name">Introduction to Xen Virtualization</span></a></li><li><a href="cha-kvm-intro.html" class=" "><span class="title-number">3 </span><span class="title-name">Introduction to KVM Virtualization</span></a></li><li><a href="cha-tools-intro.html" class=" "><span class="title-number">4 </span><span class="title-name">Virtualization Tools</span></a></li><li><a href="cha-vt-installation.html" class=" "><span class="title-number">5 </span><span class="title-name">Installation of Virtualization Components</span></a></li><li><a href="cha-virt-support.html" class=" "><span class="title-number">6 </span><span class="title-name">Supported Hosts, Guests, and Features</span></a></li></ol></li><li class="active"><a href="part-virt-libvirt.html" class="has-children you-are-here"><span class="title-number">II </span><span class="title-name">Managing Virtual Machines with <code class="systemitem">libvirt</code></span></a><ol><li><a href="cha-libvirt-overview.html" class=" "><span class="title-number">7 </span><span class="title-name">Starting and Stopping <code class="systemitem">libvirtd</code></span></a></li><li><a href="cha-kvm-inst.html" class=" "><span class="title-number">8 </span><span class="title-name">Guest Installation</span></a></li><li><a href="cha-libvirt-managing.html" class=" "><span class="title-number">9 </span><span class="title-name">Basic VM Guest Management</span></a></li><li><a href="cha-libvirt-connect.html" class=" "><span class="title-number">10 </span><span class="title-name">Connecting and Authorizing</span></a></li><li><a href="cha-libvirt-storage.html" class=" "><span class="title-number">11 </span><span class="title-name">Managing Storage</span></a></li><li><a href="cha-libvirt-networks.html" class=" you-are-here"><span class="title-number">12 </span><span class="title-name">Managing Networks</span></a></li><li><a href="cha-libvirt-config-gui.html" class=" "><span class="title-number">13 </span><span class="title-name">Configuring Virtual Machines with Virtual Machine Manager</span></a></li><li><a href="cha-libvirt-config-virsh.html" class=" "><span class="title-number">14 </span><span class="title-name">Configuring Virtual Machines with <code class="command">virsh</code></span></a></li><li><a href="cha-libvirt-manage-vagrant.html" class=" "><span class="title-number">15 </span><span class="title-name">Managing Virtual Machines with Vagrant</span></a></li></ol></li><li><a href="part-virt-common.html" class="has-children "><span class="title-number">III </span><span class="title-name">Hypervisor-Independent Features</span></a><ol><li><a href="cha-cachemodes.html" class=" "><span class="title-number">16 </span><span class="title-name">Disk Cache Modes</span></a></li><li><a href="sec-kvm-managing-clock.html" class=" "><span class="title-number">17 </span><span class="title-name">VM Guest Clock Settings</span></a></li><li><a href="chap-guestfs.html" class=" "><span class="title-number">18 </span><span class="title-name">libguestfs</span></a></li><li><a href="cha-qemu-ga.html" class=" "><span class="title-number">19 </span><span class="title-name">QEMU Guest Agent</span></a></li><li><a href="virt-crash-dump.html" class=" "><span class="title-number">20 </span><span class="title-name">Creating crash dumps of a VM Guest</span></a></li></ol></li><li><a href="part-virt-xen.html" class="has-children "><span class="title-number">IV </span><span class="title-name">Managing Virtual Machines with Xen</span></a><ol><li><a href="cha-xen-vhost.html" class=" "><span class="title-number">21 </span><span class="title-name">Setting Up a Virtual Machine Host</span></a></li><li><a href="cha-xen-network.html" class=" "><span class="title-number">22 </span><span class="title-name">Virtual Networking</span></a></li><li><a href="cha-xen-manage.html" class=" "><span class="title-number">23 </span><span class="title-name">Managing a Virtualization Environment</span></a></li><li><a href="cha-xen-vbd.html" class=" "><span class="title-number">24 </span><span class="title-name">Block Devices in Xen</span></a></li><li><a href="cha-xen-config.html" class=" "><span class="title-number">25 </span><span class="title-name">Virtualization: Configuration Options and Settings</span></a></li><li><a href="cha-xen-admin.html" class=" "><span class="title-number">26 </span><span class="title-name">Administrative Tasks</span></a></li><li><a href="cha-xen-xenstore.html" class=" "><span class="title-number">27 </span><span class="title-name">XenStore: Configuration Database Shared between Domains</span></a></li><li><a href="cha-xen-ha.html" class=" "><span class="title-number">28 </span><span class="title-name">Xen as a High-Availability Virtualization Host</span></a></li></ol></li><li><a href="part-virt-qemu.html" class="has-children "><span class="title-number">V </span><span class="title-name">Managing Virtual Machines with QEMU</span></a><ol><li><a href="cha-qemu-overview.html" class=" "><span class="title-number">29 </span><span class="title-name">QEMU Overview</span></a></li><li><a href="cha-qemu-host.html" class=" "><span class="title-number">30 </span><span class="title-name">Setting Up a KVM VM Host Server</span></a></li><li><a href="cha-qemu-guest-inst.html" class=" "><span class="title-number">31 </span><span class="title-name">Guest Installation</span></a></li><li><a href="cha-qemu-running.html" class=" "><span class="title-number">32 </span><span class="title-name">Running Virtual Machines with qemu-system-ARCH</span></a></li><li><a href="cha-qemu-monitor.html" class=" "><span class="title-number">33 </span><span class="title-name">Virtual Machine Administration Using QEMU Monitor</span></a></li></ol></li><li><a href="part-virt-lxc.html" class="has-children "><span class="title-number">VI </span><span class="title-name">Managing Virtual Machines with LXC</span></a><ol><li><a href="cha-lxc.html" class=" "><span class="title-number">34 </span><span class="title-name">Linux Containers</span></a></li><li><a href="cha-lxc2libvirt.html" class=" "><span class="title-number">35 </span><span class="title-name">Migration from LXC to <code class="systemitem">libvirt-lxc</code></span></a></li></ol></li><li><a href="gloss-vt-glossary.html" class=" "><span class="title-number"> </span><span class="title-name">Glossary</span></a></li><li><a href="app-vmdp-driver.html" class=" "><span class="title-number">A </span><span class="title-name">Virtual Machine Drivers</span></a></li><li><a href="app-kvm.html" class=" "><span class="title-number">B </span><span class="title-name">Appendix</span></a></li><li><a href="cha-xmtoxl.html" class=" "><span class="title-number">C </span><span class="title-name">XM, XL Toolstacks and Libvirt framework</span></a></li><li><a href="bk10apd.html" class=" "><span class="title-number">D </span><span class="title-name">GNU licenses</span></a></li> </ol> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section class="chapter" id="cha-libvirt-networks" data-id-title="Managing Networks"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname"><span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span></span> <span class="productnumber"><span class="productnumber"><span class="phrase">15 SP2</span></span></span></div><div><div class="title-container"><h1 class="title"><span class="title-number-name"><span class="title-number">12 </span><span class="title-name">Managing Networks</span></span> <a title="Permalink" class="permalink" href="cha-libvirt-networks.html#">#</a></h1><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/libvirt_networking.xml" title="Edit source document"> </a></div></div></div><div><div class="abstract"><p>
     This chapter describes common network configurations for a VM Host Server,
     including those supported natively by the VM Host Server and <code class="systemitem">libvirt</code>.
     The configurations are valid for all hypervisors supported by <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span>,
     such as KVM or Xen.
   </p></div></div></div></div><p>
  There are two common network configurations to provide a VM Guest with a
  network connection:
 </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
    A <span class="emphasis"><em>network bridge</em></span> acting as a Layer 2 switch
   </p></li><li class="listitem"><p>
    A <span class="emphasis"><em>virtual network</em></span> managed by <code class="systemitem">libvirt</code> with Layer 3
    forwarding enabled
   </p></li></ul></div><section class="sect1" id="libvirt-networks-bridged" data-id-title="Network Bridge"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">12.1 </span><span class="title-name">Network Bridge</span></span> <a title="Permalink" class="permalink" href="cha-libvirt-networks.html#libvirt-networks-bridged">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/libvirt_networking.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   The network bridge configuration provides a Layer 2 switch for VM Guests,
   switching Layer 2 Ethernet packets between ports on the bridge based on MAC
   addresses associated with the ports. This gives the VM Guest Layer 2 access
   to the VM Host Server's network. This configuration is analogous to connecting the
   VM Guest's virtual Ethernet cable into a hub that is shared with the host
   and other VM Guests running on the host. The configuration is often referred
   to as <span class="emphasis"><em>shared physical device</em></span>.
  </p><p>
   The network bridge configuration is the default configuration of
   <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> when configured as a KVM or Xen hypervisor. It is the
   preferred configuration when you simply want to connect VM Guests to the
   VM Host Server's LAN.
  </p><section class="sect2" id="libvirt-networks-bridged-yast" data-id-title="Managing Network Bridges with YaST"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">12.1.1 </span><span class="title-name">Managing Network Bridges with YaST</span></span> <a title="Permalink" class="permalink" href="cha-libvirt-networks.html#libvirt-networks-bridged-yast">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/libvirt_networking.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    This section includes procedures to add or remove network bridges with
    YaST.
   </p><section class="sect3" id="libvirt-networks-bridged-yast-add" data-id-title="Adding a Network Bridge"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">12.1.1.1 </span><span class="title-name">Adding a Network Bridge</span></span> <a title="Permalink" class="permalink" href="cha-libvirt-networks.html#libvirt-networks-bridged-yast-add">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/libvirt_networking.xml" title="Edit source document"> </a></div></div></div></div></div><p>
     To add a network bridge on VM Host Server, follow these steps:
    </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
       Start
       <span class="guimenu">YaST</span> › <span class="guimenu">System</span> › <span class="guimenu">Network
       Settings</span>.
      </p></li><li class="step"><p>
       Activate the <span class="guimenu">Overview</span> tab and click
       <span class="guimenu">Add</span>.
      </p></li><li class="step"><p>
       Select <span class="guimenu">Bridge</span> from the <span class="guimenu">Device Type</span>
       list and enter the bridge device interface name in the
       <span class="guimenu">Configuration Name</span> entry. Press the
       <span class="guimenu">Next</span> button to proceed.
      </p></li><li class="step"><p>
       In the <span class="guimenu">Address</span> tab, specify networking details such
       as DHCP/static IP address, subnet mask or host name.
      </p><p>
       Using <span class="guimenu">Dynamic Address</span> is only useful when also
       assigning a device to a bridge that is connected to a DHCP server.
      </p><p>
       If you intend to create a virtual bridge that has no connection to a
       real Ethernet device, use <span class="guimenu">Statically assigned IP
       Address</span>. In this case, it is a good idea to use addresses from
       the private IP address ranges, for example,
       <code class="literal">192.168.0.0/16</code>, <code class="literal">172.16.0.0/12</code>, or
       <code class="literal">10.0.0.0/8</code>.
      </p><p>
       To create a bridge that should only serve as a connection between the
       different guests without connection to the host system, set the IP
       address to <code class="literal">0.0.0.0</code> and the subnet mask to
       <code class="literal">255.255.255.255</code>. The network scripts handle this
       special address as an unset IP address.
      </p></li><li class="step"><p>
       Activate the <span class="guimenu">Bridged Devices</span> tab and activate the
       network devices you want to include in the network bridge.
      </p></li><li class="step"><p>
       Click <span class="guimenu">Next</span> to return to the
       <span class="guimenu">Overview</span> tab and confirm with <span class="guimenu">OK</span>.
       The new network bridge should now be active on VM Host Server.
      </p></li></ol></div></div></section><section class="sect3" id="libvirt-networks-bridged-yast-rm" data-id-title="Deleting a Network Bridge"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">12.1.1.2 </span><span class="title-name">Deleting a Network Bridge</span></span> <a title="Permalink" class="permalink" href="cha-libvirt-networks.html#libvirt-networks-bridged-yast-rm">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/libvirt_networking.xml" title="Edit source document"> </a></div></div></div></div></div><p>
     To delete an existing network bridge, follow these steps:
    </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
       Start
       <span class="guimenu">YaST</span> › <span class="guimenu">System</span> › <span class="guimenu">Network
       Settings</span>.
      </p></li><li class="step"><p>
       Select the bridge device you want to delete from the list in the
       <span class="guimenu">Overview</span> tab.
      </p></li><li class="step"><p>
       Delete the bridge with <span class="guimenu">Delete</span> and confirm with
       <span class="guimenu">OK</span>.
      </p></li></ol></div></div></section></section><section class="sect2" id="libvirt-networks-bridged-add-brctl" data-id-title="Managing Network Bridges from the Command Line"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">12.1.2 </span><span class="title-name">Managing Network Bridges from the Command Line</span></span> <a title="Permalink" class="permalink" href="cha-libvirt-networks.html#libvirt-networks-bridged-add-brctl">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/libvirt_networking.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    This section includes procedures to add or remove network bridges using the
    command line.
   </p><section class="sect3" id="libvirt-networks-bridged-add-brctl-add" data-id-title="Adding a Network Bridge"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">12.1.2.1 </span><span class="title-name">Adding a Network Bridge</span></span> <a title="Permalink" class="permalink" href="cha-libvirt-networks.html#libvirt-networks-bridged-add-brctl-add">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/libvirt_networking.xml" title="Edit source document"> </a></div></div></div></div></div><p>
     To add a new network bridge device on VM Host Server, follow these steps:
    </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
       Log in as <code class="systemitem">root</code> on the VM Host Server where you want to create a new
       network bridge.
      </p></li><li class="step"><p>
       Choose a name for the new
       bridge—<em class="replaceable">virbr_test</em> in our
       example—and run
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>ip link add name <em class="replaceable">VIRBR_TEST</em> type bridge</pre></div></li><li class="step"><p>
       Check if the bridge was created on VM Host Server:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>bridge vlan
[...]
virbr_test  1 PVID Egress Untagged</pre></div><p>
       <code class="literal">virbr_test</code> is present, but is not associated with any
       physical network interface.
      </p></li><li class="step"><p>
       Bring the network bridge up and add a network interface to the bridge:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>ip link set virbr_test up
<code class="prompt root"># </code>ip link set eth1 master virbr_test</pre></div><div id="id-1.12.4.7.5.5.3.3.4.3" data-id-title="Network Interface Must Be Unused" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg"/><div class="admon-title">Important: Network Interface Must Be Unused</div><p>
        You can only assign a network interface that is not yet used by another
        network bridge.
       </p></div></li><li class="step"><p>
       Optionally, enable STP (see
       <a class="link" href="https://en.wikipedia.org/wiki/Spanning_Tree_Protocol" target="_blank">Spanning
       Tree Protocol</a>):
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>bridge link set dev virbr_test cost 4</pre></div></li></ol></div></div></section><section class="sect3" id="libvirt-networks-bridged-add-brctl-del" data-id-title="Deleting a Network Bridge"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">12.1.2.2 </span><span class="title-name">Deleting a Network Bridge</span></span> <a title="Permalink" class="permalink" href="cha-libvirt-networks.html#libvirt-networks-bridged-add-brctl-del">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/libvirt_networking.xml" title="Edit source document"> </a></div></div></div></div></div><p>
     To delete an existing network bridge device on VM Host Server from the command
     line, follow these steps:
    </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
       Log in as <code class="systemitem">root</code> on the VM Host Server where you want to delete an
       existing network bridge.
      </p></li><li class="step"><p>
       List existing network bridges to identify the name of the bridge to
       remove:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>bridge vlan
[...]
virbr_test  1 PVID Egress Untagged</pre></div></li><li class="step"><p>
       Delete the bridge:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>ip link delete dev virbr_test</pre></div></li></ol></div></div></section></section><section class="sect2" id="sec-xen-net-vlan" data-id-title="Using VLAN Interfaces"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">12.1.3 </span><span class="title-name">Using VLAN Interfaces</span></span> <a title="Permalink" class="permalink" href="cha-libvirt-networks.html#sec-xen-net-vlan">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/libvirt_networking.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    Sometimes, it is necessary to create a private connection either between
    two VM Host Servers or between VM Guest systems. For example, to migrate
    VM Guest to hosts in a different network segment, or to create a private
    bridge that only VM Guest systems may connect to (even when running on
    different VM Host Server systems). An easy way to build such connections is to set
    up VLAN networks.
   </p><p>
    VLAN interfaces are commonly set up on the VM Host Server. They either interconnect
    the different VM Host Server systems, or they may be set up as a physical
    interface to an otherwise virtual-only bridge. It is even possible to
    create a bridge with a VLAN as a physical interface that has no IP address
    in the VM Host Server. That way, the guest systems have no possibility to access
    the host over this network.
   </p><p>
    Run the YaST module <span class="guimenu">System</span> › <span class="guimenu">Network
    Settings</span>. Follow this procedure to set up the VLAN
    device:
   </p><div class="procedure" id="id-1.12.4.7.5.6.5" data-id-title="Setting up VLAN Interfaces with YaST"><div class="title-container"><div class="procedure-title-wrap"><div class="procedure-title"><span class="title-number-name"><span class="title-number">Procedure 12.1: </span><span class="title-name">Setting up VLAN Interfaces with YaST </span></span><a title="Permalink" class="permalink" href="cha-libvirt-networks.html#id-1.12.4.7.5.6.5">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/libvirt_networking.xml" title="Edit source document"> </a></div></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
      Click <span class="guimenu">Add</span> to create a new network interface.
     </p></li><li class="step"><p>
      In the <span class="guimenu">Hardware Dialog</span>, select <span class="guimenu">Device
      Type</span> <span class="guimenu">VLAN</span>.
     </p></li><li class="step"><p>
      Change the value of <span class="guimenu">Configuration Name</span> to the ID of
      your VLAN. Note that VLAN ID <code class="literal">1</code> is commonly used for
      management purposes.
     </p></li><li class="step"><p>
      Click <span class="guimenu">Next</span>.
     </p></li><li class="step"><p>
      Select the interface that the VLAN device should connect to below
      <span class="guimenu">Real Interface for VLAN</span>. If the desired interface does
      not appear in the list, first set up this interface without an IP
      address.
     </p></li><li class="step"><p>
      Select the desired method for assigning an IP address to the VLAN device.
     </p></li><li class="step"><p>
      Click <span class="guimenu">Next</span> to finish the configuration.
     </p></li></ol></div></div><p>
    It is also possible to use the VLAN interface as a physical interface of a
    bridge. This makes it possible to connect several VM Host Server-only networks
    and allows live migration of VM Guest systems that are connected to such a
    network.
   </p><p>
    YaST does not always allow setting no IP address. However, this may be a
    desired feature, especially if VM Host Server-only networks should be connected.
    In this case, use the special address <code class="literal">0.0.0.0</code> with
    netmask <code class="literal">255.255.255.255</code>. The system scripts handle this
    address as no IP address set.
   </p></section></section><section class="sect1" id="libvirt-networks-virtual" data-id-title="Virtual Networks"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">12.2 </span><span class="title-name">Virtual Networks</span></span> <a title="Permalink" class="permalink" href="cha-libvirt-networks.html#libvirt-networks-virtual">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/libvirt_networking.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   <code class="systemitem">libvirt</code>-managed virtual networks are similar to bridged networks, but
   typically have no Layer 2 connection to the VM Host Server. Connectivity to
   the VM Host Server's physical network is accomplished with Layer 3 forwarding,
   which introduces additional packet processing on the VM Host Server as compared
   to a Layer 2 bridged network. Virtual networks also provide DHCP and DNS
   services for VM Guests. For more information on <code class="systemitem">libvirt</code> virtual networks,
   see the <em class="citetitle">Network XML format</em> documentation at
   <a class="link" href="https://libvirt.org/formatnetwork.html" target="_blank">https://libvirt.org/formatnetwork.html</a>.
  </p><p>
   A standard <code class="systemitem">libvirt</code> installation on <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> already comes with a
   predefined virtual network named <code class="literal">default</code> that provides
   DHCP and DNS services for the network, along with connectivity to the
   VM Host Server's physical network using the network address translation (NAT)
   forwarding mode. Although it is predefined, the <code class="literal">default</code>
   virtual network must be explicitly enabled by the administrator. For more
   information on the forwarding modes supported by <code class="systemitem">libvirt</code> see the
   <em class="citetitle">Connectivity</em> section of the
   <em class="citetitle">Network XML format</em> documentation at
   <a class="link" href="https://libvirt.org/formatnetwork.html#elementsConnect" target="_blank">https://libvirt.org/formatnetwork.html#elementsConnect</a>.
  </p><p>
   <code class="systemitem">libvirt</code>-managed virtual networks can be used to satisfy a wide range
   of use-cases but are commonly used on VM Host Servers that have a wireless
   connection or dynamic/sporadic network connectivity such as laptops.
   Virtual networks are also useful when the VM Host Server's network has limited
   IP addresses, allowing forwarding of packets between the virtual network
   and the VM Host Server's network. However, most server use cases are better
   suited for the network bridge configuration, where VM Guests are connected
   to the VM Host Server's LAN.
  </p><div id="id-1.12.4.7.6.5" data-id-title="Enabling Forwarding Mode" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.svg"/><div class="admon-title">Warning: Enabling Forwarding Mode</div><p>
    Enabling forwarding mode in a <code class="systemitem">libvirt</code> virtual network enables forwarding
    in the VM Host Server by setting <code class="filename">/proc/sys/net/ipv4/ip_forward</code>
    and <code class="filename">/proc/sys/net/ipv6/conf/all/forwarding</code> to 1, which
    essentially turns the VM Host Server into a router. Restarting the VM Host Server's
    network may reset the values and disable forwarding. To avoid this behavior,
    explicitly enable forwarding in the VM Host Server by editing the
    <code class="filename">/etc/sysctl.conf</code> file and adding:
   </p><div class="verbatim-wrap"><pre class="screen">net.ipv4.ip_forward = 1</pre></div><div class="verbatim-wrap"><pre class="screen">net.ipv6.conf.all.forwarding = 1</pre></div></div><section class="sect2" id="libvirt-networks-virtual-vmm" data-id-title="Managing Virtual Networks with Virtual Machine Manager"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">12.2.1 </span><span class="title-name">Managing Virtual Networks with Virtual Machine Manager</span></span> <a title="Permalink" class="permalink" href="cha-libvirt-networks.html#libvirt-networks-virtual-vmm">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/libvirt_networking.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    You can define, configure, and operate virtual networks with Virtual Machine Manager.
   </p><section class="sect3" id="libvirt-networks-virtual-vmm-define" data-id-title="Defining Virtual Networks"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">12.2.1.1 </span><span class="title-name">Defining Virtual Networks</span></span> <a title="Permalink" class="permalink" href="cha-libvirt-networks.html#libvirt-networks-virtual-vmm-define">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/libvirt_networking.xml" title="Edit source document"> </a></div></div></div></div></div><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
       Start Virtual Machine Manager. In the list of available connections, right-click the name
       of the connection for which you need to configure the virtual network,
       and then select <span class="guimenu">Details</span>.
      </p></li><li class="step"><p>
       In the <span class="guimenu">Connection Details</span> window, click the
       <span class="guimenu">Virtual Networks</span> tab. You can see the list of all
       virtual networks available for the current connection. On the right,
       there are details of the selected virtual network.
      </p><div class="figure" id="id-1.12.4.7.6.6.3.2.2.2"><div class="figure-contents"><div class="mediaobject"><a href="images/libvirt_vmm_conndetails.png"><img src="images/libvirt_vmm_conndetails.png" width="45%" alt="Connection Details" title="Connection Details"/></a></div></div><div class="title-container"><div class="figure-title-wrap"><div class="figure-title"><span class="title-number-name"><span class="title-number">Figure 12.1: </span><span class="title-name">Connection Details </span></span><a title="Permalink" class="permalink" href="cha-libvirt-networks.html#id-1.12.4.7.6.6.3.2.2.2">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/libvirt_networking.xml" title="Edit source document"> </a></div></div></div></li><li class="step"><p>
       To add a new virtual network, click <span class="guimenu">Add</span>.
      </p></li><li class="step"><p>
       Specify a name for the new virtual network and click
       <span class="guimenu">Forward</span>.
      </p><div class="figure" id="id-1.12.4.7.6.6.3.2.4.2"><div class="figure-contents"><div class="mediaobject"><a href="images/libvirt_vmm_vnet_name.png"><img src="images/libvirt_vmm_vnet_name.png" width="45%" alt="Create virtual network" title="Create virtual network"/></a></div></div><div class="title-container"><div class="figure-title-wrap"><div class="figure-title"><span class="title-number-name"><span class="title-number">Figure 12.2: </span><span class="title-name">Create virtual network </span></span><a title="Permalink" class="permalink" href="cha-libvirt-networks.html#id-1.12.4.7.6.6.3.2.4.2">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/libvirt_networking.xml" title="Edit source document"> </a></div></div></div></li><li class="step"><p>
       To specify an IPv4 network address space definition, activate the
       relevant option and type it into the <span class="guimenu">Network</span> text
       entry.
      </p><div class="figure" id="id-1.12.4.7.6.6.3.2.5.2"><div class="figure-contents"><div class="mediaobject"><a href="images/libvirt_vmm_vnet_ipv4.png"><img src="images/libvirt_vmm_vnet_ipv4.png" width="45%" alt="Create virtual network" title="Create virtual network"/></a></div></div><div class="title-container"><div class="figure-title-wrap"><div class="figure-title"><span class="title-number-name"><span class="title-number">Figure 12.3: </span><span class="title-name">Create virtual network </span></span><a title="Permalink" class="permalink" href="cha-libvirt-networks.html#id-1.12.4.7.6.6.3.2.5.2">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/libvirt_networking.xml" title="Edit source document"> </a></div></div></div></li><li class="step"><p>
       <code class="systemitem">libvirt</code> can provide your virtual network with a DHCP server. If you
       need it, activate <span class="guimenu">Enable DHCPv4</span>, then type the start
       and end IP address range of assignable addresses.
      </p></li><li class="step"><p>
       To enable static routing for the new virtual network, activate the
       relevant option and type the network and gateway addresses.
      </p></li><li class="step"><p>
       Click <span class="guimenu">Forward</span> to proceed.
      </p></li><li class="step"><p>
       To specify IPv6-related options—network address space, DHCPv6
       server, or static route—activate <span class="guimenu">Enable IPv6 network
       address space definition</span> and activate the relevant options and
       fill in the relevant boxes.
      </p></li><li class="step"><p>
       Click <span class="guimenu">Forward</span> to proceed.
      </p></li><li class="step"><p>
       Select whether you want an isolated or forwarded virtual network.
      </p><div class="figure" id="id-1.12.4.7.6.6.3.2.11.2"><div class="figure-contents"><div class="mediaobject"><a href="images/libvirt_vmm_vnet_type.png"><img src="images/libvirt_vmm_vnet_type.png" width="45%" alt="Create virtual network" title="Create virtual network"/></a></div></div><div class="title-container"><div class="figure-title-wrap"><div class="figure-title"><span class="title-number-name"><span class="title-number">Figure 12.4: </span><span class="title-name">Create virtual network </span></span><a title="Permalink" class="permalink" href="cha-libvirt-networks.html#id-1.12.4.7.6.6.3.2.11.2">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/libvirt_networking.xml" title="Edit source document"> </a></div></div></div><p>
       For forwarded networks, specify the network interface to which the
       requests will be forwarded, and one of the forwarding modes: While
       <span class="guimenu">NAT</span> (network address translation) remaps the virtual
       network address space and allows sharing a single IP address,
       <span class="guimenu">Routed</span> forwards packets from the virtual network to
       the VM Host Server's physical network with no translation.
      </p></li><li class="step"><p>
       If you did not specify an IPv6 network address space definition earlier,
       you can enable IPv6 internal routing between virtual machines.
      </p></li><li class="step"><p><span class="step-optional">(Optional)</span> 
       Optionally, change the DNS domain name.
      </p></li><li class="step"><p>
       Click <span class="guimenu">Finish</span> to create the new virtual network. On
       the VM Host Server, a new virtual network bridge
       <code class="literal">virbr<em class="replaceable">X</em></code> is available, which
       corresponds to the newly created virtual network. You can check with
       <code class="command">bridge link</code>. <code class="systemitem">libvirt</code> automatically adds iptables
       rules to allow traffic to/from guests attached to the new
       <span class="emphasis"><em>virbr<em class="replaceable">X</em></em></span> device.
      </p></li></ol></div></div></section><section class="sect3" id="libvirt-networks-virtual-vmm-start" data-id-title="Starting Virtual Networks"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">12.2.1.2 </span><span class="title-name">Starting Virtual Networks</span></span> <a title="Permalink" class="permalink" href="cha-libvirt-networks.html#libvirt-networks-virtual-vmm-start">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/libvirt_networking.xml" title="Edit source document"> </a></div></div></div></div></div><p>
     To start a virtual network that is temporarily stopped, follow these
     steps:
    </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
       Start Virtual Machine Manager. In the list of available connections, right-click the name
       of the connection for which you need to configure the virtual network,
       and then select <span class="guimenu">Details</span>.
      </p></li><li class="step"><p>
       In the <span class="guimenu">Connection Details</span> window, click the
       <span class="guimenu">Virtual Networks</span> tab. You can see the list of all
       virtual networks available for the current connection.
      </p></li><li class="step"><p>
       To start the virtual network, click <span class="guimenu">Start</span>.
      </p></li></ol></div></div></section><section class="sect3" id="libvirt-networks-virtual-vmm-stop" data-id-title="Stopping Virtual Networks"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">12.2.1.3 </span><span class="title-name">Stopping Virtual Networks</span></span> <a title="Permalink" class="permalink" href="cha-libvirt-networks.html#libvirt-networks-virtual-vmm-stop">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/libvirt_networking.xml" title="Edit source document"> </a></div></div></div></div></div><p>
     To stop an active virtual network, follow these steps:
    </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
       Start Virtual Machine Manager. In the list of available connections, right-click the name
       of the connection for which you need to configure the virtual network,
       and then select <span class="guimenu">Details</span>.
      </p></li><li class="step"><p>
       In the <span class="guimenu">Connection Details</span> window, click the
       <span class="guimenu">Virtual Networks</span> tab. You can see the list of all
       virtual networks available for the current connection.
      </p></li><li class="step"><p>
       Select the virtual network to be stopped, then click <span class="guimenu">Stop</span>.
      </p></li></ol></div></div></section><section class="sect3" id="libvirt-networks-virtual-vmm-delete" data-id-title="Deleting Virtual Networks"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">12.2.1.4 </span><span class="title-name">Deleting Virtual Networks</span></span> <a title="Permalink" class="permalink" href="cha-libvirt-networks.html#libvirt-networks-virtual-vmm-delete">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/libvirt_networking.xml" title="Edit source document"> </a></div></div></div></div></div><p>
     To delete a virtual network from VM Host Server, follow these steps:
    </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
       Start Virtual Machine Manager. In the list of available connections, right-click the name
       of the connection for which you need to configure the virtual network,
       and then select <span class="guimenu">Details</span>.
      </p></li><li class="step"><p>
       In the <span class="guimenu">Connection Details</span> window, click the
       <span class="guimenu">Virtual Networks</span> tab. You can see the list of all
       virtual networks available for the current connection.
      </p></li><li class="step"><p>
       Select the virtual network to be deleted, then click <span class="guimenu">Delete</span>.
      </p></li></ol></div></div></section><section class="sect3" id="libvirt-networks-virtual-vmm-nsswitch" data-id-title="Obtaining IP Addresses with nsswitch for NAT Networks (in KVM)"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">12.2.1.5 </span><span class="title-name">Obtaining IP Addresses with <code class="command">nsswitch</code> for NAT Networks (in KVM)</span></span> <a title="Permalink" class="permalink" href="cha-libvirt-networks.html#libvirt-networks-virtual-vmm-nsswitch">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/libvirt_networking.xml" title="Edit source document"> </a></div></div></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
       On VM Host Server, install libvirt-nss, which provides NSS support for
       libvirt:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> zypper in libvirt-nss</pre></div></li><li class="listitem"><p>
       Add <code class="literal">libvirt</code> to
       <code class="filename">/etc/nsswitch.conf</code>:
      </p><div class="verbatim-wrap"><pre class="screen">...
hosts:  files libvirt mdns_minimal [NOTFOUND=return] dns
...</pre></div></li><li class="listitem"><p>
       If NSCD is running, restart it:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> systemctl restart nscd</pre></div></li></ul></div><p>
     Now you can reach the guest system by name from the host.
    </p><p>
     The NSS module has limited functionality. It reads
     <code class="filename">/var/lib/libvirt/dnsmasq/*.status</code> files to find the
     host name and corresponding IP addresses in a JSON record describing each
     lease provided by <code class="command">dnsmasq</code>. Host name translation can
     only be done on those VM Host Servers using a libvirt-managed bridged network
     backed by <code class="command">dnsmasq</code>.
    </p><p>
     For more information, see
     <a class="link" href="http://wiki.libvirt.org/page/NSS_module" target="_blank">http://wiki.libvirt.org/page/NSS_module</a>.
    </p></section></section><section class="sect2" id="libvirt-networks-virtual-virsh" data-id-title="Managing Virtual Networks with virsh"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">12.2.2 </span><span class="title-name">Managing Virtual Networks with <code class="command">virsh</code></span></span> <a title="Permalink" class="permalink" href="cha-libvirt-networks.html#libvirt-networks-virtual-virsh">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/libvirt_networking.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    You can manage <code class="systemitem">libvirt</code>-provided virtual networks with the
    <code class="command">virsh</code> command line tool. To view all network related
    <code class="command">virsh</code> commands, run
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> virsh help network
Networking (help keyword 'network'):
 net-autostart                  autostart a network
        net-create                     create a network from an XML file
        net-define                     define (but don't start) a network from an XML file
        net-destroy                    destroy (stop) a network
        net-dumpxml                    network information in XML
        net-edit                       edit XML configuration for a network
        net-event                      Network Events
        net-info                       network information
        net-list                       list networks
        net-name                       convert a network UUID to network name
        net-start                      start a (previously defined) inactive network
        net-undefine                   undefine an inactive network
        net-update                     update parts of an existing network's configuration
 net-uuid                       convert a network name to network UUID</pre></div><p>
    To view brief help information for a specific <code class="command">virsh</code>
    command, run <code class="command">virsh help
    <em class="replaceable">VIRSH_COMMAND</em></code>:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> virsh help net-create
  NAME
    net-create - create a network from an XML file

  SYNOPSIS
    net-create &lt;file&gt;

  DESCRIPTION
    Create a network.

  OPTIONS
    [--file] &lt;string&gt;  file containing an XML network description</pre></div><section class="sect3" id="libvirt-networks-virtual-virsh-create" data-id-title="Creating a Network"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">12.2.2.1 </span><span class="title-name">Creating a Network</span></span> <a title="Permalink" class="permalink" href="cha-libvirt-networks.html#libvirt-networks-virtual-virsh-create">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/libvirt_networking.xml" title="Edit source document"> </a></div></div></div></div></div><p>
     To create a new <span class="emphasis"><em>running</em></span> virtual network, run
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> virsh net-create <em class="replaceable">VNET_DEFINITION.xml</em></pre></div><p>
     The <em class="replaceable">VNET_DEFINITION.xml</em> XML file includes the
     definition of the virtual network that <code class="systemitem">libvirt</code> accepts.
    </p><p>
     To define a new virtual network without activating it, run
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> virsh net-define <em class="replaceable">VNET_DEFINITION.xml</em></pre></div><p>
     The following examples illustrate definitions of different types of
     virtual networks.
    </p><div class="complex-example"><div class="example" id="ex-libvirt-net-nat" data-id-title="NAT Based Network"><div class="title-container"><div class="example-title-wrap"><div class="example-title"><span class="title-number-name"><span class="title-number">Example 12.1: </span><span class="title-name">NAT Based Network </span></span><a title="Permalink" class="permalink" href="cha-libvirt-networks.html#ex-libvirt-net-nat">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/libvirt_networking.xml" title="Edit source document"> </a></div></div><div class="example-contents"><p>
      The following configuration allows VM Guests outgoing connectivity if it
      is available on VM Host Server. In the absence of VM Host Server networking, it
      allows guests to talk directly to each other.
     </p><div class="verbatim-wrap"><pre class="screen">&lt;network&gt;
&lt;name&gt;vnet_nated&lt;/name&gt;<span class="callout" id="vnet-xml-name">1</span>
&lt;bridge name="virbr1"/&gt;<span class="callout" id="vnet-xml-bridge">2</span>
 &lt;forward mode="nat"/&gt;<span class="callout" id="vnet-xml-forward">3</span>
 &lt;ip address="192.168.122.1" netmask="255.255.255.0"&gt;<span class="callout" id="vnet-xml-ip">4</span>
  &lt;dhcp&gt;
   &lt;range start="192.168.122.2" end="192.168.122.254"/&gt;<span class="callout" id="vnet-xml-dhcp">5</span>
   &lt;host mac="52:54:00:c7:92:da" name="host1.testing.com" \
    ip="192.168.1.23.101"/&gt;<span class="callout" id="vnet-xml-dhcp-host">6</span>
   &lt;host mac="52:54:00:c7:92:db" name="host2.testing.com" \
    ip="192.168.1.23.102"/&gt;
   &lt;host mac="52:54:00:c7:92:dc" name="host3.testing.com" \
    ip="192.168.1.23.103"/&gt;
  &lt;/dhcp&gt;
 &lt;/ip&gt;
&lt;/network&gt;</pre></div><div class="calloutlist"><table style="border: 0; "><tr><td style="width: 5%; vertical-align: top; text-align: left; "><p><a href="#vnet-xml-name"><span class="callout">1</span></a> </p></td><td style="vertical-align: top; text-align: left; "><p>
        The name of the new virtual network.
       </p></td></tr><tr><td style="width: 5%; vertical-align: top; text-align: left; "><p><a href="#vnet-xml-bridge"><span class="callout">2</span></a> </p></td><td style="vertical-align: top; text-align: left; "><p>
        The name of the bridge device used to construct the virtual network.
        When defining a new network with a &lt;forward&gt; mode of "nat" or
        "route" (or an isolated network with no &lt;forward&gt; element),
        <code class="systemitem">libvirt</code> will automatically generate a unique name for the bridge
        device if none is given.
       </p></td></tr><tr><td style="width: 5%; vertical-align: top; text-align: left; "><p><a href="#vnet-xml-forward"><span class="callout">3</span></a> </p></td><td style="vertical-align: top; text-align: left; "><p>
        Inclusion of the &lt;forward&gt; element indicates that the virtual
        network will be connected to the physical LAN. The
        <code class="literal">mode</code> attribute specifies the forwarding method. The
        most common modes are "nat" (default, network address translation),
        "route" (direct forwarding to the physical network, no address
        translation), and "bridge" (network bridge configured outside of
        <code class="systemitem">libvirt</code>). If the &lt;forward&gt; element is not specified, the virtual
        network will be isolated from other networks. For a complete list of
        forwarding modes, see
        <a class="link" href="http://libvirt.org/formatnetwork.html#elementsConnect" target="_blank">http://libvirt.org/formatnetwork.html#elementsConnect</a>.
       </p></td></tr><tr><td style="width: 5%; vertical-align: top; text-align: left; "><p><a href="#vnet-xml-ip"><span class="callout">4</span></a> </p></td><td style="vertical-align: top; text-align: left; "><p>
        The IP address and netmask for the network bridge.
       </p></td></tr><tr><td style="width: 5%; vertical-align: top; text-align: left; "><p><a href="#vnet-xml-dhcp"><span class="callout">5</span></a> </p></td><td style="vertical-align: top; text-align: left; "><p>
        Enable DHCP server for the virtual network, offering IP addresses
        ranging from the specified <code class="literal">start</code> and
        <code class="literal">end</code> attribute.
       </p></td></tr><tr><td style="width: 5%; vertical-align: top; text-align: left; "><p><a href="#vnet-xml-dhcp-host"><span class="callout">6</span></a> </p></td><td style="vertical-align: top; text-align: left; "><p>
        The optional &lt;host&gt; elements specify hosts that will be given names
        and predefined IP addresses by the built-in DHCP server. Any IPv4 host
        element must specify the following: the MAC address of the host to be assigned a given
        name, the IP to be assigned to that host, and the name to be given to
        that host by the DHCP server. An IPv6 host element differs slightly
        from that for IPv4: there is no <code class="literal">mac</code> attribute since
        a MAC address has no defined meaning in IPv6. Instead, the
        <code class="literal">name</code> attribute is used to identify the host to be
        assigned the IPv6 address. For DHCPv6, the <code class="literal">name</code> is
        the plain name of the client host sent by the client to the server.
        Note that this method of assigning a specific IP address can also be
        used instead of the <code class="literal">mac</code> attribute for IPv4.
       </p></td></tr></table></div></div></div></div><div class="complex-example"><div class="example" id="id-1.12.4.7.6.7.6.9" data-id-title="Routed Network"><div class="title-container"><div class="example-title-wrap"><div class="example-title"><span class="title-number-name"><span class="title-number">Example 12.2: </span><span class="title-name">Routed Network </span></span><a title="Permalink" class="permalink" href="cha-libvirt-networks.html#id-1.12.4.7.6.7.6.9">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/libvirt_networking.xml" title="Edit source document"> </a></div></div><div class="example-contents"><p>
      The following configuration routes traffic from the virtual network to
      the LAN without applying any NAT. The IP address range must be
      preconfigured in the routing tables of the router on the VM Host Server
      network.
     </p><div class="verbatim-wrap"><pre class="screen">&lt;network&gt;
 &lt;name&gt;vnet_routed&lt;/name&gt;
 &lt;bridge name="virbr1"/&gt;
 &lt;forward mode="route" dev="eth1"/&gt;<span class="callout" id="vnet-xml-route">1</span>
 &lt;ip address="192.168.122.1" netmask="255.255.255.0"&gt;
  &lt;dhcp&gt;
   &lt;range start="192.168.122.2" end="192.168.122.254"/&gt;
  &lt;/dhcp&gt;
 &lt;/ip&gt;
&lt;/network&gt;</pre></div><div class="calloutlist"><table style="border: 0; "><tr><td style="width: 5%; vertical-align: top; text-align: left; "><p><a href="#vnet-xml-route"><span class="callout">1</span></a> </p></td><td style="vertical-align: top; text-align: left; "><p>
        The guest traffic may only go out via the <code class="systemitem">eth1</code>
        network device on the VM Host Server.
       </p></td></tr></table></div></div></div></div><div class="complex-example"><div class="example" id="id-1.12.4.7.6.7.6.10" data-id-title="Isolated Network"><div class="title-container"><div class="example-title-wrap"><div class="example-title"><span class="title-number-name"><span class="title-number">Example 12.3: </span><span class="title-name">Isolated Network </span></span><a title="Permalink" class="permalink" href="cha-libvirt-networks.html#id-1.12.4.7.6.7.6.10">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/libvirt_networking.xml" title="Edit source document"> </a></div></div><div class="example-contents"><p>
      This configuration provides a completely isolated private network. The
      guests can talk to each other, and to VM Host Server, but cannot reach any
      other machines on the LAN, as the &lt;forward&gt; element is missing in the
      XML description.
     </p><div class="verbatim-wrap"><pre class="screen">&lt;network&gt;
 &lt;name&gt;vnet_isolated&lt;/name&gt;
 &lt;bridge name="virbr3"/&gt;
 &lt;ip address="192.168.152.1" netmask="255.255.255.0"&gt;
  &lt;dhcp&gt;
   &lt;range start="192.168.152.2" end="192.168.152.254"/&gt;
  &lt;/dhcp&gt;
 &lt;/ip&gt;
 &lt;/network&gt;</pre></div></div></div></div><div class="complex-example"><div class="example" id="id-1.12.4.7.6.7.6.11" data-id-title="Using an Existing Bridge on VM Host Server"><div class="title-container"><div class="example-title-wrap"><div class="example-title"><span class="title-number-name"><span class="title-number">Example 12.4: </span><span class="title-name">Using an Existing Bridge on VM Host Server </span></span><a title="Permalink" class="permalink" href="cha-libvirt-networks.html#id-1.12.4.7.6.7.6.11">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/libvirt_networking.xml" title="Edit source document"> </a></div></div><div class="example-contents"><p>
      This configuration shows how to use an existing VM Host Server's network bridge
      <code class="literal">br0</code>. VM Guests are directly connected to the physical
      network. Their IP addresses will all be on the subnet of the physical
      network, and there will be no restrictions on incoming or outgoing
      connections.
     </p><div class="verbatim-wrap"><pre class="screen">&lt;network&gt;
        &lt;name&gt;host-bridge&lt;/name&gt;
        &lt;forward mode="bridge"/&gt;
        &lt;bridge name="br0"/&gt;
&lt;/network&gt;</pre></div></div></div></div></section><section class="sect3" id="libvirt-networks-virtual-virsh-list" data-id-title="Listing Networks"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">12.2.2.2 </span><span class="title-name">Listing Networks</span></span> <a title="Permalink" class="permalink" href="cha-libvirt-networks.html#libvirt-networks-virtual-virsh-list">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/libvirt_networking.xml" title="Edit source document"> </a></div></div></div></div></div><p>
     To list all virtual networks available to <code class="systemitem">libvirt</code>, run:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> virsh net-list --all

 Name                 State      Autostart     Persistent
----------------------------------------------------------
 crowbar              active     yes           yes
 vnet_nated           active     yes           yes
 vnet_routed          active     yes           yes
 vnet_isolated        inactive   yes           yes</pre></div><p>
     To list available domains, run:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> virsh list
 Id    Name                           State
----------------------------------------------------
 1     nated_sles12sp3                running
 ...</pre></div><p>
     To get a list of interfaces of a running domain, run <code class="option">domifaddr
     <em class="replaceable">DOMAIN</em></code>, or optionally specify the
     interface to limit the output to this interface. By default, it
     additionally outputs their IP and MAC addresses:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> virsh domifaddr nated_sles12sp3 --interface vnet0 --source lease
 Name       MAC address          Protocol     Address
-------------------------------------------------------------------------------
 vnet0      52:54:00:9e:0d:2b    ipv6         fd00:dead:beef:55::140/64
 -          -                    ipv4         192.168.100.168/24</pre></div><p>
     To print brief information of all virtual interfaces associated with the
     specified domain, run:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> virsh domiflist nated_sles12sp3
Interface  Type       Source       Model       MAC
---------------------------------------------------------
vnet0      network    vnet_nated   virtio      52:54:00:9e:0d:2b</pre></div></section><section class="sect3" id="libvirt-networks-virtual-virsh-info" data-id-title="Getting Details about a Network"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">12.2.2.3 </span><span class="title-name">Getting Details about a Network</span></span> <a title="Permalink" class="permalink" href="cha-libvirt-networks.html#libvirt-networks-virtual-virsh-info">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/libvirt_networking.xml" title="Edit source document"> </a></div></div></div></div></div><p>
     To get detailed information about a network, run:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> virsh net-info vnet_routed
Name:           vnet_routed
UUID:           756b48ff-d0c6-4c0a-804c-86c4c832a498
Active:         yes
Persistent:     yes
Autostart:      yes
Bridge:         virbr5</pre></div></section><section class="sect3" id="libvirt-networks-virtual-virsh-start" data-id-title="Starting a Network"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">12.2.2.4 </span><span class="title-name">Starting a Network</span></span> <a title="Permalink" class="permalink" href="cha-libvirt-networks.html#libvirt-networks-virtual-virsh-start">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/libvirt_networking.xml" title="Edit source document"> </a></div></div></div></div></div><p>
     To start an inactive network that was already defined, find its name (or
     unique identifier, UUID) with:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> virsh net-list --inactive
 Name                 State      Autostart     Persistent
----------------------------------------------------------
 vnet_isolated        inactive   yes           yes</pre></div><p>
     Then run:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> virsh net-start vnet_isolated
Network vnet_isolated started</pre></div></section><section class="sect3" id="libvirt-networks-virtual-virsh-stop" data-id-title="Stopping a Network"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">12.2.2.5 </span><span class="title-name">Stopping a Network</span></span> <a title="Permalink" class="permalink" href="cha-libvirt-networks.html#libvirt-networks-virtual-virsh-stop">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/libvirt_networking.xml" title="Edit source document"> </a></div></div></div></div></div><p>
     To stop an active network, find its name (or unique identifier, UUID)
     with:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> virsh net-list --inactive
 Name                 State      Autostart     Persistent
----------------------------------------------------------
 vnet_isolated        active     yes           yes</pre></div><p>
     Then run:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> virsh net-destroy vnet_isolated
Network vnet_isolated destroyed</pre></div></section><section class="sect3" id="libvirt-networks-virtual-virsh-undefine" data-id-title="Removing a Network"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">12.2.2.6 </span><span class="title-name">Removing a Network</span></span> <a title="Permalink" class="permalink" href="cha-libvirt-networks.html#libvirt-networks-virtual-virsh-undefine">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/libvirt_networking.xml" title="Edit source document"> </a></div></div></div></div></div><p>
     To remove the definition of an inactive network from VM Host Server permanently,
     run:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> virsh net-undefine vnet_isolated
Network vnet_isolated has been undefined</pre></div></section></section></section></section><nav class="bottom-pagination"><div><a class="pagination-link prev" href="cha-libvirt-storage.html"><span class="pagination-relation">Previous</span><span class="pagination-label"><span class="title-number">Chapter 11 </span>Managing Storage</span></a> </div><div><a class="pagination-link next" href="cha-libvirt-config-gui.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Chapter 13 </span>Configuring Virtual Machines with Virtual Machine Manager</span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="sect1"><a href="cha-libvirt-networks.html#libvirt-networks-bridged"><span class="title-number">12.1 </span><span class="title-name">Network Bridge</span></a></span></li><li><span class="sect1"><a href="cha-libvirt-networks.html#libvirt-networks-virtual"><span class="title-number">12.2 </span><span class="title-name">Virtual Networks</span></a></span></li></ul></div><div class="side-title">Share this page</div><ul class="share"><li><a id="_share-fb" href="#" title="Facebook"> </a></li><li><a id="_share-in" href="#" title="LinkedIn"> </a></li><li><a id="_share-tw" href="#" title="Twitter/X"> </a></li><li><a id="_share-mail" href="#" title="E-Mail"> </a></li><li><a id="_print-button" href="#" title="Print this page"> </a></li></ul> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2024</span></div></div></footer></body></html>