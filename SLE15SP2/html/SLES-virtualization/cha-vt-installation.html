<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><title>SLES 15 SP2 | Virtualization Guide | Installation of Virtualization Components</title><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"/>
<meta name="title" content="Installation of Virtualization Components | SLES 15 SP2"/>
<meta name="description" content="Depending on the scope of the installation, none of the virtualization tools may be installed on your system. They will be automatically installed wh…"/>
<meta name="product-name" content="SUSE Linux Enterprise Server"/>
<meta name="product-number" content="15 SP2"/>
<meta name="book-title" content="Virtualization Guide"/>
<meta name="chapter-title" content="Chapter 5. Installation of Virtualization Components"/>
<meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi"/>
<meta name="tracker-type" content="bsc"/>
<meta name="tracker-bsc-assignee" content="fs@suse.com"/>
<meta name="tracker-bsc-component" content="Documentation"/>
<meta name="tracker-bsc-product" content="SUSE Linux Enterprise Server 15 SP2"/>
<meta name="publisher" content="SUSE"/><meta property="og:title" content="Virtualization Guide"/>
<meta property="og:description" content="Learn all about virtualization and VM management"/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Virtualization Guide"/>
<meta name="twitter:description" content="Learn all about virtualization and VM management"/>
<script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": ["TechArticle"],
    "image": "https://www.suse.com/assets/img/suse-white-logo-green.svg",
    
     "isPartOf": {
      "@type": "CreativeWorkSeries",
      "name": "Products &amp; Solutions"
    },
    
    "inLanguage": "en",
    

    "headline": "Installation of Virtualization Components",
  
    "description": "Installation of Virtualization Components",
      
    "author": [
      {
        "@type": "Corporation",
        "name": "SUSE Product &amp; Solution Documentation Team",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    ],
      
    "dateModified": "2024-06-10T00:00+02:00",
      
    "datePublished": "2020-07-21T00:00+02:00",
      

    "about": [
      
    ],
  
    "sameAs": [
          "https://www.facebook.com/SUSEWorldwide/about",
          "https://www.youtube.com/channel/UCHTfqIzPKz4f_dri36lAQGA",
          "https://twitter.com/SUSE",
          "https://www.linkedin.com/company/suse"
    ],
    "publisher": {
      "@type": "Corporation",
      "name": "SUSE",
      "url": "https://documentation.suse.com",
      "logo": {
        "@type": "ImageObject",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    }
  }</script>
<link rel="prev" href="cha-tools-intro.html" title="Chapter 4. Virtualization Tools"/><link rel="next" href="cha-virt-support.html" title="Chapter 6. Supported Hosts, Guests, and Features"/><script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/script-purejs.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script><meta name="edit-url" content="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/vt_installation.xml"/></head><body class="draft wide offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"><img src="static/images/logo.svg" alt="Logo" class="logo"/></div></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">Virtualization Guide</a><span> / </span><a class="crumb" href="part-virt-intro.html">Introduction</a><span> / </span><a class="crumb" href="cha-vt-installation.html">Installation of Virtualization Components</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title">Virtualization Guide</div><ol><li><a href="cha-kvm.html" class=" "><span class="title-number"> </span><span class="title-name">About This Manual</span></a></li><li class="active"><a href="part-virt-intro.html" class="has-children you-are-here"><span class="title-number">I </span><span class="title-name">Introduction</span></a><ol><li><a href="chap-virtualization-introduction.html" class=" "><span class="title-number">1 </span><span class="title-name">Virtualization Technology</span></a></li><li><a href="cha-xen-basics.html" class=" "><span class="title-number">2 </span><span class="title-name">Introduction to Xen Virtualization</span></a></li><li><a href="cha-kvm-intro.html" class=" "><span class="title-number">3 </span><span class="title-name">Introduction to KVM Virtualization</span></a></li><li><a href="cha-tools-intro.html" class=" "><span class="title-number">4 </span><span class="title-name">Virtualization Tools</span></a></li><li><a href="cha-vt-installation.html" class=" you-are-here"><span class="title-number">5 </span><span class="title-name">Installation of Virtualization Components</span></a></li><li><a href="cha-virt-support.html" class=" "><span class="title-number">6 </span><span class="title-name">Supported Hosts, Guests, and Features</span></a></li></ol></li><li><a href="part-virt-libvirt.html" class="has-children "><span class="title-number">II </span><span class="title-name">Managing Virtual Machines with <code class="systemitem">libvirt</code></span></a><ol><li><a href="cha-libvirt-overview.html" class=" "><span class="title-number">7 </span><span class="title-name">Starting and Stopping <code class="systemitem">libvirtd</code></span></a></li><li><a href="cha-kvm-inst.html" class=" "><span class="title-number">8 </span><span class="title-name">Guest Installation</span></a></li><li><a href="cha-libvirt-managing.html" class=" "><span class="title-number">9 </span><span class="title-name">Basic VM Guest Management</span></a></li><li><a href="cha-libvirt-connect.html" class=" "><span class="title-number">10 </span><span class="title-name">Connecting and Authorizing</span></a></li><li><a href="cha-libvirt-storage.html" class=" "><span class="title-number">11 </span><span class="title-name">Managing Storage</span></a></li><li><a href="cha-libvirt-networks.html" class=" "><span class="title-number">12 </span><span class="title-name">Managing Networks</span></a></li><li><a href="cha-libvirt-config-gui.html" class=" "><span class="title-number">13 </span><span class="title-name">Configuring Virtual Machines with Virtual Machine Manager</span></a></li><li><a href="cha-libvirt-config-virsh.html" class=" "><span class="title-number">14 </span><span class="title-name">Configuring Virtual Machines with <code class="command">virsh</code></span></a></li><li><a href="cha-libvirt-manage-vagrant.html" class=" "><span class="title-number">15 </span><span class="title-name">Managing Virtual Machines with Vagrant</span></a></li></ol></li><li><a href="part-virt-common.html" class="has-children "><span class="title-number">III </span><span class="title-name">Hypervisor-Independent Features</span></a><ol><li><a href="cha-cachemodes.html" class=" "><span class="title-number">16 </span><span class="title-name">Disk Cache Modes</span></a></li><li><a href="sec-kvm-managing-clock.html" class=" "><span class="title-number">17 </span><span class="title-name">VM Guest Clock Settings</span></a></li><li><a href="chap-guestfs.html" class=" "><span class="title-number">18 </span><span class="title-name">libguestfs</span></a></li><li><a href="cha-qemu-ga.html" class=" "><span class="title-number">19 </span><span class="title-name">QEMU Guest Agent</span></a></li><li><a href="virt-crash-dump.html" class=" "><span class="title-number">20 </span><span class="title-name">Creating crash dumps of a VM Guest</span></a></li></ol></li><li><a href="part-virt-xen.html" class="has-children "><span class="title-number">IV </span><span class="title-name">Managing Virtual Machines with Xen</span></a><ol><li><a href="cha-xen-vhost.html" class=" "><span class="title-number">21 </span><span class="title-name">Setting Up a Virtual Machine Host</span></a></li><li><a href="cha-xen-network.html" class=" "><span class="title-number">22 </span><span class="title-name">Virtual Networking</span></a></li><li><a href="cha-xen-manage.html" class=" "><span class="title-number">23 </span><span class="title-name">Managing a Virtualization Environment</span></a></li><li><a href="cha-xen-vbd.html" class=" "><span class="title-number">24 </span><span class="title-name">Block Devices in Xen</span></a></li><li><a href="cha-xen-config.html" class=" "><span class="title-number">25 </span><span class="title-name">Virtualization: Configuration Options and Settings</span></a></li><li><a href="cha-xen-admin.html" class=" "><span class="title-number">26 </span><span class="title-name">Administrative Tasks</span></a></li><li><a href="cha-xen-xenstore.html" class=" "><span class="title-number">27 </span><span class="title-name">XenStore: Configuration Database Shared between Domains</span></a></li><li><a href="cha-xen-ha.html" class=" "><span class="title-number">28 </span><span class="title-name">Xen as a High-Availability Virtualization Host</span></a></li></ol></li><li><a href="part-virt-qemu.html" class="has-children "><span class="title-number">V </span><span class="title-name">Managing Virtual Machines with QEMU</span></a><ol><li><a href="cha-qemu-overview.html" class=" "><span class="title-number">29 </span><span class="title-name">QEMU Overview</span></a></li><li><a href="cha-qemu-host.html" class=" "><span class="title-number">30 </span><span class="title-name">Setting Up a KVM VM Host Server</span></a></li><li><a href="cha-qemu-guest-inst.html" class=" "><span class="title-number">31 </span><span class="title-name">Guest Installation</span></a></li><li><a href="cha-qemu-running.html" class=" "><span class="title-number">32 </span><span class="title-name">Running Virtual Machines with qemu-system-ARCH</span></a></li><li><a href="cha-qemu-monitor.html" class=" "><span class="title-number">33 </span><span class="title-name">Virtual Machine Administration Using QEMU Monitor</span></a></li></ol></li><li><a href="part-virt-lxc.html" class="has-children "><span class="title-number">VI </span><span class="title-name">Managing Virtual Machines with LXC</span></a><ol><li><a href="cha-lxc.html" class=" "><span class="title-number">34 </span><span class="title-name">Linux Containers</span></a></li><li><a href="cha-lxc2libvirt.html" class=" "><span class="title-number">35 </span><span class="title-name">Migration from LXC to <code class="systemitem">libvirt-lxc</code></span></a></li></ol></li><li><a href="gloss-vt-glossary.html" class=" "><span class="title-number"> </span><span class="title-name">Glossary</span></a></li><li><a href="app-vmdp-driver.html" class=" "><span class="title-number">A </span><span class="title-name">Virtual Machine Drivers</span></a></li><li><a href="app-kvm.html" class=" "><span class="title-number">B </span><span class="title-name">Appendix</span></a></li><li><a href="cha-xmtoxl.html" class=" "><span class="title-number">C </span><span class="title-name">XM, XL Toolstacks and Libvirt framework</span></a></li><li><a href="bk10apd.html" class=" "><span class="title-number">D </span><span class="title-name">GNU licenses</span></a></li> </ol> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section class="chapter" id="cha-vt-installation" data-id-title="Installation of Virtualization Components"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname"><span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span></span> <span class="productnumber"><span class="productnumber"><span class="phrase">15 SP2</span></span></span></div><div><div class="title-container"><h1 class="title"><span class="title-number-name"><span class="title-number">5 </span><span class="title-name">Installation of Virtualization Components</span></span> <a title="Permalink" class="permalink" href="cha-vt-installation.html#">#</a></h1><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/vt_installation.xml" title="Edit source document"> </a></div></div></div></div></div><p>
  Depending on the scope of the installation, none of the virtualization tools
  may be installed on your system. They will be automatically installed when
  configuring the hypervisor with the YaST module <span class="guimenu">Virtualization</span> › <span class="guimenu">Install Hypervisor and
  Tools</span>. In case this module is not available in YaST,
  install the package <span class="package">yast2-vm</span>.
 </p><section class="sect1" id="sec-vt-installation-kvm" data-id-title="Installing KVM"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">5.1 </span><span class="title-name">Installing KVM</span></span> <a title="Permalink" class="permalink" href="cha-vt-installation.html#sec-vt-installation-kvm">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/vt_installation.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   To install KVM and KVM tools, proceed as follows:
  </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
     Verify that the <span class="package">yast2-vm</span> package is installed. This package
     is YaST's configuration tool that simplifies the installation of virtualization
     hypervisors.
    </p></li><li class="step"><p>
     Start YaST and choose <span class="guimenu">Virtualization</span> › <span class="guimenu">Install Hypervisor and
     Tools</span>.
    </p></li><li class="step"><p>
     Select <span class="guimenu">KVM server</span> for a minimal installation of
     QEMU tools. Select <span class="guimenu">KVM tools</span> if a
     <code class="systemitem">libvirt</code>-based management stack is also desired. Confirm with
     <span class="guimenu">Accept</span>.
    </p></li><li class="step"><p>
     To enable normal networking for the VM Guest, using a
     network bridge is recommended. YaST offers to automatically
     configure a bridge on the VM Host Server. Agree to do so by choosing
     <span class="guimenu">Yes</span>, otherwise choose <span class="guimenu">No</span>.
    </p></li><li class="step"><p>
     After the setup has been finished, you can start setting up
     VM Guests. Rebooting the VM Host Server is not required.
    </p></li></ol></div></div></section><section class="sect1" id="sec-vt-installation-xen" data-id-title="Installing Xen"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">5.2 </span><span class="title-name">Installing Xen</span></span> <a title="Permalink" class="permalink" href="cha-vt-installation.html#sec-vt-installation-xen">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/vt_installation.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   To install Xen and Xen tools, proceed as follows:
  </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
     Start YaST and choose <span class="guimenu">Virtualization</span> › <span class="guimenu">Install Hypervisor and
     Tools</span>.
    </p></li><li class="step"><p>
     Select <span class="guimenu">Xen server</span> for a minimal installation of
     Xen tools. Select <span class="guimenu">Xen tools</span> if a
     <code class="systemitem">libvirt</code>-based management stack is also desired. Confirm with
     <span class="guimenu">Accept</span>.
    </p></li><li class="step"><p>
     To enable normal networking for the VM Guest, using a
     network bridge is recommended. YaST offers to automatically
     configure a bridge on the VM Host Server. Agree to do so by choosing
     <span class="guimenu">Yes</span>, otherwise choose <span class="guimenu">No</span>.
    </p></li><li class="step"><p>
     After the setup has been finished, you need to reboot the machine with
     the <span class="emphasis"><em>Xen kernel</em></span>.
    </p><div id="id-1.12.3.6.5.3.4.2" data-id-title="Default Boot Kernel" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.svg"/><div class="admon-title">Tip: Default Boot Kernel</div><p>
      If everything works as expected, change the default boot kernel with YaST and make the Xen-enabled kernel the default.
      For more information about changing the default kernel, see <span class="intraxref">Book “Administration Guide”, Chapter 14 “The Boot Loader GRUB 2”, Section 14.3 “Configuring the Boot Loader with YaST”</span>.
     </p></div></li></ol></div></div></section><section class="sect1" id="sec-vt-installation-containers" data-id-title="Installing Containers"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">5.3 </span><span class="title-name">Installing Containers</span></span> <a title="Permalink" class="permalink" href="cha-vt-installation.html#sec-vt-installation-containers">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/vt_installation.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   To install containers, proceed as follows:
  </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
     Start YaST and choose <span class="guimenu">Virtualization</span> › <span class="guimenu">Install Hypervisor and
     Tools</span>.
    </p></li><li class="step"><p>
     Select <span class="guimenu">libvirt lxc daemon</span> and confirm with
     <span class="guimenu">Accept</span>.
    </p></li></ol></div></div></section><section class="sect1" id="sec-vt-installation-patterns" data-id-title="Patterns"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">5.4 </span><span class="title-name">Patterns</span></span> <a title="Permalink" class="permalink" href="cha-vt-installation.html#sec-vt-installation-patterns">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/vt_installation.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   It is possible using Zypper and patterns to install virtualization
   packages. Run the command <code class="command">zypper in -t pattern</code>
   <em class="replaceable">PATTERN</em>. Available patterns are:
  </p><div class="variablelist"><dl class="variablelist"><dt id="id-1.12.3.6.7.3.1"><span class="term">KVM</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
        <code class="systemitem">kvm_server</code>: sets up the
        KVM VM Host Server with QEMU tools for management
       </p></li><li class="listitem"><p>
        <code class="systemitem">kvm_tools</code>: installs the
        <code class="systemitem">libvirt</code> tools for managing and monitoring VM Guests
       </p></li></ul></div></dd><dt id="id-1.12.3.6.7.3.2"><span class="term">Xen</span></dt><dd><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
        <code class="systemitem">xen_server</code>: sets up the
        Xen VM Host Server with Xen tools for management
       </p></li><li class="listitem"><p>
        <code class="systemitem">xen_tools</code>: installs the
        <code class="systemitem">libvirt</code> tools for managing and monitoring VM Guests
       </p></li></ul></div></dd><dt id="id-1.12.3.6.7.3.3"><span class="term">Containers</span></dt><dd><p>
      There is no pattern for containers; install the
      <span class="emphasis"><em>libvirt-daemon-lxc</em></span> package.
     </p></dd></dl></div></section><section class="sect1" id="sec-vt-installation-ovmf" data-id-title="Installing UEFI Support"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">5.5 </span><span class="title-name">Installing UEFI Support</span></span> <a title="Permalink" class="permalink" href="cha-vt-installation.html#sec-vt-installation-ovmf">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/vt_installation.xml" title="Edit source document"> </a></div></div></div></div></div><div id="id-1.12.3.6.8.2" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note</div><p>
    KVM guests support secure boot by using the OVMF firmware.
    Xen HVM guests support booting from the OVMF firmware as well, but they do not support secure boot.
   </p></div><p>
   UEFI support is provided by <span class="emphasis"><em>OVMF</em></span>
   (<span class="emphasis"><em>Open Virtual Machine Firmware</em></span>). To enable UEFI
   boot, first install the <span class="package">qemu-ovmf-x86_64</span> or
   <span class="package">qemu-uefi-aarch64</span> package depending on the architecture of the guest.
  </p><p>
   The firmware used by virtual machines is auto-selected. The auto-selection
   is based on the *.json files in the
   <span class="package">qemu-ovmf-<em class="replaceable">ARCH</em></span> package. The
   <code class="systemitem">libvirt</code> QEMU driver parses those files when loading so it knows the
   capabilities of the various types of firmware. Then when the user selects the type
   of firmware and any desired features (for example, support for secure boot),
   <code class="systemitem">libvirt</code> will be able to find a firmware that satisfies the user's
   requirements.
  </p><p>
   For example, to specify EFI with secure boot, use the following
   configuration:
  </p><div class="verbatim-wrap"><pre class="screen">&lt;os firmware='efi'&gt;
 &lt;loader secure='yes'/&gt;
&lt;/os&gt;</pre></div><p>
   The <span class="package">qemu-ovmf-<em class="replaceable">ARCH</em></span> packages
   contain the following files:
  </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">rpm -ql qemu-ovmf-x86_64</code>
[...]
/usr/share/qemu/ovmf-x86_64-ms-code.bin
/usr/share/qemu/ovmf-x86_64-ms-vars.bin
/usr/ddshare/qemu/ovmf-x86_64-ms.bin
/usr/share/qemu/ovmf-x86_64-suse-code.bin
/usr/share/qemu/ovmf-x86_64-suse-vars.bin
/usr/share/qemu/ovmf-x86_64-suse.bin
[...]</pre></div><p>
   The <code class="filename">*-code.bin</code> files are the UEFI firmware files.
   The <code class="filename">*-vars.bin</code> files are corresponding variable
   store images that can be used as a template for a per-VM non-volatile
   store. <code class="systemitem">libvirt</code> copies the specified <code class="literal">vars</code>
   template to a per-VM path under
   <code class="filename">/var/lib/libvirt/qemu/nvram/</code> when first
   creating the VM. Files without <code class="literal">code</code> or
   <code class="literal">vars</code> in the name can be used as a single UEFI
   image. They are not as useful since no UEFI variables persist
   across power cycles of the VM.
  </p><p>
   The <code class="filename">*-ms*.bin</code> files contain Microsoft keys as
   found on real hardware. Therefore, they are configured as the default in
   <code class="systemitem">libvirt</code>. Likewise, the <code class="filename">*-suse*.bin</code> files
   contain preinstalled SUSE keys. There is also a set
   of files with no preinstalled keys.
  </p><p>
   For details, see <a class="xref" href="cha-kvm-inst.html#vle-libvirt-inst-virt-install-ovmf">Using UEFI and Secure Boot</a> and <a class="link" href="http://www.linux-kvm.org/downloads/lersek/ovmf-whitepaper-c770f8c.txt" target="_blank">http://www.linux-kvm.org/downloads/lersek/ovmf-whitepaper-c770f8c.txt</a>.
  </p></section><section class="sect1" id="sec-vt-installation-nested-vms" data-id-title="Enable Support for Nested Virtualization in KVM"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">5.6 </span><span class="title-name">Enable Support for Nested Virtualization in KVM</span></span> <a title="Permalink" class="permalink" href="cha-vt-installation.html#sec-vt-installation-nested-vms">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/vt_installation.xml" title="Edit source document"> </a></div></div></div></div></div><div id="id-1.12.3.6.9.2" data-id-title="Technology Preview" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg"/><div class="admon-title">Important: Technology Preview</div><p>
    KVM's nested virtualization is still a technology preview. It is provided
    for testing purposes and is not supported.
   </p></div><p>
   Nested guests are KVM guests run in a KVM guest. When describing nested
   guests, we will use the following virtualization layers:
  </p><div class="variablelist"><dl class="variablelist"><dt id="id-1.12.3.6.9.4.1"><span class="term">L0</span></dt><dd><p>
      A bare metal host running KVM.
     </p></dd><dt id="id-1.12.3.6.9.4.2"><span class="term">L1</span></dt><dd><p>
      A virtual machine running on L0. Because it can run another KVM, it is
      called a <span class="emphasis"><em>guest hypervisor</em></span>.
     </p></dd><dt id="id-1.12.3.6.9.4.3"><span class="term">L2</span></dt><dd><p>
      A virtual machine running on L1. It is called a <span class="emphasis"><em>nested
       guest</em></span>.
     </p></dd></dl></div><p>
   Nested virtualization has many advantages. You can benefit from it in the
   following scenarios:
  </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
     Manage your own virtual machines directly with your hypervisor of choice in
     cloud environments.
    </p></li><li class="listitem"><p>
     Enable the live migration of hypervisors and their guest virtual machines
     as a single entity.
    </p></li><li class="listitem"><p>
     Use it for software development and testing.
    </p></li></ul></div><p>
   To enable nesting temporarily, remove the module and reload it with the
   <code class="option">nested</code> KVM module parameter:
  </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
     For Intel CPUs, run:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> modprobe -r kvm_intel &amp;&amp; modprobe kvm_intel nested=1</pre></div></li><li class="listitem"><p>
     For AMD CPUs, run:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> modprobe -r kvm_amd &amp;&amp; modprobe kvm_amd nested=1</pre></div></li></ul></div><p>
   To enable nesting permanently, enable the <code class="option">nested</code> KVM
   module parameter in the <code class="filename">/etc/modprobe.d/kvm_*.conf</code> file,
   depending on your CPU:
  </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
     For Intel CPUs, edit <code class="filename">/etc/modprobe.d/kvm_intel.conf</code>
     and add the following line:
    </p><div class="verbatim-wrap"><pre class="screen">options kvm_intel nested=1</pre></div></li><li class="listitem"><p>
     For AMD CPUs, edit <code class="filename">/etc/modprobe.d/kvm_amd.conf</code> and
     add the following line:
    </p><div class="verbatim-wrap"><pre class="screen">options kvm_amd nested=1</pre></div></li></ul></div><p>
   When your L0 host is capable of nesting, you will be able to start an L1
   guest in one of the following ways:
  </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
     Use the <code class="option">-cpu host</code> QEMU command line option.
    </p></li><li class="listitem"><p>
     Add the <code class="literal">vmx</code> (for Intel CPUs) or the
     <code class="literal">svm</code> (for AMD CPUs) CPU feature to the
     <code class="option">-cpu</code> QEMU command line option, which enables
     virtualization for the virtual CPU.
    </p></li></ul></div><section class="sect2" id="sec-vt-installation-nested-vms-esxi" data-id-title="VMware ESX as a guest hypervisor"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">5.6.1 </span><span class="title-name">VMware ESX as a guest hypervisor</span></span> <a title="Permalink" class="permalink" href="cha-vt-installation.html#sec-vt-installation-nested-vms-esxi">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE15SP2/xml/vt_installation.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    If you use VMware ESX as a guest hypervisor on top of a KVM bare metal
    hypervisor, you may experience unstable network communication. This problem
    occurs especially between nested KVM guests and the KVM bare metal
    hypervisor or external network. The following default CPU configuration of
    the nested KVM guest is causing the problem:
   </p><div class="verbatim-wrap"><pre class="screen">&lt;cpu mode='host-model' check='partial'/&gt;</pre></div><p>
    To fix it, modify the CPU configuration as follow:
   </p><div class="verbatim-wrap"><pre class="screen">[...]
&lt;cpu mode='host-passthrough' check='none'&gt;
 &lt;cache mode='passthrough'/&gt;
&lt;/cpu&gt;
[...]</pre></div></section></section></section><nav class="bottom-pagination"><div><a class="pagination-link prev" href="cha-tools-intro.html"><span class="pagination-relation">Previous</span><span class="pagination-label"><span class="title-number">Chapter 4 </span>Virtualization Tools</span></a> </div><div><a class="pagination-link next" href="cha-virt-support.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Chapter 6 </span>Supported Hosts, Guests, and Features</span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="sect1"><a href="cha-vt-installation.html#sec-vt-installation-kvm"><span class="title-number">5.1 </span><span class="title-name">Installing KVM</span></a></span></li><li><span class="sect1"><a href="cha-vt-installation.html#sec-vt-installation-xen"><span class="title-number">5.2 </span><span class="title-name">Installing Xen</span></a></span></li><li><span class="sect1"><a href="cha-vt-installation.html#sec-vt-installation-containers"><span class="title-number">5.3 </span><span class="title-name">Installing Containers</span></a></span></li><li><span class="sect1"><a href="cha-vt-installation.html#sec-vt-installation-patterns"><span class="title-number">5.4 </span><span class="title-name">Patterns</span></a></span></li><li><span class="sect1"><a href="cha-vt-installation.html#sec-vt-installation-ovmf"><span class="title-number">5.5 </span><span class="title-name">Installing UEFI Support</span></a></span></li><li><span class="sect1"><a href="cha-vt-installation.html#sec-vt-installation-nested-vms"><span class="title-number">5.6 </span><span class="title-name">Enable Support for Nested Virtualization in KVM</span></a></span></li></ul></div><div class="side-title">Share this page</div><ul class="share"><li><a id="_share-fb" href="#" title="Facebook"> </a></li><li><a id="_share-in" href="#" title="LinkedIn"> </a></li><li><a id="_share-tw" href="#" title="Twitter/X"> </a></li><li><a id="_share-mail" href="#" title="E-Mail"> </a></li><li><a id="_print-button" href="#" title="Print this page"> </a></li></ul> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2024</span></div></div></footer></body></html>