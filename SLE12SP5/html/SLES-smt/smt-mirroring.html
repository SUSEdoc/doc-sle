<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><title>SLES 12 SP5 | Subscription Management Tool Guide | Mirroring Repositories on the SMT Server</title><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"/>
<meta name="title" content="Mirroring Repositories on the SMT Server | SLES 12 SP5"/>
<meta name="description" content="You can mirror the installation and update repositories on the SMT server. This way, you do not need to download updates on each machine, which saves…"/>
<meta name="product-name" content="SUSE Linux Enterprise Server"/>
<meta name="product-number" content="12 SP5"/>
<meta name="book-title" content="Subscription Management Tool Guide"/>
<meta name="chapter-title" content="Chapter 4. Mirroring Repositories on the SMT Server"/>
<meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi"/>
<meta name="tracker-type" content="bsc"/>
<meta name="tracker-bsc-assignee" content="fs@suse.com"/>
<meta name="tracker-bsc-component" content="Documentation"/>
<meta name="tracker-bsc-product" content="SUSE Linux Enterprise Server 12 SP5"/>
<meta name="publisher" content="SUSE"/><meta property="og:title" content="Subscription Management Tool Guide"/>
<meta property="og:description" content="Use SMT, a proxy system for SUSE Customer Center"/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Subscription Management Tool Guide"/>
<meta name="twitter:description" content="Use SMT, a proxy system for SUSE Customer Center"/>
<script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": ["TechArticle"],
    "image": "https://www.suse.com/assets/img/suse-white-logo-green.svg",
    
     "isPartOf": {
      "@type": "CreativeWorkSeries",
      "name": "Products &amp; Solutions"
    },
    
    "inLanguage": "en",
    

    "headline": "Mirroring Repositories on the SMT Server",
  
    "description": "Mirroring Repositories on the SMT Server",
      
    "author": [
      {
        "@type": "Corporation",
        "name": "SUSE Product &amp; Solution Documentation Team",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    ],
      
    "dateModified": "2019-12-09T00:00+02:00",
      
    "datePublished": "2019-12-09T00:00+02:00",
      

    "about": [
      
    ],
  
    "sameAs": [
          "https://www.facebook.com/SUSEWorldwide/about",
          "https://www.youtube.com/channel/UCHTfqIzPKz4f_dri36lAQGA",
          "https://twitter.com/SUSE",
          "https://www.linkedin.com/company/suse"
    ],
    "publisher": {
      "@type": "Corporation",
      "name": "SUSE",
      "url": "https://documentation.suse.com",
      "logo": {
        "@type": "ImageObject",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    }
  }</script>
<link rel="prev" href="smt-server.html" title="Chapter 3. SMT Server Configuration"/><link rel="next" href="smt-management.html" title="Chapter 5. Managing Repositories with YaST SMT Server Management"/><script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/script-purejs.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script><meta name="edit-url" content="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/smt_mirroring.xml"/></head><body class="draft wide offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"><img src="static/images/logo.svg" alt="Logo" class="logo"/></div></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">SMT Guide</a><span> / </span><a class="crumb" href="smt-mirroring.html">Mirroring Repositories on the SMT Server</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title">SMT Guide</div><ol><li><a href="pre-smt.html" class=" "><span class="title-number"> </span><span class="title-name">About This Guide</span></a></li><li><a href="smt-overview.html" class=" "><span class="title-number">1 </span><span class="title-name">Overview</span></a></li><li><a href="smt-installation.html" class=" "><span class="title-number">2 </span><span class="title-name">SMT Installation</span></a></li><li><a href="smt-server.html" class=" "><span class="title-number">3 </span><span class="title-name">SMT Server Configuration</span></a></li><li><a href="smt-mirroring.html" class=" you-are-here"><span class="title-number">4 </span><span class="title-name">Mirroring Repositories on the SMT Server</span></a></li><li><a href="smt-management.html" class=" "><span class="title-number">5 </span><span class="title-name">Managing Repositories with YaST SMT Server Management</span></a></li><li><a href="smt-registration.html" class=" "><span class="title-number">6 </span><span class="title-name">Managing Client Machines with SMT</span></a></li><li><a href="smt-reporting.html" class=" "><span class="title-number">7 </span><span class="title-name">SMT Reports</span></a></li><li><a href="smt-tools.html" class=" "><span class="title-number">8 </span><span class="title-name">SMT Tools and Configuration Files</span></a></li><li><a href="smt-client.html" class=" "><span class="title-number">9 </span><span class="title-name">Configuring Clients to Use SMT</span></a></li><li><a href="smt-advanced.html" class=" "><span class="title-number">10 </span><span class="title-name">Advanced Topics</span></a></li><li><a href="smt-app-api.html" class=" "><span class="title-number">A </span><span class="title-name">SMT REST API</span></a></li> </ol> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section class="chapter" id="smt-mirroring" data-id-title="Mirroring Repositories on the SMT Server"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname"><span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span></span> <span class="productnumber"><span class="productnumber">12 SP5</span></span></div><div><div class="title-container"><h1 class="title"><span class="title-number-name"><span class="title-number">4 </span><span class="title-name">Mirroring Repositories on the SMT Server</span></span> <a title="Permalink" class="permalink" href="smt-mirroring.html#">#</a></h1><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/smt_mirroring.xml" title="Edit source document"> </a></div></div></div></div></div><p>
  You can mirror the installation and update repositories on the SMT
  server. This way, you do not need to download updates on each machine, which saves time and bandwidth.
 </p><div id="id-1.9.6.4" data-id-title="SUSE Linux Enterprise Server 9 Repositories" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg"/><div class="admon-title">Important: SUSE Linux Enterprise Server 9 Repositories</div><p>
   As SUSE Linux Enterprise Server 9 is no longer supported, SMT does not mirror SUSE Linux Enterprise Server 9
   repositories.
  </p></div><section class="sect1" id="smt-mirroring-getcredentials" data-id-title="Mirroring Credentials"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">4.1 </span><span class="title-name">Mirroring Credentials</span></span> <a title="Permalink" class="permalink" href="smt-mirroring.html#smt-mirroring-getcredentials">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/smt_mirroring.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   Before you create a local mirror of the repositories, you need appropriate
   organization credentials. You can obtain the credentials from SUSE Customer Center.
  </p><p>
   To get the credentials from SUSE Customer Center, follow these steps:
  </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
     Visit SUSE Customer Center at <a class="link" href="http://scc.suse.com" target="_blank">http://scc.suse.com</a> and log in.
    </p></li><li class="step"><p>
     If you are a member of multiple organizations, select the organization you
     want to work with from the drop-down box in the top-right corner.
    </p></li><li class="step"><p>
     Click <span class="guimenu">Proxies</span> in the top menu.
    </p></li><li class="step"><p>
     Switch to the <span class="guimenu">Mirroring credentials</span> section.
    </p></li><li class="step"><p>
     To see the password, click the
    <span class="inlinemediaobject"><a href="images/scc_eye_icon.png"><img src="images/scc_eye_icon.png" width="13" alt="Eye icon" title="Eye icon"/></a></span>icon.
    </p></li></ol></div></div><p>
   The obtained credentials should be set with the YaST SMT Server
   Configuration module or added directly to the
   <code class="filename">/etc/smt.conf</code> file. For more information about the
   <code class="filename">/etc/smt.conf</code> file, see
   <a class="xref" href="smt-tools.html#smt-config-smtconf" title="8.2.1. /etc/smt.conf">Section 8.2.1, “/etc/smt.conf”</a>.
  </p><div id="smt-mirror-credential-merge" data-id-title="Merging Multiple Organization Site Credentials" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.svg"/><div class="admon-title">Tip: Merging Multiple Organization Site Credentials</div><p>
    SMT can only work with one mirror credential at a time. Multiple
    credentials are not supported. When a customer creates a new company, this
    generates a new mirror credential. This is not always convenient, as some products
    are available via the first set and other products via the second set. To
    request a merge of credentials, contact your account manager.
   </p></div></section><section class="sect1" id="smt-mirroring-manage" data-id-title="Managing Software Repositories with SMT Command Line Tools"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">4.2 </span><span class="title-name">Managing Software Repositories with SMT Command Line Tools</span></span> <a title="Permalink" class="permalink" href="smt-mirroring.html#smt-mirroring-manage">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/smt_mirroring.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   This section describes tools and procedures for viewing information about
   software repositories available through SMT, configuring these
   repositories, and setting up custom repositories on the command line. For
   details on the YaST SMT Server Management module, see
   <a class="xref" href="smt-management.html" title="Chapter 5. Managing Repositories with YaST SMT Server Management">Chapter 5, <em>Managing Repositories with YaST SMT Server Management</em></a>.
  </p><section class="sect2" id="id-1.9.6.6.3" data-id-title="Updating the Local SMT Database"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">4.2.1 </span><span class="title-name">Updating the Local SMT Database</span></span> <a title="Permalink" class="permalink" href="smt-mirroring.html#id-1.9.6.6.3">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/smt_mirroring.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    The local SMT database needs to be updated periodically with the information
    downloaded from SUSE Customer Center. These periodic updates can be configured with the
    SMT Management module, as described in
    <a class="xref" href="smt-server.html#smt-yast-scheduling" title="3.5. Setting the SMT Job Schedule with YaST">Section 3.5, “Setting the SMT Job Schedule with YaST”</a>.
   </p><p>
    To update the SMT database manually, use the <code class="command">smt-sync</code>
    command. For more information about the <code class="command">smt-sync</code>
    command, see <a class="xref" href="smt-tools.html#smt-scripts-smtsync" title="8.1.2.7. smt-sync">Section 8.1.2.7, “smt-sync”</a>.
   </p></section><section class="sect2" id="id-1.9.6.6.4" data-id-title="Enabled Repositories and Repositories That Can Be Mirrored"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">4.2.2 </span><span class="title-name">Enabled Repositories and Repositories That Can Be Mirrored</span></span> <a title="Permalink" class="permalink" href="smt-mirroring.html#id-1.9.6.6.4">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/smt_mirroring.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    The database installed with SMT contains information about all software
    repositories available on SUSE Customer Center. However, the used mirror credentials
    determine which repositories can really be mirrored. For more information
    about getting and setting organization credentials, see
    <a class="xref" href="smt-mirroring.html#smt-mirroring-getcredentials" title="4.1. Mirroring Credentials">Section 4.1, “Mirroring Credentials”</a>.
   </p><p>
    Repositories that can be mirrored have the <code class="literal">MIRRORABLE</code>
    flag set in the repositories table in the SMT database. That a
    repository can be mirrored does not mean that it needs to be mirrored. Only
    repositories with the <code class="literal">DOMIRROR</code> flag set in the SMT
    database will be mirrored. For more information about configuring which
    repositories should be mirrored,
    see <a class="xref" href="smt-mirroring.html#smt-mirroring-manage-domirror" title="4.2.4. Selecting Repositories to Be Mirrored">Section 4.2.4, “Selecting Repositories to Be Mirrored”</a>.
   </p></section><section class="sect2" id="id-1.9.6.6.5" data-id-title="Getting Information about Repositories"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">4.2.3 </span><span class="title-name">Getting Information about Repositories</span></span> <a title="Permalink" class="permalink" href="smt-mirroring.html#id-1.9.6.6.5">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/smt_mirroring.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    Use the <code class="command">smt-repos</code> command to list available software
    repositories and additional information. Using this command without any
    options lists all available repositories, including repositories that
    cannot be mirrored. In the first column, the enabled repositories
    (repositories set to be mirrored) are marked with <code class="literal">Yes</code>.
    Disabled repositories are marked with <code class="literal">No</code>. The other
    columns show ID, type, name, target, and description of the listed
    repositories. The last columns show whether the repository can be mirrored
    and whether staging is enabled.
   </p><p>
    Use the <code class="option">--verbose</code> option, to get additional information
    about the URL of the repository and the path it will be mirrored to.

   </p><p>
    The repository listing can be limited to the repositories that can be
    mirrored or to the repositories that are enabled. To list the repositories that can be
    mirrored, use the <code class="option">-m</code> or <code class="option">--only-mirrorable</code>
    option: <code class="command">smt-repos -m</code>.
   </p><p>
    To list only enabled repositories, use the <code class="option">-o</code> or
    <code class="option">--only-enabled</code> option: <code class="command">smt-repos -o</code>
    (see <a class="xref" href="smt-mirroring.html#ex-smt-mirroring-repos-o" title="Listing All Enabled Repositories">Example 4.1, “Listing All Enabled Repositories”</a>).
   </p><div class="example" id="ex-smt-mirroring-repos-o" data-id-title="Listing All Enabled Repositories"><div class="title-container"><div class="example-title-wrap"><div class="example-title"><span class="title-number-name"><span class="title-number">Example 4.1: </span><span class="title-name">Listing All Enabled Repositories </span></span><a title="Permalink" class="permalink" href="smt-mirroring.html#ex-smt-mirroring-repos-o">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/smt_mirroring.xml" title="Edit source document"> </a></div></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">tux:~ # smt-repos -o
.---------------------------------------------------------------------------------------------------------------------.
| Mirr| ID | Type | Name                    | Target        | Description                             | Can be M| Stag|
+-----+----+------+-------------------------+---------------+-----------------------------------------+---------+-----+
| Yes |  1 | zypp | ATI-Driver-SLE11-SP2    | --            | ATI-Driver-SLE11-SP2                    | Yes     | Yes |
| Yes |  2 | zypp | nVidia-Driver-SLE11-SP2 | --            | nVidia-Driver-SLE11-SP2                 | Yes     | No  |
| Yes |  3 | nu   | SLED11-SP2-Updates      | sle-11-x86_64 | SLED11-SP2-Updates for sle-11-x86_64    | Yes     | No  |
| Yes |  4 | nu   | SLES11-SP1-Updates      | sle-11-x86_64 | SLES11-SP1-Updates for sle-11-x86_64    | Yes     | Yes |
| Yes |  5 | nu   | SLES11-SP2-Core         | sle-11-x86_64 | SLES11-SP2-Core for sle-11-x86_64       | Yes     | No  |
| Yes |  6 | nu   | SLES11-SP2-Updates      | sle-11-i586   | SLES11-SP2-Updates for sle-11-i586      | Yes     | No  |
| Yes |  7 | nu   | WebYaST-Testing-Updates | sle-11-i586   | WebYaST-Testing-Updates for sle-11-i586 | Yes     | No  |
'-----+----+------+-------------------------+---------------+-----------------------------------------+---------+-----'</pre></div></div></div><p>
    You can also list only repositories with a specific name or show
    information about a repository with a specific name and target. To list
    repositories with a particular name, use the <code class="command">smt-repos</code>

    <em class="replaceable">REPOSITORY_NAME</em> command. To show information
    about a repository with a specific name and target, use the
    <code class="command">smt-repos</code> <em class="replaceable">repository_name</em>
    <em class="replaceable">TARGET</em> command.
   </p><p>
    To get a list of installation repositories from remote, see
    <a class="xref" href="smt-client.html#smt-clients-repolist" title="9.7. Listing Accessible Repositories">Section 9.7, “Listing Accessible Repositories”</a>.
   </p></section><section class="sect2" id="smt-mirroring-manage-domirror" data-id-title="Selecting Repositories to Be Mirrored"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">4.2.4 </span><span class="title-name">Selecting Repositories to Be Mirrored</span></span> <a title="Permalink" class="permalink" href="smt-mirroring.html#smt-mirroring-manage-domirror">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/smt_mirroring.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    Only enabled repositories can be mirrored. In the database, the enabled
    repositories have the <code class="literal">DOMIRROR</code> flag set. Repositories
    can be enabled or disabled using the <code class="command">smt-repos</code> command.
   </p><p>
    To enable one or more repositories, follow these steps:
   </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
      To enable all repositories that can be mirrored or to
      choose one repository from the list of all repositories, run the
      <code class="command">smt-repos -e</code> command.
     </p><p>
      You can limit the list of repositories by using the relevant options. To
      limit the list to the repositories that can be mirrored, use the
      <code class="option">-m</code> option: <code class="command">smt-repos -m -e</code>. To limit
      the list to the repositories with a specific name, use the
      <code class="command">smt-repos -e</code>
      <em class="replaceable">REPOSITORY_NAME</em> command. To list a repository
      with a specific name and target, use the <code class="command">smt-repos -e
      <em class="replaceable">REPOSITORY_NAME</em>
      <em class="replaceable">TARGET</em></code> command.
     </p><p>
      To enable all repositories belonging to a specific product,
      use the <code class="option">--enable-by-prod</code> or <code class="option">-p</code> option,
      followed by the name of the product and optionally the version,
      architecture, and release:
     </p><div class="verbatim-wrap"><pre class="screen">smt-repos -p <em class="replaceable">product</em>[,<em class="replaceable">version</em>[,<em class="replaceable">architecture</em>[,<em class="replaceable">release</em>]]]</pre></div><p>
      For example, to enable all repositories belonging to SUSE Linux Enterprise Server 10 SP3 for
      PowerPC architecture, use the <code class="command">smt-repos -p
      SUSE-Linux-Enterprise-Server-SP3,10,ppc</code> command. The list of
      known products can be obtained with the
      <code class="command">smt-list-products</code> command.
     </p><div id="id-1.9.6.6.6.4.1.6" data-id-title="Installer Self-Update Repository" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.svg"/><div class="admon-title">Tip: Installer Self-Update Repository</div><p>
       SMT supports mirroring the installer self-update repository (find more
       information in <span class="intraxref">Book “Deployment Guide”, Chapter 6 “Installation with YaST”, Section 6.4.1 “Self-Update Process”</span>). If
       you need to provide the self-update repository, identify and enable it,
       for example:
      </p><div class="verbatim-wrap"><pre class="screen">$ smt-repos -m | grep Installer
$ smt-repos -e SLES12-SP2-Installer-Updates sle-12-x86_64</pre></div></div></li><li class="step"><p>
      If more than one repository is listed, choose the one you want to enable:
      specify its ID listed in the repository table and press
      <span class="keycap">Enter</span>. If you want to enable all the listed
      repositories, use <code class="literal">a</code> and press
      <span class="keycap">Enter</span>.
     </p></li></ol></div></div><p>
    To disable one or more repositories, follow these steps:
   </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
      To disable all enabled repositories or just choose one
      repository from the list of all repositories, run the <code class="command">smt-repos
      -d</code> command.
     </p><p>
      To choose the repository to be disabled from a shorter list,
      or to disable all repositories from a limited group, use any of the
      available options to limit the list of repositories. To limit the list to
      the enabled repositories, use the <code class="option">-o</code>
      option: <code class="command">smt-repos -o -d</code>. To limit the list to
      repositories with a particular name, use the <code class="command">smt-repos

      -d</code> <em class="replaceable">REPOSITORY_NAME</em> command. To show a repository with a specific name and target, use the
      <code class="command">smt-repos -d
      <em class="replaceable">REPOSITORY_NAME</em>
      <em class="replaceable">TARGET</em></code> command.
     </p></li><li class="step"><p>
      If more than one repository is listed, choose which one you want to
      disable: specify its ID listed in the repository table and
      press <span class="keycap">Enter</span>. If you want to disable all the
      listed repositories, use <code class="literal">a</code> and press
      <span class="keycap">Enter</span>.
     </p></li></ol></div></div></section><section class="sect2" id="id-1.9.6.6.7" data-id-title="Deleting Mirrored Repositories"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">4.2.5 </span><span class="title-name">Deleting Mirrored Repositories</span></span> <a title="Permalink" class="permalink" href="smt-mirroring.html#id-1.9.6.6.7">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/smt_mirroring.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    You can delete mirrored repositories that are no longer used. If you delete
    a repository, it will be physically removed from the SMT storage area.
   </p><p>
    Use the <code class="command">smt-repos
    --delete</code> command to delete a repository with a specific name. To
    delete the repository in a namespace, specify the <code class="option">--namespace <em class="replaceable">DIRNAME</em></code>
    option.
   </p><p>
    The <code class="option">--delete</code> option lists all repositories. You can delete the specified
    repositories by entering the ID number or the name and target. To delete all repositories, enter
    <span class="guimenu">a</span>.
   </p><div id="id-1.9.6.6.7.5" data-id-title="Detecting Repository IDs" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note: Detecting Repository IDs</div><p>
     Every repository has an SHA-1 hash that you can use as an ID. You can get the
     repository's hash by calling <code class="command">smt-repos -v</code>.
    </p></div></section><section class="sect2" id="id-1.9.6.6.8" data-id-title="Mirroring Custom Repositories"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">4.2.6 </span><span class="title-name">Mirroring Custom Repositories</span></span> <a title="Permalink" class="permalink" href="smt-mirroring.html#id-1.9.6.6.8">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/smt_mirroring.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    SMT also makes it possible to mirror repositories that are not available
    at the SUSE Customer Center. These repositories are called <span class="quote">“<span class="quote">custom
    repositories</span>”</span>, and they can be mirrored using the
    <code class="command">smt-setup-custom-repos</code> command.  It is also possible to
    delete custom repositories.
   </p><p>
    When adding a new custom repository, the
    <code class="command">smt-setup-custom-repos</code> command inserts a new record in the
    database and sets the <span class="emphasis"><em>mirror</em></span> flag to
    <em class="replaceable">true</em>. You can disable
    mirroring later, if necessary.
   </p><p>
    To set up a custom repository to be available through SMT, follow these
    steps:
   </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
      If you do not know the ID of the product the new repositories should
      belong to, use <code class="command">smt-list-products</code> to get the ID. For
      the description of the <code class="command">smt-list-products</code>, see
      <a class="xref" href="smt-tools.html#smt-scripts-listproducts" title="8.1.2.4. smt-list-products">Section 8.1.2.4, “smt-list-products”</a>.
     </p></li><li class="step"><p>
      Run
     </p><div class="verbatim-wrap"><pre class="screen">smt-setup-custom-repos --productid <em class="replaceable">PRODUCT_ID</em> \
--name <em class="replaceable">REPOSITORY_NAME</em> --exturl <em class="replaceable">REPOSITORY_URL</em></pre></div><p>
      <em class="replaceable">PRODUCT_ID</em> is the ID of the
      product the repository belongs to,
      <em class="replaceable">REPOSITORY_NAME</em> is the name of the
      repository, and <em class="replaceable">REPOSITORY_URL</em> is the URL of the
      repository. If the added repository needs to be
      available for more than one product, specify the IDs of all products that
      should use the added repository.
     </p><p>
      For example, the following command sets <code class="literal">My repository</code> available at
      <code class="literal">http://example.com/My_repository</code> to the products with
      the IDs <code class="literal">423</code>, <code class="literal">424</code>, and
      <code class="literal">425</code>:
     </p><div class="verbatim-wrap"><pre class="screen">smt-setup-custom-repos --productid 423 --productid 424 \
--productid 425 --name 'My_repository' \
--exturl 'http://example.com/My_repository'</pre></div></li></ol></div></div><div id="id-1.9.6.6.8.6" data-id-title="Mirroring Unsigned Repositories" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note: Mirroring Unsigned Repositories</div><p>
     By default, SUSE Linux Enterprise 10 does not allow the use of unsigned
     repositories. So if you want to mirror unsigned repositories and
     use them on client machines, be aware that the package installation
     tool—YaST or <code class="command">zypper</code>—will ask you whether
     to use repositories that are not signed.
    </p></div><p>
    To remove an existing custom repository from the SMT database, use
    <code class="command">smt-setup-custom-repos --delete</code>
    <em class="replaceable">ID</em>, where <em class="replaceable">ID</em>
    is the ID of the repository to be removed.
   </p></section></section><section class="sect1" id="id-1.9.6.7" data-id-title="The Structure of /srv/www/htdocs for SLE 11"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">4.3 </span><span class="title-name">The Structure of /srv/www/htdocs for SLE 11</span></span> <a title="Permalink" class="permalink" href="smt-mirroring.html#id-1.9.6.7">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/smt_mirroring.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   The path to the directory containing the mirror is set by the
   <code class="option">MirrorTo</code> option in the <code class="filename">/etc/smt.conf</code>
   configuration file. For more information about
   <code class="filename">/etc/smt.conf</code>, see
   <a class="xref" href="smt-tools.html#smt-config-smtconf" title="8.2.1. /etc/smt.conf">Section 8.2.1, “/etc/smt.conf”</a>. If the
   <code class="option">MirrorTo</code> option is not set to the Apache <code class="filename">htdocs</code> directory
   <code class="filename">/srv/www/htdocs/</code>, the following links need to be
   created. If the directories already exist, they need to be removed
   prior to creating the link (the data in these directories will be lost). In
   the following examples, <em class="replaceable">MIRRORTO</em> needs to be
   replaced by the path the option <code class="option">MirrorTo</code> is set to.
  </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
     <code class="filename">/srv/www/htdocs/repo/$RCE</code> must point to
     <code class="filename"><em class="replaceable">MIRRORTO</em>/repo/$RCE/</code>
    </p></li><li class="listitem"><p>
     <code class="filename">/srv/www/htdocs/repo/RPMMD</code> must point to
     <code class="filename"><em class="replaceable">MIRRORTO</em>/repo/RPMMD/</code>
    </p></li><li class="listitem"><p>
     <code class="filename">/srv/www/htdocs/repo/testing</code> must point to
     <code class="filename"><em class="replaceable">MIRRORTO</em>/repo/testing/</code>
    </p></li><li class="listitem"><p>
     <code class="filename">/srv/www/htdocs/repo/full</code> must point to
     <code class="filename"><em class="replaceable">MIRRORTO</em>/repo/full/</code>
    </p></li></ul></div><p>
   The directory specified using the <code class="option">MirrorTo</code> option and the
   subdirectories listed above must exist. Files, directories, and links in
   <em class="replaceable">/MIRRORTO</em> must belong to the
   <code class="systemitem">smt</code> user and the
   <code class="systemitem">www</code> group.
  </p><p>
   Here is an example where the <code class="option">MirrorTo</code> is set to
   <code class="literal">/mirror/data</code>:
  </p><div class="verbatim-wrap"><pre class="screen">l /srv/www/htdocs/repo/
total 16
lrwxrwxrwx 1 smt  www    22 Feb  9 14:23 $RCE -&gt; /mirror/data/repo/$RCE/
drwxr-xr-x 4 smt  www  4096 Feb  9 14:23 ./
drwxr-xr-x 4 root root 4096 Feb  8 15:44 ../
lrwxrwxrwx 1 smt  www    23 Feb  9 14:23 RPMMD -&gt; /mirror/data/repo/RPMMD/
lrwxrwxrwx 1 smt  www    22 Feb  9 14:23 full -&gt; /mirror/data/repo/full/
drwxr-xr-x 2 smt  www  4096 Feb  8 11:12 keys/
lrwxrwxrwx 1 smt  www    25 Feb  9 14:23 testing -&gt; /mirror/data/repo/testing/
drwxr-xr-x 2 smt  www  4096 Feb  8 14:14 tools/</pre></div><p>
   The links can be created using the <code class="command">ln -s</code> commands. For
   example:
  </p><div class="verbatim-wrap"><pre class="screen">cd /srv/www/htdocs/repo
for LINK in \$RCE RPMMD full testing; do
 ln -s /mirror/data/repo/${LINK}/ &amp;&amp; chown -h smt.www ${LINK}
done</pre></div><div id="id-1.9.6.7.9" data-id-title="The /srv/www/htdocs/repo Directory" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg"/><div class="admon-title">Important: The <code class="filename">/srv/www/htdocs/repo</code> Directory</div><p>
    The <code class="filename">/srv/www/htdocs/repo</code> directory must not be a
    symbolic link.
   </p></div><div id="id-1.9.6.7.10" data-id-title="Apache and Symbolic Links" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg"/><div class="admon-title">Important: Apache and Symbolic Links</div><p>
    By default Apache on <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> is configured to not follow symbolic
    links. To enable symbolic links for
    <code class="filename">/srv/www/htdocs/repo/</code> add the following snippet to
    <code class="filename">/etc/apache2/default-server.conf</code> (or the respective
    virtual host configuration in case you are running SMT on a virtual host):
   </p><div class="verbatim-wrap"><pre class="screen">&lt;Directory "/srv/www/htdocs/repo"&gt;
 Options FollowSymLinks
&lt;/Directory&gt;</pre></div><p>
    After having made the change, test the syntax and reload the Apache
    configuration files to activate the change:
   </p><div class="verbatim-wrap"><pre class="screen">rcapache2 configtest &amp;&amp; rcapache2 reload</pre></div></div></section><section class="sect1" id="id-1.9.6.8" data-id-title="The Structure of /srv/www/htdocs for SLE 12"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">4.4 </span><span class="title-name">The Structure of /srv/www/htdocs for SLE 12</span></span> <a title="Permalink" class="permalink" href="smt-mirroring.html#id-1.9.6.8">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/smt_mirroring.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   The repository structure in the <code class="filename">/srv/www/htdocs</code>
   directory matches the structure specified in SUSE Customer Center. There are the
   following directories in the structure (selected examples, similar for other
   products and architectures):
  </p><div class="verbatim-wrap"><pre class="screen">repo/SUSE/Products/SLE-SDK/12/x86_64/product/</pre></div><p>
   Contains the -POOL repository of SDK (the GA version of all packages).
  </p><div class="verbatim-wrap"><pre class="screen">repo/SUSE/Products/SLE-SDK/12/x86_64/product.license/</pre></div><p>
   Contains EULA associated with the product.
  </p><div class="verbatim-wrap"><pre class="screen">repo/SUSE/Updates/SLE-SDK/12/x86_64/update/
repo/SUSE/Updates/SLE-SDK/12/s390x/update/
repo/SUSE/Updates/SLE-SERVER/12/x86_64/update/</pre></div><p>
   Contain update repositories for respective products.
  </p><div class="verbatim-wrap"><pre class="screen">repo/full/SUSE/Updates/SLE-SERVER/12/x86_64/update/
repo/testing/SUSE/Updates/SLE-SERVER/12/x86_64/update/</pre></div><p>
   Contain repositories created for staging of respective
   repositories.
  </p></section><section class="sect1" id="smt-mirroring-testenv" data-id-title="Using the Test Environment"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">4.5 </span><span class="title-name">Using the Test Environment</span></span> <a title="Permalink" class="permalink" href="smt-mirroring.html#smt-mirroring-testenv">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/smt_mirroring.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   You can mirror repositories to a test environment instead of the production
   environment. The test environment can be used with a limited number of
   client machines before the tested repositories are moved to the production
   environment. The test environment can be run on the main SMT server.
  </p><p>
   The testing environment uses the same structure as the production
   environment, but it is located in the
   <code class="filename">/srv/www/htdocs/repo/testing/</code> subdirectory.
  </p><p>
   To mirror a repository to the testing environment, you can use the
   <span class="guimenu">Staging</span> tab in the YaST SMT Management module, or the
   command <code class="command">smt-staging</code>.
  </p><p>
   To register a client in the testing environment, follow these steps:
  </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
     De-register the client from the SMT server by running <code class="command">SUSEConnect --de-register</code> on the client host.
    </p></li><li class="step"><p>
     Modify <code class="filename">/etc/SUSEConnect</code> on the client machine as
     follows:
    </p><div class="verbatim-wrap"><pre class="screen">namespace: testing</pre></div></li><li class="step"><p>
     Re-register the client host against SMT in order for the new
     namespace setting to take effect. See general information about
     registering SMT clients in <a class="xref" href="smt-client.html" title="Chapter 9. Configuring Clients to Use SMT">Chapter 9, <em>Configuring Clients to Use SMT</em></a>.
    </p></li></ol></div></div><p>
   To move the testing environment to the production environment, manually copy
   or move it using the <code class="command">cp -a</code> or <code class="command">mv</code>
   command.
  </p><p>
   You can enable <span class="quote">“<span class="quote">staging</span>”</span> for a repository in the
   <span class="guimenu">Repositories</span> tab of the SMT Management module or with
   the <code class="command">smt-repos</code> command. The mirroring happens
   automatically to <code class="filename">repo/full/</code>.
  </p><p>
   If you have an SLE11-based update repository with patches, SMT tools can
   be used to manage them. Using these tools, you can select patches,
   create a snapshot and copy it into <code class="filename">repo/testing/</code>. After
   tests are finished, you can copy the contents of
   <code class="filename">repo/testing</code> into the production area
   <code class="filename">/repo</code>.
  </p><p>
   SLE10-based update repositories are not supported by SMT tools. Not all of
   these repositories support selective staging. In this case, you must mirror
   the complete package.
  </p><p>
   Recommended workflow:
  </p><div class="verbatim-wrap"><pre class="screen">customer center =&gt; repo/full =&gt; repo/testing, =&gt; repo/production</pre></div></section><section class="sect1" id="smt-staging" data-id-title="Testing and Filtering Update Repositories with Staging"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">4.6 </span><span class="title-name">Testing and Filtering Update Repositories with Staging</span></span> <a title="Permalink" class="permalink" href="smt-mirroring.html#smt-staging">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/smt_mirroring.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   You can test repositories on any clients using the
   <code class="command">smt-staging</code> command
   before moving them to the production environment. You can select new update
   repositories to be installed on clients.
  </p><p>
   You can either use the <code class="command">smt-staging</code> command or the YaST SMT Management module for staging. For more details, see
   <a class="xref" href="smt-management.html#smt-yast-staging-stage" title="5.3. Staging Repositories">Section 5.3, “Staging Repositories”</a>.
  </p><div class="figure" id="id-1.9.6.10.4"><div class="figure-contents"><div class="mediaobject"><a href="images/smt_staging.png"><img src="images/smt_staging.png" width="70%" alt="SMT Staging Schema" title="SMT Staging Schema"/></a></div></div><div class="title-container"><div class="figure-title-wrap"><div class="figure-title"><span class="title-number-name"><span class="title-number">Figure 4.1: </span><span class="title-name">SMT Staging Schema </span></span><a title="Permalink" class="permalink" href="smt-mirroring.html#id-1.9.6.10.4">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/smt_mirroring.xml" title="Edit source document"> </a></div></div></div><p>
   Repositories with staging enabled are mirrored to the
   <code class="filename">/<em class="replaceable">MIRRORTO</em>/repo/full</code>
   subdirectory. This subdirectory is usually not used by your clients.
   Incoming new updates are not automatically visible to the clients before you
   get a chance to test them. Later, you can generate a testing environment of
   this repository, which goes to the
   <code class="filename">/<em class="replaceable">MIRRORTO</em>/repo</code> directory.
  </p><p>
   If you have an SLE 11-based update repository with patches, you can use
   SMT tools to manage them. Using these tools, you can select patches,
   create a snapshot and put it into <code class="filename">repo/testing/</code>. After
   tests are finished, you can put the content of
   <code class="filename">repo/testing</code> into the <code class="filename">/repo</code>
   production area called the <code class="literal">default</code> staging
   group. You can create additional staging groups as needed using the
   <code class="command">smt-staging creategroup</code> command.
  </p><div id="id-1.9.6.10.7" data-id-title="SLE 10-based Update Repositories" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note: SLE 10-based Update Repositories</div><p>
    SLE 10-based update repositories are not supported by SMT tools. Not all
    of these repositories support selective staging. In this case, you need to
    mirror the complete package.
   </p></div><div class="variablelist"><dl class="variablelist"><dt id="id-1.9.6.10.8.1"><span class="term">Enabling Staging</span></dt><dd><p>
      To enable or disable staging, use the <code class="command">smt-repos</code>
      command with the <code class="option">--enable-staging</code> or <code class="option">-s</code>
      options:
     </p><div class="verbatim-wrap"><pre class="screen">smt-repos --enable-staging</pre></div><p>
      You can enable the required repositories by entering the ID number or by
      entering the name and target. If you want to enable all repositories,
      enter <span class="guimenu">a</span>.
     </p></dd><dt id="id-1.9.6.10.8.2"><span class="term">Generating Testing and Production Snapshots</span></dt><dd><p>
      To create the testing repository in the <code class="literal">default</code> staging
      group, run the following command:
     </p><div class="verbatim-wrap"><pre class="screen">smt-staging createrepo <em class="replaceable">REPOSITORY_ID</em> -–testing</pre></div><p>
      You can then test the installation and functionality of the patches in
      testing clients. If testing was successful, create the
      production repository:
     </p><div class="verbatim-wrap"><pre class="screen">smt-staging createrepo <em class="replaceable">REPOSITORY_ID</em> --production</pre></div><p>
      To create testing and production repositories in a named staging group,
      create the group and the repositories in this group:
     </p><div class="verbatim-wrap"><pre class="screen">smt-staging creategroup <em class="replaceable">GROUPNAME</em> <em class="replaceable">TESTINGDIR</em> <em class="replaceable">PRODUCTIONDIR</em>
smt-staging createrepo --group <em class="replaceable">GROUPNAME</em> <em class="replaceable">REPOSITORY_ID</em> -–testing
SMT-STAGING createrepo --group <em class="replaceable">GROUPNAME</em> <em class="replaceable">REPOSITORY_ID</em> -–production</pre></div><p>
      This can be useful when you want to combine SLES11-SP1-Updates
      and SLES11-SP2-Updates of the <code class="literal">sle-11-x86_64</code>
      architecture into one repository of a group:
     </p><div class="verbatim-wrap"><pre class="screen">smt-staging creategroup SLES11SP1-SP2-Up test-sp1-sp2 prod-sp1-sp2
smt-staging createrepo --group SLES11SP1-SP2-Up \
  SLES11-SP1-Updates sle-11-x86_64 --testing
smt-staging createrepo --group SLES11SP1-SP2-Up \
  SLES11-SP2-Updates sle-11-x86_64 --testing
smt-staging createrepo --group SLES11SP1-SP2-Up \
  SLES11-SP1-Updates sle-11-x86_64 --production
smt-staging createrepo --group SLES11SP1-SP2-Up \
  SLES11-SP2-Updates sle-11-x86_64 --production</pre></div><p>
      Group names can contain the following characters: <code class="literal">-_</code>,
      <code class="literal">a-z A-Z</code>, and <code class="literal">0-9</code>.
     </p></dd></dl></div><div class="variablelist"><dl class="variablelist"><dt id="id-1.9.6.10.9.1"><span class="term">Filtering Patches</span></dt><dd><p>
      You can allow or forbid all or selected patches using the
      <code class="command">allow</code> or <code class="command">forbid</code> commands:
     </p><div class="verbatim-wrap"><pre class="screen">smt-staging forbid --patch <em class="replaceable">ID</em>
smt-staging forbid --category <em class="replaceable">CATEGORYNAME</em></pre></div></dd><dt id="id-1.9.6.10.9.2"><span class="term">Signing Changed Repositories</span></dt><dd><p>
      Filtering one or more patches from a repository invalidates the original
      signature, and the repository needs to be signed again. The
      <code class="command">smt-staging createrepo</code> command does that
      automatically, provided you configure the SMT server.
     </p><p>
      To enable signing of changed metadata, the admin needs to generate a new
      signing key. This can be done with GPG like this:
     </p><div class="verbatim-wrap"><pre class="screen">mkdir <em class="replaceable">DIR</em>
gpg --gen-key --homedir <em class="replaceable">DIR</em>
sudo mv <em class="replaceable">DIR</em> /var/lib/smt/.gnupg
sudo chown smt:users -R /var/lib/smt/.gnupg
sudo chmod go-rwx -R /var/lib/smt/.gnupg</pre></div><p>
      The ID of the newly generated key can be obtained using the <code class="command">gpg
      --gen-key</code> command. The ID must be added to the
      <code class="option">signingKeyID</code> option in the
      <code class="filename">/etc/smt.conf</code> file.
     </p><p>
      At this point, the clients are not aware of the new key. Import the
      new key to clients during their registration as follows:
     </p><div class="verbatim-wrap"><pre class="screen">sudo -u smt gpg --homedir /var/lib/smt/.gnupg \
  --export -a <em class="replaceable">SIGNING_KEYID</em> \
  &gt; /<em class="replaceable">MIRRORTO</em>/repo/keys/smt-signing-key.key</pre></div><p>
      In this example, <em class="replaceable">MIRRORTO</em> is the base
      directory where repositories will be mirrored. After that, clients can
      import this key during the registration process.
     </p></dd><dt id="id-1.9.6.10.9.3"><span class="term">Registering Clients in the Testing Environment</span></dt><dd><p>
      To register a client in the testing environment, follow these steps:
     </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
        De-register the client from the SMT server by running <code class="command">SUSEConnect --de-register</code> on the client host.
       </p></li><li class="step"><p>
        Modify <code class="filename">/etc/SUSEConnect</code> on the client machine as
        follows:
       </p><div class="verbatim-wrap"><pre class="screen">namespace: testing</pre></div></li><li class="step"><p>
        Re-register the client host against SMT in order for the new
        namespace setting to take effect. See general information about
        registering SMT clients in <a class="xref" href="smt-client.html" title="Chapter 9. Configuring Clients to Use SMT">Chapter 9, <em>Configuring Clients to Use SMT</em></a>.
       </p></li></ol></div></div></dd></dl></div></section><section class="sect1" id="smt-repo-preload" data-id-title="Repository Preloading"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">4.7 </span><span class="title-name">Repository Preloading</span></span> <a title="Permalink" class="permalink" href="smt-mirroring.html#smt-repo-preload">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/smt_mirroring.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   Deploying multiple SMT servers can take time if each new SMT server
   must mirror the same repositories.
  </p><p>
   To save time when deploying new SMT servers, the repositories can be preloaded
   from another server or disk instead. To do this, follow these steps:
  </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
     Enable the repositories to be mirrored with the SMT, for example:
    </p><div class="verbatim-wrap"><pre class="screen">smt-repos -e SLES12-Updates sle-12-x86_64</pre></div></li><li class="step"><p>
     Perform a dry run of <code class="command">smt-mirror</code> to create the required repository
     directories:
    </p><div class="verbatim-wrap"><pre class="screen">smt-mirror -d --dryrun -L /var/log/smt/smt-mirror.log</pre></div><p>
     The following directories are created based on the repository above and the default <code class="option">MirrorTo</code>:
    </p><div class="verbatim-wrap"><pre class="screen">/srv/www/htdocs/repo/repoindex.xml
/srv/www/htdocs/repo/$RCE/SLES12-Updates/sle-12-x86_64/*</pre></div></li><li class="step"><p>
     Then copy the repositories from another SMT server, for
     example:
    </p><div class="verbatim-wrap"><pre class="screen">rsync -av 'smt12:/srv/www/htdocs/repo/\$RCE/SLES12-Updates/sle-12-x86_64/' \
 '/srv/www/htdocs/repo/$RCE/SLES12-Updates/sle-12-x86_64/'</pre></div></li><li class="step"><p>
     To get the repository data fixed, run the following command:
    </p><div class="verbatim-wrap"><pre class="screen">smt-mirror -d -L /var/log/smt/smt-mirror.log</pre></div></li></ol></div></div><div id="id-1.9.6.11.5" data-id-title="Possible Error Messages" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg"/><div class="admon-title">Important: Possible Error Messages</div><p>
    Errors, such as <code class="literal">repomd.xml is the same, but repo is
    not valid. Start mirroring.</code>, are considered normal.
 They occur because the metadata of the preloaded repositories in
 the server's database remains incorrect until the initial mirror of the repositories has completed.
   </p></div></section></section><nav class="bottom-pagination"><div><a class="pagination-link prev" href="smt-server.html"><span class="pagination-relation">Previous</span><span class="pagination-label"><span class="title-number">Chapter 3 </span>SMT Server Configuration</span></a> </div><div><a class="pagination-link next" href="smt-management.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Chapter 5 </span>Managing Repositories with YaST SMT Server Management</span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="sect1"><a href="smt-mirroring.html#smt-mirroring-getcredentials"><span class="title-number">4.1 </span><span class="title-name">Mirroring Credentials</span></a></span></li><li><span class="sect1"><a href="smt-mirroring.html#smt-mirroring-manage"><span class="title-number">4.2 </span><span class="title-name">Managing Software Repositories with SMT Command Line Tools</span></a></span></li><li><span class="sect1"><a href="smt-mirroring.html#id-1.9.6.7"><span class="title-number">4.3 </span><span class="title-name">The Structure of /srv/www/htdocs for SLE 11</span></a></span></li><li><span class="sect1"><a href="smt-mirroring.html#id-1.9.6.8"><span class="title-number">4.4 </span><span class="title-name">The Structure of /srv/www/htdocs for SLE 12</span></a></span></li><li><span class="sect1"><a href="smt-mirroring.html#smt-mirroring-testenv"><span class="title-number">4.5 </span><span class="title-name">Using the Test Environment</span></a></span></li><li><span class="sect1"><a href="smt-mirroring.html#smt-staging"><span class="title-number">4.6 </span><span class="title-name">Testing and Filtering Update Repositories with Staging</span></a></span></li><li><span class="sect1"><a href="smt-mirroring.html#smt-repo-preload"><span class="title-number">4.7 </span><span class="title-name">Repository Preloading</span></a></span></li></ul></div><div class="side-title">Share this page</div><ul class="share"><li><a id="_share-fb" href="#" title="Facebook"> </a></li><li><a id="_share-in" href="#" title="LinkedIn"> </a></li><li><a id="_share-tw" href="#" title="Twitter/X"> </a></li><li><a id="_share-mail" href="#" title="E-Mail"> </a></li><li><a id="_print-button" href="#" title="Print this page"> </a></li></ul> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2024</span></div></div></footer></body></html>