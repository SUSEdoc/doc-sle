<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><title>SLES 12 SP5 | Deployment Guide | Upgrading Online</title><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"/>
<meta name="title" content="Upgrading Online | SLES 12 SP5"/>
<meta name="description" content="SUSE offers an intuitive graphical and a simple command line tool to upgrade a running system to a new service pack. They provide support for rollbac…"/>
<meta name="product-name" content="SUSE Linux Enterprise Server"/>
<meta name="product-number" content="12 SP5"/>
<meta name="book-title" content="Deployment Guide"/>
<meta name="chapter-title" content="Chapter 22. Upgrading Online"/>
<meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi"/>
<meta name="tracker-type" content="bsc"/>
<meta name="tracker-bsc-assignee" content="fs@suse.com"/>
<meta name="tracker-bsc-component" content="Documentation"/>
<meta name="tracker-bsc-product" content="SUSE Linux Enterprise Server 12 SP5"/>
<meta name="publisher" content="SUSE"/><meta property="og:title" content="Deployment Guide"/>
<meta property="og:description" content="Install single or multiple systems"/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Deployment Guide"/>
<meta name="twitter:description" content="Install single or multiple systems"/>
<script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": ["TechArticle"],
    "image": "https://www.suse.com/assets/img/suse-white-logo-green.svg",
    
     "isPartOf": {
      "@type": "CreativeWorkSeries",
      "name": "Products &amp; Solutions"
    },
    
    "inLanguage": "en",
    

    "headline": "Upgrading Online",
  
    "description": "SUSE offers an intuitive graphical and a simple command line tool to upgrade a running system to a new service pack. They provide support for rollbac…",
      
    "author": [
      {
        "@type": "Corporation",
        "name": "SUSE Product &amp; Solution Documentation Team",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    ],
      
    "dateModified": "2019-12-09T00:00+02:00",
      
    "datePublished": "2019-12-09T00:00+02:00",
      

    "about": [
      
    ],
  
    "sameAs": [
          "https://www.facebook.com/SUSEWorldwide/about",
          "https://www.youtube.com/channel/UCHTfqIzPKz4f_dri36lAQGA",
          "https://twitter.com/SUSE",
          "https://www.linkedin.com/company/suse"
    ],
    "publisher": {
      "@type": "Corporation",
      "name": "SUSE",
      "url": "https://documentation.suse.com",
      "logo": {
        "@type": "ImageObject",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    }
  }</script>
<link rel="prev" href="cha-update-offline.html" title="Chapter 21. Upgrading Offline"/><link rel="next" href="cha-update-backporting.html" title="Chapter 23. Backporting Source Code"/><script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/script-purejs.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script><meta name="edit-url" content="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/sle_update_online.xml"/></head><body class="draft wide offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"><img src="static/images/logo.svg" alt="Logo" class="logo"/></div></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">Deployment Guide</a><span> / </span><a class="crumb" href="part-update.html">Updating and Upgrading SUSE Linux Enterprise</a><span> / </span><a class="crumb" href="cha-update-online.html">Upgrading Online</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title">Deployment Guide</div><ol><li><a href="preface-deployment.html" class=" "><span class="title-number"> </span><span class="title-name">About This Guide</span></a></li><li><a href="cha-planning.html" class=" "><span class="title-number">1 </span><span class="title-name">Planning for <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span></span></a></li><li><a href="part-prep.html" class="has-children "><span class="title-number">I </span><span class="title-name">Installation Preparation</span></a><ol><li><a href="cha-x86.html" class=" "><span class="title-number">2 </span><span class="title-name">Installation on AMD64 and Intel 64</span></a></li><li><a href="cha-power.html" class=" "><span class="title-number">3 </span><span class="title-name">Installation on IBM POWER</span></a></li><li><a href="cha-zseries.html" class=" "><span class="title-number">4 </span><span class="title-name">Installation on IBM IBM Z and LinuxONE</span></a></li><li><a href="cha-aarch64.html" class=" "><span class="title-number">5 </span><span class="title-name">Installation on Arm AArch64</span></a></li></ol></li><li><a href="part-mandeploy.html" class="has-children "><span class="title-number">II </span><span class="title-name">The Installation Workflow</span></a><ol><li><a href="cha-inst.html" class=" "><span class="title-number">6 </span><span class="title-name">Installation with YaST</span></a></li><li><a href="cha-deployment-clone-image.html" class=" "><span class="title-number">7 </span><span class="title-name">Cloning Disk Images</span></a></li></ol></li><li><a href="part-installserver.html" class="has-children "><span class="title-number">III </span><span class="title-name">Setting Up an Installation Server</span></a><ol><li><a href="cha-deployment-instserver.html" class=" "><span class="title-number">8 </span><span class="title-name">Setting Up the Server Holding the Installation Sources</span></a></li><li><a href="cha-deployment-prep-boot.html" class=" "><span class="title-number">9 </span><span class="title-name">Preparing the Boot of the Target System</span></a></li><li><a href="cha-deployment-firstboot.html" class=" "><span class="title-number">10 </span><span class="title-name">Deploying Customized Preinstallations</span></a></li></ol></li><li><a href="part-remoteinstall.html" class="has-children "><span class="title-number">IV </span><span class="title-name">Remote Installation</span></a><ol><li><a href="cha-deployment-remoteinst.html" class=" "><span class="title-number">11 </span><span class="title-name">Remote Installation</span></a></li></ol></li><li><a href="part-sysconfig.html" class="has-children "><span class="title-number">V </span><span class="title-name">Initial System Configuration</span></a><ol><li><a href="cha-y2-hw.html" class=" "><span class="title-number">12 </span><span class="title-name">Setting Up Hardware Components with YaST</span></a></li><li><a href="cha-advdisk.html" class=" "><span class="title-number">13 </span><span class="title-name">Advanced Disk Setup</span></a></li><li><a href="cha-y2-sw.html" class=" "><span class="title-number">14 </span><span class="title-name">Installing or Removing Software</span></a></li><li><a href="cha-add-ons.html" class=" "><span class="title-number">15 </span><span class="title-name">Installing Modules, Extensions, and Third Party Add-On Products</span></a></li><li><a href="cha-tuning-multikernel.html" class=" "><span class="title-number">16 </span><span class="title-name">Installing Multiple Kernel Versions</span></a></li><li><a href="cha-y2-userman.html" class=" "><span class="title-number">17 </span><span class="title-name">Managing Users with YaST</span></a></li><li><a href="cha-y2-lang.html" class=" "><span class="title-number">18 </span><span class="title-name">Changing Language and Country Settings with YaST</span></a></li></ol></li><li class="active"><a href="part-update.html" class="has-children you-are-here"><span class="title-number">VI </span><span class="title-name">Updating and Upgrading SUSE Linux Enterprise</span></a><ol><li><a href="cha-update-background.html" class=" "><span class="title-number">19 </span><span class="title-name">Lifecycle and Support</span></a></li><li><a href="cha-update-sle.html" class=" "><span class="title-number">20 </span><span class="title-name">Upgrading SUSE Linux Enterprise</span></a></li><li><a href="cha-update-offline.html" class=" "><span class="title-number">21 </span><span class="title-name">Upgrading Offline</span></a></li><li><a href="cha-update-online.html" class=" you-are-here"><span class="title-number">22 </span><span class="title-name">Upgrading Online</span></a></li><li><a href="cha-update-backporting.html" class=" "><span class="title-number">23 </span><span class="title-name">Backporting Source Code</span></a></li></ol></li><li><a href="bk02apa.html" class=" "><span class="title-number">A </span><span class="title-name">GNU licenses</span></a></li> </ol> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section class="chapter" id="cha-update-online" data-id-title="Upgrading Online"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname"><span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span></span> <span class="productnumber"><span class="productnumber">12 SP5</span></span></div><div><div class="title-container"><h1 class="title"><span class="title-number-name"><span class="title-number">22 </span><span class="title-name">Upgrading Online</span></span> <a title="Permalink" class="permalink" href="cha-update-online.html#">#</a></h1><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/sle_update_online.xml" title="Edit source document"> </a></div></div></div><div><div class="abstract"><p>
    SUSE offers an intuitive graphical and a simple command line tool to
    upgrade a running system to a new service pack. They provide support
    for <span class="quote">“<span class="quote">rollback</span>”</span> of service packs and more. This chapter
    explains how to do a service pack upgrade step by step with these tools.
   </p></div></div></div></div><section class="sect1" id="sec-update-migr-conceptual-overview" data-id-title="Conceptual Overview"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">22.1 </span><span class="title-name">Conceptual Overview</span></span> <a title="Permalink" class="permalink" href="cha-update-online.html#sec-update-migr-conceptual-overview">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/sle_update_online.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   Before upgrading your system, read <a class="xref" href="cha-update-sle.html#sec-update-prep" title="20.3. Preparing the System">Section 20.3, “Preparing the System”</a>.
  </p><p>
   SUSE releases new service packs for the SUSE Linux Enterprise family at regular intervals.
   To make it easy for customers to migrate to a new service pack and minimize
   downtime, SUSE supports migrating online while the system is running.
  </p><p>
   Starting with SLE 12, YaST Wagon has been replaced by
   YaST migration (GUI) and Zypper migration (command line). The following
   features are supported:
  </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
     System always in a defined state until the first RPM is updated
    </p></li><li class="listitem"><p>
     Canceling is possible until the first RPM is updated
    </p></li><li class="listitem"><p>
     Simple recovery, if there is an error
    </p></li><li class="listitem"><p>
     <span class="quote">“<span class="quote">Rollback</span>”</span> via system tools; no backup/restore needed
    </p></li><li class="listitem"><p>
     Use of all active repositories
    </p></li><li class="listitem"><p>
     The ability to skip a service pack
    </p></li></ul></div><div id="id-1.4.9.5.3.6" data-id-title="Upgrading SUSE Manager Clients" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg"/><div class="admon-title">Important: Upgrading SUSE Manager Clients</div><p>If the system to upgrade is a SUSE Manager client, it cannot be
    upgraded by YaST online migration or <code class="command">zypper migration</code>.
    Use the <em class="citetitle">Client Migration</em> procedure instead. It is
    described in the <em class="citetitle">SUSE Manager Upgrade Guide</em>, available
    at <a class="link" href="https://documentation.suse.com/suma/" target="_blank">https://documentation.suse.com/suma/</a>.
   </p></div></section><section class="sect1" id="sec-update-migr-workflow" data-id-title="Service Pack Migration Workflow"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">22.2 </span><span class="title-name">Service Pack Migration Workflow</span></span> <a title="Permalink" class="permalink" href="cha-update-online.html#sec-update-migr-workflow">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/sle_update_online.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   A service pack migration can be executed by either YaST,
   <code class="command">zypper</code>, or AutoYaST.
  </p><p>
   Before you can start a service pack migration, your system must be
   registered at the SUSE Customer Center or a local SMT server.  SUSE Manager can
   also be used.
  </p><p>
   Regardless of the method, a service pack migration consists of the following
   steps:
  </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
     Find possible migration targets on your registered systems.
    </p></li><li class="listitem"><p>
     Select one migration target.
    </p></li><li class="listitem"><p>
     Request and enable new repositories.
    </p></li><li class="listitem"><p>
     Run the migration.
    </p></li></ol></div><p>
   The list of migration targets depends on the products you have installed and
   registered. If you have an extension installed for which the new SP is not
   yet available, it could be that no migration target is offered to you.
  </p><p>
   The list of migration targets available for your host will always be
   retrieved from the SUSE Customer Center and depend on products or extensions installed.
  </p></section><section class="sect1" id="sec-update-migr-cancel-spm" data-id-title="Canceling Service Pack Migration"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">22.3 </span><span class="title-name">Canceling Service Pack Migration</span></span> <a title="Permalink" class="permalink" href="cha-update-online.html#sec-update-migr-cancel-spm">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/sle_update_online.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   A service pack migration can only be cancelled at specific stages during the
   migration process:
  </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
     Until the package upgrade starts, there are only minimal changes on the
     system, like for services and repositories. Restore
     <code class="filename">/etc/zypp/repos.d/*</code> to revert to the former state.
    </p></li><li class="listitem"><p>
     After the package upgrade starts, you can revert to the former state by
     using a Snapper snapshot (see <span class="intraxref">Book “Administration Guide”, Chapter 7 “System Recovery and Snapshot Management with Snapper”</span>).
    </p></li><li class="listitem"><p>
     After the migration target was selected, SUSE Customer Center changes the repository
     data. To revert this state manually, use <code class="command">SUSEConnect</code>
     <code class="option">--rollback</code>.
    </p></li></ol></div></section><section class="sect1" id="sec-update-migr-yast-onlinemigr" data-id-title="Upgrading with the Online Migration Tool (YaST)"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">22.4 </span><span class="title-name">Upgrading with the Online Migration Tool (YaST)</span></span> <a title="Permalink" class="permalink" href="cha-update-online.html#sec-update-migr-yast-onlinemigr">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/sle_update_online.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   To perform a service pack migration with YaST, use the <span class="guimenu">Online
   Migration</span> tool. By default, YaST does not install any packages
   from a third-party repository. If a package was installed from a third-party
   repository, YaST prevents packages from being replaced with the same
   package coming from SUSE.
  </p><div id="id-1.4.9.5.6.3" data-id-title="Reduce Installation Size" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note: Reduce Installation Size</div><p>
    When performing the SP migration, YaST will install all recommended
    packages. Especially in the case of custom minimal installations, this may
    increase the installation size of the system significantly.
   </p><p>
    To change this default behavior and allow only required packages,
    adjust the <code class="option">solver.onlyRequires</code> option in
    <code class="filename">/etc/zypp/zypp.conf</code>.
   </p><div class="verbatim-wrap"><pre class="screen">solver.onlyRequires = true</pre></div><p>
    Also, edit the file <code class="filename">/etc/zypp/zypper.conf</code> and
    change the <code class="option">installRecommends</code> option.
   </p><div class="verbatim-wrap"><pre class="screen">installRecommends=false</pre></div></div><p>
   This changes the behavior of all package operations, such as the
   installation of patches or new packages.
  </p><p>
   To start the service pack migration, do the following:
  </p><div class="procedure" id="pro-update-migr-yast"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
     Deactivate all unused extensions on your registration server to avoid
     future dependency conflicts. In case you forget an extension, YaST
     will later detect unused extension repositories and deactivate them.
    </p></li><li class="step"><p>
     If you are logged in to a GNOME session running on the machine you are
     going to update, switch to a text console. Running the update from within
     a GNOME session is not recommended. Note that this does not apply when
     being logged in from a remote machine (unless you are running a VNC
     session with GNOME).
    </p></li><li class="step"><p>
     If you are an LTSS subscriber, you must deactivate the LTSS repository. This cannot
     be done with YaST. Instead, run these commands, using the version number of the
     installed repository:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> SUSEConnect -d -p SLES-LTSS/<em class="replaceable">12.2</em>/x86_64
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper ref -s</pre></div><p>
    See the following support bulletin for more information:
    <a class="link" href="https://www.suse.com/support/kb/doc/?id=7022381" target="_blank">https://www.suse.com/support/kb/doc/?id=7022381</a>.
</p></li><li class="step"><p>
     Install the package
     <span class="package">yast2-migration</span>
     and its dependencies (in YaST under <span class="guimenu">Software</span> › <span class="guimenu">Software Management</span>).
    </p></li><li class="step"><p>
     Restart YaST, otherwise the newly installed module will not be shown in
     the control center.
    </p></li><li class="step"><p>
     In YaST, choose <span class="guimenu">Online Migration</span> (depending on the
     version of <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> that you are upgrading from, this module is
     categorized under either <span class="guimenu">System</span> or
     <span class="guimenu">Software</span>). YaST will show possible migration
     targets and a summary. If more than one migration target is available
     for your system, select one from the list.
    </p></li><li class="step"><p>
     Select one migration target from the list and proceed with
     <span class="guimenu">Next</span>.
    </p></li><li class="step"><p>
     In case the migration tool offers update repositories, it is recommended
     to proceed with <span class="guimenu">Yes</span>.
    </p></li><li class="step"><p>
     
     If the Online Migration tool finds obsolete repositories coming from DVD
     or a local server, it is highly recommended to disable them. Obsolete
     repositories are from a previous SP. Any old repositories from SCC or SMT
     are removed automatically.
    </p></li><li class="step"><p>
     Check the summary and proceed with the migration by clicking
     <span class="guimenu">Next</span>. Confirm with <span class="guimenu">Start Update</span>.
    </p></li><li class="step"><p>
     After the successful migration restart your system.
    </p></li></ol></div></div></section><section class="sect1" id="sec-update-migr-zypper-onlinemigr" data-id-title="Upgrading with Zypper"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">22.5 </span><span class="title-name">Upgrading with Zypper</span></span> <a title="Permalink" class="permalink" href="cha-update-online.html#sec-update-migr-zypper-onlinemigr">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/sle_update_online.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   To perform a service pack migration with Zypper, use the command line tool
   <code class="command">zypper</code> <code class="option">migration</code> from the package
   <span class="package">zypper-migration-plugin</span>.
  </p><div id="id-1.4.9.5.7.3" data-id-title="Reduce Installation Size" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note: Reduce Installation Size</div><p>
    When performing the SP migration, YaST will install all recommended
    packages. Especially in the case of custom minimal installations, this may
    increase the installation size of the system significantly.
   </p><p>
    To change this default behavior and allow only required packages,
    adjust the <code class="option">solver.onlyRequires</code> option in
    <code class="filename">/etc/zypp/zypp.conf</code>.
   </p><div class="verbatim-wrap"><pre class="screen">solver.onlyRequires = true</pre></div><p>
    Also, edit the file <code class="filename">/etc/zypp/zypper.conf</code> and
    change the <code class="option">installRecommends</code> option.
   </p><div class="verbatim-wrap"><pre class="screen">installRecommends=false</pre></div></div><p>
   This changes the behavior of all package operations, such as the
   installation of patches or new packages. To change the behavior of Zypper
   for a single invocation, add the parameter <code class="option">--no-recommends</code>
   to your command line.
  </p><p>
   To start the service pack migration, do the following:
  </p><div class="procedure" id="pro-update-migr-zypper"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
     If you are logged in to a GNOME session running on the machine you are
     going to update, switch to a text console. Running the update from within
     a GNOME session is not recommended. Note that this does not apply when
     being logged in from a remote machine (unless you are running a VNC
     session with GNOME).
    </p></li><li class="step"><p>
     Register your SUSE Linux Enterprise machine if you have not done so:
    </p><div class="verbatim-wrap"><pre class="screen">sudo <code class="command">SUSEConnect</code> --regcode <em class="replaceable">YOUR_REGISTRATION_CODE</em></pre></div></li><li class="step"><p>
     If you are an LTSS subscriber, you must deactivate the LTSS repository. Run these commands,
     using the version number of the installed repository:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> SUSEConnect -d -p SLES-LTSS/<em class="replaceable">12.2</em>/x86_64
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> zypper ref -s</pre></div><p>
    See the following support bulletin for more information:
    <a class="link" href="https://www.suse.com/support/kb/doc/?id=7022381" target="_blank">https://www.suse.com/support/kb/doc/?id=7022381</a>.
</p></li><li class="step"><p>
     Install the latest updates:
    </p><div class="verbatim-wrap"><pre class="screen">sudo <code class="command">zypper</code> patch</pre></div></li><li class="step"><p>
     Install the <span class="package">zypper-migration-plugin</span> package and
     its dependencies:
    </p><div class="verbatim-wrap"><pre class="screen">sudo <code class="command">zypper</code> in zypper-migration-plugin</pre></div></li><li class="step"><p>
     Run <code class="command">zypper</code> <code class="option">migration</code>:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>sudo <code class="command">zypper</code> migration
Executing 'zypper  patch-check'

Refreshing service 'SUSE_Linux_Enterprise_Server_12_x86_64'.
Loading repository data...
Reading installed packages...
0 patches needed (0 security patches)

Available migrations:

    1 | SUSE Linux Enterprise Server 12 SP1 x86_64
    2 | SUSE Linux Enterprise Server 12 SP2 x86_64</pre></div><p>
     Some notes about the migration process:
    </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
       If more than one migration target is available for your system, Zypper
       allows you to select one SP from the list. This is the same as skipping
       one or more SPs. Keep in mind, online migration for base
       products (SLES, SLED) remains available only between the SPs of a
       major version.
      </p></li><li class="listitem"><p>
       By default, Zypper uses the option
       <code class="option">--no-allow-vendor-change</code> which is passed to
       <code class="command">zypper</code> <code class="option">dup</code>. If a package was
       installed from a third-party repository, this option prevents packages
       from being replaced with the same package coming from SUSE.
      </p></li><li class="listitem"><p>
       
       If Zypper finds obsolete repositories coming from DVD or a local server,
       it is highly recommended to disable them. Old SCC or SMT repositories
       are removed automatically.
      </p></li></ul></div></li><li class="step"><p>
     Review all the changes, especially the packages that are going to be
     removed. Proceed by typing <code class="literal">y</code> (the exact number of
     packages to upgrade can vary on your system):
    </p><div class="verbatim-wrap"><pre class="screen">266 packages to upgrade, 54 to downgrade, 17 new, 8 to reinstall, 5 to remove, 1 to change arch.
Overall download size: 285.1 MiB. Already cached: 0 B  After the operation, additional 139.8 MiB will be used.
Continue? [y/n/? shows all options] (y):</pre></div><p>
     Use the <span class="keycap">Shift</span><span class="key-connector">–</span><span class="keycap">Page ↑</span> or <span class="keycap">Shift</span><span class="key-connector">–</span><span class="keycap">Page ↓</span> keys to scroll in your shell.
    </p></li><li class="step"><p>
     After successful migration restart your system.
    </p></li></ol></div></div></section><section class="sect1" id="sec-update-migr-plainzypper-onlinemigr" data-id-title="Upgrading with Plain Zypper"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">22.6 </span><span class="title-name">Upgrading with Plain Zypper</span></span> <a title="Permalink" class="permalink" href="cha-update-online.html#sec-update-migr-plainzypper-onlinemigr">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/sle_update_online.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   If you cannot use YaST migration or the Zypper migration, you can still
   migrate with plain Zypper and some manual interactions. To start a service
   pack migration, do the following:
  </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
     If you are logged in to a GNOME session running on the machine you are
     going to update, switch to a text console. Running the update from within
     a GNOME session is not recommended. Note that this does not apply when
     being logged in from a remote machine (unless you are running a VNC
     session with GNOME).
    </p></li><li class="step"><p>
     Update the package management tools with the old SUSE Linux Enterprise repositories:
    </p><div class="verbatim-wrap"><pre class="screen">sudo <code class="command">zypper</code> patch --updatestack-only</pre></div></li><li class="step"><p>
     If the system is registered, it needs to be de-registered:
    </p><div class="verbatim-wrap"><pre class="screen">sudo <code class="command">SUSEConnect</code> --de-register</pre></div></li><li class="step"><p>
     Remove the old installation sources and repositories and adjust the
     third-party repositories.
    </p></li><li class="step"><p>
     Add the new installation sources, be it local or remote sources (for the
     placeholder <em class="replaceable">REPOSITORY</em>, refer to
     <a class="xref" href="cha-update-background.html#sec-update-nmm-repositories" title="19.7. Repository Model">Section 19.7, “Repository Model”</a>):
    </p><div class="verbatim-wrap"><pre class="screen">sudo <code class="command">zypper</code> addrepo <em class="replaceable">REPOSITORY</em></pre></div><p>
     You can also use SUSE Customer Center or Subscription Management Tool. The command for SUSE Linux Enterprise 12 SP1 on x86-64
     is:
    </p><div class="verbatim-wrap"><pre class="screen">sudo <code class="command">SUSEConnect</code> -p SLES/12.2/x86_64 <em class="replaceable">OPTIONS</em></pre></div><p>
     Keep in mind, cross-architecture upgrades are not supported.
    </p><p>
     Zypper will display a conflict between the old and new kernel. Choose
     Solution 1 to continue.
    </p><div class="verbatim-wrap"><pre class="screen">Problem: product:SLES-12.2-0.x86_64 conflicts with kernel &lt; 4.4 provided by kernel-default-<em class="replaceable">VERSION</em>
 Solution 1: Following actions will be done:
  replacement of kernel-default-<em class="replaceable">VERSION</em> with kernel-default-<em class="replaceable">VERSION</em>
  deinstallation of kernel-default-<em class="replaceable">VERSION</em>
 Solution 2: do not install product:SLES-12.2-0.x86_64</pre></div></li><li class="step"><p>
     Finalize the migration:
    </p><div class="verbatim-wrap"><pre class="screen">sudo <code class="command">zypper</code> ref -f -s
sudo <code class="command">zypper</code> dup --no-allow-vendor-change --no-recommends</pre></div><p>
     The first command will update all services and repositories. The second
     command performs a distribution upgrade. Here, the last two options are
     important: <code class="option">-no-allow-vendor-change</code> ensures that
     third-party RPMs will not overwrite RPMs from the base system. The option
     <code class="option">--no-recommends</code> ensures that packages deselected during
     initial installation will not be added again.
    </p></li></ol></div></div></section><section class="sect1" id="sec-update-migr-rollback" data-id-title="Rolling Back a Service Pack"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">22.7 </span><span class="title-name">Rolling Back a Service Pack</span></span> <a title="Permalink" class="permalink" href="cha-update-online.html#sec-update-migr-rollback">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/sle_update_online.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   If a service pack does not work for you, SUSE Linux Enterprise supports reverting the system
   to the state before the service pack migration was started. Prerequisite is
   a Btrfs root partition with snapshots enabled (this is the default when
   installing SLES 12). See <span class="intraxref">Book “Administration Guide”, Chapter 7 “System Recovery and Snapshot Management with Snapper”</span> for details.
  </p><div class="procedure" id="pro-update-migr-rollback"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
     Get a list of all Snapper snapshots:
    </p><div class="verbatim-wrap"><pre class="screen">sudo snapper list</pre></div><p>
     Review the output to locate the snapshot that was created immediately
     before the service pack migration was started. The column
     <span class="guimenu">Description</span> contains a corresponding statement and the
     snapshot is marked as <code class="literal">important</code> in the column
     <span class="guimenu">Userdata</span>. Memorize the snapshot number from the column
     <span class="guimenu">#</span> and its date from the column
     <span class="guimenu">Date</span>.
    </p></li><li class="step"><p>
     Reboot the system. From the boot menu, select <span class="guimenu">Start boot loader
     from a read-only snapshot</span> and then choose the snapshot with the
     date and number you memorized in the previous step. A second boot menu
     (the one from the snapshot) is loaded. Select the entry starting with
     <code class="literal">SLES 12</code> and boot it.
    </p></li><li class="step"><p>
     The system boots into the previous state with the system partition mounted
     read-only. Log in as <code class="systemitem">root</code> and check whether you have chosen the
     correct snapshot. Also make sure everything works as expected. Note that
     since the root file system is mounted read-only, restrictions
     in functionality may apply.
    </p><p>
     In case of problems or if you have booted the wrong snapshot, reboot
     and choose a different snapshot to boot from—up to this point no
     permanent changes have been made. If the snapshot is correct and works as
     expected, make the change permanent by running the following command:
    </p><div class="verbatim-wrap"><pre class="screen">snapper rollback</pre></div><p>
     Reboot afterward. On the boot screen, choose the default boot entry to
     reboot into the reinstated system.
    </p></li><li class="step"><p>
     Check if the repository configuration has been properly
     reset. Furthermore, check if all products are properly registered. If
     either one is not the case, updating the system at a later point in time
     may no longer work, or the system may be updated using the wrong package
     repositories.
    </p><p>
     Make sure the system can access the Internet before starting
     this procedure.
    </p><ol type="a" class="substeps"><li class="step"><p>
       Refresh services and repositories by running
      </p><div class="verbatim-wrap"><pre class="screen">sudo zypper ref -fs</pre></div></li><li class="step"><p>
       Get a list of active repositories by running
      </p><div class="verbatim-wrap"><pre class="screen">sudo zypper lr</pre></div><p>
       Carefully check the output of this command. No services and repositories
       that were added for the update should be listed. If you, for example,
       are rolling back from a service pack migration from SLES 12 SP1 to
       SLES 12 SP2, the list must <span class="emphasis"><em>not</em></span> contain the
       repositories <code class="literal">SLES12-SP2-Pool</code> and
       <code class="literal">SLES12-SP2-Updates</code>, but rather the
       <code class="literal">SP1</code> versions.
      </p><p>
       If wrong repositories are listed, delete them and, if
       necessary, replace them with the versions matching your product or
       service pack version. For a list of repositories for the supported
       migration paths refer to <a class="xref" href="cha-update-background.html#sec-update-nmm-repositories" title="19.7. Repository Model">Section 19.7, “Repository Model”</a>.
      </p></li><li class="step"><p>
       Last, check the registration status for all products installed by
       running
      </p><div class="verbatim-wrap"><pre class="screen">SUSEConnect --status</pre></div><p>
       All products should be reported as being
       <code class="literal">Registered</code>. If this is not the case, repair the
       registration by running
      </p><div class="verbatim-wrap"><pre class="screen">SUSEConnect --rollback</pre></div></li></ol></li></ol></div></div><p>
   Now you have successfully reverted the system to the state that was captured
   immediately before the service pack migration was started.
  </p></section></section><nav class="bottom-pagination"><div><a class="pagination-link prev" href="cha-update-offline.html"><span class="pagination-relation">Previous</span><span class="pagination-label"><span class="title-number">Chapter 21 </span>Upgrading Offline</span></a> </div><div><a class="pagination-link next" href="cha-update-backporting.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Chapter 23 </span>Backporting Source Code</span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="sect1"><a href="cha-update-online.html#sec-update-migr-conceptual-overview"><span class="title-number">22.1 </span><span class="title-name">Conceptual Overview</span></a></span></li><li><span class="sect1"><a href="cha-update-online.html#sec-update-migr-workflow"><span class="title-number">22.2 </span><span class="title-name">Service Pack Migration Workflow</span></a></span></li><li><span class="sect1"><a href="cha-update-online.html#sec-update-migr-cancel-spm"><span class="title-number">22.3 </span><span class="title-name">Canceling Service Pack Migration</span></a></span></li><li><span class="sect1"><a href="cha-update-online.html#sec-update-migr-yast-onlinemigr"><span class="title-number">22.4 </span><span class="title-name">Upgrading with the Online Migration Tool (YaST)</span></a></span></li><li><span class="sect1"><a href="cha-update-online.html#sec-update-migr-zypper-onlinemigr"><span class="title-number">22.5 </span><span class="title-name">Upgrading with Zypper</span></a></span></li><li><span class="sect1"><a href="cha-update-online.html#sec-update-migr-plainzypper-onlinemigr"><span class="title-number">22.6 </span><span class="title-name">Upgrading with Plain Zypper</span></a></span></li><li><span class="sect1"><a href="cha-update-online.html#sec-update-migr-rollback"><span class="title-number">22.7 </span><span class="title-name">Rolling Back a Service Pack</span></a></span></li></ul></div><div class="side-title">Share this page</div><ul class="share"><li><a id="_share-fb" href="#" title="Facebook"> </a></li><li><a id="_share-in" href="#" title="LinkedIn"> </a></li><li><a id="_share-tw" href="#" title="Twitter/X"> </a></li><li><a id="_share-mail" href="#" title="E-Mail"> </a></li><li><a id="_print-button" href="#" title="Print this page"> </a></li></ul> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2024</span></div></div></footer></body></html>