<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><title>SLES 12 SP5 | AutoYaST | Rules and Classes</title><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"/>
<meta name="title" content="Rules and Classes | SLES 12 SP5"/>
<meta name="description" content=""/>
<meta name="product-name" content="SUSE Linux Enterprise Server"/>
<meta name="product-number" content="12 SP5"/>
<meta name="book-title" content="AutoYaST"/>
<meta name="chapter-title" content="Chapter 5. Rules and Classes"/>
<meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi"/>
<meta name="tracker-type" content="bsc"/>
<meta name="tracker-bsc-assignee" content="fs@suse.com"/>
<meta name="tracker-bsc-component" content="Documentation"/>
<meta name="tracker-bsc-product" content="SUSE Linux Enterprise Server 12 SP5"/>
<meta name="publisher" content="SUSE"/><meta property="og:title" content="AutoYaST Guide"/>
<meta property="og:description" content="Automate SLES installation with AutoYaST"/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="AutoYaST Guide"/>
<meta name="twitter:description" content="Automate SLES installation with AutoYaST"/>
<script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": ["TechArticle"],
    "image": "https://www.suse.com/assets/img/suse-white-logo-green.svg",
    
     "isPartOf": {
      "@type": "CreativeWorkSeries",
      "name": "Products &amp; Solutions"
    },
    
    "inLanguage": "en",
    

    "headline": "Rules and Classes",
  
    "description": "Rules and Classes",
      
    "author": [
      {
        "@type": "Corporation",
        "name": "SUSE Product &amp; Solution Documentation Team",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    ],
      
    "dateModified": "2019-12-09T00:00+02:00",
      
    "datePublished": "2019-12-09T00:00+02:00",
      

    "about": [
      
    ],
  
    "sameAs": [
          "https://www.facebook.com/SUSEWorldwide/about",
          "https://www.youtube.com/channel/UCHTfqIzPKz4f_dri36lAQGA",
          "https://twitter.com/SUSE",
          "https://www.linkedin.com/company/suse"
    ],
    "publisher": {
      "@type": "Corporation",
      "name": "SUSE",
      "url": "https://documentation.suse.com",
      "logo": {
        "@type": "ImageObject",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    }
  }</script>
<link rel="prev" href="configuration.html" title="Chapter 4. Configuration and Installation Options"/><link rel="next" href="Invoking.html" title="Chapter 6. The Auto-Installation Process"/><script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/script-purejs.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script><meta name="edit-url" content="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/ay_bigfile.xml"/></head><body class="draft wide offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"><img src="static/images/logo.svg" alt="Logo" class="logo"/></div></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">AutoYaST</a><span> / </span><a class="crumb" href="rulesandclass.html">Rules and Classes</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title">AutoYaST</div><ol><li><a href="introduction.html" class=" "><span class="title-number">1 </span><span class="title-name">Introduction</span></a></li><li><a href="Profile.html" class=" "><span class="title-number">2 </span><span class="title-name">The Control File</span></a></li><li><a href="CreateProfile.html" class=" "><span class="title-number">3 </span><span class="title-name">Creating a Control File</span></a></li><li><a href="configuration.html" class=" "><span class="title-number">4 </span><span class="title-name">Configuration and Installation Options</span></a></li><li><a href="rulesandclass.html" class=" you-are-here"><span class="title-number">5 </span><span class="title-name">Rules and Classes</span></a></li><li><a href="Invoking.html" class=" "><span class="title-number">6 </span><span class="title-name">The Auto-Installation Process</span></a></li><li><a href="InstalledSystem.html" class=" "><span class="title-number">7 </span><span class="title-name">Running AutoYaST in an Installed System</span></a></li><li><a href="handlingrules.html" class=" "><span class="title-number">A </span><span class="title-name">Handling Rules</span></a></li><li><a href="app-ay-faq.html" class=" "><span class="title-number">B </span><span class="title-name">AutoYaST FAQ - Frequently Asked Questions</span></a></li><li><a href="appendix-linuxrc.html" class=" "><span class="title-number">C </span><span class="title-name">Advanced Linuxrc Options</span></a></li><li><a href="bk04apd.html" class=" "><span class="title-number">D </span><span class="title-name">GNU licenses</span></a></li> </ol> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section class="chapter" id="rulesandclass" data-id-title="Rules and Classes"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname"><span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span></span> <span class="productnumber"><span class="productnumber">12 SP5</span></span></div><div><div class="title-container"><h1 class="title"><span class="title-number-name"><span class="title-number">5 </span><span class="title-name">Rules and Classes</span></span> <a title="Permalink" class="permalink" href="rulesandclass.html#">#</a></h1><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/ay_bigfile.xml" title="Edit source document"> </a></div></div></div></div></div><section class="sect1" id="rules" data-id-title="Rules-based Automatic Installation"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">5.1 </span><span class="title-name">Rules-based Automatic Installation</span></span> <a title="Permalink" class="permalink" href="rulesandclass.html#rules">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/ay_bigfile.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    Rules offer the possibility to configure a system depending on system
    attributes by merging multiple control files during installation. The
    rules-based installation is controlled by a rules file. This is useful
    to install, for example, systems in two departments in one go. Assume a
    scenario where machines in department A need to be installed as office
    desktops, whereas machines in department B need to be installed as
    developer workstations. You would create a rules file with two different
    rules. For each rule, you could use different system parameters to
    distinguish the installations from one another. Each rule would also
    contain a link to an appropriate profile for each department.
   </p><p>
    The rules file is an XML file containing rules for each group of systems
    (or single systems) that you want to automatically install. A set of
    rules distinguish a group of systems based on one or more system
    attributes. After passing all rules, each group of systems is linked to
    a control file. Both the rules file and the control files must be
    located in a pre-defined and accessible location.
   </p><p>
    The rules file is retrieved only if no specific control file is supplied
    using the <code class="literal">autoyast</code> keyword. For example, if the
    following is used, the rules file will not be evaluated:
   </p><div class="verbatim-wrap"><pre class="screen">autoyast=http://10.10.0.1/profile/myprofile.xml
autoyast=http://10.10.0.1/profile/rules/rules.xml</pre></div><p>
    Instead use:
   </p><div class="verbatim-wrap"><pre class="screen">autoyast=http://10.10.0.1/profile/</pre></div><p>
    which will load
    <code class="literal">http://10.10.0.1/profile/rules/rules.xml</code> (the slash
    at the end of the directory name is important).
   </p><div class="figure" id="rules-fig1"><div class="figure-contents"><div class="mediaobject"><a href="images/autoyast_rules.png"><img src="images/autoyast_rules.png" alt="Rules" title="Rules"/></a></div></div><div class="title-container"><div class="figure-title-wrap"><div class="figure-title"><span class="title-number-name"><span class="title-number">Figure 5.1: </span><span class="title-name">Rules </span></span><a title="Permalink" class="permalink" href="rulesandclass.html#rules-fig1">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/ay_bigfile.xml" title="Edit source document"> </a></div></div></div><p>
    If more than one rule applies, the final control file for each group is
    generated on the fly using a merge script. The merging process is based
    on the order of the rules and later rules override configuration data in
    earlier rules. Note that the names of the top sections in the merged xml
    files need to be in alphabetical order for the merge to succeed.
   </p><p>
    The use of a rules file is optional. If the rules file is not found,
    system installation proceeds in the standard way by using the
    supplied control file or by searching for the control file depending on
    the MAC or the IP address of the system.
   </p><section class="sect2" id="rulesfile" data-id-title="Rules File Explained"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">5.1.1 </span><span class="title-name">Rules File Explained</span></span> <a title="Permalink" class="permalink" href="rulesandclass.html#rulesfile">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/ay_bigfile.xml" title="Edit source document"> </a></div></div></div></div></div><div class="complex-example"><div class="example" id="id-1.6.6.4.12.2" data-id-title="Simple Rules File"><div class="title-container"><div class="example-title-wrap"><div class="example-title"><span class="title-number-name"><span class="title-number">Example 5.1: </span><span class="title-name">Simple Rules File </span></span><a title="Permalink" class="permalink" href="rulesandclass.html#id-1.6.6.4.12.2">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/ay_bigfile.xml" title="Edit source document"> </a></div></div><div class="example-contents"><p>
      The following simple example illustrates how the rules file is used to
      retrieve the configuration for a client with known hardware.
     </p><div class="verbatim-wrap"><pre class="screen">&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE autoinstall&gt;
&lt;autoinstall xmlns="http://www.suse.com/1.0/yast2ns" xmlns:config="http://www.suse.com/1.0/configns"&gt;
  &lt;rules config:type="list"&gt;
    &lt;rule&gt;
       &lt;disksize&gt;
            &lt;match&gt;/dev/sdc 1000&lt;/match&gt;
            &lt;match_type&gt;greater&lt;/match_type&gt;
       &lt;/disksize&gt;
       &lt;result&gt;
            &lt;profile&gt;department_a.xml&lt;/profile&gt;
            &lt;continue config:type="boolean"&gt;false&lt;/continue&gt;
        &lt;/result&gt;
    &lt;/rule&gt;
    &lt;rule&gt;
       &lt;disksize&gt;
            &lt;match&gt;/dev/sda 1000&lt;/match&gt;
            &lt;match_type&gt;greater&lt;/match_type&gt;
       &lt;/disksize&gt;
       &lt;result&gt;
            &lt;profile&gt;department_b.xml&lt;/profile&gt;
            &lt;continue config:type="boolean"&gt;false&lt;/continue&gt;
        &lt;/result&gt;
    &lt;/rule&gt;
  &lt;/rules&gt;
&lt;/autoinstall&gt;</pre></div></div></div></div><p>
     The last example defines two rules and provides a different control
     file for every rule. The rule used in this case is
     <code class="literal">disksize</code>. After parsing the rules file, YaST
     attempts to match the target system with the rules in the
     <code class="filename">rules.xml</code> file. A rule match occurs when the
     target system matches all system attributes defined in the rule. When the system matches a rule, the respective resource is added to
     the stack of control files AutoYaST will use to create the final control
     file. The <code class="literal">continue</code> property tells AutoYaST whether it
     should continue with other rules after a match has been found.
    </p><p>
     If the first rule does not match, the next rule in the list is examined
     until a match is found.
    </p><p>
     Using the <code class="literal">disksize</code> attribute, you can provide
     different configurations for systems with hard disks of different
     sizes. The first rule checks if the device
     <code class="filename">/dev/sdc</code> is available and if it is greater than 1
     GB in size using the <code class="literal">match</code> property.
    </p><p>
     A rule must have at least one attribute to be matched. If you need to
     check more attributes, such as memory or architectures, you can add
     more attributes in the rule resource as shown in the next example.
    </p><div class="complex-example"><div class="example" id="id-1.6.6.4.12.7" data-id-title="Simple Rules File"><div class="title-container"><div class="example-title-wrap"><div class="example-title"><span class="title-number-name"><span class="title-number">Example 5.2: </span><span class="title-name">Simple Rules File </span></span><a title="Permalink" class="permalink" href="rulesandclass.html#id-1.6.6.4.12.7">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/ay_bigfile.xml" title="Edit source document"> </a></div></div><div class="example-contents"><p>
      The following example illustrates how the rules file is used to
      retrieve the configuration for a client with known hardware.
     </p><div class="verbatim-wrap"><pre class="screen">&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE autoinstall&gt;
&lt;autoinstall xmlns="http://www.suse.com/1.0/yast2ns" xmlns:config="http://www.suse.com/1.0/configns"&gt;
  &lt;rules config:type="list"&gt;
    &lt;rule&gt;
       &lt;disksize&gt;
            &lt;match&gt;/dev/sdc 1000&lt;/match&gt;
            &lt;match_type&gt;greater&lt;/match_type&gt;
       &lt;/disksize&gt;
       &lt;memsize&gt;
            &lt;match&gt;1000&lt;/match&gt;
            &lt;match_type&gt;greater&lt;/match_type&gt;
       &lt;/memsize&gt;
       &lt;result&gt;
            &lt;profile&gt;department_a.xml&lt;/profile&gt;
            &lt;continue config:type="boolean"&gt;false&lt;/continue&gt;
        &lt;/result&gt;
    &lt;/rule&gt;
    &lt;rule&gt;
       &lt;disksize&gt;
            &lt;match&gt;/dev/shda 1000&lt;/match&gt;
            &lt;match_type&gt;greater&lt;/match_type&gt;
       &lt;/disksize&gt;
       &lt;memsize&gt;
            &lt;match&gt;256&lt;/match&gt;
            &lt;match_type&gt;greater&lt;/match_type&gt;
       &lt;/memsize&gt;
       &lt;result&gt;
            &lt;profile&gt;department_b.xml&lt;/profile&gt;
            &lt;continue config:type="boolean"&gt;false&lt;/continue&gt;
        &lt;/result&gt;
    &lt;/rule&gt;
  &lt;/rules&gt;
&lt;/autoinstall&gt;</pre></div></div></div></div><p>
     The rules directory must be located in the same directory specified via
     the <code class="literal">autoyast</code> keyword at boot time. If the client was
     booted using <code class="literal">autoyast=http://10.10.0.1/profiles/</code>,
     AutoYaST will search for the rules file at
     http://10.10.0.1/profiles/rules/rules.xml.
    </p></section><section class="sect2" id="customrules" data-id-title="Custom Rules"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">5.1.2 </span><span class="title-name">Custom Rules</span></span> <a title="Permalink" class="permalink" href="rulesandclass.html#customrules">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/ay_bigfile.xml" title="Edit source document"> </a></div></div></div></div></div><p>
     If the attributes AutoYaST provides for rules are not enough for your
     purposes, use custom rules. Custom rules contain a shell script. The
     output of the script (STDOUT, STDERR is ignored) can be evaluated.
    </p><p>
     Here is an example for the use of custom rules:
    </p><div class="verbatim-wrap"><pre class="screen">&lt;rule&gt;
  &lt;custom1&gt;
    &lt;script&gt;
if grep -i intel /proc/cpuinfo &gt; /dev/null; then
echo -n "intel"
else
echo -n "non_intel"
fi;
    &lt;/script&gt;
    &lt;match&gt;*&lt;/match&gt;
    &lt;match_type&gt;exact&lt;/match_type&gt;
  &lt;/custom1&gt;
  &lt;result&gt;
    &lt;profile&gt;@custom1@.xml&lt;/profile&gt;
    &lt;continue config:type="boolean"&gt;true&lt;/continue&gt;
  &lt;/result&gt;
&lt;/rule&gt;</pre></div><p>
     The script in this rule can echo either <code class="literal">intel</code> or
     <code class="literal">non_intel</code> to STDOUT (the output of the grep command
     must be directed to /dev/null in this case). The output of the rule
     script will be filled between the two '@' characters, to determine the
     file name of the control file to fetch. AutoYaST will read the output and
     fetch a file with the name <code class="filename">intel.xml</code> or
     <code class="filename">non_intel.xml</code>. This file can contain the AutoYaST
     profile part for the software selection; for example, in case you want
     a different software selection on intel hardware than on others.
    </p><p>
     The number of custom rules is limited to five. So you can use
     <code class="literal">custom1</code> to <code class="literal">custom5</code>.
    </p></section><section class="sect2" id="matchtypes" data-id-title="Match Types for Rules"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">5.1.3 </span><span class="title-name">Match Types for Rules</span></span> <a title="Permalink" class="permalink" href="rulesandclass.html#matchtypes">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/ay_bigfile.xml" title="Edit source document"> </a></div></div></div></div></div><p>
     You can use five different match_types:
    </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
       <code class="literal">exact</code> (default)
      </p></li><li class="listitem"><p>
       <code class="literal">greater</code>
      </p></li><li class="listitem"><p>
       <code class="literal">lower</code>
      </p></li><li class="listitem"><p>
       <code class="literal">range</code>
      </p></li><li class="listitem"><p>
       <code class="literal">regex</code> (a simple <code class="literal">=~</code> operator
       like in Bash)
      </p></li></ul></div><p>
     If using <code class="literal">exact</code>, the string must match exactly as
     specified. <code class="literal">regex</code> can be used to match substrings
     like <code class="literal">ntel</code> will match Intel, intel and intelligent.
     <code class="literal">greater</code> and <code class="literal">lower</code> can be used for
     <code class="literal">memsize</code> or <code class="literal">totaldisk</code> for example. They can match only with rules that
     return an integer value. A range is only possible for integer values
     too and has the form of <code class="literal">value1-value2</code>, for example
     <code class="literal">512-1024</code>.
    </p></section><section class="sect2" id="rulescombination" data-id-title="Combine Attributes"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">5.1.4 </span><span class="title-name">Combine Attributes</span></span> <a title="Permalink" class="permalink" href="rulesandclass.html#rulescombination">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/ay_bigfile.xml" title="Edit source document"> </a></div></div></div></div></div><p>
     Multiple attributes can be combined via a logical operator. It is
     possible to let a rule match if <code class="literal">disksize</code> is greater than 1GB or <code class="literal">memsize</code>
     is exactly 512MB.
    </p><p>
     You can do this with the <code class="literal">operator</code> element in the
     rules.xml file. <code class="literal">and</code> and <code class="literal">or</code> are
     possible operators, <code class="literal">and</code> being the default. Here is
     an example:
    </p><div class="verbatim-wrap"><pre class="screen">&lt;rule&gt;
  &lt;disksize&gt;
    &lt;match&gt;/dev/sda 1000&lt;/match&gt;
    &lt;match_type&gt;greater&lt;/match_type&gt;
  &lt;/disksize&gt;
  &lt;memsize&gt;
    &lt;match&gt;256&lt;/match&gt;
    &lt;match_type&gt;greater&lt;/match_type&gt;
  &lt;/memsize&gt;
  &lt;result&gt;
    &lt;profile&gt;machine2.xml&lt;/profile&gt;
    &lt;continue config:type="boolean"&gt;false&lt;/continue&gt;
  &lt;/result&gt;
  &lt;operator&gt;or&lt;/operator&gt;
&lt;/rule&gt;</pre></div></section><section class="sect2" id="rulesstructure" data-id-title="Rules File Structure"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">5.1.5 </span><span class="title-name">Rules File Structure</span></span> <a title="Permalink" class="permalink" href="rulesandclass.html#rulesstructure">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/ay_bigfile.xml" title="Edit source document"> </a></div></div></div></div></div><p>
     The <code class="filename">rules.xml</code> file needs to:
    </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
       have at least one rule,
      </p></li><li class="listitem"><p>
       have the name <code class="filename">rules.xml</code>,
      </p></li><li class="listitem"><p>
       be located in the directory <code class="filename">rules</code> in the profile
       repository,
      </p></li><li class="listitem"><p>
       have at least one attribute to match in the rule.
      </p></li></ul></div></section><section class="sect2" id="ruleattributes" data-id-title="Predefined System Attributes"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">5.1.6 </span><span class="title-name">Predefined System Attributes</span></span> <a title="Permalink" class="permalink" href="rulesandclass.html#ruleattributes">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/ay_bigfile.xml" title="Edit source document"> </a></div></div></div></div></div><p>
     The following table lists the predefined system attributes you can
     match in the rules file.
    </p><p>
     If you are unsure about a value on your system, run
     <code class="command">/usr/lib/YaST/bin/y2base ayast_probe ncurses</code>.
     The text box displaying the detected values can be scrolled. Note that
     this command will not work while another YaST process that
     requires a lock (for example the installer) is running. Therefore you
     cannot run it during the installation.
    </p><div class="table" id="id-1.6.6.4.17.4" data-id-title="System Attributes"><div class="title-container"><div class="table-title-wrap"><div class="table-title"><span class="title-number-name"><span class="title-number">Table 5.1: </span><span class="title-name">System Attributes </span></span><a title="Permalink" class="permalink" href="rulesandclass.html#id-1.6.6.4.17.4">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/ay_bigfile.xml" title="Edit source document"> </a></div></div><div class="table-contents"><table style="border-collapse: collapse; border-top: 1px solid ; border-bottom: 1px solid ; border-left: 1px solid ; border-right: 1px solid ; "><colgroup><col/><col/><col/></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          Attribute
         </p>
        </th><th style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          Values
         </p>
        </th><th style="border-bottom: 1px solid ; ">
         <p>
          Description
         </p>
        </th></tr></thead><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          <code class="literal">hostaddress</code>
         </p>
        </td><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          IP address of the host
         </p>
        </td><td style="border-bottom: 1px solid ; ">
         <p>
          This attribute must always match exactly.
         </p>
        </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          <code class="literal">host name</code>
         </p>
        </td><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          The name of the host
         </p>
        </td><td style="border-bottom: 1px solid ; ">
         <p>
          This attribute must always match exactly.
         </p>
        </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          <code class="literal">domain</code>
         </p>
        </td><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          Domain name of host
         </p>
        </td><td style="border-bottom: 1px solid ; ">
         <p>
          This attribute must always match exactly.
         </p>
        </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          <code class="literal">installed_product</code>
         </p>
        </td><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          The name of the product to be installed.
         </p>
        </td><td style="border-bottom: 1px solid ; ">
         <p>
          This attribute must always match exactly.
         </p>
        </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          <code class="literal">installed_product_version</code>
         </p>
        </td><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          The version of the product to be installed.
         </p>
        </td><td style="border-bottom: 1px solid ; ">
         <p>
          This attribute must always match exactly.
         </p>
        </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          <code class="literal">network</code>
         </p>
        </td><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          network address of host
         </p>
        </td><td style="border-bottom: 1px solid ; ">
         <p>
          This attribute must always match exactly.
         </p>
        </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          <code class="literal">mac</code>
         </p>
        </td><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          MAC address of host
         </p>
        </td><td style="border-bottom: 1px solid ; ">
         <p>
          This attribute must always match exactly (the MAC addresses should
          have the form <code class="literal">0080c8f6484c</code>).
         </p>
        </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          <code class="literal">linux</code>
         </p>
        </td><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          Number of installed Linux partitions on the system
         </p>
        </td><td style="border-bottom: 1px solid ; ">
         <p>
          This attribute can be 0 or more.
         </p>
        </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          <code class="literal">others</code>
         </p>
        </td><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          Number of installed non-Linux partitions on the system
         </p>
        </td><td style="border-bottom: 1px solid ; ">
         <p>
          This attribute can be 0 or more.
         </p>
        </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          <code class="literal">xserver</code>
         </p>
        </td><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          X Server needed for graphic adapter
         </p>
        </td><td style="border-bottom: 1px solid ; ">
         <p>
          This attribute must always match exactly.
         </p>
        </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          <code class="literal">memsize</code>
         </p>
        </td><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          Memory available on host in MBytes
         </p>
        </td><td style="border-bottom: 1px solid ; ">
         <p>
          All match types are available.
         </p>
        </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          <code class="literal">totaldisk</code>
         </p>
        </td><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          Total disk space available on host in MBytes
         </p>
        </td><td style="border-bottom: 1px solid ; ">
         <p>
          All match types are available.
         </p>
        </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          <code class="literal">hostid</code>
         </p>
        </td><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          Hex representation of the IP address
         </p>
        </td><td style="border-bottom: 1px solid ; ">
         <p>
          Exact match required
         </p>
        </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          <code class="literal">arch</code>
         </p>
        </td><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          Architecture of host
         </p>
        </td><td style="border-bottom: 1px solid ; ">
         <p>
          Exact match required
         </p>
        </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          <code class="literal">karch</code>
         </p>
        </td><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          Kernel Architecture of host (for example SMP kernel, Xen
          kernel)
         </p>
         
        </td><td style="border-bottom: 1px solid ; ">
         <p>
          Exact match required
         </p>
        </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          <code class="literal">disksize</code>
         </p>
        </td><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          Drive device and size
         </p>
        </td><td style="border-bottom: 1px solid ; ">
         <p>
          All match types are available.
         </p>
        </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          <code class="literal">product</code>
         </p>
        </td><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          The hardware product name as specified in SMBIOS
         </p>
        </td><td style="border-bottom: 1px solid ; ">
         <p>
          Exact match required
         </p>
        </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          <code class="literal">product_vendor</code>
         </p>
        </td><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          The hardware vendor as specified in SMBIOS
         </p>
        </td><td style="border-bottom: 1px solid ; ">
         <p>
          Exact match required
         </p>
        </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          <code class="literal">board</code>
         </p>
        </td><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          The system board name as specified in SMBIOS
         </p>
        </td><td style="border-bottom: 1px solid ; ">
         <p>
          Exact match required
         </p>
        </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          <code class="literal">board_vendor</code>
         </p>
        </td><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          The system board vendor as specified in SMBIOS
         </p>
        </td><td style="border-bottom: 1px solid ; ">
         <p>
          Exact match required
         </p>
        </td></tr><tr><td style="border-right: 1px solid ; ">
         <p>
          <code class="literal">custom1-5</code>
         </p>
        </td><td style="border-right: 1px solid ; ">
         <p>
          Custom rules using shell scripts
         </p>
        </td><td>
         <p>
          All match types are available.
         </p>
        </td></tr></tbody></table></div></div></section><section class="sect2" id="rules-dialogs" data-id-title="Rules with Dialogs"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">5.1.7 </span><span class="title-name">Rules with Dialogs</span></span> <a title="Permalink" class="permalink" href="rulesandclass.html#rules-dialogs">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/ay_bigfile.xml" title="Edit source document"> </a></div></div></div></div></div><p>
     You can use dialog pop-ups with check boxes to select rules you want
     matched.
    </p><p>
     The elements listed below must be placed within the following XML
     structure in the <code class="filename">rules.xml</code> file:
    </p><div class="verbatim-wrap"><pre class="screen">&lt;rules config:type="list"&gt;
  &lt;rule&gt;
    &lt;dialog&gt;
      ...
    &lt;/dialog&gt;
  &lt;/rule&gt;
&lt;/rules&gt;</pre></div><div class="informaltable"><table style="border-collapse: collapse; border-top: 1px solid ; border-bottom: 1px solid ; border-left: 1px solid ; border-right: 1px solid ; "><colgroup><col/><col/><col/></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          Attribute
         </p>
        </th><th style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          Values
         </p>
        </th><th style="border-bottom: 1px solid ; ">
         <p>
          Description
         </p>
        </th></tr></thead><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          <code class="literal">dialog_nr</code>
         </p>
        </td><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          All rules with the same <code class="literal">dialog_nr</code> are presented
          in the same pop-up dialog. The same <code class="literal">dialog_nr</code>
          can appear in multiple rules.
         </p>
<div class="verbatim-wrap"><pre class="screen">&lt;dialog_nr config:type="integer"&gt;3&lt;/dialog_nr&gt;</pre></div>
        </td><td style="border-bottom: 1px solid ; ">
         <p>
          This element is optional and the default for a missing dialog_nr
          is always <code class="literal">0</code>. To use one pop-up for
          all rules, you do not need to specify the
          <code class="literal">dialog_nr</code>.
         </p>
        </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          <code class="literal">element</code>
         </p>
        </td><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          Specify a unique ID. Even if you have more than one dialog, you
          must not use the same id twice. Using id <code class="literal">1</code> on
          dialog 1 and id <code class="literal">1</code> on dialog 2 is not supported.
          (This behavior is contrary to the <code class="literal">ask</code> dialog,
          where you can have the same ID for multiple dialogs.)
         </p>
<div class="verbatim-wrap"><pre class="screen">&lt;element config:type="integer"&gt;3&lt;/element&gt;</pre></div>
        </td><td style="border-bottom: 1px solid ; ">
         <p>
          Optional. If left out, AutoYaST adds its own ids internally. Then
          you cannot specify conflicting rules (see below).
         </p>
        </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          <code class="literal">title</code>
         </p>
        </td><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          Caption of the pop-up dialog
         </p>
<div class="verbatim-wrap"><pre class="screen">&lt;title&gt;Desktop Selection&lt;/title&gt;</pre></div>
        </td><td style="border-bottom: 1px solid ; ">
         <p>
          Optional
         </p>
        </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          <code class="literal">question</code>
         </p>
        </td><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          Question shown in the pop-up behind the check box.
         </p>
<div class="verbatim-wrap"><pre class="screen">&lt;question&gt;GNOME Desktop&lt;/question&gt;</pre></div>
        </td><td style="border-bottom: 1px solid ; ">
         <p>
          Optional. If you do not configure a text here, the name of the XML
          file that is triggered by this rule will be shown instead.
         </p>
        </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          <code class="literal">timeout</code>
         </p>
        </td><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
         <p>
          Timeout in seconds after which the dialog will automatically
          <span class="quote">“<span class="quote">press</span>”</span> the okay button. Useful for a non-blocking
          installation in combination with rules dialogs.
         </p>
<div class="verbatim-wrap"><pre class="screen">&lt;timeout config:type="integer"&gt;30&lt;/timeout&gt;</pre></div>
        </td><td style="border-bottom: 1px solid ; ">
         <p>
          Optional. A missing timeout will stop the installation process
          until the dialog is confirmed by the user.
         </p>
        </td></tr><tr><td style="border-right: 1px solid ; ">
         <p>
          <code class="literal">conflicts</code>
         </p>
        </td><td style="border-right: 1px solid ; ">
         <p>
          A list of element ids (rules) that conflict with this rule. If
          this rule matches or is selected by the user, all conflicting
          rules are deselected and disabled in the pop-up. Take care that
          you do not create deadlocks.
         </p>
<div class="verbatim-wrap"><pre class="screen">&lt;conflicts config:type="list"&gt;
  &lt;element config:type="integer"&gt;1&lt;/element&gt;
  &lt;element config:type="integer"&gt;5&lt;/element&gt;
  ...
&lt;/conflicts&gt;</pre></div>
        </td><td>
         <p>
          <code class="literal">optional</code>
         </p>
        </td></tr></tbody></table></div><p>
     Here is an example of how to use dialogs with rules:
    </p><div class="verbatim-wrap"><pre class="screen">&lt;rules config:type="list"&gt;
  &lt;rule&gt;
    &lt;custom1&gt;
      &lt;script&gt;
echo -n 100
      &lt;/script&gt;
      &lt;match&gt;100&lt;/match&gt;
      &lt;match_type&gt;exact&lt;/match_type&gt;
    &lt;/custom1&gt;
    &lt;result&gt;
      &lt;profile&gt;rules/gnome.xml&lt;/profile&gt;
      &lt;continue config:type="boolean"&gt;true&lt;/continue&gt;
    &lt;/result&gt;
    &lt;dialog&gt;
      &lt;element config:type="integer"&gt;0&lt;/element&gt;
      &lt;question&gt;GNOME Desktop&lt;/question&gt;
      &lt;title&gt;Desktop Selection&lt;/title&gt;
      &lt;conflicts config:type="list"&gt;
        &lt;element config:type="integer"&gt;1&lt;/element&gt;
      &lt;/conflicts&gt;
      &lt;dialog_nr config:type="integer"&gt;0&lt;/dialog_nr&gt;
    &lt;/dialog&gt;
  &lt;/rule&gt;
  &lt;rule&gt;
    &lt;custom1&gt;
      &lt;script&gt;
echo -n 100
      &lt;/script&gt;
      &lt;match&gt;101&lt;/match&gt;
      &lt;match_type&gt;exact&lt;/match_type&gt;
    &lt;/custom1&gt;
    &lt;result&gt;
      &lt;profile&gt;rules/gnome.xml&lt;/profile&gt;
      &lt;continue config:type="boolean"&gt;true&lt;/continue&gt;
    &lt;/result&gt;
    &lt;dialog&gt;
      &lt;element config:type="integer"&gt;1&lt;/element&gt;
      &lt;dialog_nr config:type="integer"&gt;0&lt;/dialog_nr&gt;
      &lt;question&gt;Gnome Desktop&lt;/question&gt;
      &lt;conflicts config:type="list"&gt;
        &lt;element config:type="integer"&gt;0&lt;/element&gt;
      &lt;/conflicts&gt;
    &lt;/dialog&gt;
  &lt;/rule&gt;
  &lt;rule&gt;
    &lt;custom1&gt;
      &lt;script&gt;
echo -n 100
      &lt;/script&gt;
      &lt;match&gt;100&lt;/match&gt;
      &lt;match_type&gt;exact&lt;/match_type&gt;
    &lt;/custom1&gt;
    &lt;result&gt;
      &lt;profile&gt;rules/all_the_rest.xml&lt;/profile&gt;
      &lt;continue config:type="boolean"&gt;false&lt;/continue&gt;
    &lt;/result&gt;
  &lt;/rule&gt;
&lt;/rules&gt;</pre></div></section></section><section class="sect1" id="classes" data-id-title="Classes"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">5.2 </span><span class="title-name">Classes</span></span> <a title="Permalink" class="permalink" href="rulesandclass.html#classes">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/ay_bigfile.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    Classes represent configurations for groups of target systems. Unlike
    rules, classes need to be configured in the control file. Then classes
    can be assigned to target systems.
   </p><p>
    Here is an example of a class definition:
   </p><div class="verbatim-wrap"><pre class="screen">&lt;classes config:type="list"&gt;
  &lt;class&gt;
    &lt;class_name&gt;TrainingRoom&lt;/class_name&gt;
    &lt;configuration&gt;Software.xml&lt;/configuration&gt;
  &lt;/class&gt;
&lt;/classes&gt;</pre></div><p>
    In the example above, the file <code class="filename">Software.xml</code> must be
    placed in the subdirectory <code class="filename">classes/TrainingRoom/</code> It
    will be fetched from the same place the AutoYaST control file and rules
    were fetched from.
   </p><p>
    If you have multiple control files and those control files share parts,
    better use classes for common parts.

    
    You can also use XIncludes.
   </p><p>
    Using the configuration management system, you can define a set of
    classes. A class definition consists of the following variables:
   </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
      Name: class name
     </p></li><li class="listitem"><p>
      Description:
     </p></li><li class="listitem"><p>
      Order: order (or priority) of the class in the stack of migration
      
     </p></li></ul></div><div class="figure" id="id-1.6.6.5.9"><div class="figure-contents"><div class="mediaobject"><a href="images/cms-class-definitions.png"><img src="images/cms-class-definitions.png" alt="Defining Classes" title="Defining Classes"/></a></div></div><div class="title-container"><div class="figure-title-wrap"><div class="figure-title"><span class="title-number-name"><span class="title-number">Figure 5.2: </span><span class="title-name">Defining Classes </span></span><a title="Permalink" class="permalink" href="rulesandclass.html#id-1.6.6.5.9">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/ay_bigfile.xml" title="Edit source document"> </a></div></div></div><p>
    You can create as many classes as you need, however it is recommended to
    keep the set of classes as small as possible to keep the configuration
    system concise. For example, the following sets of classes can be used:
   </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
      site: classes describing a physical location or site,
     </p></li><li class="listitem"><p>
      machine: classes describing a type of machine,
     </p></li><li class="listitem"><p>
      role: classes describing the function of the machine,
     </p></li><li class="listitem"><p>
      group: classes describing a department or a group within a site or a
      location.
     </p></li></ul></div><p>
    A file saved in a class directory can have the same syntax and format as
    a regular control file but represents a subset of the configuration. For
    example, to create a new control file for a computer with a
    specific network interface, you only need the control file resource that
    controls the configuration of the network. Having multiple
    network types, you can merge the one needed for a special type of
    hardware with other class files and create a new control file which
    suits the system being installed.
    
   </p></section><section class="sect1" id="mixinfrulesclasses" data-id-title="Mixing Rules and Classes"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">5.3 </span><span class="title-name">Mixing Rules and Classes</span></span> <a title="Permalink" class="permalink" href="rulesandclass.html#mixinfrulesclasses">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/ay_bigfile.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    It is possible to mix rules and classes during an auto-installation
    session. For example you can identify a system using rules which contain
    class definitions in them. The process is described in the figure
    <a class="xref" href="handlingrules.html#rulesflow" title="Rules Retrieval Process">Figure A.1, “Rules Retrieval Process”</a>.
   </p><p>
    After retrieving the rules and merging them, the generated control file
    is parsed and checked for class definitions. If classes are defined,
    then the class files are retrieved from the original repository and a
    new merge process is initiated.
   </p></section><section class="sect1" id="merging" data-id-title="Merging of Rules and Classes"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">5.4 </span><span class="title-name">Merging of Rules and Classes</span></span> <a title="Permalink" class="permalink" href="rulesandclass.html#merging">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP5/xml/ay_bigfile.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    With classes and with rules, multiple XML files get merged into one
    resulting XML file. This merging process is often confusing for people,
    because it behaves different than one would expect. First of all, it is
    important to note that the names of the top sections in the merged XML
    files must be in alphabetical order for the merge to succeed.
   </p><p>
    For example, the following two XML parts should be merged:
   </p><div class="verbatim-wrap"><pre class="screen">&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;filesystem config:type="symbol"&gt;swap&lt;/filesystem&gt;
        &lt;format config:type="boolean"&gt;true&lt;/format&gt;
        &lt;mount&gt;swap&lt;/mount&gt;
        &lt;partition_id config:type="integer"&gt;130&lt;/partition_id&gt;
        &lt;size&gt;2000mb&lt;/size&gt;
      &lt;/partition&gt;
      &lt;partition&gt;
        &lt;filesystem config:type="symbol"&gt;xfs&lt;/filesystem&gt;
        &lt;partition_type&gt;primary&lt;/partition_type&gt;
        &lt;size&gt;4Gb&lt;/size&gt;
        &lt;mount&gt;/data&lt;/mount&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
  &lt;/drive&gt;
&lt;/partitioning&gt;</pre></div><div class="verbatim-wrap"><pre class="screen">&lt;partitioning config:type="list"&gt;
  &lt;drive&gt;
    &lt;initialize config:type="boolean"&gt;false&lt;/initialize&gt;
    &lt;partitions config:type="list"&gt;
      &lt;partition&gt;
        &lt;format config:type="boolean"&gt;true&lt;/format&gt;
        &lt;filesystem config:type="symbol"&gt;xfs&lt;/filesystem&gt;
        &lt;mount&gt;/&lt;/mount&gt;
        &lt;partition_id config:type="integer"&gt;131&lt;/partition_id&gt;
        &lt;partition_type&gt;primary&lt;/partition_type&gt;
        &lt;size&gt;max&lt;/size&gt;
      &lt;/partition&gt;
    &lt;/partitions&gt;
    &lt;use&gt;all&lt;/use&gt;
  &lt;/drive&gt;
&lt;/partitioning&gt;</pre></div><p>
    You might expect the control file to contain 3 partitions. This is not
    the case. You will end up with two partitions and the first partition is
    a mix up of the swap and the root partition. Settings configured in both
    partitions, like <code class="literal">mount</code> or <code class="literal">size</code>,
    will be used from the second file. Settings that only exist in the first
    or second partition, will be copied to the merged partition too.
    
   </p><p>
    In this example, you do not want a second <code class="literal">drive</code>. The
    two drives should be merged into one. With regard to partitions, three
    separate ones should be defined. Using the <code class="literal">dont_merge</code>
    method solves the merging problem:
   </p><div class="verbatim-wrap"><pre class="screen">&lt;classes config:type="list"&gt;
  &lt;class&gt;
    &lt;class_name&gt;swap&lt;/class_name&gt;
    &lt;configuration&gt;largeswap.xml&lt;/configuration&gt;
    &lt;dont_merge config:type="list"&gt;
      &lt;element&gt;partition&lt;/element&gt;
    &lt;/dont_merge&gt;
  &lt;/class&gt;
&lt;/classes&gt;</pre></div><div class="verbatim-wrap"><pre class="screen">&lt;rule&gt;
  &lt;board_vendor&gt;
    &lt;match&gt;ntel&lt;/match&gt;
    &lt;match_type&gt;regex&lt;/match_type&gt;
  &lt;/board_vendor&gt;
  &lt;result&gt;
    &lt;profile&gt;classes/largeswap.xml&lt;/profile&gt;
    &lt;continue config:type="boolean"&gt;true&lt;/continue&gt;
    &lt;dont_merge config:type="list"&gt;
      &lt;element&gt;partition&lt;/element&gt;
    &lt;/dont_merge&gt;
  &lt;/result&gt;
  &lt;board_vendor&gt;
    &lt;match&gt;PowerEdge [12]850&lt;/match&gt;
    &lt;match_type&gt;regex&lt;/match_type&gt;
  &lt;/board_vendor&gt;
  &lt;result&gt;
    &lt;profile&gt;classes/smallswap.xml&lt;/profile&gt;
    &lt;continue config:type="boolean"&gt;true&lt;/continue&gt;
    &lt;dont_merge config:type="list"&gt;
      &lt;element&gt;partition&lt;/element&gt;
    &lt;/dont_merge&gt;
  &lt;/result&gt;
&lt;/rule&gt;</pre></div></section></section><nav class="bottom-pagination"><div><a class="pagination-link prev" href="configuration.html"><span class="pagination-relation">Previous</span><span class="pagination-label"><span class="title-number">Chapter 4 </span>Configuration and Installation Options</span></a> </div><div><a class="pagination-link next" href="Invoking.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Chapter 6 </span>The Auto-Installation Process</span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="sect1"><a href="rulesandclass.html#rules"><span class="title-number">5.1 </span><span class="title-name">Rules-based Automatic Installation</span></a></span></li><li><span class="sect1"><a href="rulesandclass.html#classes"><span class="title-number">5.2 </span><span class="title-name">Classes</span></a></span></li><li><span class="sect1"><a href="rulesandclass.html#mixinfrulesclasses"><span class="title-number">5.3 </span><span class="title-name">Mixing Rules and Classes</span></a></span></li><li><span class="sect1"><a href="rulesandclass.html#merging"><span class="title-number">5.4 </span><span class="title-name">Merging of Rules and Classes</span></a></span></li></ul></div><div class="side-title">Share this page</div><ul class="share"><li><a id="_share-fb" href="#" title="Facebook"> </a></li><li><a id="_share-in" href="#" title="LinkedIn"> </a></li><li><a id="_share-tw" href="#" title="Twitter/X"> </a></li><li><a id="_share-mail" href="#" title="E-Mail"> </a></li><li><a id="_print-button" href="#" title="Print this page"> </a></li></ul> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2024</span></div></div></footer></body></html>