<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><title>SLES 15 SP5 | Virtualization Guide | Virtual machine administration using QEMU monitor</title><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"/>
<meta name="title" content="Virtual machine administration using QEMU monitor | SL…"/>
<meta name="description" content="When a virtual machine is invoked by the qemu-system-ARCH command, for example qemu-system-x86_64, a monitor console is provided for performing inter…"/>
<meta name="product-name" content="SUSE Linux Enterprise Server"/>
<meta name="product-number" content="15 SP5"/>
<meta name="book-title" content="Virtualization Guide"/>
<meta name="chapter-title" content="Chapter 37. Virtual machine administration using QEMU monitor"/>
<meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi"/>
<meta name="tracker-type" content="bsc"/>
<meta name="tracker-bsc-assignee" content="fs@suse.com"/>
<meta name="tracker-bsc-component" content="Documentation"/>
<meta name="tracker-bsc-product" content="PUBLIC SUSE Linux Enterprise Server 15 SP5"/>
<meta name="publisher" content="SUSE"/><meta property="og:title" content="Virtualization Guide"/>
<meta property="og:description" content="Learn all about virtualization and VM management"/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Virtualization Guide"/>
<meta name="twitter:description" content="Learn all about virtualization and VM management"/>
<script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": ["TechArticle"],
    "image": "https://www.suse.com/assets/img/suse-white-logo-green.svg",
    
     "isPartOf": {
      "@type": "CreativeWorkSeries",
      "name": "Products &amp; Solutions"
    },
    
    "inLanguage": "en",
    

    "headline": "Virtual machine administration using QEMU monitor",
  
    "description": "Virtual machine administration using QEMU monitor",
      
    "author": [
      {
        "@type": "Corporation",
        "name": "SUSE Product &amp; Solution Documentation Team",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    ],
      
    "dateModified": "2024-05-29T00:00+02:00",
      
    "datePublished": "2023-06-20T00:00+02:00",
      

    "about": [
      
    ],
  
    "sameAs": [
          "https://www.facebook.com/SUSEWorldwide/about",
          "https://www.youtube.com/channel/UCHTfqIzPKz4f_dri36lAQGA",
          "https://twitter.com/SUSE",
          "https://www.linkedin.com/company/suse"
    ],
    "publisher": {
      "@type": "Corporation",
      "name": "SUSE",
      "url": "https://documentation.suse.com",
      "logo": {
        "@type": "ImageObject",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    }
  }</script>
<link rel="prev" href="cha-qemu-running.html" title="Chapter 36. Running virtual machines with qemu-system-ARCH"/><link rel="next" href="part-virt-troubleshoot.html" title="Part VI. Troubleshooting"/><script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/script-purejs.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script><meta name="edit-url" content="https://github.com/SUSE/doc-sle/edit/main/xml/qemu_monitor.xml"/></head><body class="draft wide offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"><img src="static/images/logo.svg" alt="Logo" class="logo"/></div></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">Virtualization Guide</a><span> / </span><a class="crumb" href="part-virt-qemu.html">Managing virtual machines with QEMU</a><span> / </span><a class="crumb" href="cha-qemu-monitor.html">Virtual machine administration using QEMU monitor</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title">Virtualization Guide</div><ol><li><a href="cha-kvm.html" class=" "><span class="title-number"> </span><span class="title-name">Preface</span></a></li><li><a href="part-virt-intro.html" class="has-children "><span class="title-number">I </span><span class="title-name">Introduction</span></a><ol><li><a href="chap-virtualization-introduction.html" class=" "><span class="title-number">1 </span><span class="title-name">Virtualization technology</span></a></li><li><a href="cha-virtualization-scenarios.html" class=" "><span class="title-number">2 </span><span class="title-name">Virtualization scenarios</span></a></li><li><a href="cha-xen-basics.html" class=" "><span class="title-number">3 </span><span class="title-name">Introduction to Xen virtualization</span></a></li><li><a href="cha-kvm-intro.html" class=" "><span class="title-number">4 </span><span class="title-name">Introduction to KVM virtualization</span></a></li><li><a href="cha-tools-intro.html" class=" "><span class="title-number">5 </span><span class="title-name">Virtualization tools</span></a></li><li><a href="cha-vt-installation.html" class=" "><span class="title-number">6 </span><span class="title-name">Installation of virtualization components</span></a></li><li><a href="cha-virt-support.html" class=" "><span class="title-number">7 </span><span class="title-name">Virtualization limits and support</span></a></li></ol></li><li><a href="part-virt-libvirt.html" class="has-children "><span class="title-number">II </span><span class="title-name">Managing virtual machines with <code class="systemitem">libvirt</code></span></a><ol><li><a href="cha-libvirt-overview.html" class=" "><span class="title-number">8 </span><span class="title-name"><code class="systemitem">libvirt</code> daemons</span></a></li><li><a href="cha-libvirt-host.html" class=" "><span class="title-number">9 </span><span class="title-name">Preparing the VM Host Server</span></a></li><li><a href="cha-kvm-inst.html" class=" "><span class="title-number">10 </span><span class="title-name">Guest installation</span></a></li><li><a href="cha-libvirt-managing.html" class=" "><span class="title-number">11 </span><span class="title-name">Basic VM Guest management</span></a></li><li><a href="cha-libvirt-connect.html" class=" "><span class="title-number">12 </span><span class="title-name">Connecting and authorizing</span></a></li><li><a href="cha-libvirt-storage.html" class=" "><span class="title-number">13 </span><span class="title-name">Advanced storage topics</span></a></li><li><a href="cha-libvirt-config-gui.html" class=" "><span class="title-number">14 </span><span class="title-name">Configuring virtual machines with Virtual Machine Manager</span></a></li><li><a href="cha-libvirt-config-virsh.html" class=" "><span class="title-number">15 </span><span class="title-name">Configuring virtual machines with <code class="command">virsh</code></span></a></li><li><a href="sec-libvirt-admin-migrate.html" class=" "><span class="title-number">16 </span><span class="title-name">Migrating VM Guests</span></a></li><li><a href="xen2kvm-migration.html" class=" "><span class="title-number">17 </span><span class="title-name">Xen to KVM migration guide</span></a></li></ol></li><li><a href="part-virt-common.html" class="has-children "><span class="title-number">III </span><span class="title-name">Hypervisor-independent features</span></a><ol><li><a href="cha-cachemodes.html" class=" "><span class="title-number">18 </span><span class="title-name">Disk cache modes</span></a></li><li><a href="sec-kvm-managing-clock.html" class=" "><span class="title-number">19 </span><span class="title-name">VM Guest clock settings</span></a></li><li><a href="chap-guestfs.html" class=" "><span class="title-number">20 </span><span class="title-name">libguestfs</span></a></li><li><a href="cha-qemu-ga.html" class=" "><span class="title-number">21 </span><span class="title-name">QEMU guest agent</span></a></li><li><a href="tpm.html" class=" "><span class="title-number">22 </span><span class="title-name">Software TPM emulator</span></a></li><li><a href="virt-crash-dump.html" class=" "><span class="title-number">23 </span><span class="title-name">Creating crash dumps of a VM Guest</span></a></li></ol></li><li><a href="part-virt-xen.html" class="has-children "><span class="title-number">IV </span><span class="title-name">Managing virtual machines with Xen</span></a><ol><li><a href="cha-xen-vhost.html" class=" "><span class="title-number">24 </span><span class="title-name">Setting up a virtual machine host</span></a></li><li><a href="cha-xen-network.html" class=" "><span class="title-number">25 </span><span class="title-name">Virtual networking</span></a></li><li><a href="cha-xen-manage.html" class=" "><span class="title-number">26 </span><span class="title-name">Managing a virtualization environment</span></a></li><li><a href="cha-xen-vbd.html" class=" "><span class="title-number">27 </span><span class="title-name">Block devices in Xen</span></a></li><li><a href="cha-xen-config.html" class=" "><span class="title-number">28 </span><span class="title-name">Virtualization: configuration options and settings</span></a></li><li><a href="cha-xen-admin.html" class=" "><span class="title-number">29 </span><span class="title-name">Administrative tasks</span></a></li><li><a href="cha-xen-xenstore.html" class=" "><span class="title-number">30 </span><span class="title-name">XenStore: configuration database shared between domains</span></a></li><li><a href="cha-xen-ha.html" class=" "><span class="title-number">31 </span><span class="title-name">Xen as a high-availability virtualization host</span></a></li><li><a href="pv-to-fv.html" class=" "><span class="title-number">32 </span><span class="title-name">Xen: converting a paravirtual (PV) guest into a fully virtual (FV/HVM) guest</span></a></li></ol></li><li class="active"><a href="part-virt-qemu.html" class="has-children you-are-here"><span class="title-number">V </span><span class="title-name">Managing virtual machines with QEMU</span></a><ol><li><a href="cha-qemu-overview.html" class=" "><span class="title-number">33 </span><span class="title-name">QEMU overview</span></a></li><li><a href="cha-qemu-host.html" class=" "><span class="title-number">34 </span><span class="title-name">Setting up a KVM VM Host Server</span></a></li><li><a href="cha-qemu-guest-inst.html" class=" "><span class="title-number">35 </span><span class="title-name">Guest installation</span></a></li><li><a href="cha-qemu-running.html" class=" "><span class="title-number">36 </span><span class="title-name">Running virtual machines with qemu-system-ARCH</span></a></li><li><a href="cha-qemu-monitor.html" class=" you-are-here"><span class="title-number">37 </span><span class="title-name">Virtual machine administration using QEMU monitor</span></a></li></ol></li><li><a href="part-virt-troubleshoot.html" class="has-children "><span class="title-number">VI </span><span class="title-name">Troubleshooting</span></a><ol><li><a href="cha-virt-help.html" class=" "><span class="title-number">38 </span><span class="title-name">Integrated help and package documentation</span></a></li><li><a href="cha-virt-logs.html" class=" "><span class="title-number">39 </span><span class="title-name">Gathering system information and logs</span></a></li></ol></li><li><a href="gloss-vt-glossary.html" class=" "><span class="title-number"> </span><span class="title-name">Glossary</span></a></li><li><a href="app-vmdp-driver.html" class=" "><span class="title-number">A </span><span class="title-name">Virtual machine drivers</span></a></li><li><a href="app-gpu-passthru.html" class=" "><span class="title-number">B </span><span class="title-name">Configuring GPU Pass-Through for NVIDIA cards</span></a></li><li><a href="cha-xmtoxl.html" class=" "><span class="title-number">C </span><span class="title-name">XM, XL toolstacks, and the <code class="systemitem">libvirt</code> framework</span></a></li><li><a href="bk10apd.html" class=" "><span class="title-number">D </span><span class="title-name">GNU licenses</span></a></li> </ol> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section class="chapter" id="cha-qemu-monitor" data-id-title="Virtual machine administration using QEMU monitor"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname"><span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span></span> <span class="productnumber"><span class="productnumber"><span class="phrase">15 SP5</span></span></span></div><div><div class="title-container"><h1 class="title"><span class="title-number-name"><span class="title-number">37 </span><span class="title-name">Virtual machine administration using QEMU monitor</span></span> <a title="Permalink" class="permalink" href="cha-qemu-monitor.html#">#</a></h1><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/qemu_monitor.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    When a virtual machine is invoked by the <code class="command">qemu-system-<em class="replaceable">ARCH</em></code> command, for
    example <code class="command">qemu-system-x86_64</code>, a monitor console is
    provided for performing interaction with the user. Using the commands
    available in the monitor console, it is possible to inspect the running
    operating system, change removable media, take screenshots or audio grabs
    and control other aspects of the virtual machine.
  </p><div id="id-1.12.7.6.4" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note</div><p>
      The following sections list selected useful QEMU monitor commands and
      their purpose. To get the full list, enter <code class="command">help</code> in the
      QEMU monitor command line.
    </p></div><section class="sect1" id="sec-qemu-monitor-access" data-id-title="Accessing monitor console"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">37.1 </span><span class="title-name">Accessing monitor console</span></span> <a title="Permalink" class="permalink" href="cha-qemu-monitor.html#sec-qemu-monitor-access">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/qemu_monitor.xml" title="Edit source document"> </a></div></div></div></div></div><div id="id-1.12.7.6.5.2" data-id-title="No monitor console for libvirt" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.svg"/><div class="admon-title">Tip: No monitor console for <code class="systemitem">libvirt</code></div><p>
        You can access the monitor console only if you started the virtual
        machine directly with the <code class="command">qemu-system-<em class="replaceable">ARCH</em></code> command and are viewing its
        graphical output in a native QEMU window.
      </p><p>
        If you started the virtual machine with <code class="systemitem">libvirt</code> (for example, using
        <code class="command">virt-manager</code>) and are viewing its output via VNC or
        Spice sessions, you cannot access the monitor console directly. You
        can, however, send the monitor command to the virtual machine via
        <code class="command">virsh</code>:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code>virsh qemu-monitor-command <em class="replaceable">COMMAND</em></pre></div></div><p>
      The way you access the monitor console depends on which display device
      you use to view the output of a virtual machine. Find more details about
      displays in <a class="xref" href="cha-qemu-running.html#cha-qemu-running-devices-graphic-display" title="36.3.2.2. Display options">Section 36.3.2.2, “Display options”</a>.
      For example, to view the monitor while the <code class="option">-display gtk</code>
      option is in use, press <span class="keycap">Ctrl</span><span class="key-connector">–</span><span class="keycap">Alt</span><span class="key-connector">–</span><span class="keycap">2</span>. Similarly, when
      the <code class="option">-nographic</code> option is in use, you can switch to the
      monitor console by pressing the following key combination:
      <span class="keycap">Ctrl</span><span class="key-connector">–</span><span class="keycap">A</span><span class="keycap">C</span>.
    </p><p>
      To get help while using the console, use <code class="command">help</code> or
      <code class="command">?</code>. To get help for a specific command, use
      <code class="command">help</code> <em class="replaceable">COMMAND</em>.
    </p></section><section class="sect1" id="sec-qemu-monitor-get" data-id-title="Getting information about the guest system"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">37.2 </span><span class="title-name">Getting information about the guest system</span></span> <a title="Permalink" class="permalink" href="cha-qemu-monitor.html#sec-qemu-monitor-get">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/qemu_monitor.xml" title="Edit source document"> </a></div></div></div></div></div><p>
      To get information about the guest system, use <code class="command">info</code>.
      If used without any option, the list of possible options is printed.
      Options determine which part of the system is analyzed:
    </p><div class="variablelist"><dl class="variablelist"><dt id="id-1.12.7.6.6.3.1"><span class="term"><code class="command">info version</code></span></dt><dd><p>
            Shows the version of QEMU.
          </p></dd><dt id="id-1.12.7.6.6.3.2"><span class="term"><code class="command">info commands</code></span></dt><dd><p>
            Lists available QMP commands.
          </p></dd><dt id="id-1.12.7.6.6.3.3"><span class="term"><code class="command">info network</code></span></dt><dd><p>
            Shows the network state.
          </p></dd><dt id="id-1.12.7.6.6.3.4"><span class="term"><code class="command">info chardev</code></span></dt><dd><p>
            Shows the character devices.
          </p></dd><dt id="id-1.12.7.6.6.3.5"><span class="term"><code class="command">info block</code></span></dt><dd><p>
            Information about block devices, such as hard disks, floppy drives,
            or CD-ROMs.
          </p></dd><dt id="id-1.12.7.6.6.3.6"><span class="term"><code class="command">info blockstats</code></span></dt><dd><p>
            Read and write statistics on block devices.
          </p></dd><dt id="id-1.12.7.6.6.3.7"><span class="term"><code class="command">info registers</code></span></dt><dd><p>
            Shows the CPU registers.
          </p></dd><dt id="id-1.12.7.6.6.3.8"><span class="term"><code class="command">info cpus</code></span></dt><dd><p>
            Shows information about available CPUs.
          </p></dd><dt id="id-1.12.7.6.6.3.9"><span class="term"><code class="command">info history</code></span></dt><dd><p>
            Shows the command line history.
          </p></dd><dt id="id-1.12.7.6.6.3.10"><span class="term"><code class="command">info irq</code></span></dt><dd><p>
            Shows the interrupt statistics.
          </p></dd><dt id="id-1.12.7.6.6.3.11"><span class="term"><code class="command">info pic</code></span></dt><dd><p>
            Shows the i8259 (PIC) state.
          </p></dd><dt id="id-1.12.7.6.6.3.12"><span class="term"><code class="command">info pci</code></span></dt><dd><p>
            Shows the PCI information.
          </p></dd><dt id="id-1.12.7.6.6.3.13"><span class="term"><code class="command">info tlb</code></span></dt><dd><p>
            Shows virtual to physical memory mappings.
          </p></dd><dt id="id-1.12.7.6.6.3.14"><span class="term"><code class="command">info mem</code></span></dt><dd><p>
            Shows the active virtual memory mappings.
          </p></dd><dt id="id-1.12.7.6.6.3.15"><span class="term"><code class="command">info jit</code></span></dt><dd><p>
            Shows dynamic compiler information.
          </p></dd><dt id="id-1.12.7.6.6.3.16"><span class="term"><code class="command">info kvm</code></span></dt><dd><p>
            Shows the KVM information.
          </p></dd><dt id="id-1.12.7.6.6.3.17"><span class="term"><code class="command">info numa</code></span></dt><dd><p>
            Shows the NUMA information.
          </p></dd><dt id="id-1.12.7.6.6.3.18"><span class="term"><code class="command">info usb</code></span></dt><dd><p>
            Shows the guest USB devices.
          </p></dd><dt id="id-1.12.7.6.6.3.19"><span class="term"><code class="command">info usbhost</code></span></dt><dd><p>
            Shows the host USB devices.
          </p></dd><dt id="id-1.12.7.6.6.3.20"><span class="term"><code class="command">info profile</code></span></dt><dd><p>
            Shows the profiling information.
          </p></dd><dt id="id-1.12.7.6.6.3.21"><span class="term"><code class="command">info capture</code></span></dt><dd><p>
            Shows the capture (audio grab) information.
          </p></dd><dt id="id-1.12.7.6.6.3.22"><span class="term"><code class="command">info snapshots</code></span></dt><dd><p>
            Shows the currently saved virtual machine snapshots.
          </p></dd><dt id="id-1.12.7.6.6.3.23"><span class="term"><code class="command">info status</code></span></dt><dd><p>
            Shows the current virtual machine status.
          </p></dd><dt id="id-1.12.7.6.6.3.24"><span class="term"><code class="command">info mice</code></span></dt><dd><p>
            Shows which guest mice are receiving events.
          </p></dd><dt id="id-1.12.7.6.6.3.25"><span class="term"><code class="command">info vnc</code></span></dt><dd><p>
            Shows the VNC server status.
          </p></dd><dt id="id-1.12.7.6.6.3.26"><span class="term"><code class="command">info name</code></span></dt><dd><p>
            Shows the current virtual machine name.
          </p></dd><dt id="id-1.12.7.6.6.3.27"><span class="term"><code class="command">info uuid</code></span></dt><dd><p>
            Shows the current virtual machine UUID.
          </p></dd><dt id="id-1.12.7.6.6.3.28"><span class="term"><code class="command">info usernet</code></span></dt><dd><p>
            Shows the user network stack connection states.
          </p></dd><dt id="id-1.12.7.6.6.3.29"><span class="term"><code class="command">info migrate</code></span></dt><dd><p>
            Shows the migration status.
          </p></dd><dt id="id-1.12.7.6.6.3.30"><span class="term"><code class="command">info balloon</code></span></dt><dd><p>
            Shows the balloon device information.
          </p></dd><dt id="id-1.12.7.6.6.3.31"><span class="term"><code class="command">info qtree</code></span></dt><dd><p>
            Shows the device tree.
          </p></dd><dt id="id-1.12.7.6.6.3.32"><span class="term"><code class="command">info qdm</code></span></dt><dd><p>
            Shows the qdev device model list.
          </p></dd><dt id="id-1.12.7.6.6.3.33"><span class="term"><code class="command">info roms</code></span></dt><dd><p>
            Shows the ROMs.
          </p></dd><dt id="id-1.12.7.6.6.3.34"><span class="term"><code class="command">info migrate_cache_size</code></span></dt><dd><p>
            Shows the current migration xbzrle (<span class="quote">“<span class="quote">Xor Based Zero Run
            Length Encoding</span>”</span>) cache size.
          </p></dd><dt id="id-1.12.7.6.6.3.35"><span class="term"><code class="command">info migrate_capabilities</code></span></dt><dd><p>
            Shows the status of the multiple migration capabilities, such as
            xbzrle compression.
          </p></dd><dt id="id-1.12.7.6.6.3.36"><span class="term"><code class="command">info mtree</code></span></dt><dd><p>
            Shows the VM Guest memory hierarchy.
          </p></dd><dt id="id-1.12.7.6.6.3.37"><span class="term"><code class="command">info trace-events</code></span></dt><dd><p>
            Shows available trace-events and their status.
          </p></dd></dl></div></section><section class="sect1" id="sec-qemu-monitor-vnc-pw" data-id-title="Changing VNC password"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">37.3 </span><span class="title-name">Changing VNC password</span></span> <a title="Permalink" class="permalink" href="cha-qemu-monitor.html#sec-qemu-monitor-vnc-pw">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/qemu_monitor.xml" title="Edit source document"> </a></div></div></div></div></div><p>
      To change the VNC password, use the <code class="command">change vnc
      password</code> command and enter the new password:
    </p><div class="verbatim-wrap"><pre class="screen">(qemu) change vnc password
Password: ********
(qemu)</pre></div></section><section class="sect1" id="sec-qemu-monitor-manage-dev" data-id-title="Managing devices"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">37.4 </span><span class="title-name">Managing devices</span></span> <a title="Permalink" class="permalink" href="cha-qemu-monitor.html#sec-qemu-monitor-manage-dev">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/qemu_monitor.xml" title="Edit source document"> </a></div></div></div></div></div><p>
      To add a new disk while the guest is running (hotplug), use the
      <code class="command">drive_add</code> and <code class="command">device_add</code> commands.
      First define a new drive to be added as a device to bus 0:
    </p><div class="verbatim-wrap"><pre class="screen">(qemu) drive_add 0 if=none,file=/tmp/test.img,format=raw,id=disk1
OK</pre></div><p>
      You can confirm your new device by querying the block subsystem:
    </p><div class="verbatim-wrap"><pre class="screen">(qemu) info block
[...]
disk1: removable=1 locked=0 tray-open=0 file=/tmp/test.img ro=0 drv=raw \
encrypted=0 bps=0 bps_rd=0 bps_wr=0 iops=0 iops_rd=0 iops_wr=0</pre></div><p>
      After the new drive is defined, it needs to be connected to a device so
      that the guest can see it. The typical device would be a
      <code class="literal">virtio-blk-pci</code> or <code class="literal">scsi-disk</code>. To get
      the full list of available values, run:
    </p><div class="verbatim-wrap"><pre class="screen">(qemu) device_add ?
name "VGA", bus PCI
name "usb-storage", bus usb-bus
[...]
name "virtio-blk-pci", bus virtio-bus</pre></div><p>
      Now add the device
    </p><div class="verbatim-wrap"><pre class="screen">(qemu) device_add virtio-blk-pci,drive=disk1,id=myvirtio1</pre></div><p>
      and confirm with
    </p><div class="verbatim-wrap"><pre class="screen">(qemu) info pci
[...]
Bus  0, device   4, function 0:
    SCSI controller: PCI device 1af4:1001
      IRQ 0.
      BAR0: I/O at 0xffffffffffffffff [0x003e].
      BAR1: 32 bit memory at 0xffffffffffffffff [0x00000ffe].
      id "myvirtio1"</pre></div><div id="id-1.12.7.6.8.12" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.svg"/><div class="admon-title">Tip</div><p>
        Devices added with the <code class="command">device_add</code> command can be
        removed from the guest with <code class="command">device_del</code>. Enter
        <code class="command">help device_del</code> on the QEMU monitor command line
        for more information.
      </p></div><p>
      To release the device or file connected to the removable media device,
      use the <code class="command">eject</code> <em class="replaceable">DEVICE</em>
      command. Use the optional <code class="option">-f</code> to force ejection.
    </p><p>
      To change removable media (like CD-ROMs), use the
      <code class="command">change</code> <em class="replaceable">DEVICE</em> command. The
      name of the removable media can be determined using the <code class="command">info
      block</code> command:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">(qemu) </code><code class="command">info block</code>
ide1-cd0: type=cdrom removable=1 locked=0 file=/dev/sr0 ro=1 drv=host_device
<code class="prompt user">(qemu) </code><code class="command">change ide1-cd0 /path/to/image</code></pre></div></section><section class="sect1" id="sec-qemu-monitor-keyboard" data-id-title="Controlling keyboard and mouse"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">37.5 </span><span class="title-name">Controlling keyboard and mouse</span></span> <a title="Permalink" class="permalink" href="cha-qemu-monitor.html#sec-qemu-monitor-keyboard">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/qemu_monitor.xml" title="Edit source document"> </a></div></div></div></div></div><p>
      It is possible to use the monitor console to emulate keyboard and mouse
      input if necessary. For example, if your graphical user interface
      intercepts certain key combinations at low level (such as
      <span class="keycap">Ctrl</span><span class="key-connector">–</span><span class="keycap">Alt</span><span class="key-connector">–</span><span class="keycap">F1</span>
      in X Window Syustem), you can still enter them using the
      <code class="command">sendkey</code> <em class="replaceable">KEYS</em>:
    </p><div class="verbatim-wrap"><pre class="screen">sendkey ctrl-alt-f1</pre></div><p>
      To list the key names used in the <em class="replaceable">KEYS</em> option,
      enter <code class="command">sendkey</code> and press <span class="keycap">→|</span>.
    </p><p>
      To control the mouse, the following commands can be used:
    </p><div class="variablelist"><dl class="variablelist"><dt id="id-1.12.7.6.9.6.1"><span class="term"><code class="command">mouse_move</code> <em class="replaceable">DX</em> <em class="replaceable">dy</em> [<em class="replaceable">DZ</em>]</span></dt><dd><p>
            Move the active mouse pointer to the specified coordinates dx, dy
            with the optional scroll axis dz.
          </p></dd><dt id="id-1.12.7.6.9.6.2"><span class="term"><code class="command">mouse_button</code> <em class="replaceable">VAL</em></span></dt><dd><p>
            Change the state of the mouse buttons (1=left, 2=middle, 4=right).
          </p></dd><dt id="id-1.12.7.6.9.6.3"><span class="term"><code class="command">mouse_set</code> <em class="replaceable">INDEX</em></span></dt><dd><p>
            Set which mouse device receives events. Device index numbers can be
            obtained with the <code class="command">info mice</code> command.
          </p></dd></dl></div></section><section class="sect1" id="sec-qemu-monitor-memory" data-id-title="Changing available memory"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">37.6 </span><span class="title-name">Changing available memory</span></span> <a title="Permalink" class="permalink" href="cha-qemu-monitor.html#sec-qemu-monitor-memory">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/qemu_monitor.xml" title="Edit source document"> </a></div></div></div></div></div><p>
      If the virtual machine was started with the <code class="option">-balloon
      virtio</code> option (the paravirtualized balloon device is therefore
      enabled), you can change the available memory dynamically. For more
      information about enabling the balloon device, see
      <a class="xref" href="cha-qemu-guest-inst.html#cha-qemu-guest-inst-qemu-kvm" title="35.1. Basic installation with qemu-system-ARCH">Section 35.1, “Basic installation with <code class="command">qemu-system-ARCH</code>”</a>.
    </p><p>
      To get information about the balloon device in the monitor console and to
      determine whether the device is enabled, use the <code class="command">info
      balloon</code> command:
    </p><div class="verbatim-wrap"><pre class="screen">(qemu) info balloon</pre></div><p>
      If the balloon device is enabled, use the <code class="command">balloon</code>
      <em class="replaceable">MEMORY_IN_MB</em> command to set the requested
      amount of memory:
    </p><div class="verbatim-wrap"><pre class="screen">(qemu) balloon 400</pre></div></section><section class="sect1" id="sec-qemu-monitor-virt-memory" data-id-title="Dumping virtual machine memory"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">37.7 </span><span class="title-name">Dumping virtual machine memory</span></span> <a title="Permalink" class="permalink" href="cha-qemu-monitor.html#sec-qemu-monitor-virt-memory">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/qemu_monitor.xml" title="Edit source document"> </a></div></div></div></div></div><p>
      To save the content of the virtual machine memory to a disk or console
      output, use the following commands:
    </p><div class="variablelist"><dl class="variablelist"><dt id="id-1.12.7.6.11.3.1"><span class="term"><code class="command">memsave</code><em class="replaceable">ADDR</em><em class="replaceable">SIZE</em><em class="replaceable">FILENAME</em></span></dt><dd><p>
            Saves virtual memory dump starting at
            <em class="replaceable">ADDR</em> of size
            <em class="replaceable">SIZE</em> to file
            <em class="replaceable">FILENAME</em>
          </p></dd><dt id="id-1.12.7.6.11.3.2"><span class="term"><code class="command">pmemsave</code><em class="replaceable">ADDR</em><em class="replaceable">SIZE</em><em class="replaceable">FILENAME</em></span></dt><dd><p>
            Saves physical memory dump starting at
            <em class="replaceable">ADDR</em> of size
            <em class="replaceable">SIZE</em> to file
            <em class="replaceable">FILENAME</em>-
          </p></dd><dt id="id-1.12.7.6.11.3.3"><span class="term">x /<em class="replaceable">FMT</em><em class="replaceable">ADDR</em></span></dt><dd><p>
            Makes a virtual memory dump starting at address
            <em class="replaceable">ADDR</em> and formatted according to the
            <em class="replaceable">FMT</em> string. The
            <em class="replaceable">FMT</em> string consists of three parameters
            <code class="literal"><em class="replaceable">COUNT</em><em class="replaceable">FORMAT</em><em class="replaceable">SIZE</em></code>:
          </p><p>
            The <em class="replaceable">COUNT</em> parameter is the number of
            items to be dumped.
          </p><p>
            The <em class="replaceable">FORMAT</em> can be <code class="literal">x</code>
            (hex), <code class="literal">d</code> (signed decimal), <code class="literal">u</code>
            (unsigned decimal), <code class="literal">o</code> (octal),
            <code class="literal">c</code> (char) or <code class="literal">i</code> (assembly
            instruction).
          </p><p>
            The <em class="replaceable">SIZE</em> parameter can be
            <code class="literal">b</code> (8 bits), <code class="literal">h</code> (16 bits),
            <code class="literal">w</code> (32 bits) or <code class="literal">g</code> (64 bits).
            On x86, <code class="literal">h</code> or <code class="literal">w</code> can be
            specified with the <code class="literal">i</code> format to respectively
            select 16 or 32-bit code instruction size.
          </p></dd><dt id="id-1.12.7.6.11.3.4"><span class="term">xp /<em class="replaceable">FMT</em><em class="replaceable">ADDR</em></span></dt><dd><p>
            Makes a physical memory dump starting at address
            <em class="replaceable">ADDR</em> and formatted according to the
            <em class="replaceable">FMT</em> string. The
            <em class="replaceable">FMT</em> string consists of three parameters
            <code class="literal"><em class="replaceable">COUNT</em><em class="replaceable">FORMAT</em><em class="replaceable">SIZE</em></code>:
          </p><p>
            The <em class="replaceable">COUNT</em> parameter is the number of the
            items to be dumped.
          </p><p>
            The <em class="replaceable">FORMAT</em> can be <code class="literal">x</code>
            (hex), <code class="literal">d</code> (signed decimal), <code class="literal">u</code>
            (unsigned decimal), <code class="literal">o</code> (octal),
            <code class="literal">c</code> (char) or <code class="literal">i</code> (asm
            instruction).
          </p><p>
            The <em class="replaceable">SIZE</em> parameter can be
            <code class="literal">b</code> (8 bits), <code class="literal">h</code> (16 bits),
            <code class="literal">w</code> (32 bits) or <code class="literal">g</code> (64 bits).
            On x86, <code class="literal">h</code> or <code class="literal">w</code> can be
            specified with the<code class="literal">i</code> format to respectively
            select 16 or 32-bit code instruction size.
          </p></dd></dl></div></section><section class="sect1" id="sec-qemu-monitor-snapshots" data-id-title="Managing virtual machine snapshots"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">37.8 </span><span class="title-name">Managing virtual machine snapshots</span></span> <a title="Permalink" class="permalink" href="cha-qemu-monitor.html#sec-qemu-monitor-snapshots">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/qemu_monitor.xml" title="Edit source document"> </a></div></div></div></div></div><p>
      Managing snapshots in QEMU monitor is not supported by SUSE
      yet. The information found in this section may be helpful in specific
      cases.
    </p><p>
      <a class="xref" href="gloss-vt-glossary.html#gloss-vt-vm" title="Virtual Machine">Virtual Machine</a> snapshots are snapshots of the complete
      virtual machine including the state of CPU, RAM and the content of all
      writable disks. To use virtual machine snapshots, you must have at least
      one non-removable and writable block device using the
      <code class="literal">qcow2</code> disk image format.
    </p><p>
      Snapshots are helpful when you need to save your virtual machine in a
      particular state. For example, after you have configured network services
      on a virtualized server and want to quickly start the virtual machine in
      the same state that was saved last. You can also create a snapshot after
      the virtual machine has been powered off to create a backup state before
      you try something experimental and make VM Guest unstable. This section
      introduces the former case, while the latter is described in
      <a class="xref" href="cha-qemu-guest-inst.html#cha-qemu-guest-inst-qemu-img-snapshots" title="35.2.3. Managing snapshots of virtual machines with qemu-img">Section 35.2.3, “Managing snapshots of virtual machines with qemu-img”</a>.
    </p><p>
      The following commands are available for managing snapshots in QEMU
      monitor:
    </p><div class="variablelist"><dl class="variablelist"><dt id="id-1.12.7.6.12.6.1"><span class="term"><code class="command">savevm</code><em class="replaceable">NAME</em></span></dt><dd><p>
            Creates a new virtual machine snapshot under the tag
            <em class="replaceable">NAME</em> or replaces an existing snapshot.
          </p></dd><dt id="id-1.12.7.6.12.6.2"><span class="term"><code class="command">loadvm</code><em class="replaceable">NAME</em></span></dt><dd><p>
            Loads a virtual machine snapshot tagged
            <em class="replaceable">NAME</em>.
          </p></dd><dt id="id-1.12.7.6.12.6.3"><span class="term"><code class="command">delvm</code></span></dt><dd><p>
            Deletes a virtual machine snapshot.
          </p></dd><dt id="id-1.12.7.6.12.6.4"><span class="term"><code class="command">info snapshots</code></span></dt><dd><p>
            Prints information about available snapshots.
          </p><div class="verbatim-wrap"><pre class="screen">(qemu) info snapshots
Snapshot list:
ID<span class="callout" id="co-qemu-monitor-snapshot-l-id">1</span>      TAG<span class="callout" id="co-qemu-monitor-snapshot-l-tag">2</span>                 VM SIZE<span class="callout" id="co-qemu-monitor-snapshot-l-size">3</span>   DATE<span class="callout" id="co-qemu-monitor-snapshot-l-date">4</span>          VM CLOCK<span class="callout" id="co-qemu-monitor-snapshot-l-clock">5</span>
1         booting                4.4M 2013-11-22 10:51:10   00:00:20.476
2         booted                 184M 2013-11-22 10:53:03   00:02:05.394
3         logged_in              273M 2013-11-22 11:00:25   00:04:34.843
4         ff_and_term_running    372M 2013-11-22 11:12:27   00:08:44.965</pre></div><div class="calloutlist"><table style="border: 0; "><tr><td style="width: 5%; vertical-align: top; text-align: left; "><p><a href="#co-qemu-monitor-snapshot-l-id"><span class="callout">1</span></a> </p></td><td style="vertical-align: top; text-align: left; "><p>
                Unique auto-incremented identification number of the snapshot.
              </p></td></tr><tr><td style="width: 5%; vertical-align: top; text-align: left; "><p><a href="#co-qemu-monitor-snapshot-l-tag"><span class="callout">2</span></a> </p></td><td style="vertical-align: top; text-align: left; "><p>
                Unique description string of the snapshot. It is meant as a
                human readable version of the ID.
              </p></td></tr><tr><td style="width: 5%; vertical-align: top; text-align: left; "><p><a href="#co-qemu-monitor-snapshot-l-size"><span class="callout">3</span></a> </p></td><td style="vertical-align: top; text-align: left; "><p>
                The disk space occupied by the snapshot. Note that the more
                memory is consumed by running applications, the bigger the
                snapshot is.
              </p></td></tr><tr><td style="width: 5%; vertical-align: top; text-align: left; "><p><a href="#co-qemu-monitor-snapshot-l-date"><span class="callout">4</span></a> </p></td><td style="vertical-align: top; text-align: left; "><p>
                Time and date the snapshot was created.
              </p></td></tr><tr><td style="width: 5%; vertical-align: top; text-align: left; "><p><a href="#co-qemu-monitor-snapshot-l-clock"><span class="callout">5</span></a> </p></td><td style="vertical-align: top; text-align: left; "><p>
                The current state of the virtual machine's clock.
              </p></td></tr></table></div></dd></dl></div></section><section class="sect1" id="sec-qemu-monitor-suspend" data-id-title="Suspending and resuming virtual machine execution"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">37.9 </span><span class="title-name">Suspending and resuming virtual machine execution</span></span> <a title="Permalink" class="permalink" href="cha-qemu-monitor.html#sec-qemu-monitor-suspend">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/qemu_monitor.xml" title="Edit source document"> </a></div></div></div></div></div><p>
      The following commands are available for suspending and resuming virtual
      machines:
    </p><div class="variablelist"><dl class="variablelist"><dt id="id-1.12.7.6.13.3.1"><span class="term"><code class="command">stop</code></span></dt><dd><p>
            Suspends the execution of the virtual machine.
          </p></dd><dt id="id-1.12.7.6.13.3.2"><span class="term"><code class="command">cont</code></span></dt><dd><p>
            Resumes the execution of the virtual machine.
          </p></dd><dt id="id-1.12.7.6.13.3.3"><span class="term"><code class="command">system_reset</code></span></dt><dd><p>
            Resets the virtual machine. The effect is similar to the reset
            button on a physical machine. This may leave the file system in an
            unclean state.
          </p></dd><dt id="id-1.12.7.6.13.3.4"><span class="term"><code class="command">system_powerdown</code></span></dt><dd><p>
            Sends an <a class="xref" href="gloss-vt-glossary.html#gloss-vt-acpi" title="ACPI">ACPI</a> shutdown request to the
            machine. The effect is similar to the power button on a physical
            machine.
          </p></dd><dt id="id-1.12.7.6.13.3.5"><span class="term"><code class="command">q</code> or <code class="command">quit</code></span></dt><dd><p>
            Terminates QEMU immediately.
          </p></dd></dl></div></section><section class="sect1" id="sec-qemu-monitor-migrate" data-id-title="Live migration"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">37.10 </span><span class="title-name">Live migration</span></span> <a title="Permalink" class="permalink" href="cha-qemu-monitor.html#sec-qemu-monitor-migrate">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/qemu_monitor.xml" title="Edit source document"> </a></div></div></div></div></div><p>
      The live migration process allows to transmit any virtual machine from
      one host system to another host system without any interruption in
      availability. It is possible to change hosts permanently or only during
      maintenance.
    </p><p>
      The requirements for live migration:
    </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
          All requirements from
          <a class="xref" href="sec-libvirt-admin-migrate.html#libvirt-admin-live-migration-requirements" title="16.2. Migration requirements">Section 16.2, “Migration requirements”</a> are
          applicable.
        </p></li><li class="listitem"><p>
          Live migration is only possible between VM Host Servers with the same CPU
          features.
        </p></li><li class="listitem"><p>
          <a class="xref" href="gloss-vt-glossary.html#gloss-vt-storage-ahci" title="AHCI">AHCI</a> interface,
          <a class="xref" href="gloss-vt-glossary.html#gloss-vt-virtfs" title="VirtFS">VirtFS</a> feature, and the
          <code class="option">-mem-path</code> command line option are not compatible
          with migration.
        </p></li><li class="listitem"><p>
          The guest on the source and destination hosts must be started in the
          same way.
        </p></li><li class="listitem"><p>
          <code class="option">-snapshot</code> qemu command line option should not be
          used for migration (and this <code class="command">qemu</code> command line
          option is not supported).
        </p></li></ul></div><div id="id-1.12.7.6.14.5" data-id-title="Support status" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg"/><div class="admon-title">Important: Support status</div><p>
        The <code class="literal">postcopy</code> mode is not yet supported in
        <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span>. It is released as a technology preview only. For more
        information about <code class="literal">postcopy</code>, see
        <a class="link" href="https://wiki.qemu.org/Features/PostCopyLiveMigration" target="_blank">https://wiki.qemu.org/Features/PostCopyLiveMigration</a>.
      </p></div><p>
      More recommendations can be found at the following Web site:
      <a class="link" href="https://www.linux-kvm.org/page/Migration" target="_blank">https://www.linux-kvm.org/page/Migration</a>
    </p><p>
      The live migration process has the following steps:
    </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
          The virtual machine instance is running on the source host.
        </p></li><li class="step"><p>
          The virtual machine is started on the destination host in the frozen
          listening mode. The parameters used are the same as on the source
          host plus the <code class="option">-incoming
          tcp:<em class="replaceable">IP</em>:<em class="replaceable">PORT</em></code>
          parameter, where <em class="replaceable">IP</em> specifies the IP
          address and <em class="replaceable">PORT</em> specifies the port for
          listening to the incoming migration. If 0 is set as IP address, the
          virtual machine listens on all interfaces.
        </p></li><li class="step"><p>
          On the source host, switch to the monitor console and use the
          <code class="command">migrate -d tcp:</code>
          <em class="replaceable">DESTINATION_IP</em>:<em class="replaceable">PORT</em>
          command to initiate the migration.
        </p></li><li class="step"><p>
          To determine the state of the migration, use the <code class="command">info
          migrate</code> command in the monitor console on the source host.
        </p></li><li class="step"><p>
          To cancel the migration, use the <code class="command">migrate_cancel</code>
          command in the monitor console on the source host.
        </p></li><li class="step"><p>
          To set the maximum tolerable downtime for migration in seconds, use
          the <code class="command">migrate_set_downtime</code>
          <em class="replaceable">NUMBER_OF_SECONDS</em> command.
        </p></li><li class="step"><p>
          To set the maximum speed for migration in bytes per second, use the
          <code class="command">migrate_set_speed</code>
          <em class="replaceable">BYTES_PER_SECOND</em> command.
        </p></li></ol></div></div></section><section class="sect1" id="qemu-monitor-qmp" data-id-title="QMP - QEMU machine protocol"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">37.11 </span><span class="title-name">QMP - QEMU machine protocol</span></span> <a title="Permalink" class="permalink" href="cha-qemu-monitor.html#qemu-monitor-qmp">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/qemu_monitor.xml" title="Edit source document"> </a></div></div></div></div></div><p>
      QMP is a JSON-based protocol that allows applications—such as
      <code class="systemitem">libvirt</code>—to communicate with a running QEMU instance. There are
      several ways you can access the QEMU monitor using QMP commands.
    </p><section class="sect2" id="sec-qemu-monitor-qmp-io" data-id-title="Access QMP via standard input/output"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">37.11.1 </span><span class="title-name">Access QMP via standard input/output</span></span> <a title="Permalink" class="permalink" href="cha-qemu-monitor.html#sec-qemu-monitor-qmp-io">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/qemu_monitor.xml" title="Edit source document"> </a></div></div></div></div></div><p>
        The most flexible way to use QMP is by specifying the
        <code class="option">-mon</code> option. The following example creates a QMP
        instance using standard input/output. In the following examples,
        <code class="literal">-&gt;</code> marks lines with commands sent from client to
        the running QEMU instance, while <code class="literal">&lt;-</code> marks lines
        with the output returned from QEMU.
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> qemu-system-x86_64 [...] \
-chardev stdio,id=mon0 \
-mon chardev=mon0,mode=control,pretty=on

&lt;- {
    "QMP": {
        "version": {
            "qemu": {
                "micro": 0,
                "minor": 0,
                "major": 2
            },
            "package": ""
        },
        "capabilities": [
        ]
    }
}</pre></div><p>
        When a new QMP connection is established, QMP sends its greeting
        message and enters capabilities negotiation mode. In this mode, only
        the <code class="command">qmp_capabilities</code> command works. To exit
        capabilities negotiation mode and enter command mode, the
        <code class="command">qmp_capabilities</code> command must be issued first:
      </p><div class="verbatim-wrap"><pre class="screen">-&gt; { "execute": "qmp_capabilities" }
&lt;- {
    "return": {
    }
}</pre></div><p>
        Note that <code class="literal">"return": {}</code> is a QMP's success response.
      </p><p>
        QMP's commands can have arguments. For example to eject a CD-ROM drive,
        enter the following:
      </p><div class="verbatim-wrap"><pre class="screen">-&gt;{ "execute": "eject", "arguments": { "device": "ide1-cd0" } }
&lt;- {
    "timestamp": {
        "seconds": 1410353381,
        "microseconds": 763480
    },
    "event": "DEVICE_TRAY_MOVED",
    "data": {
        "device": "ide1-cd0",
        "tray-open": true
    }
}
{
    "return": {
    }
}</pre></div></section><section class="sect2" id="sec-qemu-monitor-qmp-telnet" data-id-title="Access QMP via telnet"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">37.11.2 </span><span class="title-name">Access QMP via telnet</span></span> <a title="Permalink" class="permalink" href="cha-qemu-monitor.html#sec-qemu-monitor-qmp-telnet">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/qemu_monitor.xml" title="Edit source document"> </a></div></div></div></div></div><p>
        Instead of the standard input/output, you can connect the QMP interface
        to a network socket and communicate with it via a specified port:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> qemu-system-x86_64 [...] \
-chardev socket,id=mon0,host=localhost,port=4444,server,nowait \
-mon chardev=mon0,mode=control,pretty=on</pre></div><p>
        And then run telnet to connect to port 4444:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code>telnet localhost 4444
Trying ::1...
Connected to localhost.
Escape character is '^]'.
&lt;- {
    "QMP": {
        "version": {
            "qemu": {
                "micro": 0,
                "minor": 0,
                "major": 2
            },
            "package": ""
        },
        "capabilities": [
        ]
    }
}</pre></div><p>
        You can create several monitor interfaces at the same time. The
        following example creates one HMP instance—human monitor which
        understands 'normal' QEMU monitor's commands—on the standard
        input/output, and one QMP instance on localhost port 4444:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> qemu-system-x86_64 [...] \
-chardev stdio,id=mon0 -mon chardev=mon0,mode=readline \
-chardev socket,id=mon1,host=localhost,port=4444,server,nowait \
  -mon chardev=mon1,mode=control,pretty=on</pre></div></section><section class="sect2" id="sec-qemu-monitor-qmp-socket" data-id-title="Access QMP via Unix socket"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">37.11.3 </span><span class="title-name">Access QMP via Unix socket</span></span> <a title="Permalink" class="permalink" href="cha-qemu-monitor.html#sec-qemu-monitor-qmp-socket">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/qemu_monitor.xml" title="Edit source document"> </a></div></div></div></div></div><p>
        Invoke QEMU using the <code class="option">-qmp</code> option, and create a Unix
        socket:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> qemu-system-x86_64 [...] \
-qmp unix:/tmp/qmp-sock,server --monitor stdio

QEMU waiting for connection on: unix:./qmp-sock,server</pre></div><p>
        To communicate with the QEMU instance via the
        <code class="literal">/tmp/qmp-sock</code> socket, use <code class="command">nc</code> (see
        <code class="command">man 1 nc</code> for more information) from another terminal
        on the same host:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> nc -U /tmp/qmp-sock
&lt;- {"QMP": {"version": {"qemu": {"micro": 0, "minor": 0, "major": 2} [...]</pre></div></section><section class="sect2" id="sec-qemu-monitor-qmp-virsh" data-id-title="Access QMP via libvirts virsh command"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">37.11.4 </span><span class="title-name">Access QMP via <code class="systemitem">libvirt</code>'s <code class="command">virsh</code> command</span></span> <a title="Permalink" class="permalink" href="cha-qemu-monitor.html#sec-qemu-monitor-qmp-virsh">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/qemu_monitor.xml" title="Edit source document"> </a></div></div></div></div></div><p>
        If you run your virtual machines under <code class="systemitem">libvirt</code> (see
        <a class="xref" href="part-virt-libvirt.html" title="Part II. Managing virtual machines with libvirt">Part II, “Managing virtual machines with <code class="systemitem">libvirt</code>”</a>), you can communicate with its
        running guests by running the <code class="command">virsh
        qemu-monitor-command</code>:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> virsh qemu-monitor-command vm_guest1 \
--pretty '{"execute":"query-kvm"}'
&lt;- {
    "return": {
        "enabled": true,
        "present": true
    },
    "id": "libvirt-8"
}</pre></div><p>
        In the above example, we ran the simple command
        <code class="command">query-kvm</code> which checks if the host is capable of
        running KVM and if KVM is enabled.
      </p><div id="id-1.12.7.6.15.6.5" data-id-title="Generating human-readable output" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.svg"/><div class="admon-title">Tip: Generating human-readable output</div><p>
          To use the standard human-readable output format of QEMU instead of
          the JSON format, use the <code class="option">--hmp</code> option:
        </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> virsh qemu-monitor-command vm_guest1 --hmp "query-kvm"</pre></div></div></section></section></section><nav class="bottom-pagination"><div><a class="pagination-link prev" href="cha-qemu-running.html"><span class="pagination-relation">Previous</span><span class="pagination-label"><span class="title-number">Chapter 36 </span>Running virtual machines with qemu-system-ARCH</span></a> </div><div><a class="pagination-link next" href="part-virt-troubleshoot.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Part VI </span>Troubleshooting</span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="sect1"><a href="cha-qemu-monitor.html#sec-qemu-monitor-access"><span class="title-number">37.1 </span><span class="title-name">Accessing monitor console</span></a></span></li><li><span class="sect1"><a href="cha-qemu-monitor.html#sec-qemu-monitor-get"><span class="title-number">37.2 </span><span class="title-name">Getting information about the guest system</span></a></span></li><li><span class="sect1"><a href="cha-qemu-monitor.html#sec-qemu-monitor-vnc-pw"><span class="title-number">37.3 </span><span class="title-name">Changing VNC password</span></a></span></li><li><span class="sect1"><a href="cha-qemu-monitor.html#sec-qemu-monitor-manage-dev"><span class="title-number">37.4 </span><span class="title-name">Managing devices</span></a></span></li><li><span class="sect1"><a href="cha-qemu-monitor.html#sec-qemu-monitor-keyboard"><span class="title-number">37.5 </span><span class="title-name">Controlling keyboard and mouse</span></a></span></li><li><span class="sect1"><a href="cha-qemu-monitor.html#sec-qemu-monitor-memory"><span class="title-number">37.6 </span><span class="title-name">Changing available memory</span></a></span></li><li><span class="sect1"><a href="cha-qemu-monitor.html#sec-qemu-monitor-virt-memory"><span class="title-number">37.7 </span><span class="title-name">Dumping virtual machine memory</span></a></span></li><li><span class="sect1"><a href="cha-qemu-monitor.html#sec-qemu-monitor-snapshots"><span class="title-number">37.8 </span><span class="title-name">Managing virtual machine snapshots</span></a></span></li><li><span class="sect1"><a href="cha-qemu-monitor.html#sec-qemu-monitor-suspend"><span class="title-number">37.9 </span><span class="title-name">Suspending and resuming virtual machine execution</span></a></span></li><li><span class="sect1"><a href="cha-qemu-monitor.html#sec-qemu-monitor-migrate"><span class="title-number">37.10 </span><span class="title-name">Live migration</span></a></span></li><li><span class="sect1"><a href="cha-qemu-monitor.html#qemu-monitor-qmp"><span class="title-number">37.11 </span><span class="title-name">QMP - QEMU machine protocol</span></a></span></li></ul></div><div class="side-title">Share this page</div><ul class="share"><li><a id="_share-fb" href="#" title="Facebook"> </a></li><li><a id="_share-in" href="#" title="LinkedIn"> </a></li><li><a id="_share-tw" href="#" title="Twitter/X"> </a></li><li><a id="_share-mail" href="#" title="E-Mail"> </a></li><li><a id="_print-button" href="#" title="Print this page"> </a></li></ul> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2024</span></div></div></footer></body></html>