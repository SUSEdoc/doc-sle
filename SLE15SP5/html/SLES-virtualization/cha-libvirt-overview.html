<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><title>SLES 15 SP5 | Virtualization Guide | libvirt daemons</title><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"/>
<meta name="title" content="libvirt daemons | SLES 15 SP5"/>
<meta name="description" content="A libvirt deployment for accessing KVM or Xen requires one or more daemons to be installed and active on the host. libvirt provides two daemon deploy…"/>
<meta name="product-name" content="SUSE Linux Enterprise Server"/>
<meta name="product-number" content="15 SP5"/>
<meta name="book-title" content="Virtualization Guide"/>
<meta name="chapter-title" content="Chapter 8. libvirt daemons"/>
<meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi"/>
<meta name="tracker-type" content="bsc"/>
<meta name="tracker-bsc-assignee" content="fs@suse.com"/>
<meta name="tracker-bsc-component" content="Documentation"/>
<meta name="tracker-bsc-product" content="PUBLIC SUSE Linux Enterprise Server 15 SP5"/>
<meta name="publisher" content="SUSE"/><meta property="og:title" content="Virtualization Guide"/>
<meta property="og:description" content="Learn all about virtualization and VM management"/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Virtualization Guide"/>
<meta name="twitter:description" content="Learn all about virtualization and VM management"/>
<script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": ["TechArticle"],
    "image": "https://www.suse.com/assets/img/suse-white-logo-green.svg",
    
     "isPartOf": {
      "@type": "CreativeWorkSeries",
      "name": "Products &amp; Solutions"
    },
    
    "inLanguage": "en",
    

    "headline": "libvirt daemons",
  
    "description": "libvirt daemons",
      
    "author": [
      {
        "@type": "Corporation",
        "name": "SUSE Product &amp; Solution Documentation Team",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    ],
      
    "dateModified": "2024-05-29T00:00+02:00",
      
    "datePublished": "2023-06-20T00:00+02:00",
      

    "about": [
      
    ],
  
    "sameAs": [
          "https://www.facebook.com/SUSEWorldwide/about",
          "https://www.youtube.com/channel/UCHTfqIzPKz4f_dri36lAQGA",
          "https://twitter.com/SUSE",
          "https://www.linkedin.com/company/suse"
    ],
    "publisher": {
      "@type": "Corporation",
      "name": "SUSE",
      "url": "https://documentation.suse.com",
      "logo": {
        "@type": "ImageObject",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    }
  }</script>
<link rel="prev" href="part-virt-libvirt.html" title="Part II. Managing virtual machines with libvirt"/><link rel="next" href="cha-libvirt-host.html" title="Chapter 9. Preparing the VM Host Server"/><script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/script-purejs.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script><meta name="edit-url" content="https://github.com/SUSE/doc-sle/edit/main/xml/libvirt_overview.xml"/></head><body class="draft wide offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"><img src="static/images/logo.svg" alt="Logo" class="logo"/></div></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">Virtualization Guide</a><span> / </span><a class="crumb" href="part-virt-libvirt.html">Managing virtual machines with libvirt</a><span> / </span><a class="crumb" href="cha-libvirt-overview.html">libvirt daemons</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title">Virtualization Guide</div><ol><li><a href="cha-kvm.html" class=" "><span class="title-number"> </span><span class="title-name">Preface</span></a></li><li><a href="part-virt-intro.html" class="has-children "><span class="title-number">I </span><span class="title-name">Introduction</span></a><ol><li><a href="chap-virtualization-introduction.html" class=" "><span class="title-number">1 </span><span class="title-name">Virtualization technology</span></a></li><li><a href="cha-virtualization-scenarios.html" class=" "><span class="title-number">2 </span><span class="title-name">Virtualization scenarios</span></a></li><li><a href="cha-xen-basics.html" class=" "><span class="title-number">3 </span><span class="title-name">Introduction to Xen virtualization</span></a></li><li><a href="cha-kvm-intro.html" class=" "><span class="title-number">4 </span><span class="title-name">Introduction to KVM virtualization</span></a></li><li><a href="cha-tools-intro.html" class=" "><span class="title-number">5 </span><span class="title-name">Virtualization tools</span></a></li><li><a href="cha-vt-installation.html" class=" "><span class="title-number">6 </span><span class="title-name">Installation of virtualization components</span></a></li><li><a href="cha-virt-support.html" class=" "><span class="title-number">7 </span><span class="title-name">Virtualization limits and support</span></a></li></ol></li><li class="active"><a href="part-virt-libvirt.html" class="has-children you-are-here"><span class="title-number">II </span><span class="title-name">Managing virtual machines with <code class="systemitem">libvirt</code></span></a><ol><li><a href="cha-libvirt-overview.html" class=" you-are-here"><span class="title-number">8 </span><span class="title-name"><code class="systemitem">libvirt</code> daemons</span></a></li><li><a href="cha-libvirt-host.html" class=" "><span class="title-number">9 </span><span class="title-name">Preparing the VM Host Server</span></a></li><li><a href="cha-kvm-inst.html" class=" "><span class="title-number">10 </span><span class="title-name">Guest installation</span></a></li><li><a href="cha-libvirt-managing.html" class=" "><span class="title-number">11 </span><span class="title-name">Basic VM Guest management</span></a></li><li><a href="cha-libvirt-connect.html" class=" "><span class="title-number">12 </span><span class="title-name">Connecting and authorizing</span></a></li><li><a href="cha-libvirt-storage.html" class=" "><span class="title-number">13 </span><span class="title-name">Advanced storage topics</span></a></li><li><a href="cha-libvirt-config-gui.html" class=" "><span class="title-number">14 </span><span class="title-name">Configuring virtual machines with Virtual Machine Manager</span></a></li><li><a href="cha-libvirt-config-virsh.html" class=" "><span class="title-number">15 </span><span class="title-name">Configuring virtual machines with <code class="command">virsh</code></span></a></li><li><a href="sec-libvirt-admin-migrate.html" class=" "><span class="title-number">16 </span><span class="title-name">Migrating VM Guests</span></a></li><li><a href="xen2kvm-migration.html" class=" "><span class="title-number">17 </span><span class="title-name">Xen to KVM migration guide</span></a></li></ol></li><li><a href="part-virt-common.html" class="has-children "><span class="title-number">III </span><span class="title-name">Hypervisor-independent features</span></a><ol><li><a href="cha-cachemodes.html" class=" "><span class="title-number">18 </span><span class="title-name">Disk cache modes</span></a></li><li><a href="sec-kvm-managing-clock.html" class=" "><span class="title-number">19 </span><span class="title-name">VM Guest clock settings</span></a></li><li><a href="chap-guestfs.html" class=" "><span class="title-number">20 </span><span class="title-name">libguestfs</span></a></li><li><a href="cha-qemu-ga.html" class=" "><span class="title-number">21 </span><span class="title-name">QEMU guest agent</span></a></li><li><a href="tpm.html" class=" "><span class="title-number">22 </span><span class="title-name">Software TPM emulator</span></a></li><li><a href="virt-crash-dump.html" class=" "><span class="title-number">23 </span><span class="title-name">Creating crash dumps of a VM Guest</span></a></li></ol></li><li><a href="part-virt-xen.html" class="has-children "><span class="title-number">IV </span><span class="title-name">Managing virtual machines with Xen</span></a><ol><li><a href="cha-xen-vhost.html" class=" "><span class="title-number">24 </span><span class="title-name">Setting up a virtual machine host</span></a></li><li><a href="cha-xen-network.html" class=" "><span class="title-number">25 </span><span class="title-name">Virtual networking</span></a></li><li><a href="cha-xen-manage.html" class=" "><span class="title-number">26 </span><span class="title-name">Managing a virtualization environment</span></a></li><li><a href="cha-xen-vbd.html" class=" "><span class="title-number">27 </span><span class="title-name">Block devices in Xen</span></a></li><li><a href="cha-xen-config.html" class=" "><span class="title-number">28 </span><span class="title-name">Virtualization: configuration options and settings</span></a></li><li><a href="cha-xen-admin.html" class=" "><span class="title-number">29 </span><span class="title-name">Administrative tasks</span></a></li><li><a href="cha-xen-xenstore.html" class=" "><span class="title-number">30 </span><span class="title-name">XenStore: configuration database shared between domains</span></a></li><li><a href="cha-xen-ha.html" class=" "><span class="title-number">31 </span><span class="title-name">Xen as a high-availability virtualization host</span></a></li><li><a href="pv-to-fv.html" class=" "><span class="title-number">32 </span><span class="title-name">Xen: converting a paravirtual (PV) guest into a fully virtual (FV/HVM) guest</span></a></li></ol></li><li><a href="part-virt-qemu.html" class="has-children "><span class="title-number">V </span><span class="title-name">Managing virtual machines with QEMU</span></a><ol><li><a href="cha-qemu-overview.html" class=" "><span class="title-number">33 </span><span class="title-name">QEMU overview</span></a></li><li><a href="cha-qemu-host.html" class=" "><span class="title-number">34 </span><span class="title-name">Setting up a KVM VM Host Server</span></a></li><li><a href="cha-qemu-guest-inst.html" class=" "><span class="title-number">35 </span><span class="title-name">Guest installation</span></a></li><li><a href="cha-qemu-running.html" class=" "><span class="title-number">36 </span><span class="title-name">Running virtual machines with qemu-system-ARCH</span></a></li><li><a href="cha-qemu-monitor.html" class=" "><span class="title-number">37 </span><span class="title-name">Virtual machine administration using QEMU monitor</span></a></li></ol></li><li><a href="part-virt-troubleshoot.html" class="has-children "><span class="title-number">VI </span><span class="title-name">Troubleshooting</span></a><ol><li><a href="cha-virt-help.html" class=" "><span class="title-number">38 </span><span class="title-name">Integrated help and package documentation</span></a></li><li><a href="cha-virt-logs.html" class=" "><span class="title-number">39 </span><span class="title-name">Gathering system information and logs</span></a></li></ol></li><li><a href="gloss-vt-glossary.html" class=" "><span class="title-number"> </span><span class="title-name">Glossary</span></a></li><li><a href="app-vmdp-driver.html" class=" "><span class="title-number">A </span><span class="title-name">Virtual machine drivers</span></a></li><li><a href="app-gpu-passthru.html" class=" "><span class="title-number">B </span><span class="title-name">Configuring GPU Pass-Through for NVIDIA cards</span></a></li><li><a href="cha-xmtoxl.html" class=" "><span class="title-number">C </span><span class="title-name">XM, XL toolstacks, and the <code class="systemitem">libvirt</code> framework</span></a></li><li><a href="bk10apd.html" class=" "><span class="title-number">D </span><span class="title-name">GNU licenses</span></a></li> </ol> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section class="chapter" id="cha-libvirt-overview" data-id-title="libvirt daemons"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname"><span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span></span> <span class="productnumber"><span class="productnumber"><span class="phrase">15 SP5</span></span></span></div><div><div class="title-container"><h1 class="title"><span class="title-number-name"><span class="title-number">8 </span><span class="title-name"><code class="systemitem">libvirt</code> daemons</span></span> <a title="Permalink" class="permalink" href="cha-libvirt-overview.html#">#</a></h1><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/libvirt_overview.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    A <code class="systemitem">libvirt</code> deployment for accessing KVM or Xen requires one or more
    daemons to be installed and active on the host. <code class="systemitem">libvirt</code> provides two
    daemon deployment options: monolithic or modular daemons. <code class="systemitem">libvirt</code> has
    always provided the single monolithic daemon <code class="systemitem">libvirtd</code>. It includes the
    primary hypervisor drivers and all secondary drivers needed for managing
    storage, networking, node devices, etc. The monolithic <code class="systemitem">libvirtd</code> also
    provides secure remote access for external clients. Over time <code class="systemitem">libvirt</code>
    added support for modular daemons, where each driver runs in its own
    daemon, allowing users to customize their <code class="systemitem">libvirt</code> deployment. The
    monolithic daemon is enabled by default, but a deployment can be
    switched to modular daemons by disabling <code class="systemitem">libvirtd</code> and enabling the
    desired individual daemons.
  </p><p>
    The modular daemon deployment is useful in scenarios where minimal
    <code class="systemitem">libvirt</code> support is needed. For example, if virtual machine storage and
    networking is not provided by <code class="systemitem">libvirt</code>, the
    <span class="package">libvirt-daemon-driver-storage</span> and
    <span class="package">libvirt-daemon-driver-network</span> packages are not
    required. Kubernetes is an example of an extreme case, where it handles all
    networking, storage, cgroups and namespace integration, etc. Only the
    <span class="package">libvirt-daemon-driver-QEMU</span> package, providing
    <code class="systemitem">virtqemud</code>, needs to be installed.
    Modular daemons allow configuring a custom <code class="systemitem">libvirt</code> deployment containing
    only the components required for the use case.
  </p><section class="sect1" id="libvirt-monolithic-daemon" data-id-title="Starting and stopping the monolithic daemon"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">8.1 </span><span class="title-name">Starting and stopping the monolithic daemon</span></span> <a title="Permalink" class="permalink" href="cha-libvirt-overview.html#libvirt-monolithic-daemon">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/libvirt_overview.xml" title="Edit source document"> </a></div></div></div></div></div><p>
      The monolithic daemon is known as <code class="systemitem">libvirtd</code> and is configured via
      <code class="filename">/etc/libvirt/libvirtd.conf</code>. <code class="systemitem">libvirtd</code> is managed
      with several <code class="systemitem">systemd</code> unit files:
    </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
          <span class="emphasis"><em>libvirtd.service</em></span> - The main <code class="systemitem">systemd</code> unit file
          for launching <code class="systemitem">libvirtd</code>. We recommend configuring
          <code class="filename">libvirtd.service</code> to start on boot if VMs are
          also configured to start on host boot.
        </p></li><li class="listitem"><p>
          <span class="emphasis"><em>libvirtd.socket</em></span> - The unit file corresponding to
          the main read-write UNIX socket
          <code class="filename">/var/run/libvirt/libvirt-sock</code>. We recommend
          enabling this unit on boot.
        </p></li><li class="listitem"><p>
          <span class="emphasis"><em>libvirtd-ro.socket</em></span> - The unit file corresponding
          to the main read-only UNIX socket
          <code class="filename">/var/run/libvirt/libvirt-sock-ro</code>. We recommend
          enabling this unit on boot.
        </p></li><li class="listitem"><p>
          <span class="emphasis"><em>libvirtd-admin.socket</em></span> - The unit file
          corresponding to the administrative UNIX socket
          <code class="filename">/var/run/libvirt/libvirt-admin-sock</code>. We
          recommend enabling this unit on boot.
        </p></li><li class="listitem"><p>
          <span class="emphasis"><em>libvirtd-tcp.socket</em></span> - The unit file
          corresponding to the TCP 16509 port for non-TLS remote access. This
          unit should not be configured to start on boot until the
          administrator has configured a suitable authentication mechanism.
        </p></li><li class="listitem"><p>
          <span class="emphasis"><em>libvirtd-tls.socket</em></span> - The unit file
          corresponding to the TCP 16509 port for TLS remote access. This unit
          should not be configured to start on boot until the administrator has
          deployed x509 certificates and optionally configured a suitable
          authentication mechanism.
        </p></li></ul></div><p>
      When <code class="systemitem">systemd</code> socket activation is used, certain configuration settings
      in <code class="filename">libvirtd.conf</code> are no longer honored. Instead,
      these settings must be controlled via the system unit files:
    </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
          <span class="emphasis"><em>listen_tcp</em></span> - TCP socket usage is enabled by
          starting the <code class="filename">libvirtd-tcp.socket</code> unit file.
        </p></li><li class="listitem"><p>
          <span class="emphasis"><em>listen_tls</em></span> - TLS socket usage is enabled by
          starting the <code class="filename">libvirtd-tls.socket</code> unit file.
        </p></li><li class="listitem"><p>
          <span class="emphasis"><em>tcp_port</em></span> - Port for the non-TLS TCP socket,
          controlled via the <code class="option">ListenStream</code> parameter in the
          <code class="filename">libvirtd-tcp.socket</code> unit file.
        </p></li><li class="listitem"><p>
          <span class="emphasis"><em>tls_port</em></span> - Port for the TLS TCP socket,
          controlled via the <code class="option">ListenStream</code> parameter in the
          <code class="filename">libvirtd-tls.socket</code> unit file.
        </p></li><li class="listitem"><p>
          <span class="emphasis"><em>listen_addr</em></span> - IP address to listen on,
          independently controlled via the <code class="option">ListenStream</code>
          parameter in the <code class="filename">libvirtd-tcp.socket</code> or
          <code class="filename">libvirtd-tls.socket</code> unit files.
        </p></li><li class="listitem"><p>
          <span class="emphasis"><em>unix_sock_group</em></span> - UNIX socket group owner,
          controlled via the <code class="option">SocketGroup</code> parameter in the
          <code class="filename">libvirtd.socket</code> and
          <code class="filename">libvirtd-ro.socket</code> unit files.
        </p></li><li class="listitem"><p>
          <span class="emphasis"><em>unix_sock_ro_perms</em></span> - Read-only UNIX socket
          permissions, controlled via the <code class="option">SocketMode</code> parameter
          in the <code class="filename">libvirtd-ro.socket</code> unit file.
        </p></li><li class="listitem"><p>
          <span class="emphasis"><em>unix_sock_rw_perms</em></span> - Read-write UNIX socket
          permissions, controlled via the <code class="option">SocketMode</code> parameter
          in the <code class="filename">libvirtd.socket</code> unit file.
        </p></li><li class="listitem"><p>
          <span class="emphasis"><em>unix_sock_admin_perms</em></span> - Admin UNIX socket
          permissions, controlled via the <code class="option">SocketMode</code> parameter
          in the <code class="filename">libvirtd-admin.socket</code> unit file.
        </p></li><li class="listitem"><p>
          <span class="emphasis"><em>unix_sock_dir</em></span> - Directory in which all UNIX
          sockets are created, independently controlled via the
          <code class="option">ListenStream</code> parameter in any of the
          <code class="filename">libvirtd.socket</code>,
          <code class="filename">libvirtd-ro.socket</code> and
          <code class="filename">libvirtd-admin.socket</code> unit files.
        </p></li></ul></div><div id="id-1.12.4.2.5.6" data-id-title="Conflicting services: libvirtd and xendomains" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg"/><div class="admon-title">Important: Conflicting services: <code class="systemitem">libvirtd</code> and <code class="systemitem">xendomains</code></div><p>
        If <code class="systemitem">libvirtd</code> fails to start, check if the service
        <code class="systemitem">xendomains</code> is loaded:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code>systemctl is-active xendomains active</pre></div><p>
        If the command returns <code class="literal">active</code>, you need to stop
        <code class="systemitem">xendomains</code> before you can start
        the <code class="systemitem">libvirtd</code> daemon. If you want <code class="systemitem">libvirtd</code> to also start after
        rebooting, additionally prevent
        <code class="systemitem">xendomains</code> from starting
        automatically. Disable the service:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> systemctl stop xendomains
<code class="prompt user">&gt; </code><code class="command">sudo</code> systemctl disable xendomains
<code class="prompt user">&gt; </code><code class="command">sudo</code> systemctl start libvirtd</pre></div><p>
        <code class="systemitem">xendomains</code> and <code class="systemitem">libvirtd</code>
        provide the same service and when used in parallel, may interfere with
        one another. As an example,
        <code class="systemitem">xendomains</code> may attempt to start
        a domU already started by <code class="systemitem">libvirtd</code>.
      </p></div></section><section class="sect1" id="libvirt-modular-daemon" data-id-title="Starting and stopping the modular daemons"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">8.2 </span><span class="title-name">Starting and stopping the modular daemons</span></span> <a title="Permalink" class="permalink" href="cha-libvirt-overview.html#libvirt-modular-daemon">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/libvirt_overview.xml" title="Edit source document"> </a></div></div></div></div></div><p>
      The modular daemons are named after the driver which they are running,
      with the pattern <span class="quote">“<span class="quote">virt<em class="replaceable">DRIVER</em>d</span>”</span>.
      They are configured via the files
      <code class="filename">/etc/libvirt/virt<em class="replaceable">DRIVER</em>d.conf</code>.
      SUSE supports the <code class="systemitem">virtqemud</code> and
      <code class="systemitem">virtxend</code> hypervisor daemons, along with
      all the secondary daemons:
    </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
          <span class="emphasis"><em>virtnetworkd</em></span> - The virtual network management
          daemon which provides <code class="systemitem">libvirt</code>'s virtual network management APIs.
          For example, virtnetworkd can be used to create a NAT virtual network
          on the host for use by virtual machines.
        </p></li><li class="listitem"><p>
          <span class="emphasis"><em>virtnodedevd</em></span> - The host physical device
          management daemon which provides <code class="systemitem">libvirt</code>'s node device management
          APIs. For example, virtnodedevd can be used to detach a PCI device
          from the host for use by a virtual machine.
        </p></li><li class="listitem"><p>
          <span class="emphasis"><em>virtnwfilterd</em></span> - The host firewall management
          daemon which provides <code class="systemitem">libvirt</code>'s firewall management APIs. For
          example, virtnwfilterd can be used to configure network traffic
          filtering rules for virtual machines.
        </p></li><li class="listitem"><p>
          <span class="emphasis"><em>virtsecretd</em></span> - The host secret management daemon
          which provides <code class="systemitem">libvirt</code>'s secret management APIs. For example,
          virtsecretd can be used to store a key associated with a LUKs volume.
        </p></li><li class="listitem"><p>
          <span class="emphasis"><em>virtstoraged</em></span> - The host storage management
          daemon which provides <code class="systemitem">libvirt</code>'s storage management APIs.
          virtstoraged can be used to create storage pools and create volumes
          from those pools.
        </p></li><li class="listitem"><p>
          <span class="emphasis"><em>virtinterfaced</em></span> - The host NIC management daemon
          which provides <code class="systemitem">libvirt</code>'s host network interface management APIs.
          For example, virtinterfaced can be used to create a bonded network
          device on the host. SUSE discourages the use of <code class="systemitem">libvirt</code>'s interface
          management APIs in favor of default networking tools like wicked or
          NetworkManager. It is recommended to disable virtinterfaced.
        </p></li><li class="listitem"><p>
          <span class="emphasis"><em>virtproxyd</em></span> - A daemon to proxy connections
          between the traditional <code class="systemitem">libvirtd</code> sockets and the modular daemon
          sockets. With a modular <code class="systemitem">libvirt</code> deployment, virtproxyd allows
          remote clients to access the <code class="systemitem">libvirt</code> APIs similar to the monolithic
          <code class="systemitem">libvirtd</code>. It can also be used by local clients that connect to the
          monolithic <code class="systemitem">libvirtd</code> sockets.
        </p></li><li class="listitem"><p>
          <span class="emphasis"><em>virtlogd</em></span> - A daemon to manage logs from virtual
          machine consoles. virtlogd is also used by the monolithic <code class="systemitem">libvirtd</code>.
          The monolithic daemon and virtqemud <code class="systemitem">systemd</code> unit files require
          virtlogd, so it is not necessary to explicitly start virtlogd.
        </p></li><li class="listitem"><p>
          <span class="emphasis"><em>virtlockd</em></span> - A daemon to manage locks held
          against virtual machine resources such as disks. virtlockd is also
          used by the monolithic <code class="systemitem">libvirtd</code>. The monolithic daemon, virtqemud,
          and virtxend <code class="systemitem">systemd</code> unit files require virtlockd, so it is not
          necessary to explicitly start virtlockd.
        </p></li></ul></div><p>
      <code class="systemitem">virtlogd</code> and
      <code class="systemitem">virtlockd</code> are also used by the
      monolithic <code class="systemitem">libvirtd</code>. These daemons have always been separate from
      <code class="systemitem">libvirtd</code> for security reasons.
    </p><p>
      By default, the modular daemons listen for connections on the
      <code class="filename">/var/run/libvirt/virt<em class="replaceable">DRIVER</em>d-sock</code>
      and
      <code class="filename">/var/run/libvirt/virt<em class="replaceable">DRIVER</em>d-sock-ro</code>
      Unix Domain Sockets. The client library prefers these sockets over the
      traditional <code class="filename">/var/run/libvirt/libvirtd-sock</code>. The
      virtproxyd daemon is available for remote clients or local clients
      expecting the traditional <code class="systemitem">libvirtd</code> socket.
    </p><p>
      Like the monolithic daemon, the modular daemons are managed with several
      <code class="systemitem">systemd</code> unit files:
    </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
          <span class="emphasis"><em>virt<em class="replaceable">DRIVER</em>d.service</em></span> -
          The main unit file for launching the
          virt<em class="replaceable">DRIVER</em>d daemon. We recommend
          configuring the service to start on boot if VMs are also configured
          to start on host boot.
        </p></li><li class="listitem"><p>
          <span class="emphasis"><em>virt<em class="replaceable">DRIVER</em>d.socket</em></span> -
          The unit file corresponding to the main read-write UNIX socket
          <code class="filename">/var/run/libvirt/virt<em class="replaceable">DRIVER</em>d-sock</code>.
          We recommend starting this socket on boot by default.
        </p></li><li class="listitem"><p>
          <span class="emphasis"><em>virt<em class="replaceable">DRIVER</em>d-ro.socket</em></span>
          - The unit file corresponding to the main read-only UNIX socket
          <code class="filename">/var/run/libvirt/virt<em class="replaceable">DRIVER</em>d-sock-ro</code>.
          We recommend starting this socket on boot by default.
        </p></li><li class="listitem"><p>
          <span class="emphasis"><em>virt<em class="replaceable">DRIVER</em>d-admin.socket</em></span>
          - The unit file corresponding to the administrative UNIX socket
          <code class="filename">/var/run/libvirt/virt<em class="replaceable">DRIVER</em>d-admin-sock</code>.
          We recommend starting this socket on boot by default.
        </p></li></ul></div><p>
      When <code class="systemitem">systemd</code> socket activation is used, several configuration settings
      in virt<em class="replaceable">DRIVER</em>d.conf are no longer honored.
      Instead, these settings must be controlled via the system unit files:
    </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
          <span class="emphasis"><em>unix_sock_group</em></span> - UNIX socket group owner,
          controlled via the <code class="option">SocketGroup</code> parameter in the
          <code class="filename">virt<em class="replaceable">DRIVER</em>d.socket</code>
          and
          <code class="filename">virt<em class="replaceable">DRIVER</em>d-ro.socket</code>
          unit files.
        </p></li><li class="listitem"><p>
          <span class="emphasis"><em>unix_sock_ro_perms</em></span> - Read-only UNIX socket
          permissions, controlled via the <code class="option">SocketMode</code> parameter
          in the
          <code class="filename">virt<em class="replaceable">DRIVER</em>d-ro.socket</code>
          unit file.
        </p></li><li class="listitem"><p>
          <span class="emphasis"><em>unix_sock_rw_perms</em></span> - Read-write UNIX socket
          permissions, controlled via the <code class="option">SocketMode</code> parameter
          in the
          <code class="filename">virt<em class="replaceable">DRIVER</em>d.socket</code>
          unit file.
        </p></li><li class="listitem"><p>
          <span class="emphasis"><em>unix_sock_admin_perms</em></span> - Admin UNIX socket
          permissions, controlled via the <code class="option">SocketMode</code> parameter
          in the
          <code class="filename">virt<em class="replaceable">DRIVER</em>d-admin.socket</code>
          unit file.
        </p></li><li class="listitem"><p>
          <span class="emphasis"><em>unix_sock_dir</em></span> - Directory in which all UNIX
          sockets are created, independently controlled via the
          <code class="option">ListenStream</code> parameter in any of the
          <code class="filename">virt<em class="replaceable">DRIVER</em>d.socket</code>,
          <code class="filename">virt<em class="replaceable">DRIVER</em>d-ro.socket</code>
          and
          <code class="filename">virt<em class="replaceable">DRIVER</em>d-admin.socket</code>
          unit files.
        </p></li></ul></div></section><section class="sect1" id="libvirt-switch-daemons" data-id-title="Switching to modular daemons"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">8.3 </span><span class="title-name">Switching to modular daemons</span></span> <a title="Permalink" class="permalink" href="cha-libvirt-overview.html#libvirt-switch-daemons">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/libvirt_overview.xml" title="Edit source document"> </a></div></div></div></div></div><p>
      Several services need to be changed when switching from the monolithic to
      modular daemons. It is recommended to stop or evict any running virtual
      machines before switching between the daemon options.
    </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
          Stop the monolithic daemon and its sockets
        </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> systemctl stop libvirtd.service
<code class="prompt user">&gt; </code><code class="command">sudo</code> systemctl stop libvirtd{,-ro,-admin}.socket</pre></div></li><li class="step"><p>
          Disable future start of the monolithic daemon
        </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> systemctl disable libvirtd.service
<code class="prompt user">&gt; </code><code class="command">sudo</code> systemctl disable libvirtd{,-ro,-admin}.socket</pre></div></li><li class="step"><p>
          Enable the modular daemons for KVM or Xen, including the desired
          secondary daemons. The following example enables the QEMU daemon
          for KVM and all the secondary daemons except the interface daemon:
        </p><div class="verbatim-wrap"><pre class="screen">for drv in qemu network nodedev nwfilter secret storage
do
 <code class="prompt user">&gt; </code><code class="command">sudo</code> systemctl enable virt${drv}d.service
 <code class="prompt user">&gt; </code><code class="command">sudo</code> systemctl enable virt${drv}d{,-ro,-admin}.socket
done</pre></div></li><li class="step"><p>
          Start the sockets for the same set of daemons
        </p><div class="verbatim-wrap"><pre class="screen">for drv in qemu network nodedev nwfilter secret storage
do
 <code class="prompt user">&gt; </code><code class="command">sudo</code> systemctl start virt${drv}d{,-ro,-admin}.socket
done</pre></div></li><li class="step"><p>
          If connections from remote hosts need to be supported, the virtproxyd
          daemon must be enabled and started:
        </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> systemctl enable virtproxyd.service
<code class="prompt user">&gt; </code><code class="command">sudo</code> systemctl enable virtproxyd{,-ro,-admin}.socket
<code class="prompt user">&gt; </code><code class="command">sudo</code> systemctl start virtproxyd{,-ro,-admin}.socket</pre></div></li></ol></div></div></section></section><nav class="bottom-pagination"><div><a class="pagination-link prev" href="part-virt-libvirt.html"><span class="pagination-relation">Previous</span><span class="pagination-label"><span class="title-number">Part II </span>Managing virtual machines with <code class="systemitem">libvirt</code></span></a> </div><div><a class="pagination-link next" href="cha-libvirt-host.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Chapter 9 </span>Preparing the VM Host Server</span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="sect1"><a href="cha-libvirt-overview.html#libvirt-monolithic-daemon"><span class="title-number">8.1 </span><span class="title-name">Starting and stopping the monolithic daemon</span></a></span></li><li><span class="sect1"><a href="cha-libvirt-overview.html#libvirt-modular-daemon"><span class="title-number">8.2 </span><span class="title-name">Starting and stopping the modular daemons</span></a></span></li><li><span class="sect1"><a href="cha-libvirt-overview.html#libvirt-switch-daemons"><span class="title-number">8.3 </span><span class="title-name">Switching to modular daemons</span></a></span></li></ul></div><div class="side-title">Share this page</div><ul class="share"><li><a id="_share-fb" href="#" title="Facebook"> </a></li><li><a id="_share-in" href="#" title="LinkedIn"> </a></li><li><a id="_share-tw" href="#" title="Twitter/X"> </a></li><li><a id="_share-mail" href="#" title="E-Mail"> </a></li><li><a id="_print-button" href="#" title="Print this page"> </a></li></ul> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2024</span></div></div></footer></body></html>