<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><title>SLED 15 SP5 | Upgrade Guide | Preparing the upgrade</title><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"/>
<meta name="title" content="Preparing the upgrade | SLED 15 SP5"/>
<meta name="description" content="Before starting the upgrade procedure, make sure your system is properly prepared. Among other things, preparation involves backing up data and check…"/>
<meta name="product-name" content="SUSE Linux Enterprise Desktop"/>
<meta name="product-number" content="15 SP5"/>
<meta name="book-title" content="Upgrade Guide"/>
<meta name="chapter-title" content="Chapter 3. Preparing the upgrade"/>
<meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi"/>
<meta name="tracker-type" content="bsc"/>
<meta name="tracker-bsc-assignee" content="fs@suse.com"/>
<meta name="tracker-bsc-component" content="Documentation"/>
<meta name="tracker-bsc-product" content="PUBLIC SUSE Linux Enterprise Desktop 15 SP5"/>
<meta name="publisher" content="SUSE"/><meta property="og:title" content="Upgrade Guide"/>
<meta property="og:description" content="Perform a SLED upgrade"/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Upgrade Guide"/>
<meta name="twitter:description" content="Perform a SLED upgrade"/>
<script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": ["TechArticle"],
    "image": "https://www.suse.com/assets/img/suse-white-logo-green.svg",
    
     "isPartOf": {
      "@type": "CreativeWorkSeries",
      "name": "Products &amp; Solutions"
    },
    
    "inLanguage": "en",
    

    "headline": "Preparing the upgrade",
  
    "description": "Before starting the upgrade procedure, make sure your system is properly prepared. Among other things, preparation involves backing up data and check…",
      
    "author": [
      {
        "@type": "Corporation",
        "name": "SUSE Product &amp; Solution Documentation Team",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    ],
      
    "dateModified": "2024-05-27T00:00+02:00",
      
    "datePublished": "2023-06-20T00:00+02:00",
      

    "about": [
      
    ],
  
    "sameAs": [
          "https://www.facebook.com/SUSEWorldwide/about",
          "https://www.youtube.com/channel/UCHTfqIzPKz4f_dri36lAQGA",
          "https://twitter.com/SUSE",
          "https://www.linkedin.com/company/suse"
    ],
    "publisher": {
      "@type": "Corporation",
      "name": "SUSE",
      "url": "https://documentation.suse.com",
      "logo": {
        "@type": "ImageObject",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    }
  }</script>
<link rel="prev" href="cha-upgrade-paths.html" title="Chapter 2. Upgrade paths and methods"/><link rel="next" href="cha-upgrade-offline.html" title="Chapter 4. Upgrading offline"/><script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/script-purejs.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script><meta name="edit-url" content="https://github.com/SUSE/doc-sle/edit/main/xml/sle_update_preparation.xml"/></head><body class="draft wide offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"><img src="static/images/logo.svg" alt="Logo" class="logo"/></div></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">Upgrade Guide</a><span> / </span><a class="crumb" href="cha-update-preparation.html">Preparing the upgrade</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title">Upgrade Guide</div><ol><li><a href="preface-upgrade.html" class=" "><span class="title-number"> </span><span class="title-name">Preface</span></a></li><li><a href="cha-upgrade-background.html" class=" "><span class="title-number">1 </span><span class="title-name">Lifecycle and support</span></a></li><li><a href="cha-upgrade-paths.html" class=" "><span class="title-number">2 </span><span class="title-name">Upgrade paths and methods</span></a></li><li><a href="cha-update-preparation.html" class=" you-are-here"><span class="title-number">3 </span><span class="title-name">Preparing the upgrade</span></a></li><li><a href="cha-upgrade-offline.html" class=" "><span class="title-number">4 </span><span class="title-name">Upgrading offline</span></a></li><li><a href="cha-upgrade-online.html" class=" "><span class="title-number">5 </span><span class="title-name">Upgrading online</span></a></li><li><a href="cha-upgrade-finish.html" class=" "><span class="title-number">6 </span><span class="title-name">Finishing the upgrade</span></a></li><li><a href="cha-update-backport.html" class=" "><span class="title-number">7 </span><span class="title-name">Backports of source code</span></a></li><li><a href="bk03apa.html" class=" "><span class="title-number">A </span><span class="title-name">GNU licenses</span></a></li> </ol> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section class="chapter" id="cha-update-preparation" data-id-title="Preparing the upgrade"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname"><span class="productname"><span class="phrase">SUSE Linux Enterprise Desktop</span></span></span> <span class="productnumber"><span class="productnumber"><span class="phrase">15 SP5</span></span></span></div><div><div class="title-container"><h1 class="title"><span class="title-number-name"><span class="title-number">3 </span><span class="title-name">Preparing the upgrade</span></span> <a title="Permalink" class="permalink" href="cha-update-preparation.html#">#</a></h1><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/sle_update_preparation.xml" title="Edit source document"> </a></div></div></div><div><div class="abstract"><p>
    Before starting the upgrade procedure, make sure your system is properly
    prepared. Among other things, preparation involves backing up data and
    checking the release notes. The following chapter guides you through these
    steps.
   </p></div></div></div></div><section class="sect1" id="sec-update-preparation-update" data-id-title="Make sure the system is up-to-date"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">3.1 </span><span class="title-name">Make sure the system is up-to-date</span></span> <a title="Permalink" class="permalink" href="cha-update-preparation.html#sec-update-preparation-update">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/sle_update_preparation.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   
   Upgrading the system is only supported from the most recent patch level.
   Make sure the latest system updates are installed by
   <span class="phrase">either</span> running <code class="command">zypper
   patch</code><span class="phrase"> or by starting the YaST module
   <span class="guimenu">Online-Update</span></span>.
  </p><div id="new-4096-bit-rpm-key" data-id-title="New 4096-bit signing key for SUSE Linux Enterprise 15" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note: New 4096-bit signing key for SUSE Linux Enterprise 15</div><p>
        Mid 2023, the SUSE Linux Enterprise 15 product family switched over from a RSA 2048-bit signing key to a new
        RSA 4096-bit key. This change covers RPM packages, package repositories and ISO signatures.
        Old repositories that are not updated anymore and RPMs released up to the switch-over date,
        will still stay signed with the old 2048 bit key.
      </p><p>
        If you update your system, the new key is automatically imported into the
        RPM keyring from the <span class="package">suse-build-key</span> package on SLE 15 SP 4 and SP5 as
        well as the LTSS versions of SLE 15 SP1, SP2, and SP3.
      </p><p>
        If the key was not imported yet, you can manually import it with:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> <code class="command">rpm --import /usr/lib/rpm/gnupg/keys/gpg-pubkey-3fa1d6ce-63c9481c.asc</code></pre></div><p>
        If you are running an older version of SLE or did not import the new key, you will be
        asked to trust it during the upgrade. Please make sure the fingerprint matches:
      </p><div class="verbatim-wrap"><pre class="screen">pub   rsa4096/0xF74F09BC3FA1D6CE 2023-01-19 [SC] [expires: 2027-01-18]
Key fingerprint = 7F00 9157 B127 B994 D5CF  BE76 F74F 09BC 3FA1 D6CE
uid           SUSE Package Signing Key &lt;build@suse.de&gt;</pre></div><p>
        Additionally, a reserve 4096-bit RSA key for disaster recovery purposes was imported:
      </p><div class="verbatim-wrap"><pre class="screen">pub   rsa4096/0xA1BFC02BD588DC46 2023-01-19 [SC] [expires: 2033-01-16]
Key fingerprint = B56E 5601 41D8 F654 2DFF  3BF9 A1BF C02B D588 DC46
uid           SUSE Package Signing Key (reserve key) &lt;build@suse.de&gt;</pre></div><p>
        This key can be manually imported using:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> <code class="command">rpm --import /usr/lib/rpm/gnupg/keys/gpg-pubkey-d588dc46-63c939db.asc</code></pre></div><p>
        Both keys can also be found on the installation media and the SUSE website at <a class="link" href="https://www.suse.com/support/security/keys/" target="_blank">https://www.suse.com/support/security/keys/</a>.
      </p></div></section><section class="sect1" id="sec-update-preparation-relnotes" data-id-title="Read the release notes"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">3.2 </span><span class="title-name">Read the release notes</span></span> <a title="Permalink" class="permalink" href="cha-update-preparation.html#sec-update-preparation-relnotes">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/sle_update_preparation.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   Find a list of all changes, new features, and known issues in the
   <a class="link" href="https://www.suse.com/releasenotes/" target="_blank">release notes</a>.
   You can also find the release notes on the installation media in the
   <code class="filename">docu</code> directory.
  </p><p>
   The release notes usually only contain the changes between two subsequent
   releases. <span class="phrase">If you are skipping one or more Service
   Packs, check the release notes of the skipped Service Packs as
   well.</span>
  </p><p>
   Consult the release notes to check whether the following applies:
  </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
     Your hardware needs special considerations
    </p></li><li class="listitem"><p>
     Any currently used software packages have changed significantly
    </p></li><li class="listitem"><p>
     Your installation requires special precautions
    </p></li></ul></div></section><section class="sect1" id="sec-update-preparation-backup" data-id-title="Make a backup"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">3.3 </span><span class="title-name">Make a backup</span></span> <a title="Permalink" class="permalink" href="cha-update-preparation.html#sec-update-preparation-backup">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/sle_update_preparation.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   Before upgrading, back up your data by copying the existing configuration
   files to a separate medium (such as tape device, removable hard disk, etc.).
   This primarily applies to files stored in <code class="filename">/etc</code> and some
   directories and files in <code class="filename">/var</code> and
   <code class="filename">/opt</code>. You may also want to write the user data in
   <code class="filename">/home</code> (the <code class="envar">HOME</code> directories) to a backup
   medium.
  </p><p>
   Back up all data as <code class="systemitem">root</code>. Only <code class="systemitem">root</code> has sufficient permissions
   for all local files.
  </p><p>
   
   If you have selected <span class="guimenu">Update an Existing System</span> as the
   installation mode in YaST, you can choose to do a (system) backup at a
   later point in time. You can choose to include all modified files and files
   from the <code class="filename">/etc/sysconfig</code> directory. However, this is not
   a complete backup, as all the other important directories mentioned above
   are missing. Find the backup in the <code class="filename">/var/adm/backup</code>
   directory.
  </p></section><section class="sect1" id="sec-update-preparation-disk" data-id-title="Check the available disk space"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">3.4 </span><span class="title-name">Check the available disk space</span></span> <a title="Permalink" class="permalink" href="cha-update-preparation.html#sec-update-preparation-disk">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/sle_update_preparation.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   Software tends to grow from version to version. Therefore, take a look at
   the available partition space before updating. If you suspect you are
   running short of disk space, back up your data before increasing the
   available space by resizing partitions, for example. There is no general
   rule regarding how much space each partition should have. Space requirements
   depend on your particular partitioning profile and the software selected.
  </p><div id="id-1.5.5.7.3" data-id-title="Automatic check for enough space in YaST" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note: Automatic check for enough space in YaST</div><p>
    During the update procedure, YaST will check how much free disk space is
    available and display a warning to the user if the installation may exceed
    the available amount. In that case, performing the update may lead to an
    <span class="emphasis"><em>unusable system</em></span>! Only if you know exactly what you are
    doing (by testing beforehand), you can skip the warning and continue the
    update.
   </p></div><section class="sect2" id="sec-update-preparation-disk-space" data-id-title="Checking disk space on non-Btrfs file systems"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">3.4.1 </span><span class="title-name">Checking disk space on non-Btrfs file systems</span></span> <a title="Permalink" class="permalink" href="cha-update-preparation.html#sec-update-preparation-disk-space">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/sle_update_preparation.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    Use the <code class="command">df</code> command to list available disk space. For
    example, in <a class="xref" href="cha-update-preparation.html#ex-update-df" title="List with df -h">Example 3.1, “List with <code class="command">df -h</code>”</a>, the root partition is
    <code class="filename">/dev/sda3</code> (mounted as <code class="filename">/</code>).
   </p><div class="example" id="ex-update-df" data-id-title="List with df -h"><div class="title-container"><div class="example-title-wrap"><div class="example-title"><span class="title-number-name"><span class="title-number">Example 3.1: </span><span class="title-name">List with <code class="command">df -h</code> </span></span><a title="Permalink" class="permalink" href="cha-update-preparation.html#ex-update-df">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/sle_update_preparation.xml" title="Edit source document"> </a></div></div><div class="example-contents"><div class="verbatim-wrap"><pre class="screen">Filesystem     Size  Used Avail Use% Mounted on
     /dev/sda3       74G   22G   53G  29% /
     tmpfs          506M     0  506M   0% /dev/shm
     /dev/sda5      116G  5.8G  111G   5% /home
     /dev/sda1       39G  1.6G   37G   4% /windows/C
     /dev/sda2      4.6G  2.6G  2.1G  57% /windows/D</pre></div></div></div></section><section class="sect2" id="sec-update-preparation-disk-btrfs-on-root" data-id-title="Checking disk space on Btrfs root file systems"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">3.4.2 </span><span class="title-name">Checking disk space on Btrfs root file systems</span></span> <a title="Permalink" class="permalink" href="cha-update-preparation.html#sec-update-preparation-disk-btrfs-on-root">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/sle_update_preparation.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    On a Btrfs file system, the output of <code class="command">df</code> can be
    misleading, because in addition to the space the raw data allocates, a
    Btrfs file system also allocates and uses space for metadata.
   </p><p>
    Consequently a Btrfs file system may report being out of space even though
    it seems that plenty of space is still available. In that case, all space
    allocated for the metadata is used up.  For
    more information refer to <span class="phrase"><code class="command">man 8
     btrfs-filesystem</code> and
    </span><a class="link" href="https://btrfs.wiki.kernel.org/index.php/FAQ" target="_blank">https://btrfs.wiki.kernel.org/index.php/FAQ</a>.
   </p><p>
    When using Btrfs for root file systems on your machine, make sure there is
    enough free space. Check the available space on all mounted partitions. In
    the worst case, an upgrade needs as much disk space as the current root
    file system (without <code class="filename">/.snapshot</code>) for a new snapshot.
   </p><p>
    The following recommendations have been proven:
   </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
      For all file systems, including Btrfs, you need enough free disk space to
      download and install big RPMs. The space of old RPMs is only freed after
      new RPMs are installed.
     </p></li><li class="listitem"><p>
      For Btrfs with snapshots, you need as a minimum as much free space as
      your current installation takes. We recommend having twice as much free
      space as the current installation.
     </p><p>
      If you do not have enough free space, you can try to delete old snapshots
      with <code class="command">snapper</code>:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">snapper</code> list
      <code class="prompt root"># </code><code class="command">snapper</code> delete NUMBER</pre></div><p>
      However, this may not help in all cases. Before migration, most snapshots
      occupy only little space.
     </p></li></ul></div></section></section><section class="sect1" id="sec-update-preparation-packagelist" data-id-title="Listing installed packages and repositories"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">3.5 </span><span class="title-name">Listing installed packages and repositories</span></span> <a title="Permalink" class="permalink" href="cha-update-preparation.html#sec-update-preparation-packagelist">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/sle_update_preparation.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   
   You can save a list of installed packages; for example, when doing a fresh
   install of a new major SLE release or reverting to the old version.
  </p><div id="id-1.5.5.8.3" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note</div><p>
    
    Be aware that not all installed packages or used repositories are available
    in newer releases of SUSE Linux Enterprise. Some may have been renamed and others replaced.
    It is also possible that some packages are still available for legacy
    purposes while another package is used by default. Therefore, some manual
    editing of the files might be necessary. This can be done with any text
    editor.
   </p></div><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
     Create a file named <code class="filename">repositories.bak.repo</code> containing
     a list of all used repositories:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">zypper</code> lr -e repositories.bak</pre></div></li><li class="step"><p>
     Also create a file named <code class="filename">installed-software.bak</code>
     containing a list of all installed packages:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">rpm</code> -qa --queryformat '%{NAME}\n' &gt; installed-software.bak</pre></div></li><li class="step"><p>
     Back up both files. The repositories and installed packages can be
     restored with the following commands:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">zypper</code> ar repositories.bak.repo
<code class="prompt root"># </code><code class="command">zypper</code> install $(cat installed-software.bak)</pre></div><div id="note-update-prep-backup-package-amount" data-id-title="Number of packages increases with an update to a new major release" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note: Number of packages increases with an update to a new major release</div><p>
      A system upgraded to a new major version (SLE <em class="replaceable">X+1</em>) may
      contain more packages than the initial system (SLE <em class="replaceable">X</em>). It
      will also contain more packages than a fresh installation of
      SLE <em class="replaceable">X+1</em> with the same pattern selection.  Reasons for this
      are:
     </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
        Packages were split to allow a more fine-grained package selection. For
        example, 37 <span class="package">texlive</span> packages on SLE 11 were split
        into over 3000 packages on SLE 15.
       </p></li><li class="listitem"><p>
        When a package has been split, all new packages are installed in the
        upgrade case to retain the same functionality as the previous
        version. However, the new default for a fresh installation of
        SLE <em class="replaceable">X+1</em> may be to not install all
        packages.
       </p></li><li class="listitem"><p>
        Legacy packages from SLE <em class="replaceable">X</em> may be kept
        for compatibility reasons.
       </p></li><li class="listitem"><p>
        Package dependencies and the scope of patterns may have changed.
       </p></li></ul></div></div></li></ol></div></div></section><section class="sect1" id="sec-update-preparation-ltss" data-id-title="Disable the LTSS extension"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">3.6 </span><span class="title-name">Disable the LTSS extension</span></span> <a title="Permalink" class="permalink" href="cha-update-preparation.html#sec-update-preparation-ltss">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/sle_update_preparation.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   If you upgrade a <span class="productname"><span class="phrase">SUSE Linux Enterprise Desktop</span></span> system with Long Term Service Pack Support
   (LTSS) to a version that is still under general support, the upgrade will
   fail with the error <code class="literal">No migration available</code>. This happens
   because <code class="command">zypper migration</code> tries to migrate
   <span class="emphasis"><em>all</em></span> repositories, but there is no LTSS repository for
   the new version yet.
  </p><p>
   To fix this issue, disable the LTSS extension before the upgrade.
  </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
     Check if the LTSS extension is enabled:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> SUSEConnect --list-extensions | grep LTSS
SUSE Linux Enterprise Server LTSS 12 SP4 x86_64 (Installed)
Deactivate with: SUSEConnect -d -p SLES-LTSS/12.4/x86_64</pre></div></li><li class="step"><p>
     Disable the LTSS extension with the command from the
     <code class="command">SUSEConnect</code> output above:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> SUSEConnect -d -p SLES-LTSS/12.4/x86_64
Deregistered SUSE Linux Enterprise Server LTSS 12 SP4 x86_64
To server: https://scc.suse.com/</pre></div></li><li class="step"><p>
     Verify the LTSS repository is no longer present with
     <code class="command">zypper lr</code>.
    </p></li></ol></div></div></section><section class="sect1" id="sec-update-preparation-ssl" data-id-title="Create non-MD5 server certificates for Java applications"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">3.7 </span><span class="title-name">Create non-MD5 server certificates for Java applications</span></span> <a title="Permalink" class="permalink" href="cha-update-preparation.html#sec-update-preparation-ssl">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/sle_update_preparation.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   As a security measure, MD5-based certificates are no longer supported in
   Java. If you have certificates created as MD5, re-create your certificates
   with the following steps:
  </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
     Open a terminal and log in as <code class="systemitem">root</code>.
    </p></li><li class="step"><p>
     Create a private key:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">openssl</code> genrsa -out server.key 1024</pre></div><p>
     If you want a stronger key, replace <code class="literal">1024</code> with a higher
     number, for example, <code class="literal">4096</code>.
    </p></li><li class="step"><p>
     Create a certificate signing request (CSR):
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">openssl</code> req -new -key server.key -out server.csr</pre></div></li><li class="step"><p>
     Self-sign the certificate:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">openssl</code> x509 -req -days 365 -in server.csr -signkey server.key -out server.crt</pre></div></li><li class="step"><p>
     Create the PEM file:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root"># </code><code class="command">cat</code> server.key server.crt &gt; server.pem</pre></div></li><li class="step"><p>
     Place the files <code class="filename">server.crt</code>,
     <code class="filename">server.csr</code>, <code class="filename">server.key</code>, and
     <code class="filename">server.pem</code> in the respective directories where the
     keys can be found. For Tomcat, for example, this directory is
     <code class="filename">/etc/tomcat/ssl/</code>.
    </p></li></ol></div></div></section><section class="sect1" id="sec-update-preparation-vms" data-id-title="Shut down virtual machine guests"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">3.8 </span><span class="title-name">Shut down virtual machine guests</span></span> <a title="Permalink" class="permalink" href="cha-update-preparation.html#sec-update-preparation-vms">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/sle_update_preparation.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   If your machine serves as a VM Host Server for KVM<span class="phrase"> or
   Xen</span>, make sure to properly shut down all running VM Guests prior
   to the update. Otherwise you may not be able to access the guests after the
   update.
  </p></section><section class="sect1" id="sec-update-preparation-rmt" data-id-title="Adjust your SMT client setup"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">3.9 </span><span class="title-name">Adjust your SMT client setup</span></span> <a title="Permalink" class="permalink" href="cha-update-preparation.html#sec-update-preparation-rmt">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/sle_update_preparation.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   If the machine you want to upgrade is registered as a client against an
   SMT server, take care to do the following:
  </p><p>
   Check if the version of the <code class="command">clientSetup4SMT.sh</code> script on
   your host is up to date. <code class="command">clientSetup4SMT.sh</code> from older
   versions of SMT cannot manage SMT 12 clients. If you apply software
   patches regularly on your SMT server, you can always find the latest
   version of <code class="command">clientSetup4SMT.sh</code> at
   <code class="filename">&lt;SMT_HOSTNAME&gt;/repo/tools/clientSetup4SMT.sh</code>.
  </p><p>
   In case upgrading your machine to a higher version of <span class="productname"><span class="phrase">SUSE Linux Enterprise Desktop</span></span> fails,
   deregister the machine from the SMT server as described in
   <a class="xref" href="cha-update-preparation.html#pro-sec-update-prep-smt-de-register" title="Deregistering a SUSE Linux Enterprise client from an SMT server">Procedure 3.1</a>.
   Afterward, restart the upgrade process.
  </p><div class="procedure" id="pro-sec-update-prep-smt-de-register" data-id-title="Deregistering a SUSE Linux Enterprise client from an SMT server"><div class="title-container"><div class="procedure-title-wrap"><div class="procedure-title"><span class="title-number-name"><span class="title-number">Procedure 3.1: </span><span class="title-name">Deregistering a SUSE Linux Enterprise client from an SMT server </span></span><a title="Permalink" class="permalink" href="cha-update-preparation.html#pro-sec-update-prep-smt-de-register">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/sle_update_preparation.xml" title="Edit source document"> </a></div></div><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
     Log in to the client machine.
    </p></li><li class="step"><p>
     The following step depends on the current operating system of the client:
    </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
       For SUSE Linux Enterprise 11, execute the following commands:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> suse_register -E
<code class="prompt user">&gt; </code><code class="command">sudo</code> rm -f /etc/SUSEConnect
<code class="prompt user">&gt; </code><code class="command">sudo</code> rm -rf /etc/zypp/credentials.d/*
<code class="prompt user">&gt; </code><code class="command">sudo</code> rm -rf /etc/zypp/repos.d/*
<code class="prompt user">&gt; </code><code class="command">sudo</code> rm -f /etc/zypp/services.d/*
<code class="prompt user">&gt; </code><code class="command">sudo</code> rm -f /var/cache/SuseRegister/*
<code class="prompt user">&gt; </code><code class="command">sudo</code> rm -f /etc/suseRegister*
<code class="prompt user">&gt; </code><code class="command">sudo</code> rm -f /var/cache/SuseRegister/lastzmdconfig.cache
<code class="prompt user">&gt; </code><code class="command">sudo</code> rm -f /etc/zmd/deviceid
<code class="prompt user">&gt; </code><code class="command">sudo</code> rm -f /etc/zmd/secret</pre></div></li><li class="listitem"><p>
       For SUSE Linux Enterprise 12, execute the following commands:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> SUSEConnect --de-register
<code class="prompt user">&gt; </code><code class="command">sudo</code> SUSEConnect --cleanup
<code class="prompt user">&gt; </code><code class="command">sudo</code> rm -f /etc/SUSEConnect
<code class="prompt user">&gt; </code><code class="command">sudo</code> rm -rf /etc/zypp/credentials.d/*
<code class="prompt user">&gt; </code><code class="command">sudo</code> rm -rf /etc/zypp/repos.d/*
<code class="prompt user">&gt; </code><code class="command">sudo</code> rm -f /etc/zypp/services.d/*</pre></div></li></ul></div></li><li class="step"><p>
     Log in to the SMT server.
    </p></li><li class="step"><p>
     Check if the client has successfully been deregistered by listing all
     client registrations:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> smt-list-registrations</pre></div></li><li class="step"><p>
     If the client's host name is still listed in the output of this command,
     get the client's <code class="literal">Unique ID</code> from the first column. (The
     client might be listed with multiple IDs.)
    </p></li><li class="step"><p>
     Delete the registration for this client:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> smt-delete-registration -g <em class="replaceable">UNIQUE_ID</em></pre></div></li><li class="step"><p>
     If the client is listed with multiple IDs, repeat the step above for each
     of its unique IDs.
    </p></li><li class="step"><p>
     Check if the client has now successfully been deregistered by re-running:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> smt-list-registrations</pre></div></li></ol></div></div></section><section class="sect1" id="sec-upgrade-prepare-boot-config" data-id-title="Adjust the resume boot parameter"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">3.10 </span><span class="title-name">Adjust the <code class="literal">resume</code> boot parameter</span></span> <a title="Permalink" class="permalink" href="cha-update-preparation.html#sec-upgrade-prepare-boot-config">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/sle_update_preparation.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   On systems that have been installed with <span class="productname"><span class="phrase">SUSE Linux Enterprise Desktop</span></span> 12 or older, the default  kernel command
   line in <code class="filename">/etc/default/grub</code> may contain a <em class="parameter">resume</em>
   parameter using a device node name such as <code class="filename">/dev/sda1</code> to refer to the
   hibernation ('suspend-to-disk') device. As device node names are not persistent and may
   change between reboots, it is strongly recommended to fix this, otherwise the upgraded system
   may hang on reboot.
  </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
     Find the hibernation device:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> <code class="command">grep resume /etc/default/grub</code>
GRUB_CMDLINE_LINUX_DEFAULT="resume=/dev/sda1 splash=silent quiet showopts"</pre></div><p>
     The hibernation device is <code class="filename">/dev/sda1</code>. If the command returns nothing,
     hibernation is not configured.
    </p></li><li class="step"><p>
     Get the UUID for <code class="filename"><em class="replaceable">/dev/sda1</em></code>:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> <code class="command">blkid /dev/vda1</code>
/dev/vda1: UUID="a1d1f2e0-b0ee-4be2-83d5-78a98c585827" TYPE="swap" PARTUUID="000134b5-01"</pre></div><p>
     The UUID for <code class="filename">/dev/sda1</code> is
     <code class="literal">a1d1f2e0-b0ee-4be2-83d5-78a98c585827</code>.
    </p></li><li class="step"><p>
     Edit <code class="filename">/etc/default/grub</code> and adjust the <em class="parameter">resume</em>
     parameter. Replace <code class="literal"><em class="replaceable">/dev/sda1</em></code> with
     <code class="literal"><em class="replaceable">UUID=a1d1f2e0-b0ee-4be2-83d5-78a98c585827</em></code>. The
     result will look like this:
    </p><div class="verbatim-wrap"><pre class="screen">GRUB_CMDLINE_LINUX_DEFAULT="resume=UUID=a1d1f2e0-b0ee-4be2-83d5-78a98c585827 splash=silent quiet showopts"</pre></div></li><li class="step"><p>
     Update the configuration of the grub boot manger:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> <code class="command">grub2-mkconfig -o /boot/grub2/grub.cfg</code></pre></div></li></ol></div></div><p>
   If the system does not use hibernation, you can simply remove the
   <em class="parameter">resume</em> parameter and update the boot configuration.
  </p></section></section><nav class="bottom-pagination"><div><a class="pagination-link prev" href="cha-upgrade-paths.html"><span class="pagination-relation">Previous</span><span class="pagination-label"><span class="title-number">Chapter 2 </span>Upgrade paths and methods</span></a> </div><div><a class="pagination-link next" href="cha-upgrade-offline.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Chapter 4 </span>Upgrading offline</span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="sect1"><a href="cha-update-preparation.html#sec-update-preparation-update"><span class="title-number">3.1 </span><span class="title-name">Make sure the system is up-to-date</span></a></span></li><li><span class="sect1"><a href="cha-update-preparation.html#sec-update-preparation-relnotes"><span class="title-number">3.2 </span><span class="title-name">Read the release notes</span></a></span></li><li><span class="sect1"><a href="cha-update-preparation.html#sec-update-preparation-backup"><span class="title-number">3.3 </span><span class="title-name">Make a backup</span></a></span></li><li><span class="sect1"><a href="cha-update-preparation.html#sec-update-preparation-disk"><span class="title-number">3.4 </span><span class="title-name">Check the available disk space</span></a></span></li><li><span class="sect1"><a href="cha-update-preparation.html#sec-update-preparation-packagelist"><span class="title-number">3.5 </span><span class="title-name">Listing installed packages and repositories</span></a></span></li><li><span class="sect1"><a href="cha-update-preparation.html#sec-update-preparation-ltss"><span class="title-number">3.6 </span><span class="title-name">Disable the LTSS extension</span></a></span></li><li><span class="sect1"><a href="cha-update-preparation.html#sec-update-preparation-ssl"><span class="title-number">3.7 </span><span class="title-name">Create non-MD5 server certificates for Java applications</span></a></span></li><li><span class="sect1"><a href="cha-update-preparation.html#sec-update-preparation-vms"><span class="title-number">3.8 </span><span class="title-name">Shut down virtual machine guests</span></a></span></li><li><span class="sect1"><a href="cha-update-preparation.html#sec-update-preparation-rmt"><span class="title-number">3.9 </span><span class="title-name">Adjust your SMT client setup</span></a></span></li><li><span class="sect1"><a href="cha-update-preparation.html#sec-upgrade-prepare-boot-config"><span class="title-number">3.10 </span><span class="title-name">Adjust the <code class="literal">resume</code> boot parameter</span></a></span></li></ul></div><div class="side-title">Share this page</div><ul class="share"><li><a id="_share-fb" href="#" title="Facebook"> </a></li><li><a id="_share-in" href="#" title="LinkedIn"> </a></li><li><a id="_share-tw" href="#" title="Twitter/X"> </a></li><li><a id="_share-mail" href="#" title="E-Mail"> </a></li><li><a id="_print-button" href="#" title="Print this page"> </a></li></ul> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2024</span></div></div></footer></body></html>