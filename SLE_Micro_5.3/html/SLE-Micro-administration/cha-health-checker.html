<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><title>SLE Micro 5.3 | Administration Guide | Health checker</title><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"/>
<meta name="title" content="Health checker | SLE Micro 5.3"/>
<meta name="description" content="Health checker is a program delivered with SLE Micro that checks whether services are running properly during booting of your system."/>
<meta name="product-name" content="SUSE Linux Enterprise Micro"/>
<meta name="product-number" content="5.3"/>
<meta name="book-title" content="Administration Guide"/>
<meta name="chapter-title" content="Chapter 8. Health checker"/>
<meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi"/>
<meta name="tracker-type" content="bsc"/>
<meta name="tracker-bsc-assignee" content="jsindelarova@suse.com"/>
<meta name="tracker-bsc-component" content="Documentation"/>
<meta name="tracker-bsc-product" content="SUSE Linux Enterprise Micro 5.3"/>
<meta name="publisher" content="SUSE"/><meta property="og:title" content="Administration of SLE Micro"/>
<meta property="og:description" content="Networking, transactional-updates and performance"/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Administration of SLE Micro"/>
<meta name="twitter:description" content="Networking, transactional-updates and performance"/>
<script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": ["TechArticle"],
    "image": "https://www.suse.com/assets/img/suse-white-logo-green.svg",
    
     "isPartOf": {
      "@type": "CreativeWorkSeries",
      "name": "Product &amp; Solutions"
    },
    
    "inLanguage": "en",
    

    "headline": "Health checker",
  
    "description": "Health checker",
      
    "author": [
      {
        "@type": "Corporation",
        "name": "SUSE Product &amp; Solution Documentation Team",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    ],
      
    "dateModified": "2022-10-03T00:00+02:00",
      
    "datePublished": "2022-10-03T00:00+02:00",
      

    "about": [
      
    ],
  
    "sameAs": [
          "https://www.facebook.com/SUSEWorldwide/about",
          "https://www.youtube.com/channel/UCHTfqIzPKz4f_dri36lAQGA",
          "https://twitter.com/SUSE",
          "https://www.linkedin.com/company/suse"
    ],
    "publisher": {
      "@type": "Corporation",
      "name": "SUSE",
      "url": "https://documentation.suse.com",
      "logo": {
        "@type": "ImageObject",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    }
  }</script>
<link rel="prev" href="part-slemicro-monitoring.html" title="Part III. Monitoring and debugging"/><link rel="next" href="cha-admin-toolbox.html" title="Chapter 9. toolbox for SLE Micro debugging"/><script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/script-purejs.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script><meta name="edit-url" content="https://github.com/SUSE/doc-sle/edit/main/xml/slemicro_health_checker.xml"/></head><body class="draft wide offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"><img src="static/images/logo.svg" alt="Logo" class="logo"/></div></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">Administration Guide</a><span> / </span><a class="crumb" href="part-slemicro-monitoring.html">Monitoring and debugging</a><span> / </span><a class="crumb" href="cha-health-checker.html">Health checker</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title">Administration Guide</div><ol><li><a href="preface-administration-slemicro.html" class=" "><span class="title-number"> </span><span class="title-name">Preface</span></a></li><li><a href="part-common.html" class="has-children "><span class="title-number">I </span><span class="title-name">Common tasks</span></a><ol><li><a href="cha-read-only-filesystem.html" class=" "><span class="title-number">1 </span><span class="title-name">Read-only file system</span></a></li><li><a href="cha-snapshots.html" class=" "><span class="title-number">2 </span><span class="title-name">Snapshots</span></a></li><li><a href="sec-transactional-udate.html" class=" "><span class="title-number">3 </span><span class="title-name">Administration using transactional updates</span></a></li><li><a href="cha-ulp.html" class=" "><span class="title-number">4 </span><span class="title-name">User space live patching</span></a></li></ol></li><li><a href="part-networking-slemicro.html" class="has-children "><span class="title-number">II </span><span class="title-name">Networking</span></a><ol><li><a href="cha-network.html" class=" "><span class="title-number">5 </span><span class="title-name">Basic networking</span></a></li><li><a href="cha-nm-vs-wicked.html" class=" "><span class="title-number">6 </span><span class="title-name">NetworkManager and <code class="command">wicked</code></span></a></li><li><a href="cha-nm-configuration.html" class=" "><span class="title-number">7 </span><span class="title-name">NetworkManager configuration and usage</span></a></li></ol></li><li class="active"><a href="part-slemicro-monitoring.html" class="has-children you-are-here"><span class="title-number">III </span><span class="title-name">Monitoring and debugging</span></a><ol><li><a href="cha-health-checker.html" class=" you-are-here"><span class="title-number">8 </span><span class="title-name">Health checker</span></a></li><li><a href="cha-admin-toolbox.html" class=" "><span class="title-number">9 </span><span class="title-name"><code class="literal">toolbox</code> for SLE Micro debugging</span></a></li><li><a href="cha-performance-monitoring.html" class=" "><span class="title-number">10 </span><span class="title-name">Monitoring performance</span></a></li></ol></li><li><a href="part-slemicro-troubleshooting.html" class="has-children "><span class="title-number">IV </span><span class="title-name">Troubleshooting</span></a><ol><li><a href="cha-adm-support-slemicro.html" class=" "><span class="title-number">11 </span><span class="title-name">Gathering system information for support</span></a></li></ol></li><li><a href="bk06apa.html" class=" "><span class="title-number">A </span><span class="title-name">GNU licenses</span></a></li> </ol> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section xml:lang="en" class="chapter" id="cha-health-checker" data-id-title="Health checker"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname"><span class="productname"><span class="phrase">SUSE Linux Enterprise Micro</span></span></span> <span class="productnumber"><span class="productnumber"><span class="phrase">5.3</span></span></span></div><div><div class="title-container"><h1 class="title"><span class="title-number-name"><span class="title-number">8 </span><span class="title-name">Health checker</span></span> <a title="Permalink" class="permalink" href="cha-health-checker.html#">#</a></h1><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/slemicro_health_checker.xml" title="Edit source document"> </a></div></div></div></div></div><p>
  Health checker is a program delivered with SLE Micro that checks whether
  services are running properly during booting of your system.
 </p><p>
  During the boot process, <code class="literal">systemd</code> calls Health checker,
  which in turn calls its plugins. Each plugin checks a particular service or
  condition. If each check passes, a status file
  (<code class="filename">/var/lib/misc/health-check.state</code>) is created. The
  status file marks the current root file system as correct.
 </p><p>
  If any of the health checker plugins reports an error, the action taken
  depends on a particular condition, as described below:
 </p><div class="variablelist"><dl class="variablelist"><dt id="id-1.8.5.2.6.1"><span class="term"><span class="emphasis"><em>The snapshot is booted for the first time.</em></span></span></dt><dd><p>
     If the current snapshot is different from the last one that worked
     properly, an automatic rollback to the last working snapshot is performed.
     This means that the last change performed to the file system broke the
     snapshot.
    </p></dd><dt id="id-1.8.5.2.6.2"><span class="term"><span class="emphasis"><em>The snapshot has already booted correctly in the past.</em></span></span></dt><dd><p>
     There could be just a temporary problem, and the system is rebooted
     automatically.
    </p></dd><dt id="id-1.8.5.2.6.3"><span class="term"><span class="emphasis"><em>The reboot of a previously correctly booted snapshot has failed.</em></span></span></dt><dd><p>
     If there was already a problem during boot and automatic reboot has been
     triggered, but the problem still persists, then the system is kept running
     to enable to the administrator to fix the problem. The services that are
     tested by the health checker plugins are stopped if possible.
    </p></dd></dl></div><section class="sect1" id="sec-health-plugins" data-id-title="Adding custom plugins"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">8.1 </span><span class="title-name">Adding custom plugins</span></span> <a title="Permalink" class="permalink" href="cha-health-checker.html#sec-health-plugins">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/slemicro_health_checker.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   Health checker supports the addition of your own plugins to check services
   during the boot process. Each plugin is a bash script that must fulfill the
   following requirements:
  </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
     Plugins are located within a specific
     directory—<code class="filename">/usr/libexec/health-checker</code>
    </p></li><li class="listitem"><p>
     The service that will be checked by the particular plugin must be defined
     in the <code class="literal">Unit</code> section of the
     <code class="filename">/usr/lib/systemd/system/health-checker.service</code> file.
     For example, the <code class="literal">etcd</code> service is defined as follows:
    </p><div class="verbatim-wrap"><pre class="screen">[Unit]
...
After=etcd.service
...</pre></div></li><li class="listitem"><p>
     Each plugin must have functions called <code class="literal">run.checks</code> and
     <code class="literal">stop_services</code> defined. The
     <code class="literal">run.checks</code> function checks whether a particular service
     has started properly. Bear in mind that service that has not been enabled
     by systemd, should be ignored. The function
     <code class="literal">stop_services</code> is called to stop the particular service
     in case the service has not been started properly. You can use the plugin
     template for your reference.
    </p></li></ul></div></section></section><nav class="bottom-pagination"><div><a class="pagination-link prev" href="part-slemicro-monitoring.html"><span class="pagination-relation">Previous</span><span class="pagination-label"><span class="title-number">Part III </span>Monitoring and debugging</span></a> </div><div><a class="pagination-link next" href="cha-admin-toolbox.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Chapter 9 </span><code class="literal">toolbox</code> for SLE Micro debugging</span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="section"><a href="cha-health-checker.html#sec-health-plugins"><span class="title-number">8.1 </span><span class="title-name">Adding custom plugins</span></a></span></li></ul></div><div class="side-title">Share this page</div><ul class="share"><li><a id="_share-fb" href="#" title="Facebook"> </a></li><li><a id="_share-in" href="#" title="LinkedIn"> </a></li><li><a id="_share-tw" href="#" title="Twitter/X"> </a></li><li><a id="_share-mail" href="#" title="E-Mail"> </a></li><li><a id="_print-button" href="#" title="Print this page"> </a></li></ul> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2024</span></div></div></footer></body></html>