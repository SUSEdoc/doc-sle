<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><title>SLES 15 SP4 | Administration Guide | sudo basics</title><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"/>
<meta name="title" content="sudo basics | SLES 15 SP4"/>
<meta name="description" content="Running certain commands requires root privileges. However, for security reasons and to avoid mistakes, it is not recommended to log in as root. A sa…"/>
<meta name="product-name" content="SUSE Linux Enterprise Server"/>
<meta name="product-number" content="15 SP4"/>
<meta name="book-title" content="Administration Guide"/>
<meta name="chapter-title" content="Chapter 2. sudo basics"/>
<meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi"/>
<meta name="tracker-type" content="bsc"/>
<meta name="tracker-bsc-assignee" content="fs@suse.com"/>
<meta name="tracker-bsc-component" content="Documentation"/>
<meta name="tracker-bsc-product" content="PUBLIC SUSE Linux Enterprise Server 15 SP4"/>
<meta name="publisher" content="SUSE"/><meta property="og:title" content="Administration Guide"/>
<meta property="og:description" content="Maintain, monitor and customize SLES"/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Administration Guide"/>
<meta name="twitter:description" content="Maintain, monitor and customize SLES"/>
<script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": ["TechArticle"],
    "image": "https://www.suse.com/assets/img/suse-white-logo-green.svg",
    
     "isPartOf": {
      "@type": "CreativeWorkSeries",
      "name": "Products &amp; Solutions"
    },
    
    "inLanguage": "en",
    

    "headline": "sudo basics",
  
    "description": "sudo basics",
      
    "author": [
      {
        "@type": "Corporation",
        "name": "SUSE Product &amp; Solution Documentation Team",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    ],
      
    "dateModified": "2024-02-13T00:00+02:00",
      
    "datePublished": "2022-06-21T00:00+02:00",
      

    "about": [
      
    ],
  
    "sameAs": [
          "https://www.facebook.com/SUSEWorldwide/about",
          "https://www.youtube.com/channel/UCHTfqIzPKz4f_dri36lAQGA",
          "https://twitter.com/SUSE",
          "https://www.linkedin.com/company/suse"
    ],
    "publisher": {
      "@type": "Corporation",
      "name": "SUSE",
      "url": "https://documentation.suse.com",
      "logo": {
        "@type": "ImageObject",
        "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
      }
    }
  }</script>
<link rel="prev" href="cha-adm-shell.html" title="Chapter 1. Bash and Bash scripts"/><link rel="next" href="cha-yast-gui.html" title="Chapter 3. Using YaST"/><script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/script-purejs.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script><meta name="edit-url" content="https://github.com/SUSE/doc-sle/edit/main/xml/adm_sudo.xml"/></head><body class="draft wide offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"><img src="static/images/logo.svg" alt="Logo" class="logo"/></div></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">Administration Guide</a><span> / </span><a class="crumb" href="part-administration.html">Common tasks</a><span> / </span><a class="crumb" href="cha-adm-sudo.html">sudo basics</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title">Administration Guide</div><ol><li><a href="pre-sle.html" class=" "><span class="title-number"> </span><span class="title-name">Preface</span></a></li><li class="active"><a href="part-administration.html" class="has-children you-are-here"><span class="title-number">I </span><span class="title-name">Common tasks</span></a><ol><li><a href="cha-adm-shell.html" class=" "><span class="title-number">1 </span><span class="title-name">Bash and Bash scripts</span></a></li><li><a href="cha-adm-sudo.html" class=" you-are-here"><span class="title-number">2 </span><span class="title-name"><code class="command">sudo</code> basics</span></a></li><li><a href="cha-yast-gui.html" class=" "><span class="title-number">3 </span><span class="title-name">Using YaST</span></a></li><li><a href="cha-yast-text.html" class=" "><span class="title-number">4 </span><span class="title-name">YaST in text mode</span></a></li><li><a href="cha-yast-lang.html" class=" "><span class="title-number">5 </span><span class="title-name">Changing language and country settings with YaST</span></a></li><li><a href="cha-yast-userman.html" class=" "><span class="title-number">6 </span><span class="title-name">Managing users with YaST</span></a></li><li><a href="cha-onlineupdate-you.html" class=" "><span class="title-number">7 </span><span class="title-name">YaST online update</span></a></li><li><a href="cha-yast-software.html" class=" "><span class="title-number">8 </span><span class="title-name">Installing or removing software</span></a></li><li><a href="cha-sw-cl.html" class=" "><span class="title-number">9 </span><span class="title-name">Managing software with command line tools</span></a></li><li><a href="cha-snapper.html" class=" "><span class="title-number">10 </span><span class="title-name">System recovery and snapshot management with Snapper</span></a></li><li><a href="cha-klp.html" class=" "><span class="title-number">11 </span><span class="title-name">Live kernel patching with KLP</span></a></li><li><a href="cha-ulp.html" class=" "><span class="title-number">12 </span><span class="title-name">User space live patching</span></a></li><li><a href="cha-transactional-updates.html" class=" "><span class="title-number">13 </span><span class="title-name">Transactional updates</span></a></li><li><a href="cha-vnc.html" class=" "><span class="title-number">14 </span><span class="title-name">Remote graphical sessions with VNC</span></a></li><li><a href="cha-net-rsync.html" class=" "><span class="title-number">15 </span><span class="title-name">File copying with RSync</span></a></li></ol></li><li><a href="part-boot.html" class="has-children "><span class="title-number">II </span><span class="title-name">Booting a Linux system</span></a><ol><li><a href="cha-boot.html" class=" "><span class="title-number">16 </span><span class="title-name">Introduction to the boot process</span></a></li><li><a href="cha-uefi.html" class=" "><span class="title-number">17 </span><span class="title-name">UEFI (Unified Extensible Firmware Interface)</span></a></li><li><a href="cha-grub2.html" class=" "><span class="title-number">18 </span><span class="title-name">The boot loader GRUB 2</span></a></li><li><a href="cha-systemd.html" class=" "><span class="title-number">19 </span><span class="title-name">The <code class="systemitem">systemd</code> daemon</span></a></li></ol></li><li><a href="part-system.html" class="has-children "><span class="title-number">III </span><span class="title-name">System</span></a><ol><li><a href="cha-64bit.html" class=" "><span class="title-number">20 </span><span class="title-name">32-bit and 64-bit applications in a 64-bit system environment</span></a></li><li><a href="cha-journalctl.html" class=" "><span class="title-number">21 </span><span class="title-name"><code class="command">journalctl</code>: Query the <code class="systemitem">systemd</code> journal</span></a></li><li><a href="cha-update-alternative.html" class=" "><span class="title-number">22 </span><span class="title-name"><code class="command">update-alternatives</code>: Managing multiple versions of commands and files</span></a></li><li><a href="cha-network.html" class=" "><span class="title-number">23 </span><span class="title-name">Basic networking</span></a></li><li><a href="cha-print.html" class=" "><span class="title-number">24 </span><span class="title-name">Printer operation</span></a></li><li><a href="cha-gui-desktop.html" class=" "><span class="title-number">25 </span><span class="title-name">Graphical user interface</span></a></li><li><a href="cha-fuse.html" class=" "><span class="title-number">26 </span><span class="title-name">Accessing file systems with FUSE</span></a></li><li><a href="cha-tuning-multikernel.html" class=" "><span class="title-number">27 </span><span class="title-name">Installing multiple kernel versions</span></a></li><li><a href="cha-mod.html" class=" "><span class="title-number">28 </span><span class="title-name">Managing kernel modules</span></a></li><li><a href="cha-udev.html" class=" "><span class="title-number">29 </span><span class="title-name">Dynamic kernel device management with <code class="systemitem">udev</code></span></a></li><li><a href="cha-suse.html" class=" "><span class="title-number">30 </span><span class="title-name">Special system features</span></a></li><li><a href="cha-nm.html" class=" "><span class="title-number">31 </span><span class="title-name">Using NetworkManager</span></a></li></ol></li><li><a href="part-hardware.html" class="has-children "><span class="title-number">IV </span><span class="title-name">Hardware configuration</span></a><ol><li><a href="sec-yast-hw-keym.html" class=" "><span class="title-number">32 </span><span class="title-name">Setting up your system keyboard layout</span></a></li><li><a href="sec-yast-hw-sound.html" class=" "><span class="title-number">33 </span><span class="title-name">Setting up sound cards</span></a></li><li><a href="sec-yast-hw-print.html" class=" "><span class="title-number">34 </span><span class="title-name">Setting up a printer</span></a></li><li><a href="cha-power-mgmt.html" class=" "><span class="title-number">35 </span><span class="title-name">Power management</span></a></li><li><a href="cha-nvdimm.html" class=" "><span class="title-number">36 </span><span class="title-name">Persistent memory</span></a></li></ol></li><li><a href="part-services.html" class="has-children "><span class="title-number">V </span><span class="title-name">Services</span></a><ol><li><a href="cha-yast-serviceman.html" class=" "><span class="title-number">37 </span><span class="title-name">Service management with YaST</span></a></li><li><a href="cha-ntp.html" class=" "><span class="title-number">38 </span><span class="title-name">Time synchronization with NTP</span></a></li><li><a href="cha-dns.html" class=" "><span class="title-number">39 </span><span class="title-name">The domain name system</span></a></li><li><a href="cha-dhcp.html" class=" "><span class="title-number">40 </span><span class="title-name">DHCP</span></a></li><li><a href="cha-slp.html" class=" "><span class="title-number">41 </span><span class="title-name">SLP</span></a></li><li><a href="cha-apache2.html" class=" "><span class="title-number">42 </span><span class="title-name">The Apache HTTP server</span></a></li><li><a href="cha-ftp.html" class=" "><span class="title-number">43 </span><span class="title-name">Setting up an FTP server with YaST</span></a></li><li><a href="cha-squid.html" class=" "><span class="title-number">44 </span><span class="title-name">Squid caching proxy server</span></a></li><li><a href="cha-wbem.html" class=" "><span class="title-number">45 </span><span class="title-name">Web Based Enterprise Management using SFCB</span></a></li></ol></li><li><a href="part-trouble.html" class="has-children "><span class="title-number">VI </span><span class="title-name">Troubleshooting</span></a><ol><li><a href="cha-adminhelp.html" class=" "><span class="title-number">46 </span><span class="title-name">Help and documentation</span></a></li><li><a href="cha-adm-support.html" class=" "><span class="title-number">47 </span><span class="title-name">Gathering system information for support</span></a></li><li><a href="cha-trouble.html" class=" "><span class="title-number">48 </span><span class="title-name">Common problems and their solutions</span></a></li></ol></li><li><a href="app-nwscheme.html" class=" "><span class="title-number">A </span><span class="title-name">An example network</span></a></li><li><a href="bk01apb.html" class=" "><span class="title-number">B </span><span class="title-name">GNU licenses</span></a></li> </ol> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section class="chapter" id="cha-adm-sudo" data-id-title="sudo basics"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname"><span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span></span> <span class="productnumber"><span class="productnumber"><span class="phrase">15 SP4</span></span></span></div><div><div class="title-container"><h1 class="title"><span class="title-number-name"><span class="title-number">2 </span><span class="title-name"><code class="command">sudo</code> basics</span></span> <a title="Permalink" class="permalink" href="cha-adm-sudo.html#">#</a></h1><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/adm_sudo.xml" title="Edit source document"> </a></div></div></div></div></div><p>
  Running certain commands requires root privileges. However, for security
  reasons and to avoid mistakes, it is not recommended to log in as
  <code class="systemitem">root</code>. A safer approach is to log in as a regular user, and
  then use <code class="command">sudo</code> to run commands with elevated privileges.
 </p><p>
  On <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span>, <code class="command">sudo</code> is configured to work similarly to <code class="command">su</code>. However,
  <code class="command">sudo</code> provides a flexible mechanism that allows users to run commands with
  privileges of any other user. This can be used to assign roles with specific
  privileges to certain users and groups. For example, it is possible to allow
  members of the group <code class="systemitem">users</code> to run a command with the privileges of
  user <code class="systemitem">wilber</code>. Access to the command can be further restricted by
  disallowing any command options. While su always requires the <code class="systemitem">root</code>
  password for authentication with PAM, <code class="command">sudo</code> can be configured to
  authenticate with your own credentials. This means that the users do not need
  to share the <code class="systemitem">root</code> password, which improves security.
 </p><section class="sect1" id="sec-adm-sudo-usage" data-id-title="Basic sudo usage"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">2.1 </span><span class="title-name">Basic <code class="command">sudo</code> usage</span></span> <a title="Permalink" class="permalink" href="cha-adm-sudo.html#sec-adm-sudo-usage">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/adm_sudo.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   The following chapter provides an introduction to basic usage of <code class="command">sudo</code>.
  </p><section class="sect2" id="sec-adm-sudo-usage-cmd" data-id-title="Running a single command"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">2.1.1 </span><span class="title-name">Running a single command</span></span> <a title="Permalink" class="permalink" href="cha-adm-sudo.html#sec-adm-sudo-usage-cmd">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/adm_sudo.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    As a regular user, you can run any command as <code class="systemitem">root</code> by
    adding <code class="command">sudo</code> before it. This prompts you to provide the root password. If
    authenticated successfully, this runs the command as <code class="systemitem">root</code>:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">id -un</code><span class="callout" id="co-sudo-usage-id">1</span>
tux
<code class="prompt user">&gt; </code><code class="command">sudo</code> <code class="command">id -un</code>
root's password:<span class="callout" id="co-sudo-usage-pw">2</span>
root
<code class="prompt user">&gt; </code><code class="command">id -un</code>
tux<span class="callout" id="co-sudo-usage-after">3</span>
<code class="prompt user">&gt; </code><code class="command">sudo</code> <code class="command">id -un</code>
<span class="callout" id="co-sudo-usage-nopw">4</span>
root</pre></div><div class="calloutlist"><table style="border: 0; "><tr><td style="width: 5%; vertical-align: top; text-align: left; "><p><a href="#co-sudo-usage-id"><span class="callout">1</span></a> </p></td><td style="vertical-align: top; text-align: left; "><p>
      The <code class="command">id -un</code> command prints the login name of the
      current user.
     </p></td></tr><tr><td style="width: 5%; vertical-align: top; text-align: left; "><p><a href="#co-sudo-usage-pw"><span class="callout">2</span></a> </p></td><td style="vertical-align: top; text-align: left; "><p>
      The password is not shown during input, neither as clear text nor as
      masking characters.
     </p></td></tr><tr><td style="width: 5%; vertical-align: top; text-align: left; "><p><a href="#co-sudo-usage-after"><span class="callout">3</span></a> </p></td><td style="vertical-align: top; text-align: left; "><p>
      Only commands that start with <code class="command">sudo</code> run with elevated privileges.
     </p></td></tr><tr><td style="width: 5%; vertical-align: top; text-align: left; "><p><a href="#co-sudo-usage-nopw"><span class="callout">4</span></a> </p></td><td style="vertical-align: top; text-align: left; "><p>
      The elevated privileges persist for a certain period of time, so you
      do not need to provide the <code class="systemitem">root</code> password again.
     </p></td></tr></table></div><div id="id-1.3.3.3.5.3.5" data-id-title="I/O redirection" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.svg"/><div class="admon-title">Tip: I/O redirection</div><p>
     When using <code class="command">sudo</code>, I/O redirection does not work:
    </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> echo s &gt; /proc/sysrq-trigger
bash: /proc/sysrq-trigger: Permission denied
<code class="prompt user">&gt; </code><code class="command">sudo</code> cat &lt; /proc/1/maps
bash: /proc/1/maps: Permission denied</pre></div><p>
     In the example above, only the <code class="command">echo</code> and
     <code class="command">cat</code> commands run with elevated privileges. The
     redirection is done by the user's shell with user privileges. To perform
     redirection with elevated privileges, either start a shell as in <a class="xref" href="cha-adm-sudo.html#sec-sudo-shell" title="2.1.2. Starting a shell">Section 2.1.2, “Starting a shell”</a> or use the <code class="command">dd</code> utility:
    </p><div class="verbatim-wrap"><pre class="screen">echo s | sudo dd of=/proc/sysrq-trigger
sudo dd if=/proc/1/maps | cat</pre></div></div></section><section class="sect2" id="sec-sudo-shell" data-id-title="Starting a shell"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">2.1.2 </span><span class="title-name">Starting a shell</span></span> <a title="Permalink" class="permalink" href="cha-adm-sudo.html#sec-sudo-shell">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/adm_sudo.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    Using <code class="command">sudo</code> every time to run a command with elevated privileges is not
    always practical.  While you can use the <code class="command">sudo bash</code>
    command, it is recommended to use one of the built-in mechanisms to start a
    shell:
   </p><div class="variablelist"><dl class="variablelist"><dt id="id-1.3.3.3.5.4.3.1"><span class="term"><code class="literal">sudo -s (&lt;command&gt;)</code>
     </span></dt><dd><p>
       Starts a shell specified by the <code class="envar">SHELL</code> environment
       variable or the target user's default shell. If a command is specified, it
       is passed to the shell (with the <code class="option">-c</code> option). Otherwise the
       shell runs in interactive mode.
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux:~ &gt; </code>sudo -s
root's password:
<code class="prompt user">root:/home/tux # </code>exit
<code class="prompt user">tux:~ &gt; </code></pre></div></dd><dt id="id-1.3.3.3.5.4.3.2"><span class="term"><code class="literal">sudo -i (&lt;command&gt;)</code>
     </span></dt><dd><p>
       Similar to <code class="option">-s</code>, but starts the shell as a login shell. This
       means that the shell's start-up files (<code class="filename">.profile</code>
       etc.) are processed, and the current working directory is set to the
       target user's home directory.
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux:~ &gt; </code>sudo -i
root's password:
<code class="prompt user">root:~ # </code>exit
<code class="prompt user">tux:~ &gt; </code></pre></div></dd></dl></div><div id="id-1.3.3.3.5.4.4" data-id-title="Environment variables" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.svg"/><div class="admon-title">Tip: Environment variables</div><p>
    By default, <code class="command">sudo</code> does not propagate environment variables. This behavior
    can be changed using the <code class="literal">env_reset</code> option (see <a class="xref" href="cha-adm-sudo.html#tab-adm-sudo-options" title="Useful flags and options">Useful flags and options</a>).
   </p></div></section></section><section class="sect1" id="sec-sudo-conf" data-id-title="Configuring sudo"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">2.2 </span><span class="title-name">Configuring <code class="command">sudo</code></span></span> <a title="Permalink" class="permalink" href="cha-adm-sudo.html#sec-sudo-conf">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/adm_sudo.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   <code class="command">sudo</code> provides a wide range on configurable options.
  </p><div id="id-1.3.3.3.6.3" data-id-title="Locked yourself out of sudo" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note: Locked yourself out of sudo</div><p>
    If you accidentally locked yourself out of <code class="command">sudo</code>, use <code class="command">su
    -</code> and the <code class="systemitem">root</code> password to start a root shell.
    To fix the error, run <code class="command">visudo</code>.
   </p></div><section class="sect2" id="sec-sudo-conf-edit" data-id-title="Editing the configuration files"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">2.2.1 </span><span class="title-name">Editing the configuration files</span></span> <a title="Permalink" class="permalink" href="cha-adm-sudo.html#sec-sudo-conf-edit">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/adm_sudo.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    The main policy configuration file for <code class="command">sudo</code> is
    <code class="filename">/etc/sudoers</code>. As it is possible to lock yourself out
    of the system if the file is malformed, it is strongly recommended to use
    <code class="command">visudo</code> for editing. It prevents editing conflicts and
    checks for syntax errors before saving the modifications.
   </p><p>
    You can use another editor instead of vi by setting the
    <code class="envar">EDITOR</code> environment variable, for example:
   </p><div class="verbatim-wrap"><pre class="screen">sudo EDITOR=<em class="replaceable">/usr/bin/nano</em> visudo</pre></div><p>
    Keep in mind that the <code class="filename">/etc/sudoers</code> file is supplied by
    the system packages, and modifications done directly in the file may break
    updates. Therefore, it is recommended to put custom configuration into
    files in the <code class="filename">/etc/sudoers.d/</code> directory. Use the
    following command to create or edit a file:
   </p><div class="verbatim-wrap"><pre class="screen">sudo visudo -f /etc/sudoers.d/<em class="replaceable">NAME</em></pre></div><p>
    The command bellow opens the file using a different editor (in this case,
    <code class="command">nano</code>):
   </p><div class="verbatim-wrap"><pre class="screen">sudo EDITOR=<em class="replaceable">/usr/bin/nano</em> visudo -f /etc/sudoers.d/<em class="replaceable">NAME</em></pre></div><div id="id-1.3.3.3.6.4.9" data-id-title="Ignored files in /etc/sudoers.d" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note: Ignored files in <code class="filename">/etc/sudoers.d</code></div><p>
     The <code class="literal">#includedir</code> directive in
     <code class="filename">/etc/sudoers</code> ignores files that end with the
     <code class="literal">~</code> (tilde) character or contain the <code class="literal">.</code>
     (dot) character.
    </p></div><p>
    For more information on the <code class="command">visudo</code> command, run
    <code class="command">man 8 visudo</code>.
   </p></section><section class="sect2" id="sec-sudo-conf-syntax" data-id-title="Basic sudoers configuration syntax"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">2.2.2 </span><span class="title-name">Basic sudoers configuration syntax</span></span> <a title="Permalink" class="permalink" href="cha-adm-sudo.html#sec-sudo-conf-syntax">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/adm_sudo.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    The sudoers configuration files contain two types of options: strings
    and flags. While strings can contain any value, flags can be turned either
    ON or OFF. The most important syntax constructs for sudoers configuration
    files are as follows:
   </p><div class="verbatim-wrap"><pre class="screen"># Everything on a line after # is ignored <span class="callout" id="co-sudo-syntax-comment">1</span>
Defaults !insults # Disable the insults flag <span class="callout" id="co-sudo-syntax-flag">2</span>
Defaults env_keep += "DISPLAY HOME" # Add DISPLAY and HOME to env_keep
tux ALL = NOPASSWD: /usr/bin/frobnicate, PASSWD: /usr/bin/journalctl <span class="callout" id="co-sudo-syntax-rule">3</span></pre></div><div class="calloutlist"><table style="border: 0; "><tr><td style="width: 5%; vertical-align: top; text-align: left; "><p><a href="#co-sudo-syntax-comment"><span class="callout">1</span></a> </p></td><td style="vertical-align: top; text-align: left; "><p>
      There are two exceptions: <code class="literal">#include</code> and
      <code class="literal">#includedir</code> are regular commands.
     </p></td></tr><tr><td style="width: 5%; vertical-align: top; text-align: left; "><p><a href="#co-sudo-syntax-flag"><span class="callout">2</span></a> </p></td><td style="vertical-align: top; text-align: left; "><p>
      Remove the <code class="literal">!</code> character to set the desired flag to ON.
     </p></td></tr><tr><td style="width: 5%; vertical-align: top; text-align: left; "><p><a href="#co-sudo-syntax-rule"><span class="callout">3</span></a> </p></td><td style="vertical-align: top; text-align: left; "><p>
      See <a class="xref" href="cha-adm-sudo.html#sec-sudo-conf-rule" title="2.2.3. Basic sudoers rules">Section 2.2.3, “Basic sudoers rules”</a>.
     </p></td></tr></table></div><div class="variablelist" id="tab-adm-sudo-options" data-id-title="Useful flags and options"><div class="title-container"><div class="variablelist-title-wrap"><div class="variablelist-title"><span class="title-number-name"><span class="title-name">Useful flags and options </span></span><a title="Permalink" class="permalink" href="cha-adm-sudo.html#tab-adm-sudo-options">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/adm_sudo.xml" title="Edit source document"> </a></div></div><dl class="variablelist"><dt id="id-1.3.3.3.6.5.5.2"><span class="term">
     <code class="literal">targetpw</code>
    </span></dt><dd><p>
      This flag controls whether the invoking user is required to enter the
      password of the target user (ON) (for example <code class="systemitem">root</code>) or the invoking
      user (OFF).
     </p><div class="verbatim-wrap"><pre class="screen">Defaults targetpw # Turn targetpw flag ON</pre></div></dd><dt id="id-1.3.3.3.6.5.5.3"><span class="term">
     <code class="literal">rootpw</code>
    </span></dt><dd><p>
       If set, <code class="command">sudo</code> prompts for the <code class="systemitem">root</code> password. The default is OFF.
      </p><div class="verbatim-wrap"><pre class="screen">Defaults !rootpw # Turn rootpw flag OFF</pre></div></dd><dt id="id-1.3.3.3.6.5.5.4"><span class="term">
     <code class="literal">env_reset</code>
    </span></dt><dd><p>
       If set, <code class="command">sudo</code> constructs a minimal environment with
       <code class="envar">TERM</code>, <code class="envar">PATH</code>, <code class="envar">HOME</code>,
       <code class="envar">MAIL</code>, <code class="envar">SHELL</code>, <code class="envar">LOGNAME</code>,
       <code class="envar">USER</code>, <code class="envar">USERNAME</code>, and
       <code class="envar">SUDO_*</code>. Additionally, variables listed in
       <code class="literal">env_keep</code> are imported from the calling
       environment. The default is ON.
      </p><div class="verbatim-wrap"><pre class="screen">Defaults env_reset # Turn env_reset flag ON</pre></div></dd><dt id="id-1.3.3.3.6.5.5.5"><span class="term">
     <code class="literal">env_keep</code>
    </span></dt><dd><p>
       List of environment variables to keep when the
         <code class="literal">env_reset</code> flag is ON.
      </p><div class="verbatim-wrap"><pre class="screen"># Set env_keep to contain EDITOR and PROMPT
Defaults env_keep = "EDITOR PROMPT"
Defaults env_keep += "JRE_HOME" # Add JRE_HOME
Defaults env_keep -= "JRE_HOME" # Remove JRE_HOME</pre></div></dd><dt id="id-1.3.3.3.6.5.5.6"><span class="term">
     <code class="literal">env_delete</code>
    </span></dt><dd><p>
       List of environment variables to remove when the
         <code class="literal">env_reset</code> flag is OFF.
      </p><div class="verbatim-wrap"><pre class="screen"># Set env_delete to contain EDITOR and PROMPT
Defaults env_delete = "EDITOR PROMPT"
Defaults env_delete += "JRE_HOME" # Add JRE_HOME
Defaults env_delete -= "JRE_HOME" # Remove JRE_HOME</pre></div></dd></dl></div><p>
    The <code class="literal">Defaults</code> token can also be used to create aliases
    for a collection of users, hosts, and commands. Furthermore, it is possible
    to apply an option only to a specific set of users.
   </p><p>
    For detailed information about the <code class="filename">/etc/sudoers</code>
    configuration file, consult <code class="command">man 5 sudoers</code>.
   </p></section><section class="sect2" id="sec-sudo-conf-rule" data-id-title="Basic sudoers rules"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">2.2.3 </span><span class="title-name">Basic sudoers rules</span></span> <a title="Permalink" class="permalink" href="cha-adm-sudo.html#sec-sudo-conf-rule">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/adm_sudo.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    Each rule follows the following scheme
    (<code class="literal">[]</code> marks optional parts):
   </p><div class="verbatim-wrap"><pre class="screen">#Who      Where         As whom      Tag                What
User_List Host_List = [(User_List)] [NOPASSWD:|PASSWD:] Cmnd_List</pre></div><div class="variablelist"><div class="title-container"><div class="variablelist-title-wrap"><div class="variablelist-title"><span class="title-number-name"><span class="title-name">sudoers rule syntax </span></span><a title="Permalink" class="permalink" href="cha-adm-sudo.html#id-1.3.3.3.6.6.4">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/adm_sudo.xml" title="Edit source document"> </a></div></div><dl class="variablelist"><dt id="id-1.3.3.3.6.6.4.2"><span class="term"><code class="literal">User_List</code>
     </span></dt><dd><p>
       One or several (separated by comma) identifiers: either a
       user name, a group in the format <code class="literal">%GROUPNAME</code>, or a user
       ID in the format <code class="literal">#UID</code>. Negation can be specified with
       the <code class="literal">!</code> prefix.
      </p></dd><dt id="id-1.3.3.3.6.6.4.3"><span class="term"><code class="literal">Host_List</code>
     </span></dt><dd><p>
       One or several (separated by comma) identifiers: either a
       (fully qualified) host name or an IP address. Negation can be specified
       with the <code class="literal">!</code> prefix. <code class="literal">ALL</code> is a common
       choice for <code class="literal">Host_List</code>.
      </p></dd><dt id="id-1.3.3.3.6.6.4.4"><span class="term"><code class="literal">NOPASSWD:|PASSWD:</code>
     </span></dt><dd><p>
       The user is not prompted for a password when running commands
       matching <code class="literal">Cmd_List</code> after <code class="literal">NOPASSWD:</code>.
      </p><p>
       <code class="literal">PASSWD</code> is the default. It only needs to be specified
       when both <code class="literal">PASSWD</code> and <code class="literal">NOPASSWD</code> are
       on the same line:
      </p><div class="verbatim-wrap"><pre class="screen">tux ALL = PASSWD: /usr/bin/foo, NOPASSWD: /usr/bin/bar</pre></div></dd><dt id="id-1.3.3.3.6.6.4.5"><span class="term"><code class="literal">Cmnd_List</code>
     </span></dt><dd><p>
       One or several (separated by comma) specifiers: A path to an
       executable, followed by an optional allowed argument.
      </p><div class="verbatim-wrap"><pre class="screen">/usr/bin/foo     # Anything allowed
/usr/bin/foo bar # Only "/usr/bin/foo bar" allowed
/usr/bin/foo ""  # No arguments allowed</pre></div></dd></dl></div><p>
    <code class="literal">ALL</code> can be used as <code class="literal">User_List</code>,
    <code class="literal">Host_List</code>, and <code class="literal">Cmnd_List</code>.
   </p><p>
    A rule that allows <code class="systemitem">tux</code> to run all commands as root without
    entering a password:
   </p><div class="verbatim-wrap"><pre class="screen">tux ALL = NOPASSWD: ALL</pre></div><p>
    A rule that allows <code class="systemitem">tux</code> to run <code class="command">systemctl restart
    apache2</code>:
   </p><div class="verbatim-wrap"><pre class="screen">tux ALL = /usr/bin/systemctl restart apache2</pre></div><p>
    A rule that allows <code class="systemitem">tux</code> to run <code class="command">wall</code> as
    <code class="systemitem">admin</code> with no arguments:
   </p><div class="verbatim-wrap"><pre class="screen">tux ALL = (admin) /usr/bin/wall ""</pre></div><div id="id-1.3.3.3.6.6.12" data-id-title="Unsafe rules" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.svg"/><div class="admon-title">Warning: Unsafe rules</div><p>
     <span class="emphasis"><em>Do not</em></span> use rules like <code class="literal">ALL ALL =
     ALL</code> without <code class="literal">Defaults targetpw</code>. Otherwise
     anyone can run commands as <code class="systemitem">root</code>.
    </p></div><div id="id-1.3.3.3.6.6.13" data-id-title="Winbind and sudo" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg"/><div class="admon-title">Important: Winbind and sudo</div><p>
   When specifying the group name in the <code class="filename">sudoers</code> file, make sure that you use the NetBIOS domain name instead of the realm, for example:
   </p><div class="verbatim-wrap"><pre class="screen"><em class="replaceable">%DOMAIN</em>\\<em class="replaceable">GROUP_NAME</em> ALL = (ALL) ALL</pre></div><p>
   Keep in mind that when using winbindd, the format also depends on the <code class="option">winbind separator</code> option in the <code class="filename">smb.conf</code> file. By default, it is <code class="literal">\</code>. If it is changed, for example, to <code class="literal">+</code>, then the account format in the <code class="filename">sudoers</code> file must be <code class="literal">DOMAIN+GROUP_NAME</code>.
   </p></div></section></section><section class="sect1" id="sec-sudo-usecases" data-id-title="sudo use cases"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">2.3 </span><span class="title-name"><code class="command">sudo</code> use cases</span></span> <a title="Permalink" class="permalink" href="cha-adm-sudo.html#sec-sudo-usecases">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/adm_sudo.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   While the default configuration works for standard usage scenarios, you can
   customize the default configuration to meet your specific needs.
  </p><section class="sect2" id="sec-sudo-usecases-userpw" data-id-title="Using sudo without root password"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">2.3.1 </span><span class="title-name">Using <code class="command">sudo</code> without <code class="systemitem">root</code> password</span></span> <a title="Permalink" class="permalink" href="cha-adm-sudo.html#sec-sudo-usecases-userpw">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/adm_sudo.xml" title="Edit source document"> </a></div></div></div></div></div><p>
        By design, members of the group
        <code class="systemitem">wheel</code> can run all commands
        with <code class="command">sudo</code> as root. The following procedure explains how to add a user
        account to the <code class="systemitem">wheel</code> group.
      </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
            Verify that the <code class="systemitem">wheel</code>
            group exists:
          </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">getent group wheel</code></pre></div><p>
            If the previous command returned no result, install the
            <span class="package">system-group-wheel</span> package that creates the
            <code class="systemitem">wheel</code> group:
          </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> <code class="command">zypper install system-group-wheel</code></pre></div></li><li class="step"><p>
            Add your user account to the group
            <code class="systemitem">wheel</code>.
          </p><p>
            If your user account is not already a member of the
            <code class="systemitem">wheel</code> group, add it
            using the <code class="command">sudo usermod -a -G wheel
            <em class="replaceable">USERNAME</em></code> command. Log out and
            log in again to enable the change. Verify that the change was
            successful by running the <code class="command">groups
            <em class="replaceable">USERNAME</em></code> command.
          </p></li><li class="step"><p>
            Authenticate with the user account's normal password.
          </p><p>
            Create the file <code class="filename">/etc/sudoers.d/userpw</code> using
            the <code class="command">visudo</code> command (see
            <a class="xref" href="cha-adm-sudo.html#sec-sudo-conf-edit" title="2.2.1. Editing the configuration files">Section 2.2.1, “Editing the configuration files”</a>) and add the following:
          </p><div class="verbatim-wrap"><pre class="screen">Defaults !targetpw</pre></div></li><li class="step"><p>
      Select a new default rule.
     </p><p>
      Depending on whether you want users to re-enter their passwords,
      uncomment the appropriate line in <code class="filename">/etc/sudoers</code> and
      comment out the default rule.
     </p><div class="verbatim-wrap"><pre class="screen">## Uncomment to allow members of group wheel to execute any command
# %wheel ALL=(ALL) ALL

## Same thing without a password
# %wheel ALL=(ALL) NOPASSWD: ALL</pre></div></li><li class="step"><p>
      Make the default rule more restrictive.
     </p><p>
      Comment out or remove the allow-everything rule in
      <code class="filename">/etc/sudoers</code>:
     </p><div class="verbatim-wrap"><pre class="screen">ALL     ALL=(ALL) ALL   # WARNING! Only use this together with 'Defaults targetpw'!</pre></div><div id="id-1.3.3.3.7.3.3.5.4" data-id-title="Dangerous rule in sudoers" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.svg"/><div class="admon-title">Warning: Dangerous rule in sudoers</div><p>
       Do not skip this step. Otherwise <span class="emphasis"><em>any</em></span> user can
       execute <span class="emphasis"><em>any</em></span> command as <code class="systemitem">root</code>!
      </p></div></li><li class="step"><p>
      Test the configuration.
     </p><p>
      Run <code class="command">sudo</code> as member and non-member of
      <code class="systemitem">wheel</code>.
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux:~ &gt; </code>groups
users wheel
<code class="prompt user">tux:~ &gt; </code>sudo id -un
tux's password:
root
<code class="prompt user">wilber:~ &gt; </code>groups
users
<code class="prompt user">wilber:~ &gt; </code>sudo id -un
wilber is not in the sudoers file.  This incident will be reported.</pre></div></li></ol></div></div></section><section class="sect2" id="sec-sudo-usecases-xorg" data-id-title="Using sudo with X.Org applications"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">2.3.2 </span><span class="title-name">Using <code class="command">sudo</code> with X.Org applications</span></span> <a title="Permalink" class="permalink" href="cha-adm-sudo.html#sec-sudo-usecases-xorg">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/adm_sudo.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    Starting graphical applications with <code class="command">sudo</code> usually results in the following
    error:
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">&gt; </code><code class="command">sudo</code> xterm
xterm: Xt error: Can't open display: %s
xterm: DISPLAY is not set</pre></div><p>
    A simple workaround is to use xhost to temporarily allow the root user
    to access the local user's X session. This is done using the following command:
   </p><div class="verbatim-wrap"><pre class="screen">xhost si:localuser:root</pre></div><p>
    The command below removes the granted access:
   </p><div class="verbatim-wrap"><pre class="screen">xhost -si:localuser:root</pre></div><div id="id-1.3.3.3.7.4.8" data-id-title="Potential security issue" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.svg"/><div class="admon-title">Warning: Potential security issue</div><p>
     Running graphical applications with root privileges has security
     implications. It is recommended to enable root access for a graphical
     application only as an exception. It is also recommended to revoke
     the granted root access as soon as the graphical application is closed.
    </p></div></section></section><section class="sect1" id="sec-adm-sudo-moreinfo" data-id-title="More information"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">2.4 </span><span class="title-name">More information</span></span> <a title="Permalink" class="permalink" href="cha-adm-sudo.html#sec-adm-sudo-moreinfo">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/main/xml/adm_sudo.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   The <code class="command">sudo --help</code> command offers a brief overview of the
   available command line options, while the <code class="command">man sudoers</code>
   command provides detailed information about <code class="filename">sudoers</code>
   and its configuration.
  </p></section></section><nav class="bottom-pagination"><div><a class="pagination-link prev" href="cha-adm-shell.html"><span class="pagination-relation">Previous</span><span class="pagination-label"><span class="title-number">Chapter 1 </span>Bash and Bash scripts</span></a> </div><div><a class="pagination-link next" href="cha-yast-gui.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Chapter 3 </span>Using YaST</span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="sect1"><a href="cha-adm-sudo.html#sec-adm-sudo-usage"><span class="title-number">2.1 </span><span class="title-name">Basic <code class="command">sudo</code> usage</span></a></span></li><li><span class="sect1"><a href="cha-adm-sudo.html#sec-sudo-conf"><span class="title-number">2.2 </span><span class="title-name">Configuring <code class="command">sudo</code></span></a></span></li><li><span class="sect1"><a href="cha-adm-sudo.html#sec-sudo-usecases"><span class="title-number">2.3 </span><span class="title-name"><code class="command">sudo</code> use cases</span></a></span></li><li><span class="sect1"><a href="cha-adm-sudo.html#sec-adm-sudo-moreinfo"><span class="title-number">2.4 </span><span class="title-name">More information</span></a></span></li></ul></div><div class="side-title">Share this page</div><ul class="share"><li><a id="_share-fb" href="#" title="Facebook"> </a></li><li><a id="_share-in" href="#" title="LinkedIn"> </a></li><li><a id="_share-tw" href="#" title="Twitter/X"> </a></li><li><a id="_share-mail" href="#" title="E-Mail"> </a></li><li><a id="_print-button" href="#" title="Print this page"> </a></li></ul> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2024</span></div></div></footer></body></html>