<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><title>SLES 12 SP4 | Storage Administration Guide | Managing Multipath I/O for Devices</title><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"/><link rel="stylesheet" type="text/css" href="static/css/style.css"/>
<link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/"/>
<meta name="title" content="Managing Multipath I/O for Devices | SLES 12 SP4"/>
<meta name="description" content="This section describes how to manage failover and path…"/>
<meta name="product-name" content="SUSE Linux Enterprise Server"/>
<meta name="product-number" content="12 SP4"/>
<meta name="book-title" content="Storage Administration Guide"/>
<meta name="chapter-title" content="Chapter 17. Managing Multipath I/O for Devices"/>
<meta name="tracker-url" content="https://bugzilla.suse.com/enter_bug.cgi"/>
<meta name="tracker-type" content="bsc"/>
<meta name="tracker-bsc-assignee" content="fs@suse.com"/>
<meta name="tracker-bsc-component" content="Documentation"/>
<meta name="tracker-bsc-product" content="SUSE Linux Enterprise Server 12 SP4"/>
<meta name="publisher" content="SUSE"/><meta property="og:title" content="Managing Multipath I/O for Devices | SLES 12 SP4"/>
<meta property="og:description" content="This section describes how to manage failover and path load balancing for multiple paths between the servers and block stora…"/>
<meta property="og:type" content="article"/>
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Managing Multipath I/O for Devices | SLES 12 SP4"/>
<meta name="twitter:description" content="This section describes how to manage failover and path load balancing for multiple paths between the servers and block stora…"/>
<link rel="prev" href="cha-nvmeof.html" title="Chapter 16. NVMe-oF"/><link rel="next" href="cha-nfs4-acls.html" title="Chapter 18. Managing Access Control Lists over NFSv4"/><script type="text/javascript">

if ( window.location.protocol.toLowerCase() != 'file:' ) {
  document.write('<link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"></link>');
};

</script><noscript><link rel="stylesheet" type="text/css" href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css"/></noscript><script src="static/js/script-purejs.js" type="text/javascript"> </script><script src="static/js/highlight.min.js" type="text/javascript"> </script><script>

$(document).ready(function() {
  $('.verbatim-wrap.highlight').each(function(i, block) {
    hljs.highlightBlock(block);
  });
});
hljs.configure({
  useBR: false
});

</script><meta name="edit-url" content="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml"/></head><body class="draft wide offline js-off" onload="$('#betawarn-button-wrap').toggle();if (document.cookie.length > 0) {if (document.cookie.indexOf('betawarn=closed') != -1){$('#betawarn').toggle()}};"><div id="betawarn" style="position:fixed;bottom:0;z-index:9025;background-color:#FDE8E8;padding:1em;margin-left:10%;margin-right:10%;display:block;border-top:.75em solid #E11;width:80%"><p style="color:#333;margin:1em 0;padding:0;">This is a draft document that was built and uploaded automatically. It may document beta software and be incomplete or even incorrect. <strong>Use this document at your own risk.</strong></p> <div id="betawarn-button-wrap" style="display:none;margin:0;padding:0;"><a href="#" onclick="$('#betawarn').toggle();var d=new Date();d.setTime(d.getTime()+(0.5*24*60*60*1000));document.cookie='betawarn=closed; expires='+d.toUTCString()+'; path=/'; return false;" style="color:#333;text-decoration:underline;float:left;margin-top:.5em;padding:1em;display:block;background-color:#FABEBE;">I understand this is a draft</a></div></div><div class="bypass-block"><a href="#_content">Jump to content</a><a href="#_bottom-pagination">Jump to page navigation: previous page [access key p]/next page [access key n]</a></div><header id="_mainnav"><div class="growth-inhibitor"><img src="static/images/logo.svg" alt="Logo" class="logo"/></div></header><div class="crumbs"><div class="growth-inhibitor"><a class="crumb" href="index.html">Storage Administration Guide</a><span> / </span><a class="crumb" href="part-net-storage.html">Network Storage</a><span> / </span><a class="crumb" href="cha-multipath.html">Managing Multipath I/O for Devices</a></div></div><main id="_content"><nav id="_side-toc-overall" class="side-toc"><div class="side-title">Storage Administration Guide</div><ol><li><a href="storage-preface.html" class=" "><span class="title-number"> </span><span class="title-name">About This Guide</span></a></li><li><a href="part-filesystems.html" class="has-children "><span class="title-number">I </span><span class="title-name">File Systems and Mounting</span></a><ol><li><a href="cha-filesystems.html" class=" "><span class="title-number">1 </span><span class="title-name">Overview of File Systems in Linux</span></a></li><li><a href="cha-resize-fs.html" class=" "><span class="title-number">2 </span><span class="title-name">Resizing File Systems</span></a></li><li><a href="cha-uuid.html" class=" "><span class="title-number">3 </span><span class="title-name">Using UUIDs to Mount Devices</span></a></li><li><a href="cha-multitiercache.html" class=" "><span class="title-number">4 </span><span class="title-name">Multi-tier Caching for Block Device Operations</span></a></li></ol></li><li><a href="part-lvm.html" class="has-children "><span class="title-number">II </span><span class="title-name">Logical Volumes (LVM)</span></a><ol><li><a href="cha-lvm.html" class=" "><span class="title-number">5 </span><span class="title-name">LVM Configuration</span></a></li><li><a href="cha-lvm-snapshots.html" class=" "><span class="title-number">6 </span><span class="title-name">LVM Volume Snapshots</span></a></li></ol></li><li><a href="part-software-raid.html" class="has-children "><span class="title-number">III </span><span class="title-name">Software RAID</span></a><ol><li><a href="cha-raid.html" class=" "><span class="title-number">7 </span><span class="title-name">Software RAID Configuration</span></a></li><li><a href="cha-raidroot.html" class=" "><span class="title-number">8 </span><span class="title-name">Configuring Software RAID for the Root Partition</span></a></li><li><a href="cha-raid10.html" class=" "><span class="title-number">9 </span><span class="title-name">Creating Software RAID 10 Devices</span></a></li><li><a href="cha-raid-degraded.html" class=" "><span class="title-number">10 </span><span class="title-name">Creating a Degraded RAID Array</span></a></li><li><a href="cha-raid-resize.html" class=" "><span class="title-number">11 </span><span class="title-name">Resizing Software RAID Arrays with mdadm</span></a></li><li><a href="cha-raid-leds.html" class=" "><span class="title-number">12 </span><span class="title-name">Storage Enclosure LED Utilities for MD Software RAIDs</span></a></li></ol></li><li class="active"><a href="part-net-storage.html" class="has-children you-are-here"><span class="title-number">IV </span><span class="title-name">Network Storage</span></a><ol><li><a href="cha-isns.html" class=" "><span class="title-number">13 </span><span class="title-name">iSNS for Linux</span></a></li><li><a href="cha-iscsi.html" class=" "><span class="title-number">14 </span><span class="title-name">Mass Storage over IP Networks: iSCSI</span></a></li><li><a href="cha-fcoe.html" class=" "><span class="title-number">15 </span><span class="title-name">Fibre Channel Storage over Ethernet Networks: FCoE</span></a></li><li><a href="cha-nvmeof.html" class=" "><span class="title-number">16 </span><span class="title-name">NVMe-oF</span></a></li><li><a href="cha-multipath.html" class=" you-are-here"><span class="title-number">17 </span><span class="title-name">Managing Multipath I/O for Devices</span></a></li><li><a href="cha-nfs4-acls.html" class=" "><span class="title-number">18 </span><span class="title-name">Managing Access Control Lists over NFSv4</span></a></li></ol></li><li><a href="app-storage-docupdates.html" class=" "><span class="title-number">A </span><span class="title-name">Documentation Updates</span></a></li><li><a href="bk08apb.html" class=" "><span class="title-number">B </span><span class="title-name">GNU licenses</span></a></li> </ol> </nav><button id="_open-side-toc-overall" title="Contents"> </button><article class="documentation"><button id="_unfold-side-toc-page">On this page</button><section xml:lang="en" class="chapter" id="cha-multipath" data-id-title="Managing Multipath I/O for Devices"><div class="titlepage"><div><div class="version-info">Applies to  <span class="productname"><span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span></span> <span class="productnumber"><span class="productnumber"><span class="phrase">12 SP4</span></span></span></div><div><div class="title-container"><h1 class="title"><span class="title-number-name"><span class="title-number">17 </span><span class="title-name">Managing Multipath I/O for Devices</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#">#</a></h1><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
  This section describes how to manage failover and path load balancing for
  multiple paths between the servers and block storage devices by using
  Multipath I/O (MPIO).
 </p><section class="sect1" id="sec-multipath-intro" data-id-title="Understanding Multipath I/O"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">17.1 </span><span class="title-name">Understanding Multipath I/O</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-intro">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   Multipathing is the ability of a server to communicate with the same
   physical or logical block storage device across multiple physical paths
   between the host bus adapters in the server and the storage controllers for
   the device, typically in Fibre Channel (FC) or iSCSI SAN environments. You
   can also achieve multiple connections with direct attached storage when
   multiple channels are available.
  </p><p>
   Linux multipathing provides connection fault tolerance and can provide load
   balancing across the active connections. When multipathing is configured and
   running, it automatically isolates and identifies device connection
   failures, and reroutes I/O to alternate connections.
  </p><p>
   Typical connection problems involve faulty adapters, cables, or controllers.
   When you configure multipath I/O for a device, the multipath driver monitors
   the active connection between devices. When the multipath driver detects I/O
   errors for an active path, it fails over the traffic to the device’s
   designated secondary path. When the preferred path becomes healthy again,
   control can be returned to the preferred path.
  </p></section><section class="sect1" id="sec-multipath-hardware" data-id-title="Hardware Support"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">17.2 </span><span class="title-name">Hardware Support</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-hardware">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   The multipathing drivers and tools support all architectures for which
   <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> is available. They support most storage arrays. The storage
   array that houses the multipathed device must support multipathing to use
   the multipathing drivers and tools. Some storage array vendors provide their
   own multipathing management tools. Consult the vendor’s hardware
   documentation to determine what settings are required.
  </p><section class="sect2" id="sec-multipath-hardware-autodetect" data-id-title="Storage Arrays That Are Automatically Detected for Multipathing"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.2.1 </span><span class="title-name">Storage Arrays That Are Automatically Detected for Multipathing</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-hardware-autodetect">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    The <code class="filename">multipath-tools</code> package automatically detects the
    following storage arrays:
   </p><table style="border: 0; " class="simplelist"><tr><td>3PARdata VV</td></tr><tr><td>AIX NVDISK</td></tr><tr><td>AIX VDASD</td></tr><tr><td>APPLE Xserve RAID</td></tr><tr><td>COMPELNT Compellent Vol</td></tr><tr><td>COMPAQ/HP HSV101, HSV111, HSV200, HSV210, HSV300, HSV400, HSV 450</td></tr><tr><td>COMPAQ/HP MSA, HSV</td></tr><tr><td>COMPAQ/HP MSA VOLUME</td></tr><tr><td>DataCore SANmelody</td></tr><tr><td>DDN SAN DataDirector</td></tr><tr><td>DEC HSG80</td></tr><tr><td>DELL MD3000</td></tr><tr><td>DELL MD3000i</td></tr><tr><td>DELL MD32xx</td></tr><tr><td>DELL MD32xxi</td></tr><tr><td>DGC</td></tr><tr><td>EMC Clariion</td></tr><tr><td>EMC Invista</td></tr><tr><td>EMC SYMMETRIX</td></tr><tr><td>EUROLOGC FC2502</td></tr><tr><td>FSC CentricStor</td></tr><tr><td>FUJITSU ETERNUS_DX, DXL, DX400, DX8000</td></tr><tr><td>HITACHI DF</td></tr><tr><td>HITACHI/HP OPEN</td></tr><tr><td>HP A6189A</td></tr><tr><td>HP HSVX700</td></tr><tr><td>HP LOGICAL VOLUME</td></tr><tr><td>HP MSA2012fc, MSA 2212fc, MSA2012i</td></tr><tr><td>HP MSA2012sa, MSA2312 fc/i/sa, MCA2324 fc/i/sa, MSA2000s VOLUME</td></tr><tr><td>HP P2000 G3 FC|P2000G3 FC/iSCSI|P2000 G3 SAS|P2000 G3 iSCSI</td></tr><tr><td>IBM 1722-600</td></tr><tr><td>IBM 1724</td></tr><tr><td>IBM 1726</td></tr><tr><td>IBM 1742</td></tr><tr><td>IBM 1745, 1746</td></tr><tr><td>IBM 1750500</td></tr><tr><td>IBM 1814</td></tr><tr><td>IBM 1815</td></tr><tr><td>IBM 1818</td></tr><tr><td>IBM 1820N00</td></tr><tr><td>IBM 2105800</td></tr><tr><td>IBM 2105F20</td></tr><tr><td>IBM 2107900</td></tr><tr><td>IBM 2145</td></tr><tr><td>IBM 2810XIV</td></tr><tr><td>IBM 3303 NVDISK</td></tr><tr><td>IBM 3526</td></tr><tr><td>IBM 3542</td></tr><tr><td>IBM IPR</td></tr><tr><td>IBM Nseries</td></tr><tr><td>IBM ProFibre 4000R</td></tr><tr><td>IBM S/390 DASD ECKD</td></tr><tr><td>IBM S/390 DASD FBA</td></tr><tr><td>Intel Multi-Flex</td></tr><tr><td>LSI/ENGENIO INF-01-00</td></tr><tr><td>NEC DISK ARRAY</td></tr><tr><td>NETAPP LUN</td></tr><tr><td>NEXENTA COMSTAR</td></tr><tr><td>Pillar Axiom</td></tr><tr><td>PIVOT3 RAIGE VOLUME</td></tr><tr><td>SGI IS</td></tr><tr><td>SGI TP9100, TP 9300</td></tr><tr><td>SGI TP9400, TP9500</td></tr><tr><td>STK FLEXLINE 380</td></tr><tr><td>STK OPENstorage D280</td></tr><tr><td>SUN CSM200_R</td></tr><tr><td>SUN LCSM100_[IEFS]</td></tr><tr><td>SUN STK6580, STK6780</td></tr><tr><td>SUN StorEdge 3510, T4</td></tr><tr><td>SUN SUN_6180</td></tr></table><p>
    In general, most other storage arrays should work. When storage arrays are
    automatically detected, the default settings for multipathing apply. If you
    want non-default settings, you must manually create and configure the
    <code class="filename">/etc/multipath.conf</code> file. The same applies for
    hardware that is not automatically detected. For information, see
    <a class="xref" href="cha-multipath.html#sec-multipath-conf-file" title="17.6. Creating or Modifying the /etc/multipath.conf File">Section 17.6, “Creating or Modifying the /etc/multipath.conf File”</a>.
   </p><p>
    Consider the following caveats:
   </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
      Not all of the storage arrays that are automatically detected have been
      tested on <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span>. Also see
      <a class="xref" href="cha-multipath.html#sec-multipath-hardware-tested" title="17.2.2. Tested Storage Arrays for Multipathing Support">Section 17.2.2, “Tested Storage Arrays for Multipathing Support”</a>.
     </p></li><li class="listitem"><p>
      Some storage arrays might require specific hardware handlers. A hardware
      handler is a kernel module that performs hardware-specific actions when
      switching path groups and dealing with I/O errors. For information, see
      <a class="xref" href="cha-multipath.html#sec-multipath-hardware-handlers" title="17.2.3. Storage Arrays that Require Specific Hardware Handlers">Section 17.2.3, “Storage Arrays that Require Specific Hardware Handlers”</a>.
     </p></li><li class="listitem"><p>
      After each modification of the <code class="filename">/etc/multipath.conf</code>
      file, you must run <code class="command">dracut</code> <code class="option">-f</code> to
      re-create the <code class="systemitem">initrd</code> on your system. Reboot
      afterward for the changes to take effect.
     </p></li></ul></div></section><section class="sect2" id="sec-multipath-hardware-tested" data-id-title="Tested Storage Arrays for Multipathing Support"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.2.2 </span><span class="title-name">Tested Storage Arrays for Multipathing Support</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-hardware-tested">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    Storage arrays from the following vendors have been tested with
    <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span>:
   </p><table style="border: 0; " class="simplelist"><tr><td>EMC</td></tr><tr><td>Hitachi</td></tr><tr><td>Hewlett-Packard/Compaq</td></tr><tr><td>IBM</td></tr><tr><td>NetApp</td></tr><tr><td>SGI</td></tr></table><p>
    Most other vendor storage arrays should also work. Consult your vendor’s
    documentation for guidance. For a list of the default storage arrays
    recognized by the <code class="filename">multipath-tools</code> package, see
    <a class="xref" href="cha-multipath.html#sec-multipath-hardware-autodetect" title="17.2.1. Storage Arrays That Are Automatically Detected for Multipathing">Section 17.2.1, “Storage Arrays That Are Automatically Detected for Multipathing”</a>.
   </p></section><section class="sect2" id="sec-multipath-hardware-handlers" data-id-title="Storage Arrays that Require Specific Hardware Handlers"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.2.3 </span><span class="title-name">Storage Arrays that Require Specific Hardware Handlers</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-hardware-handlers">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    Storage arrays that require special commands on failover from one path to
    the other or that require special nonstandard error handling might require
    more extensive support. Therefore, the Device Mapper Multipath service has
    hooks for hardware handlers. For example, one such handler for the EMC
    CLARiiON CX family of arrays is already provided.
   </p><div id="id-1.10.6.6.5.5.3" data-id-title="For More Information" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg"/><div class="admon-title">Important: For More Information</div><p>
     Consult the hardware vendor’s documentation to determine if its hardware
     handler must be installed for Device Mapper Multipath.
    </p></div><p>
    The <code class="command">multipath -t</code> command shows an internal table of
    storage arrays that require special handling with specific hardware
    handlers. The displayed list is not an exhaustive list of supported storage
    arrays. It lists only those arrays that require special handling and that
    the <code class="filename">multipath-tools</code> developers had access to during
    the tool development.
   </p><div id="id-1.10.6.6.5.5.5" data-id-title="Exceptions" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg"/><div class="admon-title">Important: Exceptions</div><p>
     Arrays with true active/active multipath support do not require special
     handling, so they are not listed for the <code class="command">multipath -t</code>
     command.
    </p></div><p>
    A listing in the <code class="command">multipath -t</code> table does not necessarily
    mean that <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> was tested on that specific hardware. For a list of
    tested storage arrays, see
    <a class="xref" href="cha-multipath.html#sec-multipath-hardware-tested" title="17.2.2. Tested Storage Arrays for Multipathing Support">Section 17.2.2, “Tested Storage Arrays for Multipathing Support”</a>.
   </p></section></section><section class="sect1" id="sec-multipath-planning" data-id-title="Planning for Multipathing"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">17.3 </span><span class="title-name">Planning for Multipathing</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-planning">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   Use the guidelines in this section when planning your multipath I/O
   solution.
  </p><section class="sect2" id="sec-multipath-planning-prereq" data-id-title="Prerequisites"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.3.1 </span><span class="title-name">Prerequisites</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-planning-prereq">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
      Multipathing is managed at the device level.
     </p></li><li class="listitem"><p>
      The storage array you use for the multipathed device must support
      multipathing. For more information, see
      <a class="xref" href="cha-multipath.html#sec-multipath-hardware" title="17.2. Hardware Support">Section 17.2, “Hardware Support”</a>.
     </p></li><li class="listitem"><p>
      You need to configure multipathing only if multiple physical paths exist
      between host bus adapters in the server and host bus controllers for the
      block storage device. You configure multipathing for the logical device
      as seen by the server.
     </p></li><li class="listitem"><p>
      For some storage arrays, the vendor provides its own multipathing
      software to manage multipathing for the array’s physical and logical
      devices. In this case, you should follow the vendor’s instructions for
      configuring multipathing for those devices.
     </p></li><li class="listitem"><p>
      When using multipathing in a virtualization environment, the multipathing
      is controlled in the host server environment. Configure multipathing for
      the device before you assign it to a virtual guest machine.
     </p></li></ul></div></section><section class="sect2" id="sec-multipath-planning-disks" data-id-title="Disk Management Tasks"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.3.2 </span><span class="title-name">Disk Management Tasks</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-planning-disks">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    Perform the following disk management tasks before you attempt to configure
    multipathing for a physical or logical device that has multiple paths:
   </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
      Use third-party tools to carve physical disks into smaller logical disks.
     </p></li><li class="listitem"><p>
      Use third-party tools to partition physical or logical disks. If you
      change the partitioning in the running system, the Device Mapper
      Multipath (DM-MP) module does not automatically detect and reflect these
      changes. DM-MPIO must be re-initialized, which usually requires a reboot.
     </p></li><li class="listitem"><p>
      Use third-party SAN array management tools to create and configure
      hardware RAID devices.
     </p></li><li class="listitem"><p>
      Use third-party SAN array management tools to create logical devices such
      as LUNs. Logical device types that are supported for a given array depend
      on the array vendor.
     </p></li></ul></div></section><section class="sect2" id="sec-multipath-planning-raid" data-id-title="Software RAIDs"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.3.3 </span><span class="title-name">Software RAIDs</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-planning-raid">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    The Linux software RAID management software runs on top of multipathing.
    For each device that has multiple I/O paths and that you plan to use in a
    software RAID, you must configure the device for multipathing before you
    attempt to create the software RAID device. Automatic discovery of
    multipathed devices is not available. The software RAID is not aware of the
    multipathing management running underneath.
   </p><p>
    For information about setting up multipathing for existing software RAIDs,
    see <a class="xref" href="cha-multipath.html#sec-multipath-raid" title="17.12. Configuring Multipath I/O for an Existing Software RAID">Section 17.12, “Configuring Multipath I/O for an Existing Software RAID”</a>.
   </p></section><section class="sect2" id="sec-multipath-planning-ha" data-id-title="High-Availability Solutions"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.3.4 </span><span class="title-name">High-Availability Solutions</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-planning-ha">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    High-availability solutions for clustering storage resources run on top of
    the multipathing service on each node. Make sure that the configuration
    settings in the <code class="filename">/etc/multipath.conf</code> file on each node
    are consistent across the cluster.
   </p><p>
    Make sure that multipath devices have the same name across all
    devices. Refer to <a class="xref" href="cha-multipath.html#sec-multipath-names-ha" title="17.9.1. Multipath Device Names in HA Clusters">Section 17.9.1, “Multipath Device Names in HA Clusters”</a> for details.
   </p><p>
    The Distributed Replicated Block Device (DRBD) high-availability solution
    for mirroring devices across a LAN runs on top of multipathing. For each
    device that has multiple I/O paths and that you plan to use in a DRDB
    solution, you must configure the device for multipathing before you
    configure DRBD.
   </p></section><section class="sect2" id="sec-multipath-planning-initrd" data-id-title="Always Keep the initrd in Synchronization with the System Configuration"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.3.5 </span><span class="title-name">
    Always Keep the <code class="filename">initrd</code> in Synchronization with the
    System Configuration
   </span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-planning-initrd">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    One of the most important requirements when using Multipath is to make sure
    that the <code class="filename">initrd</code> and the installed system behave the
    same regarding the root file system and all other file systems required to
    boot the system. If Multipath is enabled in the system, it also needs to be
    enabled in the <code class="filename">initrd</code> and vice versa. See <a class="xref" href="cha-multipath.html#sec-multipath-configuration-start" title="17.5.1. Enabling, Disabling, Starting and Stopping Multipath I/O Services">Section 17.5.1, “Enabling, Disabling, Starting and Stopping Multipath I/O Services”</a> for details.
   </p><p>
    If the <code class="filename">initrd</code> and the system are not synchronized, the
    system will not properly boot and the start-up procedure will result in an
    emergency shell. See <a class="xref" href="cha-multipath.html#sec-multipath-trouble-root" title="17.15.1. The System Exits to Emergency Shell at Boot When Multipath Is Enabled">Section 17.15.1, “The System Exits to Emergency Shell at Boot When Multipath Is Enabled”</a> for
    instructions on how to avoid or repair such a scenario.
   </p></section></section><section class="sect1" id="sec-multipath-mpiotools" data-id-title="Multipath Management Tools"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">17.4 </span><span class="title-name">Multipath Management Tools</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-mpiotools">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   The multipathing support in <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> is based on the Device Mapper
   Multipath module of the Linux kernel and the
   <code class="systemitem">multipath-tools</code> user space package. You can use the
   Multiple Devices Administration utility (<code class="command">multipath</code>) to
   view the status of multipathed devices.
  </p><section class="sect2" id="sec-multipath-mpiotools-dm" data-id-title="Device Mapper Multipath Module"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.4.1 </span><span class="title-name">Device Mapper Multipath Module</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-mpiotools-dm">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    The Device Mapper Multipath (DM-MP) module provides the multipathing
    capability for Linux. DM-MPIO is the preferred solution for multipathing on
    <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span>. It is the only multipathing option shipped with the product
    that is completely supported by SUSE.
   </p><p>
    DM-MPIO features automatic configuration of the multipathing subsystem for
    a large variety of setups. Configurations of up to eight paths to each
    device are supported. Configurations are supported for active/passive (one
    path active, others passive) or active/active (all paths active with
    round-robin load balancing).
   </p><p>
    The DM-MPIO framework is extensible in two ways:
   </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
      Using specific hardware handlers. For information, see
      <a class="xref" href="cha-multipath.html#sec-multipath-hardware-handlers" title="17.2.3. Storage Arrays that Require Specific Hardware Handlers">Section 17.2.3, “Storage Arrays that Require Specific Hardware Handlers”</a>.
     </p></li><li class="listitem"><p>
      Using load-balancing algorithms that are more sophisticated than the
      round-robin algorithm.
     </p></li></ul></div><p>
    The user space component of DM-MPIO takes care of automatic path discovery
    and grouping, and automated path retesting, so that a previously failed
    path is automatically reinstated when it becomes healthy again. This
    minimizes the need for administrator attention in a production environment.
   </p><p>
    DM-MPIO protects against failures in the paths to the device, and not
    failures in the device itself. If one of the active paths is lost (for
    example, a network adapter breaks or a fiber-optic cable is removed), I/O
    is redirected to the remaining paths. If the configuration is
    active/passive, then the path fails over to one of the passive paths. If
    you are using the round-robin load-balancing configuration, the traffic is
    balanced across the remaining healthy paths. If all active paths fail,
    inactive secondary paths must be woken up, so failover occurs with a delay
    of approximately 30 seconds.
   </p><p>
    If a disk array has more than one storage processor, ensure that the SAN
    switch has a connection to the storage processor that owns the LUNs you
    want to access. On most disk arrays, all LUNs belong to both storage
    processors, so both connections are active.
   </p><div id="id-1.10.6.6.7.3.9" data-id-title="Storage Processors" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note: Storage Processors</div><p>
     On some disk arrays, the storage array manages the traffic through storage
     processors so that it presents only one storage processor at a time. One
     processor is active and the other one is passive until there is a failure.
     If you are connected to the wrong storage processor (the one with the
     passive path) you might not see the expected LUNs, or you might see the
     LUNs but get errors when you try to access them.
    </p></div><div class="table" id="id-1.10.6.6.7.3.10" data-id-title="Multipath I/O Features of Storage Arrays"><div class="title-container"><div class="table-title-wrap"><div class="table-title"><span class="title-number-name"><span class="title-number">Table 17.1: </span><span class="title-name">Multipath I/O Features of Storage Arrays </span></span><a title="Permalink" class="permalink" href="cha-multipath.html#id-1.10.6.6.7.3.10">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div><div class="table-contents"><table style="border-collapse: collapse; border-top: 1px solid ; border-bottom: 1px solid ; border-left: 1px solid ; border-right: 1px solid ; "><colgroup><col class="1"/><col class="2"/></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; ">
        <p>
         Features of Storage Arrays
        </p>
       </th><th style="border-bottom: 1px solid ; ">
        <p>
         Description
        </p>
       </th></tr></thead><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
        <p>
         Active/passive controllers
        </p>
       </td><td style="border-bottom: 1px solid ; ">
        <p>
         One controller is active and serves all LUNs. The second controller
         acts as a standby. The second controller also presents the LUNs to the
         multipath component so that the operating system knows about redundant
         paths. If the primary controller fails, the second controller takes
         over, and it serves all LUNs.
        </p>
        <p>
         In some arrays, the LUNs can be assigned to different controllers. A
         given LUN is assigned to one controller to be its active controller.
         One controller does the disk I/O for any LUN at a time, and the second
         controller is the standby for that LUN. The second controller also
         presents the paths, but disk I/O is not possible. Servers that use
         that LUN are connected to the LUN’s assigned controller. If the
         primary controller for a set of LUNs fails, the second controller
         takes over, and it serves all LUNs.
        </p>
       </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
        <p>
         Active/active controllers
        </p>
       </td><td style="border-bottom: 1px solid ; ">
        <p>
         Both controllers share the load for all LUNs, and can process disk I/O
         for any LUN. If one controller fails, the second controller
         automatically handles all traffic.
        </p>
       </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
        <p>
         Load balancing
        </p>
       </td><td style="border-bottom: 1px solid ; ">
        <p>
         The Device Mapper Multipath driver automatically load balances traffic
         across all active paths.
        </p>
       </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
        <p>
         Controller failover
        </p>
       </td><td style="border-bottom: 1px solid ; ">
        <p>
         When the active controller fails over to the passive, or standby,
         controller, the Device Mapper Multipath driver automatically activates
         the paths between the host and the standby, making them the primary
         paths.
        </p>
       </td></tr><tr><td style="border-right: 1px solid ; ">
        <p>
         Boot/Root device support
        </p>
       </td><td>
        <p>
         Multipathing is supported for the root (<code class="filename">/</code>) device
         in <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> 10 and later. The host server must be connected to
         the currently active controller and storage processor for the boot
         device.
        </p>
        <p>
         Multipathing is supported for the <code class="filename">/boot</code> device in
         <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> 11 and later.
        </p>
       </td></tr></tbody></table></div></div><p>
    Device Mapper Multipath detects every path for a multipathed device as a
    separate SCSI device. The SCSI device names take the form
    <code class="filename">/dev/sd<em class="replaceable">N</em></code>, where
    <code class="filename"><em class="replaceable">N</em></code> is an autogenerated
    letter for the device, beginning with a and issued sequentially as the
    devices are created, such as <code class="filename">/dev/sda</code>,
    <code class="filename">/dev/sdb</code>, and so on. If the number of devices exceeds
    26, the letters are duplicated so that the next device after
    <code class="filename">/dev/sdz</code> will be named <code class="filename">/dev/sdaa</code>,
    <code class="filename">/dev/sdab</code>, and so on.
   </p><p>
    If multiple paths are not automatically detected, you can configure them
    manually in the <code class="filename">/etc/multipath.conf</code> file. The
    <code class="filename">multipath.conf</code> file does not exist until you create
    and configure it. For information, see
    <a class="xref" href="cha-multipath.html#sec-multipath-conf-file" title="17.6. Creating or Modifying the /etc/multipath.conf File">Section 17.6, “Creating or Modifying the /etc/multipath.conf File”</a>.
   </p></section><section class="sect2" id="sec-multipath-mpiotools-io-management" data-id-title="Multipath I/O Management Tools"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.4.2 </span><span class="title-name">Multipath I/O Management Tools</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-mpiotools-io-management">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    The packages <code class="systemitem">multipath-tools</code> and
    <code class="systemitem">kpartx</code> provide tools that take
    care of automatic path discovery and grouping. They automatically test the
    path periodically, so that a previously failed path is automatically
    reinstated when it becomes healthy again. This minimizes the need for
    administrator attention in a production environment.
   </p><div class="table" id="id-1.10.6.6.7.4.3" data-id-title="Tools in the multipath-tools Package"><div class="title-container"><div class="table-title-wrap"><div class="table-title"><span class="title-number-name"><span class="title-number">Table 17.2: </span><span class="title-name">Tools in the multipath-tools Package </span></span><a title="Permalink" class="permalink" href="cha-multipath.html#id-1.10.6.6.7.4.3">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div><div class="table-contents"><table style="border-collapse: collapse; border-top: 1px solid ; border-bottom: 1px solid ; border-left: 1px solid ; border-right: 1px solid ; "><colgroup><col class="1"/><col class="2"/></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; ">
        <p>
         Tool
        </p>
       </th><th style="border-bottom: 1px solid ; ">
        <p>
         Description
        </p>
       </th></tr></thead><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
        <p>
         <code class="command">multipath</code>
        </p>
       </td><td style="border-bottom: 1px solid ; ">
        <p>
         Scans the system for multipathed devices and assembles them.
        </p>
       </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
        <p>
         <code class="command">multipathd</code>
        </p>
       </td><td style="border-bottom: 1px solid ; ">
        <p>
         Waits for maps events, then executes <code class="command">multipath</code>.
        </p>
       </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
        <p>
         <code class="command">kpartx</code>
        </p>
       </td><td style="border-bottom: 1px solid ; ">
        <p>
         Maps linear devmaps to partitions on the multipathed device, which
         makes it possible to create multipath monitoring for partitions on the
         device.
        </p>
       </td></tr><tr><td style="border-right: 1px solid ; ">
        <p>
         <code class="command">mpathpersist</code>
        </p>
       </td><td>
        <p>
         Manages SCSI-persistent reservations on Device Mapper Multipath
         devices.ppc
        </p>
       </td></tr></tbody></table></div></div></section><section class="sect2" id="sec-multipath-mpiotools-mdadm" data-id-title="Using MDADM for Multipathed Devices"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.4.3 </span><span class="title-name">Using MDADM for Multipathed Devices</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-mpiotools-mdadm">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    Udev is the default device handler, and devices are automatically known to
    the system by the Worldwide ID instead of by the device node name. This
    resolves problems in previous releases of MDADM and LVM where the
    configuration files (<code class="filename">mdadm.conf</code> and
    <code class="filename">lvm.conf)</code> did not properly recognize multipathed
    devices.
   </p><p>
    As with LVM2, MDADM requires that the devices be accessed by the ID rather
    than by the device node path. Therefore, the
    <code class="systemitem">DEVICE</code> entry in
    <code class="filename">/etc/mdadm.conf</code> should be set as follows:
   </p><div class="verbatim-wrap"><pre class="screen">DEVICE /dev/disk/by-id/*</pre></div><p>
    If you are using user-friendly names, specify the path as follows so that
    only the device mapper names are scanned after multipathing is configured:
   </p><div class="verbatim-wrap"><pre class="screen">DEVICE /dev/disk/by-id/dm-uuid-.*-mpath-.*</pre></div></section><section class="sect2" id="sec-multipath-mpiotools-multipath" data-id-title="The multipath Command"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.4.4 </span><span class="title-name">The multipath Command</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-mpiotools-multipath">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    Use the Linux <code class="command">multipath(8)</code> command to configure and
    manage multipathed devices. The general syntax for the command looks like
    the following:
   </p><div class="verbatim-wrap"><pre class="screen">multipath [-v verbosity_level] [-b bindings_file] [-d] [-h|-l|-ll|-f|-F|-B|-c|-q|-r|-w|-W|-t] [-p failover|multibus|group_by_serial|group_by_prio|group_by_node_name] [<em class="replaceable">DEVICENAME</em>]</pre></div><p>
    Refer to <code class="command">man 8 multipath</code> for details.
   </p><div class="sect1 bridgehead"><h2 class="title" id="id-1.10.6.6.7.6.5"><span class="name">General Examples</span><a title="Permalink" class="permalink" href="cha-multipath.html#id-1.10.6.6.7.6.5">#</a></h2></div><div class="variablelist"><dl class="variablelist"><dt id="id-1.10.6.6.7.6.6.1"><span class="term">multipath</span></dt><dd><p>
       Configures all multipath devices.
      </p></dd><dt id="id-1.10.6.6.7.6.6.2"><span class="term">multipath <em class="replaceable">DEVICENAME</em>
     </span></dt><dd><p>
       Configures a specific multipath device.
      </p><p>
       Replace <em class="replaceable">DEVICENAME</em> with the device node name
       such as <code class="filename">/dev/sdb</code> (as shown by udev in the $DEVNAME
       variable), or in the <code class="literal">major:minor</code> format. The device
       may alternatively be a multipath map name.
      </p></dd><dt id="id-1.10.6.6.7.6.6.3"><span class="term">multipath -f</span></dt><dd><p>
       Selectively suppresses a multipath map, and its device-mapped
       partitions.
      </p></dd><dt id="id-1.10.6.6.7.6.6.4"><span class="term">multipath -d</span></dt><dd><p>
       Dry run. Displays potential multipath devices, but does not create any
       devices and does not update device maps.
      </p></dd><dt id="id-1.10.6.6.7.6.6.5"><span class="term">multipath -v2 -d</span></dt><dd><p>
       Displays multipath map information for potential multipath devices in a
       dry run. The -v2 option shows only local disks. This verbosity level
       prints the created or updated multipath names only for use to feed other
       tools like kpartx.
      </p><p>
       There is no output if the device already exists and there are no
       changes. Use <code class="command">multipath -ll</code> to see the status of
       configured multipath devices.
      </p></dd><dt id="id-1.10.6.6.7.6.6.6"><span class="term">multipath -v2 <em class="replaceable">DEVICENAME</em>
     </span></dt><dd><p>
       Configures a specific potential multipath device and displays multipath
       map information for it. This verbosity level prints only the created or
       updated multipath names for use to feed other tools like
       <code class="command">kpartx</code>.
      </p><p>
       There is no output if the device already exists and there are no
       changes. Use <code class="command">multipath -ll</code> to see the status of
       configured multipath devices.
      </p><p>
       Replace <em class="replaceable">DEVICENAME</em> with the device node name
       such as <code class="filename">/dev/sdb</code> (as shown by
       <code class="command">udev</code> in the $DEVNAME variable), or in the
       <code class="literal">major:minor</code> format. The device may alternatively be a
       multipath map name.
      </p></dd><dt id="id-1.10.6.6.7.6.6.7"><span class="term">multipath -v3</span></dt><dd><p>
       Configures potential multipath devices and displays multipath map
       information for them. This verbosity level prints all detected paths,
       multipaths, and device maps. Both WWID and <code class="literal">devnode</code>
       blacklisted devices are displayed.
      </p></dd><dt id="id-1.10.6.6.7.6.6.8"><span class="term">multipath -v3 <em class="replaceable">DEVICENAME</em>
     </span></dt><dd><p>
       Configures a specific potential multipath device and displays
       information for it. The -v3 option shows the full path list. This
       verbosity level prints all detected paths, multipaths, and device maps.
       Both WWID and <code class="literal">devnode</code> blacklisted devices are
       displayed.
      </p><p>
       Replace <em class="replaceable">DEVICENAME</em> with the device node name
       such as <code class="filename">/dev/sdb</code> (as shown by
       <code class="command">udev</code> in the $DEVNAME variable), or in the
       <code class="literal">major:minor</code> format. The device may alternatively be a
       multipath map name.
      </p></dd><dt id="id-1.10.6.6.7.6.6.9"><span class="term">multipath -ll</span></dt><dd><p>
       Displays the status of all multipath devices.
      </p></dd><dt id="id-1.10.6.6.7.6.6.10"><span class="term">multipath -ll <em class="replaceable">DEVICENAME</em>
     </span></dt><dd><p>
       Displays the status of a specified multipath device.
      </p><p>
       Replace <em class="replaceable">DEVICENAME</em> with the device node name
       such as <code class="filename">/dev/sdb</code> (as shown by
       <code class="command">udev</code> in the $DEVNAME variable), or in the
       <code class="literal">major:minor</code> format. The device may alternatively be a
       multipath map name.
      </p></dd><dt id="id-1.10.6.6.7.6.6.11"><span class="term">multipath -F</span></dt><dd><p>
       Flushes all unused multipath device maps. This unresolves the multiple
       paths; it does not delete the devices.
      </p></dd><dt id="id-1.10.6.6.7.6.6.12"><span class="term">multipath -F <em class="replaceable">DEVICENAME</em>
     </span></dt><dd><p>
       Flushes unused multipath device maps for a specified multipath device.
       This unresolves the multiple paths; it does not delete the device.
      </p><p>
       Replace <em class="replaceable">DEVICENAME</em> with the device node name
       such as <code class="filename">/dev/sdb</code> (as shown by
       <code class="command">udev</code> in the $DEVNAME variable), or in the
       <code class="literal">major:minor</code> format. The device may alternatively be a
       multipath map name.
      </p></dd><dt id="id-1.10.6.6.7.6.6.13"><span class="term">multipath -p [ failover | multibus | group_by_serial | group_by_prio | group_by_node_name ]</span></dt><dd><p>
       Sets the group policy by specifying one of the group policy options that
       are described in the following table:
      </p><div class="table" id="id-1.10.6.6.7.6.6.13.2.2" data-id-title="Group Policy Options for the multipath -p Command"><div class="title-container"><div class="table-title-wrap"><div class="table-title"><span class="title-number-name"><span class="title-number">Table 17.3: </span><span class="title-name">Group Policy Options for the multipath -p Command </span></span><a title="Permalink" class="permalink" href="cha-multipath.html#id-1.10.6.6.7.6.6.13.2.2">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div><div class="table-contents"><table style="border-collapse: collapse; border-top: 1px solid ; border-bottom: 1px solid ; border-left: 1px solid ; border-right: 1px solid ; "><colgroup><col class="1"/><col class="2"/></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; ">
           <p>
            Policy Option
           </p>
          </th><th style="border-bottom: 1px solid ; ">
           <p>
            Description
           </p>
          </th></tr></thead><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
           <p>
            failover
           </p>
          </td><td style="border-bottom: 1px solid ; ">
           <p>
            (Default) One path per priority group. You can use only one path at
            a time.
           </p>
          </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
           <p>
            multibus
           </p>
          </td><td style="border-bottom: 1px solid ; ">
           <p>
            All paths in one priority group.
           </p>
          </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
           <p>
            group_by_serial
           </p>
          </td><td style="border-bottom: 1px solid ; ">
           <p>
            One priority group per detected SCSI serial number (the controller
            node worldwide number).
           </p>
          </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
           <p>
            group_by_prio
           </p>
          </td><td style="border-bottom: 1px solid ; ">
           <p>
            One priority group per path priority value. Paths with the same
            priority are in the same priority group. Priorities are determined
            by callout programs specified as a global, per-controller, or
            per-multipath option in the
            <code class="filename">/etc/multipath.conf</code> configuration file.
           </p>
          </td></tr><tr><td style="border-right: 1px solid ; ">
           <p>
            group_by_node_name
           </p>
          </td><td>
           <p>
            One priority group per target node name. Target node names are
            fetched in the<code class="filename">
            /sys/class/fc_transport/target*/node_name</code> location.
           </p>
          </td></tr></tbody></table></div></div></dd><dt id="id-1.10.6.6.7.6.6.14"><span class="term">multipath -t</span></dt><dd><p>
       Shows internal hardware table and active configuration of
       multipath. Refer to <code class="command">man multipath</code> for details
       about the configuration parameters.
      </p></dd></dl></div></section><section class="sect2" id="sec-multipath-mpiotools-mpathpersist" data-id-title="The mpathpersist Utility"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.4.5 </span><span class="title-name">The mpathpersist Utility</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-mpiotools-mpathpersist">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    The <code class="command">mpathpersist</code> utility can be used to manage SCSI
    persistent reservations on Device Mapper Multipath devices. The general
    syntax for the command looks like the following:
   </p><div class="verbatim-wrap"><pre class="screen">mpathpersist [options] [device]</pre></div><p>
    Refer to <code class="command">man 8 mpathpersist</code> for details.
   </p><p>
    Use this utility with the service action reservation key
    (<code class="literal">reservation_key</code> attribute) in the
    <code class="filename">/etc/multipath.conf</code> file to set persistent
    reservations for SCSI devices. The attribute is not used by default. If it
    is not set, the <code class="command">multipathd</code> daemon does not check for
    persistent reservation for newly discovered paths or reinstated paths.
   </p><div class="verbatim-wrap"><pre class="screen">reservation_key &lt;<em class="replaceable">RESERVATION_KEY</em>&gt;</pre></div><p>
    You can add the attribute to the <code class="literal">defaults</code> section or the
    <code class="literal">multipaths</code> section. For example:
   </p><div class="verbatim-wrap"><pre class="screen">multipaths {
  multipath {
    wwid   XXXXXXXXXXXXXXXX
    alias      yellow
    reservation_key  0x123abc
  }
}</pre></div><p>
    Set the <code class="literal">reservation_key</code> parameter for all mpath devices
    applicable for persistent management, then restart the
    <code class="systemitem">multipathd</code> daemon by running the
    following command:
   </p><div class="verbatim-wrap"><pre class="screen">sudo systemctl restart multipathd</pre></div><p>
    After it is set up, you can specify the reservation key in the
    <code class="command">mpathpersist</code> commands.
   </p><div class="sect1 bridgehead"><h2 class="title" id="id-1.10.6.6.7.7.12"><span class="name">Examples</span><a title="Permalink" class="permalink" href="cha-multipath.html#id-1.10.6.6.7.7.12">#</a></h2></div><div class="variablelist"><dl class="variablelist"><dt id="id-1.10.6.6.7.7.13.1"><span class="term">mpathpersist --out --register --param-sark=123abc --prout-type=5 -d /dev/mapper/mpath9</span></dt><dd><p>
       Register the Service Action Reservation Key for the
       <code class="filename">/dev/mapper/mpath9</code> device.
      </p></dd><dt id="id-1.10.6.6.7.7.13.2"><span class="term">mpathpersist -i -k -d /dev/mapper/mpath9</span></dt><dd><p>
       Read the Service Action Reservation Key for the
       <code class="filename">/dev/mapper/mpath9</code> device.
      </p></dd><dt id="id-1.10.6.6.7.7.13.3"><span class="term">mpathpersist --out --reserve --param-sark=123abc --prout-type=8 -d /dev/mapper/mpath9</span></dt><dd><p>
       Reserve the Service Action Reservation Key for the
       <code class="filename">/dev/mapper/mpath9</code> device.
      </p></dd><dt id="id-1.10.6.6.7.7.13.4"><span class="term">mpathpersist -i -s -d /dev/mapper/mpath9</span></dt><dd><p>
       Read the reservation status of the
       <code class="filename">/dev/mapper/mpath9</code> device.
      </p></dd></dl></div></section></section><section class="sect1" id="sec-multipath-config" data-id-title="Configuring the System for Multipathing"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">17.5 </span><span class="title-name">Configuring the System for Multipathing</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-config">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><section class="sect2" id="sec-multipath-configuration-start" data-id-title="Enabling, Disabling, Starting and Stopping Multipath I/O Services"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.5.1 </span><span class="title-name">Enabling, Disabling, Starting and Stopping Multipath I/O Services</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-configuration-start">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    To enable multipath services to start at boot time, run the following
    command:
   </p><div class="verbatim-wrap"><pre class="screen">sudo systemctl enable multipathd</pre></div><p>
    To manually start the service in the running system or to check
    its status, enter one of the following commands:
   </p><div class="verbatim-wrap"><pre class="screen">sudo systemctl start multipathd
sudo systemctl status multipathd</pre></div><p>
    To stop the multipath services in the current session and to disable it, so
    it will not be started the next time the system is booted, run the
    following commands:
   </p><div class="verbatim-wrap"><pre class="screen">sudo systemctl stop multipathd
sudo systemctl disable multipathd</pre></div><div id="ann-multipath-configuration-initrd" data-id-title="Rebuilding the initrd" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg"/><div class="admon-title">Important: Rebuilding the <code class="systemitem">initrd</code></div><p>
     Whenever you enable or disable the multipath services it is also required
     to rebuild the <code class="systemitem">initrd</code>, otherwise the system may
     not boot anymore. When enabling the multipath services, also run the
     following command to rebuild the initrd:
    </p><div class="verbatim-wrap"><pre class="screen">dracut --force --add multipath</pre></div><p>
     When disabling the services, then run the following command to rebuild the
     initrd:
    </p><div class="verbatim-wrap"><pre class="screen">dracut --force -o multipath</pre></div><p>
     Additionally and optionally, if you also want to make sure multipath
     devices do not get set up, even when starting multipath manually,
     add the following lines to the end of
     <code class="filename">/etc/multipath.conf</code> before rebuilding the initrd:
    </p><div class="verbatim-wrap"><pre class="screen">blacklist {
    wwid ".*"
}</pre></div></div></section><section class="sect2" id="sec-multipath-configuration-sandevs" data-id-title="Preparing SAN Devices for Multipathing"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.5.2 </span><span class="title-name">Preparing SAN Devices for Multipathing</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-configuration-sandevs">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    Before configuring multipath I/O for your SAN devices, prepare the SAN
    devices, as necessary, by doing the following:
   </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
      Configure and zone the SAN with the vendor’s tools.
     </p></li><li class="listitem"><p>
      Configure permissions for host LUNs on the storage arrays with the
      vendor’s tools.
     </p></li><li class="listitem"><p>
      Install the Linux HBA driver module. Upon module installation, the driver
      automatically scans the HBA to discover any SAN devices that have
      permissions for the host. It presents them to the host for further
      configuration.
     </p><div id="id-1.10.6.6.8.4.3.3.2" data-id-title="No Native Multipathing" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note: No Native Multipathing</div><p>
       Make sure that the HBA driver you are using does not have native
       multipathing enabled.
      </p></div><p>
      See the vendor’s specific instructions for more details.
     </p></li><li class="listitem"><p>
      After the driver module is loaded, discover the device nodes assigned to
      specific array LUNs or partitions.
     </p></li><li class="listitem"><p>
      If the SAN device will be used as the root device on the server, modify
      the timeout settings for the device as described in
      <a class="xref" href="cha-multipath.html#sec-multipath-best-practice-san-timeout" title="17.14.9. SAN Timeout Settings When the Root Device Is Multipathed">Section 17.14.9, “SAN Timeout Settings When the Root Device Is Multipathed”</a>.
     </p></li></ul></div><p>
    If the LUNs are not seen by the HBA driver, <code class="command">lsscsi </code>can
    be used to check whether the SCSI devices are seen correctly by the
    operating system. When the LUNs are not seen by the HBA driver, check the
    zoning setup of the SAN. In particular, check whether LUN masking is active
    and whether the LUNs are correctly assigned to the server.
   </p><p>
    If the LUNs are seen by the HBA driver, but there are no corresponding
    block devices, additional kernel parameters are needed to change the SCSI
    device scanning behavior, such as to indicate that LUNs are not numbered
    consecutively. For information, see <em class="citetitle">TID 3955167: Troubleshooting
    SCSI (LUN) Scanning Issues</em> in the SUSE Knowledgebase at
    <a class="link" href="https://www.suse.com/support/kb/doc.php?id=3955167" target="_blank">https://www.suse.com/support/kb/doc.php?id=3955167</a>.
   </p></section><section class="sect2" id="sec-multipath-configuration-partitioning" data-id-title="Partitioning Multipath Devices"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.5.3 </span><span class="title-name">Partitioning Multipath Devices</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-configuration-partitioning">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    Partitioning devices that have multiple paths is not recommended, but it is
    supported. You can use the <code class="command">kpartx</code> tool to create
    partitions on multipath devices without rebooting. You can also partition
    the device before you attempt to configure multipathing by using the
    Partitioner function in YaST, or by using a third-party partitioning
    tool.
   </p><p>
    Multipath devices are device-mapper devices. Modifying device-mapper
    devices with command line tools (such as parted, kpartx, or fdisk) works,
    but it does not necessarily generate the udev events that are required to
    update other layers. After you partition the device-mapper device, you
    should check the multipath map to make sure the device-mapper devices were
    mapped. If they are missing, you can remap the multipath devices or reboot
    the server to pick up all of the new partitions in the multipath map.
   </p><p>
    The device-mapper device for a partition on a multipath device is not the
    same as an independent device. When you create an LVM logical volume using
    the whole device, you must specify a device that contains no partitions. If
    you specify a multipath partition as the target device for the LVM logical
    volume, LVM recognizes that the underlying physical device is partitioned
    and the create fails. If you need to subdivide a SAN device, you can carve
    LUNs on the SAN device and present each LUN as a separate multipath device
    to the server.
   </p></section></section><section class="sect1" id="sec-multipath-conf-file" data-id-title="Creating or Modifying the /etc/multipath.conf File"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">17.6 </span><span class="title-name">Creating or Modifying the /etc/multipath.conf File</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-conf-file">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   The <code class="filename">/etc/multipath.conf</code> file does not exist unless you
   create it. Default multipath device settings are applied automatically when
   the <code class="command">multipathd</code> daemon runs unless you create the
   multipath configuration file and personalize the settings.
  </p><div id="id-1.10.6.6.9.3" data-id-title="Testing and Permanently Applying Changes from /etc/multipath.conf" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg"/><div class="admon-title">Important: 
    Testing and Permanently Applying Changes from
    <code class="filename">/etc/multipath.conf</code>
   </div><p>
    Whenever you create or modify the <code class="filename">/etc/multipath.conf</code>
    file, the changes are not automatically applied when you save the
    file. This allows you to perform a dry run to verify your changes
    before they are committed. When you are satisfied with the revised
    settings, you can update the multipath maps as described in <a class="xref" href="cha-multipath.html#sec-multipath-conf-file-apply" title="17.6.4. Applying the /etc/multipath.conf File Changes to Update the Multipath Maps">Section 17.6.4, “Applying the /etc/multipath.conf File Changes to Update the Multipath Maps”</a>.
   </p></div><section class="sect2" id="sec-multipath-conf-file-create" data-id-title="Creating the /etc/multipath.conf File"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.6.1 </span><span class="title-name">Creating the /etc/multipath.conf File</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-conf-file-create">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
      Create an empty <code class="filename">/etc/multipath.conf</code> file with an
      editor of your choice.
     </p></li><li class="step"><p>
      Make sure to add an appropriate <code class="literal">device</code> section for
      your SAN. Most vendors provide documentation on the proper setup of the
      <code class="command">device</code> section. Note that different SANs require
      individual <code class="literal">device</code> sections.
     </p><p>
      If you are using a storage subsystem that is automatically detected (see
      <a class="xref" href="cha-multipath.html#sec-multipath-hardware-autodetect" title="17.2.1. Storage Arrays That Are Automatically Detected for Multipathing">Section 17.2.1, “Storage Arrays That Are Automatically Detected for Multipathing”</a>), adding a <code class="literal">device</code> is not
      required—the default settings for this device will be applied in
      this case.
     </p></li><li class="step"><p>
      Create a <code class="literal">blacklist</code> section containing all
      non-multipath devices of your machine. Refer to <a class="xref" href="cha-multipath.html#sec-multipath-blacklist" title="17.8. Blacklisting Non-Multipath Devices">Section 17.8, “Blacklisting Non-Multipath Devices”</a> for details.
     </p></li><li class="step"><p>
      If required, add more sections to the configuration file. Refer to <a class="xref" href="cha-multipath.html#sec-multipath-conf-file-sections" title="17.6.2. Sections in the /etc/multipath.conf File">Section 17.6.2, “Sections in the <code class="filename">/etc/multipath.conf</code> File”</a> for a brief
      introduction. More details are available when running <code class="command">man 5
      multipath.conf</code>.
     </p></li><li class="step"><p>
      When finished, save <code class="filename">/etc/multipath.conf</code> and test
      your settings as described in <a class="xref" href="cha-multipath.html#sec-multipath-conf-file-verify" title="17.6.3. Verifying the Multipath Setup in the /etc/multipath.conf File">Section 17.6.3, “Verifying the Multipath Setup in the /etc/multipath.conf File”</a>.
     </p></li><li class="step"><p>
      When you have successfully verified the configuration, apply it as
      described in <a class="xref" href="cha-multipath.html#sec-multipath-conf-file-apply" title="17.6.4. Applying the /etc/multipath.conf File Changes to Update the Multipath Maps">Section 17.6.4, “Applying the /etc/multipath.conf File Changes to Update the Multipath Maps”</a>.
     </p></li></ol></div></div></section><section class="sect2" id="sec-multipath-conf-file-sections" data-id-title="Sections in the /etc/multipath.conf File"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.6.2 </span><span class="title-name">Sections in the <code class="filename">/etc/multipath.conf</code> File</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-conf-file-sections">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    The <code class="filename">/etc/multipath.conf</code> file is organized into the
    following sections. See <code class="command">man 5 multipath.conf</code> for
    details.
   </p><div class="variablelist"><dl class="variablelist"><dt id="id-1.10.6.6.9.5.3.1"><span class="term">defaults</span></dt><dd><p>
       General default settings for multipath I/0. These values are used if no
       values are given in the appropriate device or multipath sections. For
       information, see
       <a class="xref" href="cha-multipath.html#sec-multipath-policies-default" title="17.7. Configuring Default Policies for Polling, Queuing, and Failback">Section 17.7, “Configuring Default Policies for Polling, Queuing, and Failback”</a>.
      </p></dd><dt id="id-1.10.6.6.9.5.3.2"><span class="term">blacklist</span></dt><dd><p>
       Lists the device names to discard as not multipath candidates. Devices
       can be identified by their device node name
       (<code class="literal">devnode</code>), their WWID (<code class="literal">wwid</code>), or
       their vendor or product strings (<code class="literal">device</code>). You
       can typically ignore non-multipathed devices, such as
       <code class="literal">hpsa</code>, <code class="literal">fd</code>, <code class="literal">hd</code>,
       <code class="literal">md</code>, <code class="literal">dm</code>, <code class="literal">sr</code>,
       <code class="literal">scd</code>, <code class="literal">st</code>, <code class="literal">ram</code>,
       <code class="literal">raw</code>, and <code class="literal">loop</code>.
       For more information and examples, see
       <a class="xref" href="cha-multipath.html#sec-multipath-blacklist" title="17.8. Blacklisting Non-Multipath Devices">Section 17.8, “Blacklisting Non-Multipath Devices”</a>.
      </p></dd><dt id="id-1.10.6.6.9.5.3.3"><span class="term">blacklist_exceptions</span></dt><dd><p>
       Lists the device names of devices to be treated as multipath candidates
       even if they are on the blacklist. Devices can be identified by their
       device node name (<code class="literal">devnode</code>), their WWID
       (<code class="literal">wwid</code>), or their vendor or product strings
       (<code class="literal">device</code>). You must specify the excepted devices by
       using the same keyword that you used in the blacklist. For example, if
       you used the <code class="literal">devnode</code> keyword for devices in the
       blacklist, you use the <code class="literal">devnode</code> keyword to exclude
       some devices in the blacklist exceptions. It is not possible to
       blacklist devices by using the <code class="literal">devnode</code> keyword and to
       exclude some of them by using the <code class="literal">wwid</code> keyword. For
       more information and examples, see
       <a class="xref" href="cha-multipath.html#sec-multipath-blacklist" title="17.8. Blacklisting Non-Multipath Devices">Section 17.8, “Blacklisting Non-Multipath Devices”</a>.
      </p></dd><dt id="id-1.10.6.6.9.5.3.4"><span class="term">multipaths</span></dt><dd><p>
       Specifies settings for individual multipath devices. Except for settings
       that do not support individual settings, these values overwrite what is
       specified in the <code class="literal">defaults</code> and
       <code class="literal">devices</code> sections of the configuration file.
      </p></dd><dt id="id-1.10.6.6.9.5.3.5"><span class="term">devices</span></dt><dd><p>
       Specifies settings for individual storage controllers. These values
       overwrite values specified in the <code class="filename">defaults</code> section
       of the configuration file. If you use a storage array that is not
       supported by default, you can create a <code class="literal">devices</code>
       subsection to specify the default settings for it. These values can be
       overwritten by settings for individual multipath devices if the keyword
       allows it.
      </p><p>
       For information, see the following:
      </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
         <a class="xref" href="cha-multipath.html#sec-multipath-names" title="17.9. Configuring User-Friendly Names or Alias Names">Section 17.9, “Configuring User-Friendly Names or Alias Names”</a>
        </p></li><li class="listitem"><p>
         <a class="xref" href="cha-multipath.html#sec-multipath-best-practice-zseries" title="17.14.6. Configuring Default Settings for IBM IBM Z Devices">Section 17.14.6, “Configuring Default Settings for IBM IBM Z Devices”</a>
        </p></li></ul></div></dd></dl></div></section><section class="sect2" id="sec-multipath-conf-file-verify" data-id-title="Verifying the Multipath Setup in the /etc/multipath.conf File"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.6.3 </span><span class="title-name">Verifying the Multipath Setup in the /etc/multipath.conf File</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-conf-file-verify">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    Whenever you create or modify the <code class="filename">/etc/multipath.conf</code>
    file, the changes are not automatically applied when you save the file. You
    can perform a <span class="quote">“<span class="quote">dry run</span>”</span> of the setup to verify the multipath
    setup before you update the multipath maps.
   </p><p>
    At the server command prompt, enter
   </p><div class="verbatim-wrap"><pre class="screen">sudo multipath -v2 -d</pre></div><p>
    This command scans the devices, then displays what the setup would look
    like if you commit the changes. It is assumed that the
    <code class="systemitem">multipathd</code> daemon is already
    running with the old (or default) multipath settings when you modify the
    <code class="filename">/etc/multipath.conf</code> file and perform the dry run. If
    the changes are acceptable, continue with the next step.
   </p><p>
    The output is similar to the following:
   </p><div class="verbatim-wrap"><pre class="screen">26353900f02796769
[size=127 GB]
[features="0"]
[hwhandler="1    emc"]

\_ round-robin 0 [first]
  \_ 1:0:1:2 sdav 66:240  [ready ]
  \_ 0:0:1:2 sdr  65:16   [ready ]

\_ round-robin 0
  \_ 1:0:0:2 sdag 66:0    [ready ]
  \_ 0:0:0:2 sdc   8:32   [ready ]</pre></div><p>
    Paths are grouped into priority groups. Only one priority group is in
    active use at a time. To model an active/active configuration, all paths
    end in the same group. To model an active/passive configuration, the paths
    that should not be active in parallel are placed in several distinct
    priority groups. This normally happens automatically on device discovery.
   </p><p>
    The output shows the order, the scheduling policy used to balance I/O
    within the group, and the paths for each priority group. For each path, its
    physical address (host:bus:target:lun), device node name, major:minor
    number, and state is shown.
   </p><p>
    By using a verbosity level of -v3 in the dry run, you can see all detected
    paths, multipaths, and device maps. Both WWID and device node blacklisted
    devices are displayed.
   </p><p>
    The following is an example of -v3 output on a 64-bit SLES 11 SP2 server
    with two Qlogic HBAs connected to a Xiotech Magnitude 3000 SAN. Some
    multiple entries have been omitted to shorten the example.
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>sudo multipath -v3 d
dm-22: device node name blacklisted
&lt; content omitted &gt;
loop7: device node name blacklisted
&lt; content omitted &gt;
md0: device node name blacklisted
&lt; content omitted &gt;
dm-0: device node name blacklisted
sdf: not found in pathvec
sdf: mask = 0x1f
sdf: dev_t = 8:80
sdf: size = 105005056
sdf: subsystem = scsi
sdf: vendor = XIOtech
sdf: product = Magnitude 3D
sdf: rev = 3.00
sdf: h:b:t:l = 1:0:0:2
sdf: tgt_node_name = 0x202100d0b2028da
sdf: serial = 000028DA0014
sdf: getuid= "/lib/udev/scsi_id --whitelisted --device=/dev/%n" (config file default)
sdf: uid = 200d0b2da28001400 (callout)
sdf: prio = const (config file default)
sdf: const prio = 1
[...]
ram15: device node name blacklisted
[...]
===== paths list =====
uuid              hcil    dev dev_t pri dm_st  chk_st  vend/prod/rev
200d0b2da28001400 1:0:0:2 sdf 8:80  1   [undef][undef] XIOtech,Magnitude 3D
200d0b2da28005400 1:0:0:1 sde 8:64  1   [undef][undef] XIOtech,Magnitude 3D
200d0b2da28004d00 1:0:0:0 sdd 8:48  1   [undef][undef] XIOtech,Magnitude 3D
200d0b2da28001400 0:0:0:2 sdc 8:32  1   [undef][undef] XIOtech,Magnitude 3D
200d0b2da28005400 0:0:0:1 sdb 8:16  1   [undef][undef] XIOtech,Magnitude 3D
200d0b2da28004d00 0:0:0:0 sda 8:0   1   [undef][undef] XIOtech,Magnitude 3D
params = 0 0 2 1 round-robin 0 1 1 8:80 1000 round-robin 0 1 1 8:32 1000
status = 2 0 0 0 2 1 A 0 1 0 8:80 A 0 E 0 1 0 8:32 A 0
sdf: mask = 0x4
sdf: path checker = directio (config file default)
directio: starting new request
directio: async io getevents returns 1 (errno=Success)
directio: io finished 4096/0
sdf: state = 2
[...]</pre></div></section><section class="sect2" id="sec-multipath-conf-file-apply" data-id-title="Applying the /etc/multipath.conf File Changes to Update the Multipath Maps"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.6.4 </span><span class="title-name">Applying the /etc/multipath.conf File Changes to Update the Multipath Maps</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-conf-file-apply">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    Changes to the <code class="filename">/etc/multipath.conf</code> file cannot take
    effect when <code class="command">multipathd</code> is running. After you make
    changes, save and close the file, then run the following commands 
    to apply the changes and update the multipath maps:
   </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
      Apply your configuration changes:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> multipathd reconfigure</pre></div></li><li class="step"><p>
      Run <code class="command">dracut -f</code> to re-create the
      <code class="filename">initrd</code> image on your system, then reboot for the
      changes to take effect.
     </p></li></ol></div></div></section><section class="sect2" id="sec-multipath-conf-file-wwid" data-id-title="Generating a WWID"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.6.5 </span><span class="title-name">Generating a WWID</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-conf-file-wwid">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    To identify a device over different paths, multipath uses a World Wide
    Identification (WWID) for each device. If the WWID is the same for two
    device paths, they are assumed to represent the same device.  We recommend
    not changing the method of WWID generation, unless there is a compelling
    reason to do so. For more details, see <code class="command">man
    multipath.conf</code>.
   </p></section></section><section class="sect1" id="sec-multipath-policies-default" data-id-title="Configuring Default Policies for Polling, Queuing, and Failback"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">17.7 </span><span class="title-name">Configuring Default Policies for Polling, Queuing, and Failback</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-policies-default">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   The goal of multipath I/O is to provide connectivity fault tolerance between
   the storage system and the server. The desired default behavior depends on
   whether the server is a stand-alone server or a node in a high-availability
   cluster.
  </p><p>
   When you configure multipath I/O for a stand-alone server, the
   <code class="literal">no_path_retry</code> setting protects the server operating
   system from receiving I/O errors as long as possible. It queues messages
   until a multipath failover occurs and provides a healthy connection.
  </p><p>
   When you configure multipath I/O for a node in a high-availability cluster,
   you want multipath to report the I/O failure to trigger the resource
   failover instead of waiting for a multipath failover to be resolved. In
   cluster environments, you must modify the <code class="literal">no_path_retry
   </code>setting so that the cluster node receives an I/O error in relation
   to the cluster verification process (recommended to be 50% of the heartbeat
   tolerance) if the connection is lost to the storage system. In addition, you
   want the multipath I/O fallback to be set to manual to avoid a ping-pong of
   resources because of path failures.
  </p><p>
   The <code class="filename">/etc/multipath.conf</code> file should contain a
   <code class="command">defaults</code> section where you can specify default behaviors
   for polling, queuing, and failback. If the field is not otherwise specified
   in a <code class="command">device</code> section, the default setting is applied for
   that SAN configuration.
  </p><p>
   The following are the compiled default settings. They will be used unless
   you overwrite these values by creating and configuring a personalized
   <code class="filename">/etc/multipath.conf</code> file.
  </p><div class="verbatim-wrap"><pre class="screen">defaults {
  verbosity 2
#  udev_dir is deprecated in SLES 11 SP3
#  udev_dir              /dev
  polling_interval      5
#  path_selector default value is service-time in SLES 11 SP3
#  path_selector         "round-robin 0"
  path selector         "service-time 0"
  path_grouping_policy  failover
#  getuid_callout is deprecated in SLES 11 SP3 and replaced with uid_attribute
#  getuid_callout        "/lib/udev/scsi_id --whitelisted --device=/dev/%n"
#  uid_attribute is new in SLES 11 SP3
  uid_attribute         "ID_SERIAL"
  prio                  "const"
  prio_args             ""
  features              "0"
  path_checker          "tur"
  alias_prefix          "mpath"
  rr_min_io_rq          1
  max_fds               "max"
  rr_weight             "uniform"
  queue_without_daemon  "yes"
  flush_on_last_del     "no"
  user_friendly_names   "no"
  fast_io_fail_tmo      5
  bindings_file         "/etc/multipath/bindings"
  wwids_file            "/etc/multipath/wwids"
  log_checker_err       "always"

  retain_attached_hw_handler  "no"
  detect_prio           "no"
  failback              "manual"
  no_path_retry         "fail"
  }</pre></div><p>
   For information about setting the polling, queuing, and failback policies,
   see the following parameters in
   <a class="xref" href="cha-multipath.html#sec-multipath-policies-failover" title="17.10. Configuring Path Failover Policies and Priorities">Section 17.10, “Configuring Path Failover Policies and Priorities”</a>:
  </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
     <a class="xref" href="cha-multipath.html#polling-interval"><code class="literal">polling_interval</code>
      </a>
    </p></li><li class="listitem"><p>
     <a class="xref" href="cha-multipath.html#no-path-retry"><code class="literal">no_path_retry</code>
      </a>
    </p></li><li class="listitem"><p>
     <a class="xref" href="cha-multipath.html#failback"><code class="literal">failback</code>
      </a>
    </p></li></ul></div><p>
   After you have modified the <code class="filename">/etc/multipath.conf</code> file,
   you must run <code class="command">dracut</code> <code class="option">-f</code> to re-create the
   <code class="filename">initrd</code> on your system, then restart the server for the
   changes to take effect. See <a class="xref" href="cha-multipath.html#sec-multipath-conf-file-apply" title="17.6.4. Applying the /etc/multipath.conf File Changes to Update the Multipath Maps">Section 17.6.4, “Applying the /etc/multipath.conf File Changes to Update the Multipath Maps”</a>
   for details.
  </p></section><section class="sect1" id="sec-multipath-blacklist" data-id-title="Blacklisting Non-Multipath Devices"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">17.8 </span><span class="title-name">Blacklisting Non-Multipath Devices</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-blacklist">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   The <code class="filename">/etc/multipath.conf</code> file can contain a
   <code class="command">blacklist</code> section where all non-multipath devices are
   listed. You can blacklist devices by WWID (<code class="literal">wwid</code> keyword),
   device name (<code class="literal">devnode</code> keyword), or device type
   (<code class="literal">device</code> section). You can also use the
   <code class="literal">blacklist_exceptions</code> section to enable multipath for some
   devices that are blacklisted by the regular expressions used in the
   <code class="literal">blacklist</code> section.
  </p><div id="id-1.10.6.6.11.3" data-id-title="Preferred Blacklisting Methods" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note: 
    Preferred Blacklisting Methods
   </div><p>
    The preferred method for blacklisting devices is by <span class="emphasis"><em>WWID</em></span>
    or by <span class="emphasis"><em>vendor and product</em></span>. Blacklisting by
    <span class="emphasis"><em>devnode</em></span> is not recommended, because device nodes
    can change and thus are not useful for persistent device identification.
   </p></div><div id="id-1.10.6.6.11.4" data-id-title="Regular Expressions in multipath.conf" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.svg"/><div class="admon-title">Warning: Regular Expressions in multipath.conf</div><p>Regular expressions in the <code class="filename">/etc/multipath.conf</code> do
    <span class="emphasis"><em>not</em></span> work in general. They only work if they are
    matched against common strings. However, the standard configuration
    of multipath already contains regular expressions for many devices
    and vendors. Matching regular expressions with other regular
    expressions does not work. Make sure that you are only matching
    against strings shown with <code class="command">multipath -t</code>.
   </p></div><p>
   You can typically ignore non-multipathed devices, such as
   <code class="literal">hpsa</code>, <code class="literal">fd</code>, <code class="literal">hd</code>,
   <code class="literal">md</code>, <code class="literal">dm</code>, <code class="literal">sr</code>,
   <code class="literal">scd</code>, <code class="literal">st</code>, <code class="literal">ram</code>,
   <code class="literal">raw</code>, and <code class="literal">loop</code>.
   For example, local SATA hard disks and flash
   disks do not have multiple paths. If you want
   <code class="command">multipath</code> to ignore single-path devices, put them in the
   <code class="command">blacklist</code> section.
  </p><div id="id-1.10.6.6.11.6" data-id-title="Compatibility" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note: Compatibility</div><p>
    The keyword <code class="literal">devnode_blacklist</code> has been deprecated and
    replaced with the keyword <code class="literal">blacklist</code>.
   </p><p>
    With SUSE Linux Enterprise Server 12 the glibc-provided regular expressions are used. To match an
    arbitrary string, you must now use <code class="literal">".*"</code> rather than
    <code class="literal">"*"</code>.
   </p></div><p>
   For example, to blacklist local devices and all arrays from the
   <code class="filename">hpsa</code> driver from being managed by multipath, the
   <code class="command">blacklist</code> section looks like this:
  </p><div class="verbatim-wrap"><pre class="screen">blacklist {
      wwid "26353900f02796769"
      devnode "^(ram|raw|loop|fd|md|dm-|sr|scd|st)[0-9]*"
      devnode "^sd[a-z][0-9]*"
}</pre></div><p>
   You can also blacklist only the partitions from a driver instead of the
   entire array. For example, you can use the following regular expression to
   blacklist only partitions from the cciss driver and not the entire array:
  </p><div class="verbatim-wrap"><pre class="screen">blacklist {
      devnode "^cciss!c[0-9]d[0-9]*[p[0-9]*]"
}</pre></div><p>
   You can blacklist by specific device types by adding a
   <code class="literal">device</code> section in the blacklist, and using the
   <code class="literal">vendor</code> and <code class="literal">product</code> keywords.
  </p><div class="verbatim-wrap"><pre class="screen">blacklist {
      device {
           vendor  "DELL"
           product ".*"
       }
}</pre></div><p>
   You can use a <code class="literal">blacklist_exceptions</code> section to enable
   multipath for some devices that were blacklisted by the regular expressions
   used in the <code class="literal">blacklist</code> section. You add exceptions by WWID
   (<code class="literal">wwid</code> keyword), device name (<code class="literal">devnode</code>
   keyword), or device type (<code class="literal">device</code> section). You must
   specify the exceptions in the same way that you blacklisted the
   corresponding devices. That is, <code class="literal">wwid</code> exceptions apply to
   a <code class="literal">wwid</code> blacklist, <code class="literal">devnode</code> exceptions
   apply to a <code class="literal">devnode</code> blacklist, and device type exceptions
   apply to a device type blacklist.
  </p><p>
   For example, you can enable multipath for a desired device type when you
   have different device types from the same vendor. Blacklist all of the
   vendor’s device types in the <code class="literal">blacklist</code> section, and
   then enable multipath for the desired device type by adding a
   <code class="literal">device</code> section in a
   <code class="literal">blacklist_exceptions</code> section.
  </p><div class="verbatim-wrap"><pre class="screen">blacklist {
      devnode "^(ram|raw|loop|fd|md|dm-|sr|scd|st|sda)[0-9]*"
      device {
           vendor  "DELL"
           product ".*"
       }
}

blacklist_exceptions {
      device {
           vendor  "DELL"
           product "MD3220i"
       }
}</pre></div><p>
   You can also use the blacklist_exceptions to enable multipath only for
   specific devices. For example:
  </p><div class="verbatim-wrap"><pre class="screen">blacklist {
      wwid ".*"
}

blacklist_exceptions {
        wwid "3600d0230000000000e13955cc3751234"
        wwid "3600d0230000000000e13955cc3751235"
}</pre></div><p>
   After you have modified the <code class="filename">/etc/multipath.conf</code> file,
   you must run <code class="command">dracut</code> <code class="option">-f</code> to re-create the
   <code class="filename">initrd</code> on your system, then restart the server for the
   changes to take effect. See <a class="xref" href="cha-multipath.html#sec-multipath-conf-file-apply" title="17.6.4. Applying the /etc/multipath.conf File Changes to Update the Multipath Maps">Section 17.6.4, “Applying the /etc/multipath.conf File Changes to Update the Multipath Maps”</a>
   for details.
  </p><p>
   Following the reboot, the local devices should no longer be listed in the
   multipath maps when you issue the <code class="command">multipath -ll</code> command.
  </p><div id="id-1.10.6.6.11.20" data-id-title="Using the find_multipaths Option" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note: Using the <code class="literal">find_multipaths</code> Option</div><p>
    Starting with <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span> 12 SP2, the multipath tools support the option
    <code class="literal">find_multipaths</code> in the <code class="literal">defaults</code>
    section of <code class="filename">/etc/multipath.conf</code>. Simply put, this
    option prevents multipath and <code class="systemitem">multipathd</code> from setting up multipath maps for
    devices with only a single path (see the <code class="command">man 5
    multipath.conf</code> for details). In certain configurations, this may
    save the administrator from the effort of creating blacklist entries, for
    example for local SATA disks.
   </p><p>
    Convenient as it seems at first, using the
    <code class="literal">find_multipaths</code> option also has disadvantages. It
    complicates and slows down the system boot, because for every device found,
    the boot logic needs to wait until all devices have been discovered to see
    whether a second path exists for the device. Additionally, problems can
    arise when some paths are down or otherwise invisible at boot time—a
    device can be falsely detected as a single-path device and activated,
    causing later addition of more paths to fail.
   </p><p>
    <code class="literal">find_multipaths</code> considers all devices that are listed in
    <code class="filename">/etc/multipath/wwids</code> with matching WWIDs as being
    multipath devices. This is important when
    <code class="literal">find_multipaths</code> is first activated: Unless
    <code class="filename">/etc/multipath/wwids</code> is deleted or edited, activating
    this option has no effect, because all previously existing multipath maps
    (including single-path ones) are listed in the wwids file. On SAN-boot
    systems with a multipathed root file system, make sure to keep
    <code class="filename">/etc/multipath/wwids</code> synchronized between the initial
    RAM disk and the file system.
   </p><p>
    In Summary, using <code class="literal">find_multipaths</code> may be convenient in
    certain use cases, but SUSE still recommends the default configuration
    with a properly configured blacklist and blacklist exceptions.
   </p></div></section><section class="sect1" id="sec-multipath-names" data-id-title="Configuring User-Friendly Names or Alias Names"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">17.9 </span><span class="title-name">Configuring User-Friendly Names or Alias Names</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-names">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   A multipath device can be identified by its WWID, by a user-friendly name,
   or by an alias that you assign for it. Device node names in the form of
   <code class="filename">/dev/sdn</code> and <code class="filename">/dev/dm-n</code> can change
   on reboot and might be assigned to different devices each time. A device’s
   WWID, user-friendly name, and alias name persist across reboots, and are the
   preferred way to identify the device.
  </p><div id="id-1.10.6.6.12.3" data-id-title="Using Persistent Names is Recommended" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg"/><div class="admon-title">Important: Using Persistent Names is Recommended</div><p>
    Because device node names in the form of <code class="filename">/dev/sdn</code> and
    <code class="filename">/dev/dm-n</code> can change on reboot, referring to multipath
    devices by their WWID is preferred. You can also use a user-friendly name
    or alias that is mapped to the WWID to identify the device uniquely across
    reboots.
   </p></div><p>
   The following table describes the types of device names that can be used for
   a device in the <code class="filename">/etc/multipath.conf</code> file. For an
   example of <code class="filename">multipath.conf</code> settings, see the
   <code class="filename">/usr/share/doc/packages/multipath-tools/multipath.conf.synthetic</code>
   file.
  </p><div class="table" id="id-1.10.6.6.12.5" data-id-title="Comparison of Multipath Device Name Types"><div class="title-container"><div class="table-title-wrap"><div class="table-title"><span class="title-number-name"><span class="title-number">Table 17.4: </span><span class="title-name">Comparison of Multipath Device Name Types </span></span><a title="Permalink" class="permalink" href="cha-multipath.html#id-1.10.6.6.12.5">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div><div class="table-contents"><table style="border-collapse: collapse; border-top: 1px solid ; border-bottom: 1px solid ; border-left: 1px solid ; border-right: 1px solid ; "><colgroup><col class="1"/><col class="2"/></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; ">
       <p>
        Name Types
       </p>
      </th><th style="border-bottom: 1px solid ; ">
       <p>
        Description
       </p>
      </th></tr></thead><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
       <p>
        WWID (default)
       </p>
      </td><td style="border-bottom: 1px solid ; ">
       <p>
        The serial WWID (Worldwide Identifier) is an identifier for the
        multipath device that is guaranteed to be globally unique and
        unchanging. The default name used in multipathing is the ID of the
        logical unit as found in the <code class="filename">/dev/disk/by-id</code>
        directory. For example, a device with the WWID of
        <code class="literal">3600508e0000000009e6baa6f609e7908</code> is listed as
        <code class="filename">/dev/disk/by-id/scsi-3600508e0000000009e6baa6f609e7908</code>.
       </p>
      </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
       <p>
        User-friendly
       </p>
      </td><td style="border-bottom: 1px solid ; ">
       <p>
        The Device Mapper Multipath device names in the
        <code class="filename">/dev/mapper</code> directory also reference the ID of the
        logical unit. These multipath device names are user-friendly names in
        the form of
        <code class="filename">/dev/mapper/mpath<em class="replaceable">N</em></code>,
        such as <code class="filename">/dev/mapper/mpath0</code>. The names are unique
        and persistent because they use the
        <code class="filename">/var/lib/multipath/bindings</code> file to track the
        association between the UUID and user-friendly names.
       </p>
      </td></tr><tr><td style="border-right: 1px solid ; ">
       <p>
        Alias
       </p>
      </td><td>
       <p>
        An alias name is a globally unique name that the administrator provides
        for a multipath device. Alias names override the WWID and the
        user-friendly
        <code class="filename">/dev/mapper/mpath<em class="replaceable">N</em></code>
        names.
       </p>
       <p>
        If you are using user_friendly_names, do not set the alias to
        mpath<em class="replaceable">N</em> format. This may conflict with an
        automatically assigned user-friendly name, and give you incorrect
        device node names.
       </p>
      </td></tr></tbody></table></div></div><p>
   The global multipath <code class="literal">user_friendly_names</code> option in the
   <code class="filename">/etc/multipath.conf</code> file is used to enable or disable
   the use of user-friendly names for multipath devices. If it is set to
   <code class="literal">no</code> (the default), multipath uses the WWID as the name of
   the device. If it is set to <code class="literal">yes</code>, multipath uses the
   <code class="filename">/var/lib/multipath/bindings</code> file to assign a persistent
   and unique name to the device in the form of
   <code class="filename">mpath&lt;<em class="replaceable">N</em>&gt;</code> in the
   <code class="filename">/dev/mapper </code>directory. The <code class="literal">bindings
   file</code> option in the <code class="literal">/etc/multipath.conf</code> file can
   be used to specify an alternate location for the
   <code class="filename">bindings</code> file.
  </p><p>
   The global multipath <code class="literal">alias</code> option in the
   <code class="filename">/etc/multipath.conf</code> file is used to explicitly assign a
   name to the device. If an alias name is set up for a multipath device, the
   alias is used instead of the WWID or the user-friendly name.
  </p><p>
   Using the <code class="literal">user_friendly_names</code> option can be problematic
   in the following situations:
  </p><div class="variablelist"><dl class="variablelist"><dt id="id-1.10.6.6.12.9.1"><span class="term">Root Device Is Using Multipath:</span></dt><dd><p>
      If the system root device is using multipath and you use the
      <code class="literal">user_friendly_names</code> option, the user-friendly settings
      in the <code class="filename">/var/lib/multipath/bindings</code> file are included
      in the <code class="filename">initrd</code>. If you later change the storage
      setup, such as by adding or removing devices, there is a mismatch between
      the bindings setting inside the <code class="filename">initrd</code> and the
      bindings settings in <code class="filename">/var/lib/multipath/bindings</code>.
     </p><div id="id-1.10.6.6.12.9.1.2.2" data-id-title="Binding Mismatches" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.svg"/><div class="admon-title">Warning: Binding Mismatches</div><p>
       A bindings mismatch between <code class="filename">initrd</code> and
       <code class="filename">/var/lib/multipath/bindings</code> can lead to a wrong
       assignment of mount points to devices, which can result in file system
       corruption and data loss.
      </p></div><p>
      To avoid this problem, we recommend that you use the default WWID
      settings for the system root device. You should not use aliases for the
      system root device. Because the device name would differ, using an alias
      causes you to lose the ability to seamlessly switch off multipathing via
      the kernel command line.
     </p></dd><dt id="id-1.10.6.6.12.9.2"><span class="term">Mounting /var from Another Partition:</span></dt><dd><p>
      The default location of the <code class="literal">user_friendly_names</code>
      configuration file is <code class="filename">/var/lib/multipath/bindings</code>.
      If the <code class="filename">/var</code> data is not located on the system root
      device but mounted from another partition, the
      <code class="filename">bindings</code> file is not available when setting up
      multipathing.
     </p><p>
      Make sure that the <code class="filename">/var/lib/multipath/bindings</code> file
      is available on the system root device and multipath can find it. For
      example, this can be done as follows:
     </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
        Move the <code class="filename">/var/lib/multipath/bindings</code> file to
        <code class="filename">/etc/multipath/bindings</code>.
       </p></li><li class="listitem"><p>
        Set the <code class="literal">bindings_file</code> option in the
        <code class="literal">defaults</code> section of
        /<code class="filename">etc/multipath.conf</code> to this new location. For
        example:
       </p><div class="verbatim-wrap"><pre class="screen">defaults {
               user_friendly_names yes
               bindings_file "/etc/multipath/bindings"
}</pre></div></li></ol></div></dd><dt id="id-1.10.6.6.12.9.3"><span class="term">Multipath Is in the initrd:</span></dt><dd><p>
      Even if the system root device is not on multipath, it is possible for
      multipath to be included in the <code class="filename">initrd</code>. For example,
      this can happen if the system root device is on LVM. If you use the
      <code class="literal">user_friendly_names</code> option and multipath is in the
      <code class="filename">initrd</code>, you should boot with the parameter
      <code class="command">multipath=off</code> to avoid problems.
     </p><p>
      This disables multipath only in the <code class="filename">initrd</code> during
      system boots. After the system boots, the
      <code class="filename">boot.multipath</code> and <code class="filename">multipathd</code>
      boot scripts can activate multipathing.
     </p></dd><dt id="id-1.10.6.6.12.9.4"><span class="term">Multipathing in HA Clusters:</span></dt><dd><p>
      See <a class="xref" href="cha-multipath.html#sec-multipath-names-ha" title="17.9.1. Multipath Device Names in HA Clusters">Section 17.9.1, “Multipath Device Names in HA Clusters”</a> for details.
     </p></dd></dl></div><p>
   To enable user-friendly names or to specify aliases:
  </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
     Open the <code class="filename">/etc/multipath.conf</code> file in a text editor
     with <code class="systemitem">root</code> privileges.
    </p></li><li class="step"><p>
     (Optional) Modify the location of the
     <code class="filename">/var/lib/multipath/bindings</code> file.
    </p><p>
     The alternate path must be available on the system root device where
     multipath can find it.
    </p><ol type="a" class="substeps"><li class="step"><p>
       Move the <code class="filename">/var/lib/multipath/bindings</code> file to
       <code class="filename">/etc/multipath/bindings</code>.
      </p></li><li class="step"><p>
       Set the <code class="literal">bindings_file</code> option in the
       <code class="literal">defaults</code> section of
       /<code class="filename">etc/multipath.conf</code> to this new location. For
       example:
      </p><div class="verbatim-wrap"><pre class="screen">defaults {
          user_friendly_names yes
          bindings_file "/etc/multipath/bindings"
}</pre></div></li></ol></li><li class="step"><p>
     (Optional, not recommended) Enable user-friendly names:
    </p><ol type="a" class="substeps"><li class="step"><p>
       Uncomment the <code class="literal">defaults</code> section and its ending
       bracket.
      </p></li><li class="step"><p>
       Uncomment the <code class="literal">user_friendly_names option</code>, then change
       its value from No to Yes.
      </p><p>
       For example:
      </p><div class="verbatim-wrap"><pre class="screen">## Use user-friendly names, instead of using WWIDs as names.
defaults {
  user_friendly_names yes
}</pre></div></li></ol></li><li class="step"><p>
     (Optional) Specify your own names for devices by using the
     <code class="command">alias</code> option in the <code class="command">multipath</code>
     section.
    </p><p>
     For example:
    </p><div class="verbatim-wrap"><pre class="screen">## Use alias names, instead of using WWIDs as names.
multipaths {
       multipath {
               wwid           36006048000028350131253594d303030
               alias             blue1
       }
       multipath {
               wwid           36006048000028350131253594d303041
               alias             blue2
       }
       multipath {
               wwid           36006048000028350131253594d303145
               alias             yellow1
       }
       multipath {
               wwid           36006048000028350131253594d303334
               alias             yellow2
       }
}</pre></div><div id="id-1.10.6.6.12.11.4.4" data-id-title="WWID Compared to WWN" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg"/><div class="admon-title">Important: WWID Compared to WWN</div><p>
      When you define device aliases in the
      <code class="filename">/etc/multipath.conf</code> file, ensure that you use each
      device’s WWID (such as
      <code class="filename">3600508e0000000009e6baa6f609e7908</code>) and not its WWN,
      which replaces the first character of a device ID with
      <code class="filename">0x</code>, such as
      <code class="filename">0x600508e0000000009e6baa6f609e7908</code>.
     </p></div></li><li class="step"><p>
     Save your changes, then close the file.
    </p></li><li class="step"><p>
     After you have modified the <code class="filename">/etc/multipath.conf</code> file,
     you must run <code class="command">dracut</code> <code class="option">-f</code> to re-create
     the <code class="filename">initrd</code> on your system, then restart the server
     for the changes to take effect. See <a class="xref" href="cha-multipath.html#sec-multipath-conf-file-apply" title="17.6.4. Applying the /etc/multipath.conf File Changes to Update the Multipath Maps">Section 17.6.4, “Applying the /etc/multipath.conf File Changes to Update the Multipath Maps”</a> for details.
    </p></li></ol></div></div><p>
   To use the entire LUN directly (for example, if you are using
   the SAN features to partition your storage), you can use the
   <code class="filename">/dev/disk/by-id/xxx</code> names for <code class="command">mkfs</code>,
   <code class="command">fstab</code>, your application, and so on. Partitioned devices
   have <code class="filename">_part&lt;n&gt;</code> appended to the device name, such
   as <code class="filename">/dev/disk/by-id/xxx_part1</code>.
  </p><p>
   In the <code class="filename">/dev/disk/by-id</code> directory, the multipath-mapped
   devices are represented by the device’s <code class="filename">dm-uuid*</code> name
   or alias name (if you assign an alias for it in the
   <code class="filename">/etc/multipath.conf</code> file). The
   <code class="filename">scsi-</code> and <code class="filename">wwn-</code> device names
   represent physical paths to the devices.
  </p><section class="sect2" id="sec-multipath-names-ha" data-id-title="Multipath Device Names in HA Clusters"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.9.1 </span><span class="title-name">Multipath Device Names in HA Clusters</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-names-ha">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    Make sure that multipath devices have the same name across all devices by
    doing the following:
   </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
      Use UUID and alias names to ensure that multipath device names are
      consistent across all nodes in the cluster. Alias names must be unique
      across all nodes. Copy the <code class="filename">/etc/multipath.conf </code>file
      from the node to the <code class="filename">/etc/</code> directory for all of the
      other nodes in the cluster.
     </p></li><li class="listitem"><p>
      When using links to multipath-mapped devices, ensure that you specify the
      <code class="filename">dm-uuid*</code> name or alias name in the
      <code class="filename">/dev/disk/by-id</code> directory, and not a fixed path
      instance of the device. For information, see
      <a class="xref" href="cha-multipath.html#sec-multipath-names" title="17.9. Configuring User-Friendly Names or Alias Names">Section 17.9, “Configuring User-Friendly Names or Alias Names”</a>.
     </p></li><li class="listitem"><p>
      Set the <code class="literal">user_friendly_names</code> configuration option to
      <code class="literal">no</code> to disable it. A user-friendly name is unique to a
      node, but a device might not be assigned the same user-friendly name on
      every node in the cluster.
     </p></li></ul></div><div id="id-1.10.6.6.12.14.4" data-id-title="User-Friendly Names" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note: User-Friendly Names</div><p>
     If you really need to use user-friendly names, you can force the
     system-defined user-friendly names to be consistent across all nodes in
     the cluster by doing the following:
    </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
       In the <code class="filename">/etc/multipath.conf</code> file on one node:
      </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
         Set the <code class="literal">user_friendly_names</code> configuration option to
         <code class="literal">yes</code> to enable it.
        </p><p>
         Multipath uses the <code class="filename">/var/lib/multipath/bindings</code>
         file to assign a persistent and unique name to the device in the form
         of <code class="filename">mpath&lt;<em class="replaceable">N</em>&gt;</code> in
         the <code class="filename">/dev/mapper </code>directory.
        </p></li><li class="listitem"><p>
         (Optional) Set the <code class="literal">bindings_file</code> option in the
         <code class="literal">defaults</code> section of the
         <code class="literal">/etc/multipath.conf</code> file to specify an alternate
         location for the <code class="filename">bindings</code> file.
        </p><p>
         The default location is
         <code class="filename">/var/lib/multipath/bindings</code>.
        </p></li></ol></div></li><li class="step"><p>
       Set up all of the multipath devices on the node.
      </p></li><li class="step"><p>
       Copy the <code class="filename">/etc/multipath.conf</code> file from the node to
       the <code class="filename">/etc/</code> directory of all the other nodes in the
       cluster.
      </p></li><li class="step"><p>
       Copy the <code class="filename">bindings</code> file from the node to the
       <code class="filename">bindings_file</code> path on all of the other nodes in the
       cluster.
      </p></li><li class="step"><p>
       After you have modified the <code class="filename">/etc/multipath.conf</code>
       file, you must run <code class="command">dracut</code> <code class="option">-f</code> to
       re-create the <code class="filename">initrd</code> on your system, then restart
       the node for the changes to take effect. See <a class="xref" href="cha-multipath.html#sec-multipath-conf-file-apply" title="17.6.4. Applying the /etc/multipath.conf File Changes to Update the Multipath Maps">Section 17.6.4, “Applying the /etc/multipath.conf File Changes to Update the Multipath Maps”</a> for details. This applies to
       all affected nodes.
      </p></li></ol></div></div></div></section></section><section class="sect1" id="sec-multipath-policies-failover" data-id-title="Configuring Path Failover Policies and Priorities"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">17.10 </span><span class="title-name">Configuring Path Failover Policies and Priorities</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-policies-failover">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   In a Linux host, when there are multiple paths to a storage controller, each
   path appears as a separate block device, and results in multiple block
   devices for single LUN. The Device Mapper Multipath service detects multiple
   paths with the same LUN ID, and creates a new multipath device with that ID.
   For example, a host with two HBAs attached to a storage controller with two
   ports via a single unzoned Fibre Channel switch sees four block devices:
   <code class="filename">/dev/sda</code>, <code class="filename">/dev/sdb</code>,
   <code class="filename">/dev/sdc</code>, and <code class="filename">/dev/sdd</code>. The Device
   Mapper Multipath service creates a single block device,
   <code class="filename">/dev/mpath/mpath1</code>, that reroutes I/O through those four
   underlying block devices.
  </p><p>
   This section describes how to specify policies for failover and configure
   priorities for the paths. Note that after you have modified the
   <code class="filename">/etc/multipath.conf</code> file, you must run
   <code class="command">dracut</code> <code class="option">-f</code> to re-create the
   <code class="filename">initrd</code> on your system, then restart the server for the
   changes to take effect. See <a class="xref" href="cha-multipath.html#sec-multipath-conf-file-apply" title="17.6.4. Applying the /etc/multipath.conf File Changes to Update the Multipath Maps">Section 17.6.4, “Applying the /etc/multipath.conf File Changes to Update the Multipath Maps”</a>
   for details.
  </p><section class="sect2" id="sec-multipath-policies-failover-path" data-id-title="Configuring the Path Failover Policies"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.10.1 </span><span class="title-name">Configuring the Path Failover Policies</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-policies-failover-path">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    Use the <code class="command">multipath</code> command with the <code class="option">-p</code>
    option to set the path failover policy:
   </p><div class="verbatim-wrap"><pre class="screen">sudo multipath <em class="replaceable">DEVICENAME</em> -p <em class="replaceable">POLICY</em></pre></div><p>
    Replace <em class="replaceable">POLICY</em> with one of the following policy
    options:
   </p><div class="table" id="id-1.10.6.6.13.4.5" data-id-title="Group Policy Options for the multipath -p Command"><div class="title-container"><div class="table-title-wrap"><div class="table-title"><span class="title-number-name"><span class="title-number">Table 17.5: </span><span class="title-name">Group Policy Options for the multipath -p Command </span></span><a title="Permalink" class="permalink" href="cha-multipath.html#id-1.10.6.6.13.4.5">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div><div class="table-contents"><table style="border-collapse: collapse; border-top: 1px solid ; border-bottom: 1px solid ; border-left: 1px solid ; border-right: 1px solid ; "><colgroup><col class="1"/><col class="2"/></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; ">
        <p>
         Policy Option
        </p>
       </th><th style="border-bottom: 1px solid ; ">
        <p>
         Description
        </p>
       </th></tr></thead><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
        <p>
         failover
        </p>
       </td><td style="border-bottom: 1px solid ; ">
        <p>
         (Default) One path per priority group.
        </p>
       </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
        <p>
         multibus
        </p>
       </td><td style="border-bottom: 1px solid ; ">
        <p>
         All paths in one priority group.
        </p>
       </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
        <p>
         group_by_serial
        </p>
       </td><td style="border-bottom: 1px solid ; ">
        <p>
         One priority group per detected serial number.
        </p>
       </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
        <p>
         group_by_prio
        </p>
       </td><td style="border-bottom: 1px solid ; ">
        <p>
         One priority group per path priority value. Priorities are determined
         by callout programs specified as a global, per-controller, or
         per-multipath option in the <code class="filename">/etc/multipath.conf</code>
         configuration file.
        </p>
       </td></tr><tr><td style="border-right: 1px solid ; ">
        <p>
         group_by_node_name
        </p>
       </td><td>
        <p>
         One priority group per target node name. Target node names are fetched
         in the<code class="filename"> /sys/class/fc_transport/target*/node_name</code>
         location.
        </p>
       </td></tr></tbody></table></div></div></section><section class="sect2" id="sec-multipath-policies-failover-prio" data-id-title="Configuring Failover Priorities"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.10.2 </span><span class="title-name">Configuring Failover Priorities</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-policies-failover-prio">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    You must manually enter the failover priorities for the device in the
    <code class="filename">/etc/multipath.conf</code> file. Examples for all settings
    and options can be found in the
    <code class="filename">/usr/share/doc/packages/multipath-tools/multipath.conf.annotated</code>
    file.
   </p><section class="sect3" id="sec-multipath-policies-failover-prio-info" data-id-title="Understanding Priority Groups and Attributes"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">17.10.2.1 </span><span class="title-name">Understanding Priority Groups and Attributes</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-policies-failover-prio-info">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
     A <span class="emphasis"><em>priority group</em></span> is a collection of paths that go to
     the same physical LUN. By default, I/O is distributed in a round-robin
     fashion across all paths in the group. The <code class="command">multipath</code>
     command automatically creates priority groups for each LUN in the SAN
     based on the <code class="literal">path_grouping_policy</code> setting for that SAN.
     The <code class="command">multipath</code> command multiplies the number of paths in
     a group by the group’s priority to determine which group is the primary.
     The group with the highest calculated value is the primary. When all paths
     in the primary group are failed, the priority group with the next highest
     value becomes active.
    </p><p>
     A <span class="emphasis"><em>path priority</em></span> is an integer value assigned to a
     path. The higher the value, the higher the priority. An external program
     is used to assign priorities for each path. For a given device, the paths
     with the same priorities belong to the same priority group.
    </p><p>
     The <code class="literal">prio</code> setting is used in the
     <code class="literal">defaults{}</code> or <code class="literal">devices{}</code> section of
     the <code class="filename">/etc/multipath.conf</code> file. It is silently ignored
     when it is specified for an individual <code class="literal">multipath</code>
     definition in the <code class="literal">multipaths{)</code> section. The
     <code class="literal">prio</code> line specifies the prioritizer. If the prioritizer
     requires an argument, you specify the argument by using the
     <code class="literal">prio_args</code> keyword on a second line.
    </p><div class="sect1 bridgehead"><h2 class="title" id="id-1.10.6.6.13.5.3.5"><span class="name">PRIO Settings for the Defaults or Devices Sections</span><a title="Permalink" class="permalink" href="cha-multipath.html#id-1.10.6.6.13.5.3.5">#</a></h2></div><div class="variablelist"><dl class="variablelist"><dt id="id-1.10.6.6.13.5.3.6.1"><span class="term">prio</span></dt><dd><p>
        Specifies the prioritizer program to call to obtain a path priority
        value. Weights are summed for each path group to determine the next
        path group to use in case of failure.
       </p><p>
        Use the <code class="literal">prio_args</code> keyword to specify arguments if
        the specified prioritizer requires arguments.
       </p><p>
        If no <code class="literal">prio</code> keyword is specified, all paths are
        equal. The default setting is <code class="literal">const</code> with a
        <code class="literal">prio_args</code> setting with no value.
       </p><div class="verbatim-wrap"><pre class="screen">prio "const"
prio_args ""</pre></div><p>
        Example prioritizer programs include:
       </p><div class="informaltable"><table style="border-collapse: collapse; border-top: 1px solid ; border-bottom: 1px solid ; border-left: 1px solid ; border-right: 1px solid ; "><colgroup><col class="1"/><col class="2"/></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; ">
            <p>
             Prioritizer Program
            </p>
           </th><th style="border-bottom: 1px solid ; ">
            <p>
             Description
            </p>
           </th></tr></thead><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
            <p>
             <code class="literal">alua</code>
            </p>
           </td><td style="border-bottom: 1px solid ; ">
            <p>
             Generates path priorities based on the SCSI-3 ALUA settings.
            </p>
           </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
            <p>
             <code class="literal">const</code>
            </p>
           </td><td style="border-bottom: 1px solid ; ">
            <p>
             Generates the same priority for all paths.
            </p>
           </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
            <p>
             <code class="literal">emc</code>
            </p>
           </td><td style="border-bottom: 1px solid ; ">
            <p>
             Generates the path priority for EMC arrays.
            </p>
           </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
            <p>
             <code class="literal">hdc</code>
            </p>
           </td><td style="border-bottom: 1px solid ; ">
            <p>
             Generates the path priority for Hitachi HDS Modular storage
             arrays.
            </p>
           </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
            <p>
             <code class="literal">hp_sw</code>
            </p>
           </td><td style="border-bottom: 1px solid ; ">
            <p>
             Generates the path priority for Compaq/HP controller in
             active/standby mode.
            </p>
           </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
            <p>
             <code class="literal">ontap</code>
            </p>
           </td><td style="border-bottom: 1px solid ; ">
            <p>
             Generates the path priority for NetApp arrays.
            </p>
           </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
            <p>
             <code class="literal">random</code>
            </p>
           </td><td style="border-bottom: 1px solid ; ">
            <p>
             Generates a random priority for each path.
            </p>
           </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
            <p>
             <code class="literal">rdac</code>
            </p>
           </td><td style="border-bottom: 1px solid ; ">
            <p>
             Generates the path priority for LSI/Engenio RDAC controller.
            </p>
           </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
            <p>
             <code class="literal">weightedpath</code>
            </p>
           </td><td style="border-bottom: 1px solid ; ">
            <p>
             Generates the path priority based on the weighted values you
             specify in the arguments for <code class="literal">prio_args</code>.
            </p>
           </td></tr><tr><td style="border-right: 1px solid ; ">
            <p>
             <code class="literal">path_latency</code>
            </p>
           </td><td>
            <p>
             Generate the path priority based on a latency algorithm, which 
             is configured with the <code class="literal">prio_args</code> keyword.
            </p>
           </td></tr></tbody></table></div></dd></dl></div><div class="sect1 bridgehead"><h2 class="title" id="id-1.10.6.6.13.5.3.7"><span class="name"><code class="literal">prio_args</code> arguments</span><a title="Permalink" class="permalink" href="cha-multipath.html#id-1.10.6.6.13.5.3.7">#</a></h2></div><p>
        These are the arguments for the prioritizer programs that
        require arguments. Most <code class="literal">prio</code> programs do not need
        arguments. There is no default. The values depend on the <code class="literal">prio</code>
        setting and whether the prioritizer requires any of the following arguments:
      </p><div class="variablelist"><dl class="variablelist"><dt id="id-1.10.6.6.13.5.3.9.1"><span class="term">weighted</span></dt><dd><p>
              Requires a value of the form
             <code class="literal">[hbtl|devname|serial|wwn]</code>
             <em class="replaceable">REGEX1</em> <em class="replaceable">PRIO1</em>
             <em class="replaceable">REGEX2</em>
             <em class="replaceable">PRIO2</em>...
            </p></dd><dt id="id-1.10.6.6.13.5.3.9.2"><span class="term">hbtl</span></dt><dd><p>
             Regex must be of SCSI H:B:T:L format, for example 1:0:.:.
             and *:0:0:., with a weight value, where H, B, T, L are the
             host, bus, target, and LUN  IDs for a device. For example:
             </p><div class="verbatim-wrap"><pre class="screen">prio "weightedpath"
prio_args "hbtl 1:.:.:. 2 4:.:.:. 4"</pre></div></dd><dt id="id-1.10.6.6.13.5.3.9.3"><span class="term">devname</span></dt><dd><p>
                Regex is in device name format. For example: sda, sd.e
            </p></dd><dt id="id-1.10.6.6.13.5.3.9.4"><span class="term">serial</span></dt><dd><p>
             Regex is in serial number format. For example: .*J1FR.*324. Look up your serial
             number with the <code class="command">multipathd show paths format %z</code> 
             command.
             (<code class="command">multipathd show wildcards</code> displays all 
             <code class="literal">format</code> wildcards.)
            </p></dd><dt id="id-1.10.6.6.13.5.3.9.5"><span class="term">alua</span></dt><dd><p>
                If <code class="literal">exclusive_pref_bit</code> is set for a device 
                (<code class="literal">alua exclusive_pref_bit</code>), paths with
                the <code class="literal">preferred path</code> bit set will 
                always be in their own path group.
            </p></dd><dt id="id-1.10.6.6.13.5.3.9.6"><span class="term">path_latency</span></dt><dd><p>
               <code class="literal">path_latency</code> adjusts latencies
                between remote and local storage arrays, if both arrays
                use the same type of hardware. Usually the latency on 
                the remote array will be higher, so you can tune the latency 
                to bring them closer together. This requires a value pair of the form 
                <code class="literal">io_num=<em class="replaceable">20</em> 
                base_num=<em class="replaceable">10</em></code>.
            </p><p>
                <code class="literal">io_num</code> is the number of read IOs sent to the current path 
                continuously, which are used to calculate the average path latency. Valid values 
                are integers from  2 to 200.
            </p><p>   
              <code class="literal">base_num</code> is the logarithmic base number, 
              used to partition different priority ranks. Valid values are integer from 2 - 10. The 
              maximum average latency value is 100s, the minimum is 1us. For example,  
              if  <code class="literal">base_num=10</code>, the paths will be grouped in priority groups with 
               path  latency &lt;=1us, (1us, 10us], (10us, 100us], (100us, 1ms], 
              (1ms, 10ms], (10ms, 100ms], (100ms, 1s], (1s, 10s], (10s, 100s], &gt;100s
             </p></dd></dl></div><div class="sect1 bridgehead"><h2 class="title" id="id-1.10.6.6.13.5.3.10"><span class="name">Multipath Attributes</span><a title="Permalink" class="permalink" href="cha-multipath.html#id-1.10.6.6.13.5.3.10">#</a></h2></div><p>
     Multipath attributes are used to control the behavior of multipath I/O for
     devices. You can specify attributes as defaults for all multipath devices.
     You can also specify attributes that apply only to a given multipath
     device by creating an entry for that device in the
     <code class="literal">multipaths</code> section of the multipath configuration file.
    </p><div class="variablelist"><dl class="variablelist"><dt id="id-1.10.6.6.13.5.3.12.1"><span class="term"><code class="literal">user_friendly_names</code>
      </span></dt><dd><p>
        Specifies whether to use world-wide IDs (WWIDs) or to use the
        <code class="filename">/var/lib/multipath/bindings</code> file to assign a
        persistent and unique alias to the multipath devices in the form of
        <code class="filename">/dev/mapper/mpathN</code>.
       </p><p>
        This option can be used in the <code class="literal">devices</code> section and
        the <code class="literal">multipaths</code> section.
       </p><div class="informaltable"><table style="border-collapse: collapse; border-top: 1px solid ; border-bottom: 1px solid ; border-left: 1px solid ; border-right: 1px solid ; "><colgroup><col class="1"/><col class="2"/></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; ">
            <p>
             Value
            </p>
           </th><th style="border-bottom: 1px solid ; ">
            <p>
             Description
            </p>
           </th></tr></thead><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
            <p>
             <code class="literal">no</code>
            </p>
           </td><td style="border-bottom: 1px solid ; ">
            <p>
             (Default) Use the WWIDs shown in the
             <code class="filename">/dev/disk/by-id/</code> location.
            </p>
           </td></tr><tr><td style="border-right: 1px solid ; ">
            <p>
             <code class="literal">yes</code>
            </p>
           </td><td>
            <p>
             Autogenerate user-friendly names as aliases for the multipath
             devices instead of the actual ID.
            </p>
           </td></tr></tbody></table></div></dd><dt id="failback"><span class="term"><code class="literal">failback</code>
      </span></dt><dd><p>
        Specifies whether to monitor the failed path recovery, and indicates
        the timing for group failback after failed paths return to service.
       </p><p>
        When the failed path recovers, the path is added back into the
        multipath-enabled path list based on this setting. Multipath evaluates
        the priority groups, and changes the active priority group when the
        priority of the primary path exceeds the secondary group.
       </p><div class="informaltable"><table style="border-collapse: collapse; border-top: 1px solid ; border-bottom: 1px solid ; border-left: 1px solid ; border-right: 1px solid ; "><colgroup><col class="1"/><col class="2"/></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; ">
            <p>
             Value
            </p>
           </th><th style="border-bottom: 1px solid ; ">
            <p>
             Description
            </p>
           </th></tr></thead><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
            <p>
             <code class="literal">manual</code>
            </p>
           </td><td style="border-bottom: 1px solid ; ">
            <p>
             (Default) The failed path is not monitored for recovery. The
             administrator runs the <code class="command">multipath</code> command to
             update enabled paths and priority groups.
            </p>
           </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
            <p>
             <code class="literal">followover</code>
            </p>
           </td><td style="border-bottom: 1px solid ; ">
            <p>
             Only perform automatic failback when the first path of a pathgroup
             becomes active. This keeps a node  from  automatically  failing
             back when another node requested the failover.
            </p>
           </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
            <p>
             <code class="literal">immediate</code>
            </p>
           </td><td style="border-bottom: 1px solid ; ">
            <p>
             When a path recovers, enable the path immediately.
            </p>
           </td></tr><tr><td style="border-right: 1px solid ; ">
            <p>
             <code class="literal"><em class="replaceable">N</em></code>
            </p>
           </td><td>
            <p>
             When the path recovers, wait <em class="replaceable">N</em> seconds
             before enabling the path. Specify an integer value greater than 0.
            </p>
           </td></tr></tbody></table></div><p>
        We recommend failback setting of <code class="literal">manual</code> for
        multipath in cluster environments to prevent multipath failover
        ping-pong.
       </p><div class="verbatim-wrap"><pre class="screen">failback "manual"</pre></div><div id="id-1.10.6.6.13.5.3.12.2.2.6" data-id-title="Verification" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg"/><div class="admon-title">Important: Verification</div><p>
         Make sure that you verify the failback setting with your storage
         system vendor. Different storage systems can require different
         settings.
        </p></div></dd><dt id="no-path-retry"><span class="term"><code class="literal">no_path_retry</code>
      </span></dt><dd><p>
        Specifies the behaviors to use on path failure.
       </p><div class="informaltable"><table style="border-collapse: collapse; border-top: 1px solid ; border-bottom: 1px solid ; border-left: 1px solid ; border-right: 1px solid ; "><colgroup><col class="1"/><col class="2"/></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; ">
            <p>
             Value
            </p>
           </th><th style="border-bottom: 1px solid ; ">
            <p>
             Description
            </p>
           </th></tr></thead><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
            <p>
             <code class="literal"><em class="replaceable">N</em></code>
            </p>
           </td><td style="border-bottom: 1px solid ; ">
            <p>
             Specifies the number of retries until <code class="command">multipath</code>
             stops the queuing and fails the path. Specify an integer value
             greater than 0.
            </p>
            <p>
             In a cluster, you can specify a value of “0” to prevent
             queuing and allow resources to fail over.
            </p>
           </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
            <p>
             <code class="literal">fail</code>
            </p>
           </td><td style="border-bottom: 1px solid ; ">
            <p>
             Specifies immediate failure (no queuing).
            </p>
           </td></tr><tr><td style="border-right: 1px solid ; ">
            <p>
             <code class="literal">queue</code>
            </p>
           </td><td>
            <p>
             Never stop queuing (queue forever until the path comes alive).
            </p>
           </td></tr></tbody></table></div><p>
        We recommend a retry setting of <code class="literal">fail</code> or
        <code class="literal">0</code> in the <code class="filename">/etc/multipath.conf</code>
        file when working in a cluster. This causes the resources to fail over
        when the connection is lost to storage. Otherwise, the messages queue
        and the resource failover cannot occur.
       </p><div class="verbatim-wrap"><pre class="screen">no_path_retry "fail"
no_path_retry "0"</pre></div><div id="id-1.10.6.6.13.5.3.12.3.2.5" data-id-title="Verification" class="admonition important normal"><img class="symbol" alt="Important" title="Important" src="static/images/icon-important.svg"/><div class="admon-title">Important: Verification</div><p>
         Make sure that you verify the retry settings with your storage system
         vendor. Different storage systems can require different settings.
        </p></div></dd><dt id="id-1.10.6.6.13.5.3.12.4"><span class="term"><code class="literal">path_checker</code>
      </span></dt><dd><p>
        Determines the state of the path.
       </p><div class="informaltable"><table style="border-collapse: collapse; border-top: 1px solid ; border-bottom: 1px solid ; border-left: 1px solid ; border-right: 1px solid ; "><colgroup><col style="width: 30%; " class="1"/><col style="width: 70%; " class="2"/></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; ">
            <p>
             Value
            </p>
           </th><th style="border-bottom: 1px solid ; ">
            <p>
             Description
            </p>
           </th></tr></thead><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
            <p>
             <code class="literal">directio</code>
            </p>
           </td><td style="border-bottom: 1px solid ; ">
            <p>
             Reads the first sector that has direct I/O. This is useful for
             DASD devices. Logs failure messages in the <code class="systemitem">systemd</code> journal (see
             <span class="intraxref">Book “Administration Guide”, Chapter 15 “<code class="command">journalctl</code>: Query the <code class="systemitem">systemd</code> Journal”</span>).
            </p>
           </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
            <p>
             <code class="literal">tur</code>
            </p>
           </td><td style="border-bottom: 1px solid ; ">
            <p>
             Issues an SCSI test unit ready command to the device. This is the
             preferred setting if the LUN supports it. On failure, the command
             does not fill up the <code class="systemitem">systemd</code> log journal with messages.
            </p>
           </td></tr><tr><td style="border-right: 1px solid ; ">
            <p>
             <em class="replaceable">CUSTOM_VENDOR_VALUE</em>
            </p>
           </td><td>
            <p>
             Some SAN vendors provide custom path_checker options:
            </p>
            <div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p><span class="formalpara-title"><code class="literal">cciss_tur</code>:</span>
                Checks the path state for HP Smart Storage Arrays.
               </p></li><li class="listitem"><p><span class="formalpara-title"><code class="literal">emc_clariion</code>:</span>
                Queries the EMC Clariion EVPD page 0xC0 to determine the path
                state.
               </p></li><li class="listitem"><p><span class="formalpara-title"><code class="literal">hp_sw</code>:</span>
                Checks the path state (Up, Down, or Ghost) for HP storage
                arrays with Active/Standby firmware.
               </p></li><li class="listitem"><p><span class="formalpara-title"><code class="literal">rdac</code>:</span>
                Checks the path state for the LSI/Engenio RDAC storage
                controller.
               </p></li></ul></div>
           </td></tr></tbody></table></div></dd><dt id="id-1.10.6.6.13.5.3.12.5"><span class="term"><code class="literal">path_grouping_policy</code>
      </span></dt><dd><p>
        Specifies the path grouping policy for a multipath device hosted by a
        given controller.
       </p><div class="informaltable"><table style="border-collapse: collapse; border-top: 1px solid ; border-bottom: 1px solid ; border-left: 1px solid ; border-right: 1px solid ; "><colgroup><col class="1"/><col class="2"/></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; ">
            <p>
             Value
            </p>
           </th><th style="border-bottom: 1px solid ; ">
            <p>
             Description
            </p>
           </th></tr></thead><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
            <p>
             <code class="literal">failover</code>
            </p>
           </td><td style="border-bottom: 1px solid ; ">
            <p>
             (Default) One path is assigned per priority group so that only one
             path at a time is used.
            </p>
           </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
            <p>
             <code class="literal">multibus</code>
            </p>
           </td><td style="border-bottom: 1px solid ; ">
            <p>
             All valid paths are in one priority group. Traffic is
             load-balanced across all active paths in the group.
            </p>
           </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
            <p>
             <code class="literal">group_by_prio</code>
            </p>
           </td><td style="border-bottom: 1px solid ; ">
            <p>
             One priority group exists for each path priority value. Paths with
             the same priority are in the same priority group. Priorities are
             assigned by an external program.
            </p>
           </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
            <p>
             <code class="literal">group_by_serial</code>
            </p>
           </td><td style="border-bottom: 1px solid ; ">
            <p>
             Paths are grouped by the SCSI target serial number (controller
             node WWN).
            </p>
           </td></tr><tr><td style="border-right: 1px solid ; ">
            <p>
             <code class="literal">group_by_node_name</code>
            </p>
           </td><td>
            <p>
             One priority group is assigned per target node name. Target node
             names are fetched in
             <code class="filename">/sys/class/fc_transport/target*/node_name</code>.
            </p>
           </td></tr></tbody></table></div></dd><dt id="id-1.10.6.6.13.5.3.12.6"><span class="term"><code class="literal">path_selector</code>
      </span></dt><dd><p>
        Specifies the path-selector algorithm to use for load balancing.
       </p><div class="informaltable"><table style="border-collapse: collapse; border-top: 1px solid ; border-bottom: 1px solid ; border-left: 1px solid ; border-right: 1px solid ; "><colgroup><col class="1"/><col class="2"/></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; ">
            <p>
             Value
            </p>
           </th><th style="border-bottom: 1px solid ; ">
            <p>
             Description
            </p>
           </th></tr></thead><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
            <p>
             <code class="literal">round-robin 0</code>
            </p>
           </td><td style="border-bottom: 1px solid ; ">
            <p>
             The load-balancing algorithm used to balance traffic across all
             active paths in a priority group.
            </p>
           </td></tr><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
            <p>
             <code class="literal">queue-length 0</code>
            </p>
           </td><td style="border-bottom: 1px solid ; ">
            <p>
             A dynamic load balancer that balances the number of in-flight I/O
             on paths similar to the least-pending option.
            </p>
           </td></tr><tr><td style="border-right: 1px solid ; ">
            <p>
             <code class="literal">service-time 0</code>
            </p>
           </td><td>
            <p>
             (Default) A service-time oriented load balancer that balances I/O
             on paths according to the latency.
            </p>
           </td></tr></tbody></table></div></dd><dt id="id-1.10.6.6.13.5.3.12.7"><span class="term">pg_timeout</span></dt><dd><p>
        Specifies path group timeout handling. No value can be specified; an
        internal default is set.
       </p></dd><dt id="polling-interval"><span class="term"><code class="literal">polling_interval</code>
      </span></dt><dd><p>
        Specifies the time in seconds between the end of one path checking
        cycle and the beginning of the next path checking cycle.
       </p><p>
        Specify an integer value greater than 0. The default value is 5. Make
        sure that you verify the polling_interval setting with your storage
        system vendor. Different storage systems can require different
        settings.
       </p></dd><dt id="id-1.10.6.6.13.5.3.12.9"><span class="term"><code class="literal">rr_min_io_rq</code>
      </span></dt><dd><p>
        Specifies the number of I/O requests to route to a path before
        switching to the next path in the current path group, using
        request-based device-mapper-multipath.
       </p><p>
        Specify an integer value greater than 0. The default value is 1.
       </p><div class="verbatim-wrap"><pre class="screen">rr_min_io_rq "1"</pre></div></dd><dt id="id-1.10.6.6.13.5.3.12.10"><span class="term"><code class="literal">rr_weight</code>
      </span></dt><dd><p>
        Specifies the weighting method to use for paths.
       </p><div class="informaltable"><table style="border-collapse: collapse; border-top: 1px solid ; border-bottom: 1px solid ; border-left: 1px solid ; border-right: 1px solid ; "><colgroup><col class="1"/><col class="2"/></colgroup><thead><tr><th style="border-right: 1px solid ; border-bottom: 1px solid ; ">
            <p>
             Value
            </p>
           </th><th style="border-bottom: 1px solid ; ">
            <p>
             Description
            </p>
           </th></tr></thead><tbody><tr><td style="border-right: 1px solid ; border-bottom: 1px solid ; ">
            <p>
             <code class="literal">uniform</code>
            </p>
           </td><td style="border-bottom: 1px solid ; ">
            <p>
             (Default) All paths have the same round-robin weights.
            </p>
           </td></tr><tr><td style="border-right: 1px solid ; ">
            <p>
             <code class="literal">priorities</code>
            </p>
           </td><td>
            <p>
             Each path’s weight is determined by the path’s priority times
             the rr_min_io_rq setting.
            </p>
           </td></tr></tbody></table></div></dd><dt id="id-1.10.6.6.13.5.3.12.11"><span class="term"><code class="literal">uid_attribute</code>
      </span></dt><dd><p>
        A udev attribute that provides a unique path identifier. The default
        value is <code class="literal">ID_SERIAL</code>.
       </p></dd></dl></div></section><section class="sect3" id="sec-multipath-policies-failover-rr" data-id-title="Configuring for Round-Robin Load Balancing"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">17.10.2.2 </span><span class="title-name">Configuring for Round-Robin Load Balancing</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-policies-failover-rr">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
     All paths are active. I/O is configured for some number of seconds or some
     number of I/O transactions before moving to the next open path in the
     sequence.
    </p></section><section class="sect3" id="sec-multipath-policies-failover-prio-single" data-id-title="Configuring for Single Path Failover"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">17.10.2.3 </span><span class="title-name">Configuring for Single Path Failover</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-policies-failover-prio-single">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
     A single path with the highest priority (lowest value setting) is active
     for traffic. Other paths are available for failover, but are not used
     unless failover occurs.
    </p></section><section class="sect3" id="sec-multipath-policies-failover-prio-rr-grouping" data-id-title="Grouping I/O Paths for Round-Robin Load Balancing"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">17.10.2.4 </span><span class="title-name">Grouping I/O Paths for Round-Robin Load Balancing</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-policies-failover-prio-rr-grouping">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
     Multiple paths with the same priority fall into the active group. When all
     paths in that group fail, the device fails over to the next highest
     priority group. All paths in the group share the traffic load in a
     round-robin load balancing fashion.
    </p></section></section><section class="sect2" id="sec-multipath-policies-failover-rtpg" data-id-title="Reporting Target Path Groups"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.10.3 </span><span class="title-name">Reporting Target Path Groups</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-policies-failover-rtpg">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    Use the SCSI Report Target Port Groups (<code class="command">sg_rtpg(8)</code>)
    command. For information, see the man page for
    <code class="command">sg_rtpg(8)</code>.
   </p></section></section><section class="sect1" id="sec-multipath-root" data-id-title="Configuring Multipath I/O for the Root Device"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">17.11 </span><span class="title-name">Configuring Multipath I/O for the Root Device</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-root">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   Device Mapper Multipath I/O (DM-MPIO) is available and supported for
   <code class="filename">/boot</code> and <code class="filename">/root</code> in <span class="productname"><span class="phrase">SUSE Linux Enterprise Server</span></span>.
   In addition, the YaST partitioner in the YaST installer supports
   enabling multipath during the install.
  </p><section class="sect2" id="sec-multipath-root-install" data-id-title="Enabling Multipath I/O at Install Time"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.11.1 </span><span class="title-name">Enabling Multipath I/O at Install Time</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-root-install">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    To install the operating system on a multipath device,
    the multipath software must be running at install time. The
    <code class="systemitem">multipathd</code> daemon is not
    automatically active during the system installation. You can start it by
    using the <span class="guimenu">Configure Multipath</span> option in the YaST
    Partitioner.
   </p><section class="sect3" id="sec-multipath-root-install-aa-lun" data-id-title="Enabling Multipath I/O at Install Time on an Active/Active Multipath Storage LUN"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">17.11.1.1 </span><span class="title-name">Enabling Multipath I/O at Install Time on an Active/Active Multipath Storage LUN</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-root-install-aa-lun">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
       Choose <span class="guimenu">Expert Partitioner</span> on the <span class="guimenu">Suggested
       Partitioning</span> screen during the installation.
      </p></li><li class="step"><p>
       Select the <span class="guimenu">Hard Disks</span> main icon, click the
       <span class="guimenu">Configure</span> button, then select <span class="guimenu">Configure
       Multipath</span>.
      </p></li><li class="step"><p>
       Start multipath.
      </p><p>
       YaST starts to rescan the disks and shows available multipath devices
       (such as
       <code class="filename">/dev/disk/by-id/dm-uuid-mpath-3600a0b80000f4593000012ae4ab0ae65</code>).
       This is the device that should be used for all further processing.
      </p></li><li class="step"><p>
       Click <span class="guimenu">Next</span> to continue with the installation.
      </p></li></ol></div></div></section><section class="sect3" id="sec-multipath-root-install-ap-lun" data-id-title="Enabling Multipath I/O at Install Time on an Active/Passive Multipath Storage LUN"><div class="titlepage"><div><div><div class="title-container"><h4 class="title"><span class="title-number-name"><span class="title-number">17.11.1.2 </span><span class="title-name">Enabling Multipath I/O at Install Time on an Active/Passive Multipath Storage LUN</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-root-install-ap-lun">#</a></h4><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
     The <code class="systemitem">multipathd</code> daemon is not
     automatically active during the system installation. You can start it by
     using the <span class="guimenu">Configure Multipath</span> option in the YaST
     Partitioner.
    </p><p>
     To enable multipath I/O at install time for an active/passive multipath
     storage LUN:
    </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
       Choose <span class="guimenu">Expert Partitioner</span> on the <span class="guimenu">Suggested
       Partitioning</span> screen during the installation.
      </p></li><li class="step"><p>
       Select the <span class="guimenu">Hard Disks</span> main icon, click the
       <span class="guimenu">Configure</span> button, then select <span class="guimenu">Configure
       Multipath</span>.
      </p></li><li class="step"><p>
       Start multipath.
      </p><p>
       YaST starts to rescan the disks and shows available multipath devices
       (such as
       <code class="filename">/dev/disk/by-id/dm-uuid-mpath-3600a0b80000f4593000012ae4ab0ae65</code>).
       This is the device that should be used for all further processing. Write
       down the device path and UUID; you will need it later.
      </p></li><li class="step"><p>
       Click <span class="guimenu">Next</span> to continue with the installation.
      </p></li><li class="step"><p>
       After all settings are done and the installation is finished, YaST
       starts to write the boot loader information, and displays a countdown to
       restart the system. Stop the counter by clicking the
       <span class="guimenu">Stop</span> button and press
       <span class="keycap">Ctrl</span><span class="key-connector">–</span><span class="keycap">Alt</span><span class="key-connector">–</span><span class="keycap">F5</span>
       to access a console.
      </p></li><li class="step"><p>
       Use the console to determine if a passive path was entered in the
       <code class="filename">/boot/grub2/device.map</code> file for the
       <code class="filename">hd0</code> entry.
      </p><p>
       This is necessary because the installation does not distinguish between
       active and passive paths.
      </p><ol type="a" class="substeps"><li class="step"><p class="intro">
         Mount the root device to <code class="filename">/mnt</code> by entering
        </p><div class="verbatim-wrap"><pre class="screen">mount /dev/disk/by-id/<em class="replaceable">UUID</em>;_part2 /mnt</pre></div><p>
         For example, enter
        </p><div class="verbatim-wrap"><pre class="screen">mount /dev/disk/by-id/dm-uuid-mpath-3600a0b80000f4593000012ae4ab0ae65_part2 /mnt</pre></div></li><li class="step"><p>
         Mount the boot device to <code class="filename">/mnt/boot</code> by entering
        </p><div class="verbatim-wrap"><pre class="screen">mount /dev/disk/by-id/<em class="replaceable">UUID</em>_part1 /mnt/boot</pre></div><p>
         For example, enter
        </p><div class="verbatim-wrap"><pre class="screen">mount /dev/disk/by-id/dm-uuid-mpath-3600a0b80000f4593000012ae4ab0ae65_part2 /mnt/boot</pre></div></li><li class="step"><p>
         In the <code class="filename">/mnt/boot/grub2/device.map</code> file, determine
         if the <code class="filename">hd0</code> entry points to a passive path, then
         do one of the following:
        </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p><span class="formalpara-title">Active path:</span>
            No action is needed. Skip all remaining steps and return to the
            YaST graphical environment by pressing
            <span class="keycap">Ctrl</span><span class="key-connector">–</span><span class="keycap">Alt</span><span class="key-connector">–</span><span class="keycap">F7</span>
            and continue with the installation.
           </p></li><li class="listitem"><p><span class="formalpara-title">Passive path:</span>
            The configuration must be changed and the boot loader must be
            reinstalled.
           </p></li></ul></div></li></ol></li><li class="step"><p class="intro">
       If the <code class="filename">hd0</code> entry points to a passive path, change
       the configuration and reinstall the boot loader:
      </p><ol type="a" class="substeps"><li class="step"><p class="intro">
         Enter the following commands at the console prompt:
        </p><div class="verbatim-wrap"><pre class="screen">          mount -o bind /dev /mnt/dev
          mount -o bind /sys /mnt/sys
          mount -o bind /proc /mnt/proc
          chroot /mnt</pre></div></li><li class="step"><p class="intro">
         At the console, run <code class="command">multipath -ll</code>, then check the
         output to find the active path.
        </p><p>
         Passive paths are flagged as <code class="literal">ghost</code>.
        </p></li><li class="step"><p>
         In the <code class="filename">/boot/grub2/device.map</code> file, change the
         <code class="literal">hd0</code> entry to an active path, save the changes, and
         close the file.
        </p></li><li class="step"><p>
         Reinstall the boot loader by entering
        </p><div class="verbatim-wrap"><pre class="screen">          grub-install /dev/disk/by-id/<em class="replaceable">UUID</em>_part1 /mnt/boot</pre></div><p>
         For example, enter
        </p><div class="verbatim-wrap"><pre class="screen">grub-install /dev/disk/by-id/dm-uuid-mpath-3600a0b80000f4593000012ae4ab0ae65_part2 /mnt/boot</pre></div></li><li class="step"><p>
         Enter the following commands:
        </p><div class="verbatim-wrap"><pre class="screen">exit
umount /mnt/*
umount /mnt</pre></div></li></ol></li><li class="step"><p>
       Return to the YaST graphical environment by pressing
       <span class="keycap">Ctrl</span><span class="key-connector">–</span><span class="keycap">Alt</span><span class="key-connector">–</span><span class="keycap">F7</span>.
      </p></li><li class="step"><p>
       Click <span class="guimenu">OK</span> to continue with the installation reboot.
      </p></li></ol></div></div></section></section><section class="sect2" id="sec-multipath-root-enable-existing" data-id-title="Enabling Multipath I/O for an Existing Root Device"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.11.2 </span><span class="title-name">Enabling Multipath I/O for an Existing Root Device</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-root-enable-existing">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
      Install Linux with only a single path active, preferably one where the
      <code class="filename">by-id</code> symbolic links are listed in the partitioner.
     </p></li><li class="step"><p>
      Mount the devices by using the <code class="filename">/dev/disk/by-id</code> path
      used during the install.
     </p></li><li class="step"><p>
      Open or create <code class="filename">/etc/dracut.conf.d/10-mp.conf</code> and
      add the following line (mind the leading whitespace):
     </p><div class="verbatim-wrap"><pre class="screen">force_drivers+=" dm-multipath"</pre></div></li><li class="step"><p>
      
      For IBM IBM Z, before running <code class="command">dracut</code>, edit the
      <code class="filename">/etc/zipl.conf</code> file to change the by-path
      information in <code class="filename">zipl.conf</code> with the same by-id
      information that was used in <code class="filename">/etc/fstab</code>.
     </p></li><li class="step"><p>
      Run <code class="command">dracut</code> <code class="option">-f</code> to update the
      <code class="filename">initrd</code> image.
     </p></li><li class="step"><p>
      For IBM IBM Z, after running <code class="command">dracut</code>, run
      <code class="command">zipl</code>.
     </p></li><li class="step"><p>
      Reboot the server.
     </p></li></ol></div></div></section><section class="sect2" id="sec-multipath-root-disable" data-id-title="Disabling Multipath I/O on the Root Device"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.11.3 </span><span class="title-name">Disabling Multipath I/O on the Root Device</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-root-disable">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    Add <code class="literal">multipath=off</code> to the kernel command line. This can
    be done with the YaST Boot Loader module. Open <span class="guimenu">Boot
    Loader Installation</span> › <span class="guimenu">Kernel Parameters</span> and add the parameter to both command lines.
   </p><p>
    This affects only the root device. All other devices are not affected.
   </p></section></section><section class="sect1" id="sec-multipath-raid" data-id-title="Configuring Multipath I/O for an Existing Software RAID"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">17.12 </span><span class="title-name">Configuring Multipath I/O for an Existing Software RAID</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-raid">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   Ideally, you should configure multipathing for devices before you use them
   as components of a software RAID device. If you add multipathing after
   creating any software RAID devices, the DM-MPIO service might be starting
   after the <code class="command">multipath</code> service on reboot, which makes
   multipathing appear not to be available for RAIDs. You can use the procedure
   in this section to get multipathing running for a previously existing
   software RAID.
  </p><p>
   For example, you might need to configure multipathing for devices in a
   software RAID under the following circumstances:
  </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
     If you create a new software RAID as part of the Partitioning settings
     during a new install or upgrade.
    </p></li><li class="listitem"><p>
     If you did not configure the devices for multipathing before using them in
     the software RAID as a member device or spare.
    </p></li><li class="listitem"><p>
     If you grow your system by adding new HBA adapters to the server or
     expanding the storage subsystem in your SAN.
    </p></li></ul></div><div id="id-1.10.6.6.15.5" data-id-title="Assumptions" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note: Assumptions</div><p>
    The following instructions assume the software RAID device is
    <code class="filename">/dev/mapper/mpath0</code>, which is its device name as
    recognized by the kernel. It assumes you have enabled user-friendly names
    in the <code class="filename">/etc/multipath.conf</code> file as described in
    <a class="xref" href="cha-multipath.html#sec-multipath-names" title="17.9. Configuring User-Friendly Names or Alias Names">Section 17.9, “Configuring User-Friendly Names or Alias Names”</a>.
   </p><p>
    Make sure to modify the instructions for the device name of your
    software RAID.
   </p></div><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p class="intro">
     Open a terminal console.
    </p><p>
     Except where otherwise directed, use this console to enter the commands in
     the following steps.
    </p></li><li class="step"><p>
     If any software RAID devices are currently mounted or running, enter the
     following commands for each device to unmount the device and stop it.
    </p><div class="verbatim-wrap"><pre class="screen">sudo umount /dev/mapper/mpath0
sudo mdadm --misc --stop /dev/mapper/mpath0</pre></div></li><li class="step"><p>
     Stop the <code class="command">md</code> service by entering
    </p><div class="verbatim-wrap"><pre class="screen">sudo systemctl stop mdmonitor</pre></div></li><li class="step"><p>
     Start the <code class="systemitem">multipathd</code> daemon by
     entering the following command:
    </p><div class="verbatim-wrap"><pre class="screen">systemctl start multipathd</pre></div></li><li class="step"><p>
     After the multipathing service has been started, verify that the software
     RAID’s component devices are listed in the
     <code class="filename">/dev/disk/by-id</code> directory. Do one of the following:
    </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p><span class="formalpara-title">Devices Are Listed:</span>
        The device names should now have symbolic links to their Device Mapper
        Multipath device names, such as <code class="filename">/dev/dm-1</code>.
       </p></li><li class="listitem"><p><span class="formalpara-title">Devices Are Not Listed:</span>
        Force the multipath service to recognize them by flushing and
        rediscovering the devices by entering
       </p><div class="verbatim-wrap"><pre class="screen">sudo multipath -F
sudo multipath -v0</pre></div><p>
       The devices should now be listed in
       <code class="filename">/dev/disk/by-id</code>, and have symbolic links to their
       Device Mapper Multipath device names. For example:
      </p><div class="verbatim-wrap"><pre class="screen">lrwxrwxrwx 1 root root 10 2011-01-06 11:42 dm-uuid-mpath-36006016088d014007e0d0d2213ecdf11 -&gt; ../../dm-1</pre></div></li></ul></div></li><li class="step"><p>
     Restart the <code class="filename">mdmonitor</code> service and the RAID device by
     entering
    </p><div class="verbatim-wrap"><pre class="screen">systemctl start mdmonitor</pre></div></li><li class="step"><p>
     Check the status of the software RAID by entering
    </p><div class="verbatim-wrap"><pre class="screen">mdadm --detail /dev/mapper/mpath0</pre></div><p>
     The RAID’s component devices should match their Device Mapper Multipath
     device names that are listed as the symbolic links of devices in the
     <code class="filename">/dev/disk/by-id</code> directory.
    </p></li><li class="step"><p>
     In case the root (<code class="filename">/</code>) device or any
     parts of it (such as <code class="filename">/var</code>, <code class="filename">/etc</code>, <code class="filename">/log</code>) are on the SAN and
     multipath is needed to boot, rebuild the <code class="systemitem">initrd</code>:
    </p><div class="verbatim-wrap"><pre class="screen">dracut -f --add-multipath</pre></div></li><li class="step"><p>
     Reboot the server to apply the changes.
    </p></li><li class="step"><p>
     Verify that the software RAID array comes up properly on top of the
     multipathed devices by checking the RAID status. Enter
    </p><div class="verbatim-wrap"><pre class="screen">mdadm --detail /dev/mapper/mpath0</pre></div><p>
     For example:
    </p><table style="border: 0; " class="simplelist"><tr><td><code class="literal">Number Major Minor RaidDevice State</code>
     </td></tr><tr><td><code class="literal">0 253 0 0 active sync /dev/dm-0</code>
     </td></tr><tr><td><code class="literal">1 253 1 1 active sync /dev/dm-1</code>
     </td></tr><tr><td><code class="literal">2 253 2 2 active sync /dev/dm-2</code>
     </td></tr></table></li></ol></div></div><div id="id-1.10.6.6.15.7" data-id-title="Using mdadm with Multipath Devices" class="admonition note normal"><img class="symbol" alt="Note" title="Note" src="static/images/icon-note.svg"/><div class="admon-title">Note: Using mdadm with Multipath Devices</div><p>
    The <code class="command">mdadm</code> tool requires that the devices be accessed by
    the ID rather than by the device node path. Refer to
    <a class="xref" href="cha-multipath.html#sec-multipath-mpiotools-mdadm" title="17.4.3. Using MDADM for Multipathed Devices">Section 17.4.3, “Using MDADM for Multipathed Devices”</a> for details.
   </p></div></section><section class="sect1" id="sec-multipath-lvm" data-id-title="Using LVM2 on Multipath Devices"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">17.13 </span><span class="title-name">Using LVM2 on Multipath Devices</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-lvm">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   When using multipath, all paths to a resource are present as devices
   in the device tree. By default LVM checks if there is a multipath
   device on top of any device in the device tree. If LVM finds a
   multipath device on top, it assumes that the device is a multipath
   component and ignores the (underlying) device.
   This is the most likely desired behavior, but it can be changed
   in <code class="filename">/etc/lvm/lvm.conf</code>. When
   multipath_component_detection is set to 0, LVM is scanning multipath
   component devices. The default entry in lvm.conf is:
  </p><div class="verbatim-wrap"><pre class="screen">    # By default, LVM2 will ignore devices used as component paths
    # of device-mapper multipath devices.
    # 1 enables; 0 disables.
    multipath_component_detection = 1</pre></div></section><section class="sect1" id="sec-multipath-best-practice" data-id-title="Best Practice"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">17.14 </span><span class="title-name">Best Practice</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-best-practice">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><section class="sect2" id="sec-multipath-best-practice-scandev" data-id-title="Scanning for New Devices without Rebooting"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.14.1 </span><span class="title-name">Scanning for New Devices without Rebooting</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-best-practice-scandev">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    If your system has already been configured for multipathing and you later
    need to add more storage to the SAN, you can use the
    <code class="command">rescan-scsi-bus.sh</code> script to scan for the new devices.
    By default, this script scans all HBAs with typical LUN ranges. The general
    syntax for the command looks like the following:
   </p><div class="verbatim-wrap"><pre class="screen">rescan-scsi-bus.sh [options] [host [host ...]]</pre></div><p>
    For most storage subsystems, the script can be run successfully without
    options. However, some special cases might need to use one or more options.
    Run <code class="command">rescan-scsi-bus.sh --help</code> for details.
   </p><div id="id-1.10.6.6.17.3.5" data-id-title="EMC PowerPath Environments" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.svg"/><div class="admon-title">Warning: EMC PowerPath Environments</div><p>
     In EMC PowerPath environments, do not use the
     <code class="filename">rescan-scsi-bus.sh</code> utility provided with the
     operating system or the HBA vendor scripts for scanning the SCSI buses. To
     avoid potential file system corruption, EMC requires that you follow the
     procedure provided in the vendor documentation for EMC PowerPath for
     Linux.
    </p></div><p>
    Use the following procedure to scan the devices and make them available to
    multipathing without rebooting the system.
   </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
      On the storage subsystem, use the vendor’s tools to allocate the device
      and update its access control settings to allow the Linux system access
      to the new storage. Refer to the vendor’s documentation for details.
     </p></li><li class="step"><p>
      Scan all targets for a host to make its new device known to the middle
      layer of the Linux kernel’s SCSI subsystem. At a terminal console
      prompt, enter
     </p><div class="verbatim-wrap"><pre class="screen">sudo rescan-scsi-bus.sh</pre></div><p>
      Depending on your setup, you might need to run
      <code class="command">rescan-scsi-bus.sh</code> with optional parameters. Refer to
      <code class="command">rescan-scsi-bus.sh --help</code> for details.
     </p></li><li class="step"><p>
      Check for scanning progress in the <code class="systemitem">systemd</code> journal (see
      <span class="intraxref">Book “Administration Guide”, Chapter 15 “<code class="command">journalctl</code>: Query the <code class="systemitem">systemd</code> Journal”</span> for details). At a terminal console
      prompt, enter
     </p><div class="verbatim-wrap"><pre class="screen">sudo journalctl -r</pre></div><p>
      This command displays the last lines of the log. For example:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>sudo journalctl -r
Feb 14 01:03 kernel: SCSI device sde: 81920000
Feb 14 01:03 kernel: SCSI device sdf: 81920000
Feb 14 01:03 multipathd: sde: path checker registered
Feb 14 01:03 multipathd: sdf: path checker registered
Feb 14 01:03 multipathd: mpath4: event checker started
Feb 14 01:03 multipathd: mpath5: event checker started
Feb 14 01:03:multipathd: mpath4: remaining active paths: 1
Feb 14 01:03 multipathd: mpath5: remaining active paths: 1
[...]</pre></div></li><li class="step"><p>
      Repeat the previous steps to add paths through other HBA adapters on the
      Linux system that are connected to the new device.
     </p></li><li class="step"><p>
      Run the <code class="command">multipath</code> command to recognize the devices for
      DM-MPIO configuration. At a terminal console prompt, enter
     </p><div class="verbatim-wrap"><pre class="screen">sudo multipath</pre></div><p>
      You can now configure the new device for multipathing.
     </p></li></ol></div></div></section><section class="sect2" id="sec-multipath-best-practice-scanpart" data-id-title="Scanning for New Partitioned Devices without Rebooting"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.14.2 </span><span class="title-name">Scanning for New Partitioned Devices without Rebooting</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-best-practice-scanpart">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    Use the example in this section to detect a newly added multipathed LUN
    without rebooting.
   </p><div id="id-1.10.6.6.17.4.3" data-id-title="EMC PowerPath Environments" class="admonition warning normal"><img class="symbol" alt="Warning" title="Warning" src="static/images/icon-warning.svg"/><div class="admon-title">Warning: EMC PowerPath Environments</div><p>
     In EMC PowerPath environments, do not use the
     <code class="filename">rescan-scsi-bus.sh</code> utility provided with the
     operating system or the HBA vendor scripts for scanning the SCSI buses. To
     avoid potential file system corruption, EMC requires that you follow the
     procedure provided in the vendor documentation for EMC PowerPath for
     Linux.
    </p></div><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
      Open a terminal console.
     </p></li><li class="step"><p>
      Scan all targets for a host to make its new device known to the middle
      layer of the Linux kernel’s SCSI subsystem. At a terminal console
      prompt, enter
     </p><div class="verbatim-wrap"><pre class="screen">rescan-scsi-bus.sh</pre></div><p>
      Depending on your setup, you might need to run
      <code class="command">rescan-scsi-bus.sh</code> with optional parameters. Refer to
      <code class="command">rescan-scsi-bus.sh --help</code> for details.
     </p></li><li class="step"><p>
      Verify that the device is seen (such as if the link has a new time stamp)
      by entering
     </p><div class="verbatim-wrap"><pre class="screen">ls -lrt /dev/dm-*</pre></div><p>
      You can also verify the devices in <code class="filename">/dev/disk/by-id</code>
      by entering
     </p><div class="verbatim-wrap"><pre class="screen">ls -l /dev/disk/by-id/</pre></div></li><li class="step"><p>
      Verify the new device appears in the log by entering
     </p><div class="verbatim-wrap"><pre class="screen">sudo journalctl -r</pre></div></li><li class="step"><p>
      Use a text editor to add a new alias definition for the device in the
      <code class="filename">/etc/multipath.conf</code> file, such as
      <code class="filename">data_vol3</code>.
     </p><p>
      For example, if the UUID is
      <code class="filename">36006016088d014006e98a7a94a85db11</code>, make the
      following changes:
     </p><div class="verbatim-wrap"><pre class="screen">defaults {
     user_friendly_names   yes
  }
multipaths {
     multipath {
          wwid    36006016088d014006e98a7a94a85db11
          alias  data_vol3
          }
  }</pre></div></li><li class="step"><p>
      Create a partition table for the device by entering
     </p><div class="verbatim-wrap"><pre class="screen">fdisk /dev/disk/by-id/dm-uuid-mpath-&lt;UUID&gt;</pre></div><p>
      Replace UUID with the device WWID, such as
      <code class="filename">36006016088d014006e98a7a94a85db11</code>.
     </p></li><li class="step"><p>
      Trigger udev by entering
     </p><div class="verbatim-wrap"><pre class="screen">sudo echo 'add' &gt; /sys/block/<em class="replaceable">DM_DEVICE</em>/uevent</pre></div><p>
      For example, to generate the device-mapper devices for the partitions on
      <code class="filename">dm-8</code>, enter
     </p><div class="verbatim-wrap"><pre class="screen">sudo echo 'add' &gt; /sys/block/dm-8/uevent</pre></div></li><li class="step"><p>
      Create a file system on the device
      <code class="filename">/dev/disk/by-id/dm-uuid-mpath-<em class="replaceable">UUID_partN</em></code>.
      Depending on your choice for the file system, you may use one of the
      following commands for this purpose: <code class="command">mkfs.btrfs</code>
      <code class="command">mkfs.ext3</code>, <code class="command">mkfs.ext4</code>, or
      <code class="command">mkfs.xfs</code>. Refer to the respective man pages for
      details. Replace <code class="filename">UUID_partN</code> with the actual UUID and
      partition number, such as 36006016088d014006e98a7a94a85db11_part1.
     </p></li><li class="step"><p>
      Create a label for the new partition by entering the following command:
     </p><div class="verbatim-wrap"><pre class="screen">sudo tune2fs -L <em class="replaceable">LABELNAME</em> /dev/disk/by-id/dm-uuid-<em class="replaceable">UUID_partN</em></pre></div><p>
      Replace <code class="filename">UUID_partN</code> with the actual UUID and
      partition number, such as 36006016088d014006e98a7a94a85db11_part1.
      Replace <em class="replaceable">LABELNAME</em> with a label of your choice.
     </p></li><li class="step"><p>
      Reconfigure DM-MPIO to let it read the aliases by entering
     </p><div class="verbatim-wrap"><pre class="screen">sudo multipathd -k'reconfigure'</pre></div></li><li class="step"><p>
      Verify that the device is recognized by
      <code class="systemitem">multipathd</code> by entering
     </p><div class="verbatim-wrap"><pre class="screen">sudo multipath -ll</pre></div></li><li class="step"><p>
      Use a text editor to add a mount entry in the
      <code class="filename">/etc/fstab</code> file.
     </p><p>
      At this point, the alias you created in a previous step is not yet in the
      <code class="filename">/dev/disk/by-label</code> directory. Add a mount entry for
      the <code class="filename">/dev/dm-9</code> path, then change the entry before the
      next time you reboot to
     </p><div class="verbatim-wrap"><pre class="screen">LABEL=<em class="replaceable">LABELNAME</em></pre></div></li><li class="step"><p>
      Create a directory to use as the mount point, then mount the device.
     </p></li></ol></div></div></section><section class="sect2" id="sec-multipath-best-practice-status" data-id-title="Viewing Multipath I/O Status"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.14.3 </span><span class="title-name">Viewing Multipath I/O Status</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-best-practice-status">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    Querying the multipath I/O status outputs the current status of the
    multipath maps.
   </p><p>
    The <code class="command">multipath -l</code> option displays the current path status
    as of the last time that the path checker was run. It does not run the path
    checker.
   </p><p>
    The <code class="command">multipath -ll</code> option runs the path checker, updates
    the path information, then displays the current status information. This
    command always displays the latest information about the path status.
   </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>sudo multipath -ll
3600601607cf30e00184589a37a31d911
[size=127 GB][features="0"][hwhandler="1 emc"]

\_ round-robin 0 [active][first]
  \_ 1:0:1:2 sdav 66:240  [ready ][active]
  \_ 0:0:1:2 sdr  65:16   [ready ][active]

\_ round-robin 0 [enabled]
  \_ 1:0:0:2 sdag 66:0    [ready ][active]
  \_ 0:0:0:2 sdc  8:32    [ready ][active]</pre></div><p>
    For each device, it shows the device’s ID, size, features, and hardware
    handlers.
   </p><p>
    Paths to the device are automatically grouped into priority groups on
    device discovery. Only one priority group is active at a time. For an
    active/active configuration, all paths are in the same group. For an
    active/passive configuration, the passive paths are placed in separate
    priority groups.
   </p><p>
    The following information is displayed for each group:
   </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
      Scheduling policy used to balance I/O within the group, such as
      round-robin
     </p></li><li class="listitem"><p>
      Whether the group is active, disabled, or enabled
     </p></li><li class="listitem"><p>
      Whether the group is the first (highest priority) group
     </p></li><li class="listitem"><p>
      Paths contained within the group
     </p></li></ul></div><p>
    The following information is displayed for each path:
   </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
      The physical address as <em class="replaceable">HOST:BUS:TARGET:LUN</em>,
      such as 1:0:1:2
     </p></li><li class="listitem"><p>
      Device node name, such as <code class="filename">sda</code>
     </p></li><li class="listitem"><p>
      Major:minor numbers
     </p></li><li class="listitem"><p>
      Status of the device
     </p></li></ul></div></section><section class="sect2" id="sec-multipath-best-practice-io-error" data-id-title="Managing I/O in Error Situations"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.14.4 </span><span class="title-name">Managing I/O in Error Situations</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-best-practice-io-error">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    You might need to configure multipathing to queue I/O if all paths fail
    concurrently by enabling queue_if_no_path. Otherwise, I/O fails immediately
    if all paths are gone. In certain scenarios, where the driver, the HBA, or
    the fabric experience spurious errors, DM-MPIO should be configured to
    queue all I/O where those errors lead to a loss of all paths, and never
    propagate errors upward.
   </p><p>
    When you use multipathed devices in a cluster, you might choose to disable
    queue_if_no_path. This automatically fails the path instead of queuing the
    I/O, and escalates the I/O error to cause a failover of the cluster
    resources.
   </p><p>
    Because enabling queue_if_no_path leads to I/O being queued indefinitely
    unless a path is reinstated, ensure that <code class="command">multipathd</code> is
    running and works for your scenario. Otherwise, I/O might be stalled
    indefinitely on the affected multipathed device until reboot or until you
    manually return to failover instead of queuing.
   </p><p>
    To test the scenario:
   </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
      Open a terminal console.
     </p></li><li class="step"><p>
      Activate queuing instead of failover for the device I/O by entering
     </p><div class="verbatim-wrap"><pre class="screen">sudo dmsetup message <em class="replaceable">DEVICE_ID</em> 0 queue_if_no_path</pre></div><p>
      Replace the <em class="replaceable">DEVICE_ID</em> with the ID for your
      device. The 0 value represents the sector and is used when sector
      information is not needed.
     </p><p>
      For example, enter:
     </p><div class="verbatim-wrap"><pre class="screen">sudo dmsetup message 3600601607cf30e00184589a37a31d911 0 queue_if_no_path</pre></div></li><li class="step"><p>
      Return to failover for the device I/O by entering
     </p><div class="verbatim-wrap"><pre class="screen">sudo dmsetup message <em class="replaceable">DEVICE_ID</em> 0 fail_if_no_path</pre></div><p>
      This command immediately causes all queued I/O to fail.
     </p><p>
      Replace the <em class="replaceable">DEVICE_ID</em> with the ID for your
      device. For example, enter
     </p><div class="verbatim-wrap"><pre class="screen">sudo dmsetup message 3600601607cf30e00184589a37a31d911 0 fail_if_no_path</pre></div></li></ol></div></div><p>
    To set up queuing I/O for scenarios where all paths fail:
   </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
      Open a terminal console.
     </p></li><li class="step"><p>
      Open the <code class="filename">/etc/multipath.conf</code> file in a text editor.
     </p></li><li class="step"><p>
      Uncomment the defaults section and its ending bracket, then add the
      <code class="literal">default_features</code> setting, as follows:
     </p><div class="verbatim-wrap"><pre class="screen">defaults {
  default_features "1 queue_if_no_path"
}</pre></div></li><li class="step"><p>
      After you modify the <code class="filename">/etc/multipath.conf</code> file, you
      must run <code class="command">dracut</code> <code class="option">-f</code> to re-create the
      <code class="filename">initrd</code> on your system, then reboot for the changes
      to take effect.
     </p></li><li class="step"><p>
      When you are ready to return to failover for the device I/O, enter
     </p><div class="verbatim-wrap"><pre class="screen">sudo dmsetup message <em class="replaceable">MAPNAME</em> 0 fail_if_no_path</pre></div><p>
      Replace the <em class="replaceable">MAPNAME</em> with the mapped alias name
      or the device ID for the device. The 0 value represents the sector and is
      used when sector information is not needed.
     </p><p>
      This command immediately causes all queued I/O to fail and propagates the
      error to the calling application.
     </p></li></ol></div></div></section><section class="sect2" id="sec-multipath-best-practice-io-stalled" data-id-title="Resolving Stalled I/O"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.14.5 </span><span class="title-name">Resolving Stalled I/O</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-best-practice-io-stalled">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    If all paths fail concurrently and I/O is queued and stalled, do the
    following:
   </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
      Enter the following command at a terminal prompt:
     </p><div class="verbatim-wrap"><pre class="screen">sudo dmsetup message <em class="replaceable">MAPNAME</em> 0 fail_if_no_path</pre></div><p>
      Replace <code class="literal"><em class="replaceable">MAPNAME</em></code> with the
      correct device ID or mapped alias name for the device. The 0 value
      represents the sector and is used when sector information is not needed.
     </p><p>
      This command immediately causes all queued I/O to fail and propagates the
      error to the calling application.
     </p></li><li class="step"><p>
      Reactivate queuing by entering the following command:
     </p><div class="verbatim-wrap"><pre class="screen">sudo dmsetup message <em class="replaceable">MAPNAME</em> 0 queue_if_no_path</pre></div></li></ol></div></div></section><section class="sect2" id="sec-multipath-best-practice-zseries" data-id-title="Configuring Default Settings for IBM IBM Z Devices"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.14.6 </span><span class="title-name">Configuring Default Settings for IBM IBM Z Devices</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-best-practice-zseries">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    Testing of the IBM Z device with multipathing has shown that the
    <code class="literal">dev_loss_tmo</code> parameter should be set to infinity
    (2147483647), and the <code class="literal">fast_io_fail_tmo</code> parameter should
    be set to 5 seconds. If you are using IBM Z devices, modify the
    <code class="filename">/etc/multipath.conf</code> file to specify the values as
    follows:
   </p><div class="verbatim-wrap"><pre class="screen">defaults {
       dev_loss_tmo 2147483647
       fast_io_fail_tmo 5
}</pre></div><p>
    The <code class="literal">dev_loss_tmo</code> parameter sets the number of seconds to
    wait before marking a multipath link as bad. When the path fails, any
    current I/O on that failed path fails. The default value varies according
    to the device driver being used. To use the driver’s internal timeouts, set
    the value to zero (0). It can also be set to "infinity" or 2147483647, which
    sets it to the max value of 2147483647 seconds (68 years).
   </p><p>
    The <code class="literal">fast_io_fail_tmo</code> parameter sets the length of time
    to wait before failing I/O when a link problem is detected. I/O that
    reaches the driver fails. If I/O is in a blocked queue, the I/O does not
    fail until the <code class="literal">dev_loss_tmo</code> time elapses and the queue
    is unblocked.
   </p><p>
    If you modify the <code class="filename">/etc/multipath.conf</code> file, the
    changes are not applied until you update the multipath maps, or until the
    <code class="systemitem">multipathd</code> daemon is restarted
    (<code class="command">systemctl restart multipathd</code>).
   </p></section><section class="sect2" id="sec-multipath-best-practice-netapp" data-id-title="Using Multipath with NetApp Devices"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.14.7 </span><span class="title-name">Using Multipath with NetApp Devices</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-best-practice-netapp">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    When using multipath for NetApp devices, we recommend the following
    settings in the <code class="filename">/etc/multipath.conf</code> file:
   </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
      Set the default values for the following parameters globally for NetApp
      devices:
     </p><div class="verbatim-wrap"><pre class="screen">max_fds max
queue_without_daemon no</pre></div></li><li class="listitem"><p>
      Set the default values for the following parameters for NetApp devices in
      the hardware table:
     </p><div class="verbatim-wrap"><pre class="screen">dev_loss_tmo infinity
fast_io_fail_tmo 5
features "3 queue_if_no_path pg_init_retries 50"</pre></div></li></ul></div></section><section class="sect2" id="sec-multipath-best-practice-noflush" data-id-title="Using --noflush with Multipath Devices"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.14.8 </span><span class="title-name">Using --noflush with Multipath Devices</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-best-practice-noflush">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    The <code class="option">--noflush</code> option should always be used when running on
    multipath devices.
   </p><p>
    For example, in scripts where you perform a table reload, you use the
    <code class="literal">--noflush</code> option on resume to ensure that any
    outstanding I/O is not flushed, because you need the multipath topology
    information.
   </p><div class="verbatim-wrap"><pre class="screen">load
resume --noflush</pre></div></section><section class="sect2" id="sec-multipath-best-practice-san-timeout" data-id-title="SAN Timeout Settings When the Root Device Is Multipathed"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.14.9 </span><span class="title-name">SAN Timeout Settings When the Root Device Is Multipathed</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-best-practice-san-timeout">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    A system with root (<code class="filename">/</code>) on a multipath device might
    stall when all paths have failed and are removed from the system because a
    <code class="literal">dev_loss_tmo</code> timeout is received from the storage
    subsystem (such as Fibre Channel storage arrays).
   </p><p>
    If the system device is configured with multiple paths and the multipath
    <code class="literal">no_path_retry</code> setting is active, you should modify the
    storage subsystem’s <code class="literal">dev_loss_tmo</code> setting accordingly
    to ensure that no devices are removed during an all-paths-down scenario. We
    strongly recommend that you set the <code class="literal">dev_loss_tmo</code> value
    to be equal to or higher than the <code class="literal">no_path_retry</code> setting
    from multipath.
   </p><p>
    The recommended setting for the storage subsystem’s
    <code class="literal">dev_los_tmo</code> is
   </p><div class="verbatim-wrap"><pre class="screen">&lt;dev_loss_tmo&gt; = &lt;no_path_retry&gt; * &lt;polling_interval&gt;</pre></div><p>
    where the following definitions apply for the multipath values:
   </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
      <code class="literal">no_path_retry</code> is the number of retries for multipath
      I/O until the path is considered to be lost, and queuing of IO is
      stopped.
     </p></li><li class="listitem"><p>
      <code class="literal">polling_interval</code> is the time in seconds between path
      checks.
     </p></li></ul></div><p>
    Each of these multipath values should be set from the
    <code class="filename">/etc/multipath.conf</code> configuration file. For
    information, see
    <a class="xref" href="cha-multipath.html#sec-multipath-conf-file" title="17.6. Creating or Modifying the /etc/multipath.conf File">Section 17.6, “Creating or Modifying the /etc/multipath.conf File”</a>.
   </p></section></section><section class="sect1" id="sec-multipath-trouble" data-id-title="Troubleshooting MPIO"><div class="titlepage"><div><div><div class="title-container"><h2 class="title"><span class="title-number-name"><span class="title-number">17.15 </span><span class="title-name">Troubleshooting MPIO</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-trouble">#</a></h2><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
   This section describes some known issues and possible solutions for MPIO.
  </p><section class="sect2" id="sec-multipath-trouble-root" data-id-title="The System Exits to Emergency Shell at Boot When Multipath Is Enabled"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.15.1 </span><span class="title-name">The System Exits to Emergency Shell at Boot When Multipath Is Enabled</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-trouble-root">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    During boot the system exits into the emergency shell with messages similar
    to the following:
   </p><div class="verbatim-wrap"><pre class="screen">[  OK  ] Listening on multipathd control socket.
         Starting Device-Mapper Multipath Device Controller...
[  OK  ] Listening on Device-mapper event daemon FIFOs.
         Starting Device-mapper event daemon...
         Expecting device dev-disk-by\x2duuid-34be48b2\x2dc21...32dd9.device...
         Expecting device dev-sda2.device...
[  OK  ] Listening on udev Kernel Socket.
[  OK  ] Listening on udev Control Socket.
         Starting udev Coldplug all Devices...
         Expecting device dev-disk-by\x2duuid-1172afe0\x2d63c...5d0a7.device...
         Expecting device dev-disk-by\x2duuid-c4a3d1de\x2d4dc...ef77d.device...
[  OK  ] Started Create list of required static device nodes ...current kernel.
         Starting Create static device nodes in /dev...
[  OK  ] Started Collect Read-Ahead Data.
[  OK  ] Started Device-mapper event daemon.
[  OK  ] Started udev Coldplug all Devices.
         Starting udev Wait for Complete Device Initialization...
[  OK  ] Started Replay Read-Ahead Data.
         Starting Load Kernel Modules...
         Starting Remount Root and Kernel File Systems...
[  OK  ] Started Create static devices
[   13.682489] floppy0: no floppy controllers found
[*     ] (1 of 4) A start job is running for dev-disk-by\x2du...(7s / 1min 30s)
[*     ] (1 of 4) A start job is running for dev-disk-by\x2du...(7s / 1min 30s)

...

Timed out waiting for device dev-disk-by\x2duuid-c4a...cfef77d.device.
[DEPEND] Dependency failed for /opt.
[DEPEND] Dependency failed for Local File Systems.
[DEPEND] Dependency failed for Postfix Mail Transport Agent.
Welcome to emergency shell
Give root password for maintenance
(or press Control-D to continue):</pre></div><p>
     At this stage, you are working in a temporary <code class="command">dracut</code>
     emergency shell from the initrd environment. To make the configuration
     changes described below persistent, you need to perform them in the
     in the environment of the installed system.
    </p><div class="procedure"><div class="procedure-contents"><ol class="procedure" type="1"><li class="step"><p>
       Identify what the system root (<code class="filename">/</code>) file system is.
       Inspect the content of the <code class="filename">/proc/cmdline</code> and
       look for the <code class="option">root=</code> parameter.
      </p></li><li class="step"><p>
       Verify whether the root file system is mounted:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> systemctl status sysroot.mount</pre></div><div id="id-1.10.6.6.18.3.5.2.3" class="admonition tip normal"><img class="symbol" alt="Tip" title="Tip" src="static/images/icon-tip.svg"/><div class="admon-title">Tip</div><p>
        <code class="command">dracut</code> mounts the root file system under
        <code class="filename">/sysroot</code> by default.
       </p></div><p>
       From now on, let us assume that the root file system is mounted under
       <code class="filename">/sysroot</code>.
      </p></li><li class="step"><p>
       Mount system-required file systems under <code class="filename">/sysroot</code>,
       <code class="command">chroot</code> into it, then mount all file systems.
       For example:
      </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code><code class="command">sudo</code> for x in proc sys dev run; do mount --bind /$x /sysroot/$x; done
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> chroot /sysroot /bin/bash
<code class="prompt user">tux &gt; </code><code class="command">sudo</code> mount -a</pre></div><p>
       Refer to <span class="intraxref">Book “Administration Guide”, Chapter 41 “Common problems and their solutions”, Section 41.6.2.3 “Accessing the Installed System”</span> for
       more details.
      </p></li><li class="step"><p>
       Make changes to the multipath or dracut configuration as suggested
       in the procedures below. Remember to rebuild <code class="filename">initrd</code>
       to include the modifications.
      </p></li><li class="step"><p>
       Exit the <code class="command">chroot</code> environment by entering the
       <code class="command">exit</code> command, then exit the emergency shell and
       reboot the server by pressing <span class="keycap">Ctrl</span><span class="key-connector">–</span><span class="keycap">D</span>.
      </p></li></ol></div></div><div class="procedure" id="pro-multipath-trouble-root-blacklist" data-id-title="Emergency Shell: Blacklist File Systems"><div class="title-container"><div class="procedure-title-wrap"><div class="procedure-title"><span class="title-number-name"><span class="title-number">Procedure 17.1: </span><span class="title-name">Emergency Shell: Blacklist File Systems </span></span><a title="Permalink" class="permalink" href="cha-multipath.html#pro-multipath-trouble-root-blacklist">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div><div class="procedure-contents"><p>
     This fix is required if the root file system is not on multipath but
     multipath is enabled. In such a setup, multipath tries to set its paths
     for all devices that are not blacklisted. Since the device with the root
     file system is already mounted, it is inaccessible for multipath and
     causes it to fail. Fix this issue by configuring multipath correctly by
     blacklisting the root device in <code class="filename">/etc/multipath.conf</code>:
    </p><ol class="procedure" type="1"><li class="step"><p>
      Run <code class="command">multipath -v2</code> in the emergency shell and identify
      the device for the root file system. It will result in an output similar
      to:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt root">root # </code>multipath -v2
Dec 18 10:10:03 | 3600508b1001030343841423043300400: ignoring map</pre></div><p>
      The string between <code class="literal">| </code> and <code class="literal">:</code> is the
      WWID needed for blacklisting.
     </p></li><li class="step"><p>
      Open <code class="filename">/etc/multipath.conf</code> and add the following:
     </p><div class="verbatim-wrap"><pre class="screen">blacklist {
  wwid "<em class="replaceable">WWID</em>"
}</pre></div><p>
      Replace <em class="replaceable">WWID</em> with the ID you retrieved in the
      previous step. For more information see
      <a class="xref" href="cha-multipath.html#sec-multipath-blacklist" title="17.8. Blacklisting Non-Multipath Devices">Section 17.8, “Blacklisting Non-Multipath Devices”</a>.
     </p></li><li class="step"><p>
      Rebuild the <code class="systemitem">initrd</code> using the following command:
     </p><div class="verbatim-wrap"><pre class="screen"><code class="prompt user">tux &gt; </code>dracut -f --add-multipath</pre></div></li></ol></div></div><div class="procedure" id="pro-multipath-trouble-root-initrd" data-id-title="Emergency Shell: Rebuild the initrd"><div class="title-container"><div class="procedure-title-wrap"><div class="procedure-title"><span class="title-number-name"><span class="title-number">Procedure 17.2: </span><span class="title-name">Emergency Shell: Rebuild the <code class="filename">initrd</code> </span></span><a title="Permalink" class="permalink" href="cha-multipath.html#pro-multipath-trouble-root-initrd">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div><div class="procedure-contents"><p>
     This fix is required if the multipath status (enabled or disabled) differs
     between <code class="filename">initrd</code> and system. To fix this, rebuild the
     <code class="filename">initrd</code>:
    </p><ul class="procedure"><li class="step"><p>
      If multipath has been <span class="emphasis"><em>enabled</em></span> in the system,
      rebuild the initrd with multipath support with this command:
     </p><div class="verbatim-wrap"><pre class="screen">dracut --force --add multipath</pre></div><p>
      In case Multipath has been <span class="emphasis"><em>disabled</em></span> in the system,
      rebuild the initrd with Multipath support with this command:
     </p><div class="verbatim-wrap"><pre class="screen">dracut --force -o multipath</pre></div></li></ul></div></div><div class="procedure" id="pro-multipath-trouble-root-drivers" data-id-title="Emergency Shell: Rebuild the initrd"><div class="title-container"><div class="procedure-title-wrap"><div class="procedure-title"><span class="title-number-name"><span class="title-number">Procedure 17.3: </span><span class="title-name">Emergency Shell: Rebuild the <code class="filename">initrd</code> </span></span><a title="Permalink" class="permalink" href="cha-multipath.html#pro-multipath-trouble-root-drivers">#</a></div></div><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div><div class="procedure-contents"><p>
     This fix is required if the initrd does not contain drivers to access
     network attached storage. This may, for example, be the case when the
     system was installed without multipath or when the respective hardware was
     added or replaced.
    </p><ol class="procedure" type="1"><li class="step"><p>
      Add the required driver(s) to the variable <code class="envar">force_drivers</code>
      in the file <code class="filename">/etc/dracut.conf.d/01-dist.conf</code>. For
      example, if your system contains a RAID controller accessed by the
      <code class="filename">hpsa</code> driver and multipathed devices connected to a
      QLogic controller accessed by the driver qla23xx, this entry would look
      like:
     </p><div class="verbatim-wrap"><pre class="screen">force_drivers+="hpsa qla23xx"</pre></div></li><li class="step"><p>
      Rebuild the <code class="systemitem">initrd</code> using the following command:
     </p><div class="verbatim-wrap"><pre class="screen">dracut -f --add-multipath</pre></div></li><li class="step"><p>
      To prevent the system from booting into emergency mode if attaching the
      network storage fails, it is recommended to add the mount option
      <code class="literal">_netdev</code> to the respective entries in
      <code class="filename">/etc/fstab</code>.
     </p></li></ol></div></div></section><section class="sect2" id="sec-multipath-trouble-prio-fail" data-id-title="PRIO Settings for Individual Devices Fail After Upgrading to Multipath 0.4.9 or Later"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.15.2 </span><span class="title-name">PRIO Settings for Individual Devices Fail After Upgrading to Multipath 0.4.9 or Later</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-trouble-prio-fail">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    Multipath Tools from version 0.4.9 onward uses the <code class="literal">prio</code>
    setting in the <code class="literal">defaults{}</code> or
    <code class="literal">devices{}</code> section of the
    <code class="filename">/etc/multipath.conf</code> file. It silently ignores the
    keyword <code class="literal">prio</code> when it is specified for an individual
    <code class="literal">multipath</code> definition in the
    <code class="literal">multipaths{)</code> section.
   </p><p>
    Multipath Tools 0.4.8 allowed the prio setting in the individual
    <code class="literal">multipath</code> definition in the
    <code class="literal">multipaths{)</code> section to override the
    <code class="literal">prio</code> settings in the <code class="literal">defaults{}</code> or
    <code class="literal">devices{}</code> section.
   </p></section><section class="sect2" id="sec-multipath-trouble-prio-argument-fail" data-id-title="PRIO Settings with Arguments Fail After Upgrading to multipath-tools-0.4.9 or Later"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.15.3 </span><span class="title-name">PRIO Settings with Arguments Fail After Upgrading to multipath-tools-0.4.9 or Later</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-trouble-prio-argument-fail">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    When you upgrade from <code class="filename">multipath-tools-0.4.8</code> to
    <code class="filename">multipath-tools-0.4.9</code>, the <code class="literal">prio</code>
    settings in the <code class="filename">/etc/multipath.conf</code> file are broken
    for prioritizers that require an argument. In multipath-tools-0.4.9, the
    <code class="literal">prio</code> keyword is used to specify the prioritizer, and the
    <code class="literal">prio_args</code> keyword is used to specify the argument for
    prioritizers that require an argument. Previously, both the prioritizer and
    its argument were specified on the same <code class="literal">prio</code> line.
   </p><p>
    For example, in multipath-tools-0.4.8, the following line was used to
    specify a prioritizer and its arguments on the same line.
   </p><div class="verbatim-wrap"><pre class="screen">prio "weightedpath hbtl [1,3]:.:.+:.+ 260 [0,2]:.:.+:.+ 20"</pre></div><p>
    After upgrading to multipath-tools-0.4.9 or later, the command causes an
    error. The message is similar to the following:
   </p><div class="verbatim-wrap"><pre class="screen">&lt;Month day hh:mm:ss&gt; | Prioritizer 'weightedpath hbtl [1,3]:.:.+:.+ 260
[0,2]:.:.+:.+ 20' not found in /lib64/multipath</pre></div><p>
    To resolve this problem, use a text editor to modify the
    <code class="literal">prio</code> line in the
    <code class="filename">/etc/multipath.conf</code> file. Create two lines with the
    prioritizer specified on the <code class="filename">prio</code> line, and the
    prioritizer argument specified on the <code class="filename">prio_args</code> line
    below it:
   </p><div class="verbatim-wrap"><pre class="screen">prio "weightedpath"
prio_args "hbtl [1,3]:.:.+:.+ 260 [0,2]:.:.+:.+ 20"</pre></div><p>
    Restart the <code class="systemitem">multipathd</code> daemon for
    the changes to become active by running <code class="command">sudo systemctl restart
    multipathd</code>.
   </p></section><section class="sect2" id="sec-multipath-trouble-tids" data-id-title="Technical Information Documents"><div class="titlepage"><div><div><div class="title-container"><h3 class="title"><span class="title-number-name"><span class="title-number">17.15.4 </span><span class="title-name">Technical Information Documents</span></span> <a title="Permalink" class="permalink" href="cha-multipath.html#sec-multipath-trouble-tids">#</a></h3><div class="icons"><a target="_blank" class="icon-reportbug" title="Report an issue"> </a><a target="_blank" class="icon-editsource" href="https://github.com/SUSE/doc-sle/edit/maintenance/SLE12SP4/xml/storage_multipath.xml" title="Edit source document"> </a></div></div></div></div></div><p>
    For information about troubleshooting multipath I/O issues on SUSE Linux
    Enterprise Server, see the following Technical Information Documents (TIDs)
    in the SUSE Knowledgebase:
   </p><div class="itemizedlist"><ul class="itemizedlist"><li class="listitem"><p>
      <a class="link" href="https://www.suse.com/support/kb/doc.php?id=3617600" target="_blank"><em class="citetitle">Using
      LVM on local and SAN attached devices</em></a>
     </p></li><li class="listitem"><p>
      <a class="link" href="https://www.suse.com/support/kb/doc.php?id=7007498" target="_blank"><em class="citetitle">Using
      LVM on Multipath (DM MPIO) Devices</em></a>
     </p></li><li class="listitem"><p>
      <a class="link" href="https://www.suse.com/support/kb/doc.php?id=7009660" target="_blank"><em class="citetitle">HOWTO:
      Add, Resize and Remove LUN without restarting SLES</em></a>
     </p></li></ul></div></section></section></section><nav class="bottom-pagination"><div><a class="pagination-link prev" href="cha-nvmeof.html"><span class="pagination-relation">Previous</span><span class="pagination-label"><span class="title-number">Chapter 16 </span>NVMe-oF</span></a> </div><div><a class="pagination-link next" href="cha-nfs4-acls.html"><span class="pagination-relation">Next</span><span class="pagination-label"><span class="title-number">Chapter 18 </span>Managing Access Control Lists over NFSv4</span></a> </div></nav></article><aside id="_side-toc-page" class="side-toc"><div class="side-title">On this page</div><div class="toc"><ul><li><span class="sect1"><a href="cha-multipath.html#sec-multipath-intro"><span class="title-number">17.1 </span><span class="title-name">Understanding Multipath I/O</span></a></span></li><li><span class="sect1"><a href="cha-multipath.html#sec-multipath-hardware"><span class="title-number">17.2 </span><span class="title-name">Hardware Support</span></a></span></li><li><span class="sect1"><a href="cha-multipath.html#sec-multipath-planning"><span class="title-number">17.3 </span><span class="title-name">Planning for Multipathing</span></a></span></li><li><span class="sect1"><a href="cha-multipath.html#sec-multipath-mpiotools"><span class="title-number">17.4 </span><span class="title-name">Multipath Management Tools</span></a></span></li><li><span class="sect1"><a href="cha-multipath.html#sec-multipath-config"><span class="title-number">17.5 </span><span class="title-name">Configuring the System for Multipathing</span></a></span></li><li><span class="sect1"><a href="cha-multipath.html#sec-multipath-conf-file"><span class="title-number">17.6 </span><span class="title-name">Creating or Modifying the /etc/multipath.conf File</span></a></span></li><li><span class="sect1"><a href="cha-multipath.html#sec-multipath-policies-default"><span class="title-number">17.7 </span><span class="title-name">Configuring Default Policies for Polling, Queuing, and Failback</span></a></span></li><li><span class="sect1"><a href="cha-multipath.html#sec-multipath-blacklist"><span class="title-number">17.8 </span><span class="title-name">Blacklisting Non-Multipath Devices</span></a></span></li><li><span class="sect1"><a href="cha-multipath.html#sec-multipath-names"><span class="title-number">17.9 </span><span class="title-name">Configuring User-Friendly Names or Alias Names</span></a></span></li><li><span class="sect1"><a href="cha-multipath.html#sec-multipath-policies-failover"><span class="title-number">17.10 </span><span class="title-name">Configuring Path Failover Policies and Priorities</span></a></span></li><li><span class="sect1"><a href="cha-multipath.html#sec-multipath-root"><span class="title-number">17.11 </span><span class="title-name">Configuring Multipath I/O for the Root Device</span></a></span></li><li><span class="sect1"><a href="cha-multipath.html#sec-multipath-raid"><span class="title-number">17.12 </span><span class="title-name">Configuring Multipath I/O for an Existing Software RAID</span></a></span></li><li><span class="sect1"><a href="cha-multipath.html#sec-multipath-lvm"><span class="title-number">17.13 </span><span class="title-name">Using LVM2 on Multipath Devices</span></a></span></li><li><span class="sect1"><a href="cha-multipath.html#sec-multipath-best-practice"><span class="title-number">17.14 </span><span class="title-name">Best Practice</span></a></span></li><li><span class="sect1"><a href="cha-multipath.html#sec-multipath-trouble"><span class="title-number">17.15 </span><span class="title-name">Troubleshooting MPIO</span></a></span></li></ul></div><div class="side-title">Share this page</div><ul class="share"><li><a id="_share-fb" href="#" title="Facebook"> </a></li><li><a id="_share-in" href="#" title="LinkedIn"> </a></li><li><a id="_share-tw" href="#" title="Twitter/X"> </a></li><li><a id="_share-mail" href="#" title="E-Mail"> </a></li><li><a id="_print-button" href="#" title="Print this page"> </a></li></ul> </aside></main><footer id="_footer"><div class="growth-inhibitor"><div class="copy"><span class="copy__rights">© SUSE
                 2024</span></div></div></footer></body></html>